begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2011 Nokia Corporation and/or its subsidiary(-ies). ** All rights reserved. ** Contact: Nokia Corporation (qt-info@nokia.com) ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL$ ** GNU Lesser General Public License Usage ** This file may be used under the terms of the GNU Lesser General Public ** License version 2.1 as published by the Free Software Foundation and ** appearing in the file LICENSE.LGPL included in the packaging of this ** file. Please review the following information to ensure the GNU Lesser ** General Public License version 2.1 requirements will be met: ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Nokia gives you certain additional ** rights. These rights are described in the Nokia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU General ** Public License version 3.0 as published by the Free Software Foundation ** and appearing in the file LICENSE.GPL included in the packaging of this ** file. Please review the following information to ensure the GNU General ** Public License version 3.0 requirements will be met: ** http://www.gnu.org/copyleft/gpl.html. ** ** Other Usage ** Alternatively, this file may be used in accordance with the terms and ** conditions contained in a signed written agreement between you and Nokia. ** ** ** ** ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_ifndef
ifndef|#
directive|ifndef
name|Q_OS_WINCE
end_ifndef
begin_include
include|#
directive|include
file|"../../shared/util.h"
end_include
begin_include
include|#
directive|include
file|<QtGui>
end_include
begin_include
include|#
directive|include
file|<QtWidgets>
end_include
begin_include
include|#
directive|include
file|<math.h>
end_include
begin_if
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_WIN
argument_list|)
operator|&&
name|defined
argument_list|(
name|interface
argument_list|)
end_if
begin_undef
DECL|macro|interface
undef|#
directive|undef
name|interface
end_undef
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"QtTest/qtestaccessible.h"
end_include
begin_if
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_WINCE
argument_list|)
end_if
begin_extern
extern|extern
literal|"C"
name|bool
name|SystemParametersInfo
parameter_list|(
name|UINT
name|uiAction
parameter_list|,
name|UINT
name|uiParam
parameter_list|,
name|PVOID
name|pvParam
parameter_list|,
name|UINT
name|fWinIni
parameter_list|)
function_decl|;
end_extern
begin_define
DECL|macro|SPI_GETPLATFORMTYPE
define|#
directive|define
name|SPI_GETPLATFORMTYPE
value|257
end_define
begin_function
DECL|function|IsValidCEPlatform
specifier|inline
name|bool
name|IsValidCEPlatform
parameter_list|()
block|{
name|wchar_t
name|tszPlatform
index|[
literal|64
index|]
decl_stmt|;
if|if
condition|(
name|SystemParametersInfo
argument_list|(
name|SPI_GETPLATFORMTYPE
argument_list|,
sizeof|sizeof
argument_list|(
name|tszPlatform
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
operator|*
name|tszPlatform
argument_list|)
argument_list|,
name|tszPlatform
argument_list|,
literal|0
argument_list|)
condition|)
block|{
name|QString
name|platform
init|=
name|QString
operator|::
name|fromWCharArray
argument_list|(
name|tszPlatform
argument_list|)
decl_stmt|;
if|if
condition|(
operator|(
name|platform
operator|==
name|QLatin1String
argument_list|(
literal|"PocketPC"
argument_list|)
operator|)
operator|||
operator|(
name|platform
operator|==
name|QLatin1String
argument_list|(
literal|"Smartphone"
argument_list|)
operator|)
condition|)
return|return
literal|false
return|;
block|}
return|return
literal|true
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|verifyChild
specifier|static
specifier|inline
name|bool
name|verifyChild
parameter_list|(
name|QWidget
modifier|*
name|child
parameter_list|,
name|QAccessibleInterface
modifier|*
name|interface
parameter_list|,
name|int
name|index
parameter_list|,
specifier|const
name|QRect
modifier|&
name|domain
parameter_list|)
block|{
if|if
condition|(
operator|!
name|child
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild: null pointer to child."
argument_list|)
expr_stmt|;
return|return
literal|false
return|;
block|}
if|if
condition|(
operator|!
name|interface
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild: null pointer to interface."
argument_list|)
expr_stmt|;
return|return
literal|false
return|;
block|}
comment|// QAccessibleInterface::childAt():
comment|// Calculate global child position and check that the interface
comment|// returns the correct index for that position.
name|QPoint
name|globalChildPos
init|=
name|child
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|int
name|indexFromChildAt
init|=
name|interface
operator|->
name|childAt
argument_list|(
name|globalChildPos
operator|.
name|x
argument_list|()
argument_list|,
name|globalChildPos
operator|.
name|y
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|indexFromChildAt
operator|!=
name|index
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild (childAt()):"
argument_list|)
expr_stmt|;
name|qWarning
argument_list|()
operator|<<
literal|"Expected:"
operator|<<
name|index
expr_stmt|;
name|qWarning
argument_list|()
operator|<<
literal|"Actual:  "
operator|<<
name|indexFromChildAt
expr_stmt|;
return|return
literal|false
return|;
block|}
comment|// QAccessibleInterface::rect():
comment|// Calculate global child geometry and check that the interface
comment|// returns a QRect which is equal to the calculated QRect.
specifier|const
name|QRect
name|expectedGlobalRect
init|=
name|QRect
argument_list|(
name|globalChildPos
argument_list|,
name|child
operator|->
name|size
argument_list|()
argument_list|)
decl_stmt|;
specifier|const
name|QRect
name|rectFromInterface
init|=
name|interface
operator|->
name|rect
argument_list|(
name|index
argument_list|)
decl_stmt|;
if|if
condition|(
name|expectedGlobalRect
operator|!=
name|rectFromInterface
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild (rect()):"
argument_list|)
expr_stmt|;
name|qWarning
argument_list|()
operator|<<
literal|"Expected:"
operator|<<
name|expectedGlobalRect
expr_stmt|;
name|qWarning
argument_list|()
operator|<<
literal|"Actual:  "
operator|<<
name|rectFromInterface
expr_stmt|;
return|return
literal|false
return|;
block|}
comment|// Verify that the child is within its domain.
if|if
condition|(
operator|!
name|domain
operator|.
name|contains
argument_list|(
name|rectFromInterface
argument_list|)
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild: Child is not within its domain."
argument_list|)
expr_stmt|;
return|return
literal|false
return|;
block|}
comment|// Verify that we get a valid QAccessibleInterface for the child.
name|QAccessibleInterface
modifier|*
name|childInterface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|child
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|childInterface
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild: Failed to retrieve interface for child."
argument_list|)
expr_stmt|;
return|return
literal|false
return|;
block|}
comment|// QAccessibleInterface::indexOfChild():
comment|// Verify that indexOfChild() returns an index equal to the index passed by,
comment|// or -1 if child is "Self" (index == 0).
name|int
name|indexFromIndexOfChild
init|=
name|interface
operator|->
name|indexOfChild
argument_list|(
name|childInterface
argument_list|)
decl_stmt|;
operator|delete
name|childInterface
expr_stmt|;
name|int
name|expectedIndex
init|=
name|index
operator|==
literal|0
condition|?
operator|-
literal|1
else|:
name|index
decl_stmt|;
if|if
condition|(
name|indexFromIndexOfChild
operator|!=
name|expectedIndex
condition|)
block|{
name|qWarning
argument_list|(
literal|"tst_QAccessibility::verifyChild (indexOfChild()):"
argument_list|)
expr_stmt|;
name|qWarning
argument_list|()
operator|<<
literal|"Expected:"
operator|<<
name|expectedIndex
expr_stmt|;
name|qWarning
argument_list|()
operator|<<
literal|"Actual:  "
operator|<<
name|indexFromIndexOfChild
expr_stmt|;
return|return
literal|false
return|;
block|}
comment|// Navigate to child, compare its object and role with the interface from queryAccessibleInterface(child).
block|{
name|QAccessibleInterface
modifier|*
name|navigatedChildInterface
init|=
literal|0
decl_stmt|;
specifier|const
name|int
name|status
init|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|index
argument_list|,
operator|&
name|navigatedChildInterface
argument_list|)
decl_stmt|;
comment|// We are navigating to a separate widget/interface, so status should be 0.
if|if
condition|(
name|status
operator|!=
literal|0
condition|)
return|return
literal|false
return|;
if|if
condition|(
name|navigatedChildInterface
operator|==
literal|0
condition|)
return|return
literal|false
return|;
operator|delete
name|navigatedChildInterface
expr_stmt|;
block|}
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|indexOfChild
specifier|static
specifier|inline
name|int
name|indexOfChild
parameter_list|(
name|QAccessibleInterface
modifier|*
name|parentInterface
parameter_list|,
name|QWidget
modifier|*
name|childWidget
parameter_list|)
block|{
if|if
condition|(
operator|!
name|parentInterface
operator|||
operator|!
name|childWidget
condition|)
return|return
operator|-
literal|1
return|;
name|QAccessibleInterface
modifier|*
name|childInterface
init|=
name|QAccessibleInterface
operator|::
name|queryAccessibleInterface
argument_list|(
name|childWidget
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|childInterface
condition|)
return|return
operator|-
literal|1
return|;
name|int
name|index
init|=
name|parentInterface
operator|->
name|indexOfChild
argument_list|(
name|childInterface
argument_list|)
decl_stmt|;
operator|delete
name|childInterface
expr_stmt|;
return|return
name|index
return|;
block|}
end_function
begin_define
DECL|macro|EXPECT
define|#
directive|define
name|EXPECT
parameter_list|(
name|cond
parameter_list|)
define|\
value|do { \         if (!errorAt&& !(cond)) { \             errorAt = __LINE__; \             qWarning("level: %d, middle: %d, role: %d (%s)", treelevel, middle, iface->role(0), #cond); \         } \     } while (0)
end_define
begin_function
DECL|function|verifyHierarchy
specifier|static
name|int
name|verifyHierarchy
parameter_list|(
name|QAccessibleInterface
modifier|*
name|iface
parameter_list|)
block|{
name|int
name|errorAt
init|=
literal|0
decl_stmt|;
name|int
name|entry
init|=
literal|0
decl_stmt|;
specifier|static
name|int
name|treelevel
init|=
literal|0
decl_stmt|;
comment|// for error diagnostics
name|QAccessibleInterface
modifier|*
name|middleChild
decl_stmt|,
modifier|*
name|if2
decl_stmt|,
modifier|*
name|if3
decl_stmt|;
name|middleChild
operator|=
literal|0
expr_stmt|;
operator|++
name|treelevel
expr_stmt|;
name|int
name|middle
init|=
name|iface
operator|->
name|childCount
argument_list|()
operator|/
literal|2
operator|+
literal|1
decl_stmt|;
if|if
condition|(
name|iface
operator|->
name|childCount
argument_list|()
operator|>=
literal|2
condition|)
block|{
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|middle
argument_list|,
operator|&
name|middleChild
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|iface
operator|->
name|childCount
argument_list|()
operator|&&
operator|!
name|errorAt
condition|;
operator|++
name|i
control|)
block|{
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|i
operator|+
literal|1
argument_list|,
operator|&
name|if2
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|==
literal|0
condition|)
block|{
comment|// navigate Ancestor...
name|QAccessibleInterface
modifier|*
name|parent
init|=
literal|0
decl_stmt|;
name|entry
operator|=
name|if2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Ancestor
argument_list|,
literal|1
argument_list|,
operator|&
name|parent
argument_list|)
expr_stmt|;
name|EXPECT
argument_list|(
name|entry
operator|==
literal|0
operator|&&
name|iface
operator|->
name|object
argument_list|()
operator|==
name|parent
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|parent
expr_stmt|;
comment|// navigate Sibling...
if|if
condition|(
name|middleChild
condition|)
block|{
name|entry
operator|=
name|if2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
name|middle
argument_list|,
operator|&
name|if3
argument_list|)
expr_stmt|;
name|EXPECT
argument_list|(
name|entry
operator|==
literal|0
operator|&&
name|if3
operator|->
name|object
argument_list|()
operator|==
name|middleChild
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|==
literal|0
condition|)
operator|delete
name|if3
expr_stmt|;
name|EXPECT
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|middleChild
argument_list|)
operator|==
name|middle
argument_list|)
expr_stmt|;
block|}
comment|// verify children...
if|if
condition|(
operator|!
name|errorAt
condition|)
name|errorAt
operator|=
name|verifyHierarchy
argument_list|(
name|if2
argument_list|)
expr_stmt|;
operator|delete
name|if2
expr_stmt|;
block|}
else|else
block|{
comment|// leaf nodes
block|}
block|}
operator|delete
name|middleChild
expr_stmt|;
operator|--
name|treelevel
expr_stmt|;
return|return
name|errorAt
return|;
block|}
end_function
begin_comment
comment|//TESTED_FILES=
end_comment
begin_class
DECL|class|tst_QAccessibility
class|class
name|tst_QAccessibility
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
public|public:
name|tst_QAccessibility
parameter_list|()
constructor_decl|;
specifier|virtual
name|~
name|tst_QAccessibility
parameter_list|()
destructor_decl|;
public|public
name|slots
public|:
name|void
name|initTestCase
parameter_list|()
function_decl|;
name|void
name|cleanupTestCase
parameter_list|()
function_decl|;
name|void
name|init
parameter_list|()
function_decl|;
name|void
name|cleanup
parameter_list|()
function_decl|;
private|private
name|slots
private|:
name|void
name|eventTest
parameter_list|()
function_decl|;
name|void
name|customWidget
parameter_list|()
function_decl|;
name|void
name|deletedWidget
parameter_list|()
function_decl|;
name|void
name|navigateGeometric
parameter_list|()
function_decl|;
name|void
name|navigateHierarchy
parameter_list|()
function_decl|;
name|void
name|sliderTest
parameter_list|()
function_decl|;
name|void
name|navigateCovered
parameter_list|()
function_decl|;
name|void
name|textAttributes
parameter_list|()
function_decl|;
name|void
name|hideShowTest
parameter_list|()
function_decl|;
name|void
name|userActionCount
parameter_list|()
function_decl|;
name|void
name|actionText
parameter_list|()
function_decl|;
name|void
name|doAction
parameter_list|()
function_decl|;
name|void
name|applicationTest
parameter_list|()
function_decl|;
name|void
name|mainWindowTest
parameter_list|()
function_decl|;
name|void
name|buttonTest
parameter_list|()
function_decl|;
name|void
name|scrollBarTest
parameter_list|()
function_decl|;
name|void
name|tabTest
parameter_list|()
function_decl|;
name|void
name|tabWidgetTest
parameter_list|()
function_decl|;
name|void
name|menuTest
parameter_list|()
function_decl|;
name|void
name|spinBoxTest
parameter_list|()
function_decl|;
name|void
name|doubleSpinBoxTest
parameter_list|()
function_decl|;
name|void
name|textEditTest
parameter_list|()
function_decl|;
name|void
name|textBrowserTest
parameter_list|()
function_decl|;
name|void
name|listViewTest
parameter_list|()
function_decl|;
name|void
name|mdiAreaTest
parameter_list|()
function_decl|;
name|void
name|mdiSubWindowTest
parameter_list|()
function_decl|;
name|void
name|lineEditTest
parameter_list|()
function_decl|;
name|void
name|workspaceTest
parameter_list|()
function_decl|;
name|void
name|dialogButtonBoxTest
parameter_list|()
function_decl|;
name|void
name|dialTest
parameter_list|()
function_decl|;
name|void
name|rubberBandTest
parameter_list|()
function_decl|;
name|void
name|abstractScrollAreaTest
parameter_list|()
function_decl|;
name|void
name|scrollAreaTest
parameter_list|()
function_decl|;
name|void
name|tableWidgetTest
parameter_list|()
function_decl|;
name|void
name|tableViewTest
parameter_list|()
function_decl|;
name|void
name|table2ListTest
parameter_list|()
function_decl|;
name|void
name|table2TreeTest
parameter_list|()
function_decl|;
name|void
name|table2TableTest
parameter_list|()
function_decl|;
name|void
name|calendarWidgetTest
parameter_list|()
function_decl|;
name|void
name|dockWidgetTest
parameter_list|()
function_decl|;
name|void
name|comboBoxTest
parameter_list|()
function_decl|;
name|void
name|accessibleName
parameter_list|()
function_decl|;
name|void
name|treeWidgetTest
parameter_list|()
function_decl|;
name|void
name|labelTest
parameter_list|()
function_decl|;
name|void
name|accelerators
parameter_list|()
function_decl|;
block|}
class|;
end_class
begin_decl_stmt
DECL|variable|Q_PI
specifier|const
name|double
name|Q_PI
init|=
literal|3.14159265358979323846
decl_stmt|;
end_decl_stmt
begin_function
DECL|function|eventName
name|QString
name|eventName
parameter_list|(
specifier|const
name|int
name|ev
parameter_list|)
block|{
switch|switch
condition|(
name|ev
condition|)
block|{
case|case
literal|0x0001
case|:
return|return
literal|"SoundPlayed"
return|;
case|case
literal|0x0002
case|:
return|return
literal|"Alert"
return|;
case|case
literal|0x0003
case|:
return|return
literal|"ForegroundChanged"
return|;
case|case
literal|0x0004
case|:
return|return
literal|"MenuStart"
return|;
case|case
literal|0x0005
case|:
return|return
literal|"MenuEnd"
return|;
case|case
literal|0x0006
case|:
return|return
literal|"PopupMenuStart"
return|;
case|case
literal|0x0007
case|:
return|return
literal|"PopupMenuEnd"
return|;
case|case
literal|0x000C
case|:
return|return
literal|"ContextHelpStart"
return|;
case|case
literal|0x000D
case|:
return|return
literal|"ContextHelpEnd"
return|;
case|case
literal|0x000E
case|:
return|return
literal|"DragDropStart"
return|;
case|case
literal|0x000F
case|:
return|return
literal|"DragDropEnd"
return|;
case|case
literal|0x0010
case|:
return|return
literal|"DialogStart"
return|;
case|case
literal|0x0011
case|:
return|return
literal|"DialogEnd"
return|;
case|case
literal|0x0012
case|:
return|return
literal|"ScrollingStart"
return|;
case|case
literal|0x0013
case|:
return|return
literal|"ScrollingEnd"
return|;
case|case
literal|0x0018
case|:
return|return
literal|"MenuCommand"
return|;
case|case
literal|0x0116
case|:
return|return
literal|"TableModelChanged"
return|;
case|case
literal|0x011B
case|:
return|return
literal|"TextCaretMoved"
return|;
case|case
literal|0x8000
case|:
return|return
literal|"ObjectCreated"
return|;
case|case
literal|0x8001
case|:
return|return
literal|"ObjectDestroyed"
return|;
case|case
literal|0x8002
case|:
return|return
literal|"ObjectShow"
return|;
case|case
literal|0x8003
case|:
return|return
literal|"ObjectHide"
return|;
case|case
literal|0x8004
case|:
return|return
literal|"ObjectReorder"
return|;
case|case
literal|0x8005
case|:
return|return
literal|"Focus"
return|;
case|case
literal|0x8006
case|:
return|return
literal|"Selection"
return|;
case|case
literal|0x8007
case|:
return|return
literal|"SelectionAdd"
return|;
case|case
literal|0x8008
case|:
return|return
literal|"SelectionRemove"
return|;
case|case
literal|0x8009
case|:
return|return
literal|"SelectionWithin"
return|;
case|case
literal|0x800A
case|:
return|return
literal|"StateChanged"
return|;
case|case
literal|0x800B
case|:
return|return
literal|"LocationChanged"
return|;
case|case
literal|0x800C
case|:
return|return
literal|"NameChanged"
return|;
case|case
literal|0x800D
case|:
return|return
literal|"DescriptionChanged"
return|;
case|case
literal|0x800E
case|:
return|return
literal|"ValueChanged"
return|;
case|case
literal|0x800F
case|:
return|return
literal|"ParentChanged"
return|;
case|case
literal|0x80A0
case|:
return|return
literal|"HelpChanged"
return|;
case|case
literal|0x80B0
case|:
return|return
literal|"DefaultActionChanged"
return|;
case|case
literal|0x80C0
case|:
return|return
literal|"AcceleratorChanged"
return|;
default|default:
return|return
literal|"Unknown Event"
return|;
block|}
block|}
end_function
begin_function
DECL|function|state
name|QAccessible
operator|::
name|State
name|state
parameter_list|(
name|QWidget
modifier|*
specifier|const
name|widget
parameter_list|)
block|{
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|widget
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|iface
condition|)
name|qWarning
argument_list|()
operator|<<
literal|"Cannot get QAccessibleInterface for widget"
expr_stmt|;
name|QAccessible
operator|::
name|State
name|state
init|=
operator|(
name|iface
condition|?
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
else|:
cast|static_cast
argument_list|<
name|QAccessible
operator|::
name|State
argument_list|>
argument_list|(
literal|0
argument_list|)
operator|)
decl_stmt|;
operator|delete
name|iface
expr_stmt|;
return|return
name|state
return|;
block|}
end_function
begin_class
DECL|class|QtTestAccessibleWidget
class|class
name|QtTestAccessibleWidget
super|:
specifier|public
name|QWidget
block|{
name|Q_OBJECT
public|public:
DECL|function|QtTestAccessibleWidget
name|QtTestAccessibleWidget
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
block|{
name|setObjectName
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|QPalette
name|pal
decl_stmt|;
name|pal
operator|.
name|setColor
argument_list|(
name|backgroundRole
argument_list|()
argument_list|,
name|Qt
operator|::
name|black
argument_list|)
expr_stmt|;
comment|//black is beautiful
name|setPalette
argument_list|(
name|pal
argument_list|)
expr_stmt|;
name|setFixedSize
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|)
expr_stmt|;
block|}
block|}
class|;
end_class
begin_class
DECL|class|QtTestAccessibleWidgetIface
class|class
name|QtTestAccessibleWidgetIface
super|:
specifier|public
name|QAccessibleWidget
block|{
public|public:
DECL|function|QtTestAccessibleWidgetIface
name|QtTestAccessibleWidgetIface
parameter_list|(
name|QtTestAccessibleWidget
modifier|*
name|w
parameter_list|)
member_init_list|:
name|QAccessibleWidget
argument_list|(
name|w
argument_list|)
block|{}
DECL|function|text
name|QString
name|text
parameter_list|(
name|Text
name|t
parameter_list|,
name|int
name|control
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|t
operator|==
name|Help
condition|)
return|return
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"Help yourself"
argument_list|)
return|;
return|return
name|QAccessibleWidget
operator|::
name|text
argument_list|(
name|t
argument_list|,
name|control
argument_list|)
return|;
block|}
DECL|function|ifaceFactory
specifier|static
name|QAccessibleInterface
modifier|*
name|ifaceFactory
parameter_list|(
specifier|const
name|QString
modifier|&
name|key
parameter_list|,
name|QObject
modifier|*
name|o
parameter_list|)
block|{
if|if
condition|(
name|key
operator|==
literal|"QtTestAccessibleWidget"
condition|)
return|return
operator|new
name|QtTestAccessibleWidgetIface
argument_list|(
cast|static_cast
argument_list|<
name|QtTestAccessibleWidget
operator|*
argument_list|>
argument_list|(
name|o
argument_list|)
argument_list|)
return|;
return|return
literal|0
return|;
block|}
block|}
class|;
end_class
begin_constructor
DECL|function|tst_QAccessibility
name|tst_QAccessibility
operator|::
name|tst_QAccessibility
parameter_list|()
block|{ }
end_constructor
begin_destructor
DECL|function|~tst_QAccessibility
name|tst_QAccessibility
operator|::
name|~
name|tst_QAccessibility
parameter_list|()
block|{ }
end_destructor
begin_function
DECL|function|initTestCase
name|void
name|tst_QAccessibility
operator|::
name|initTestCase
parameter_list|()
block|{
name|QTestAccessibility
operator|::
name|initialize
argument_list|()
expr_stmt|;
name|QAccessible
operator|::
name|installFactory
argument_list|(
name|QtTestAccessibleWidgetIface
operator|::
name|ifaceFactory
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|cleanupTestCase
name|void
name|tst_QAccessibility
operator|::
name|cleanupTestCase
parameter_list|()
block|{
name|QTestAccessibility
operator|::
name|cleanup
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|init
name|void
name|tst_QAccessibility
operator|::
name|init
parameter_list|()
block|{
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|cleanup
name|void
name|tst_QAccessibility
operator|::
name|cleanup
parameter_list|()
block|{
specifier|const
name|EventList
name|list
init|=
name|QTestAccessibility
operator|::
name|events
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|list
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|qWarning
argument_list|(
literal|"%d accessibility event(s) were not handled in testfunction '%s':"
argument_list|,
name|list
operator|.
name|count
argument_list|()
argument_list|,
name|QString
argument_list|(
name|QTest
operator|::
name|currentTestFunction
argument_list|()
argument_list|)
operator|.
name|toAscii
argument_list|()
operator|.
name|constData
argument_list|()
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|list
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
name|qWarning
argument_list|(
literal|" %d: Object: %p Event: '%s' (%d) Child: %d"
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|list
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|object
argument_list|,
name|eventName
argument_list|(
name|list
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|event
argument_list|)
operator|.
name|toAscii
argument_list|()
operator|.
name|constData
argument_list|()
argument_list|,
name|list
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|event
argument_list|,
name|list
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|child
argument_list|)
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|eventTest
name|void
name|tst_QAccessibility
operator|::
name|eventTest
parameter_list|()
block|{
name|QPushButton
modifier|*
name|button
init|=
operator|new
name|QPushButton
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|button
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"Olaf"
argument_list|)
argument_list|)
expr_stmt|;
name|button
operator|->
name|show
argument_list|()
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|button
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectShow
argument_list|)
expr_stmt|;
name|button
operator|->
name|setFocus
argument_list|(
name|Qt
operator|::
name|MouseFocusReason
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|mouseClick
argument_list|(
name|button
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|button
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|StateChanged
argument_list|)
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|button
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|StateChanged
argument_list|)
expr_stmt|;
name|button
operator|->
name|setAccessibleName
argument_list|(
literal|"Olaf the second"
argument_list|)
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|button
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|NameChanged
argument_list|)
expr_stmt|;
name|button
operator|->
name|setAccessibleDescription
argument_list|(
literal|"This is a button labeled Olaf"
argument_list|)
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|button
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|DescriptionChanged
argument_list|)
expr_stmt|;
name|button
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|button
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectHide
argument_list|)
expr_stmt|;
operator|delete
name|button
expr_stmt|;
block|}
end_function
begin_function
DECL|function|customWidget
name|void
name|tst_QAccessibility
operator|::
name|customWidget
parameter_list|()
block|{
name|QtTestAccessibleWidget
modifier|*
name|widget
init|=
operator|new
name|QtTestAccessibleWidget
argument_list|(
literal|0
argument_list|,
literal|"Heinz"
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|widget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|object
argument_list|()
operator|->
name|objectName
argument_list|()
argument_list|,
name|QString
argument_list|(
literal|"Heinz"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Help
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Help yourself"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|deletedWidget
name|void
name|tst_QAccessibility
operator|::
name|deletedWidget
parameter_list|()
block|{
name|QtTestAccessibleWidget
modifier|*
name|widget
init|=
operator|new
name|QtTestAccessibleWidget
argument_list|(
literal|0
argument_list|,
literal|"Ralf"
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|widget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|widget
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
name|widget
operator|=
literal|0
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
block|}
end_function
begin_function
DECL|function|navigateGeometric
name|void
name|tst_QAccessibility
operator|::
name|navigateGeometric
parameter_list|()
block|{
block|{
specifier|static
specifier|const
name|int
name|skip
init|=
literal|20
decl_stmt|;
comment|//speed the test up significantly
specifier|static
specifier|const
name|double
name|step
init|=
name|Q_PI
operator|/
literal|180
decl_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|w
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"Josef"
argument_list|)
argument_list|)
expr_stmt|;
name|w
operator|->
name|setFixedSize
argument_list|(
literal|400
argument_list|,
literal|400
argument_list|)
expr_stmt|;
comment|// center widget
name|QtTestAccessibleWidget
modifier|*
name|center
init|=
operator|new
name|QtTestAccessibleWidget
argument_list|(
name|w
argument_list|,
literal|"Sol"
argument_list|)
decl_stmt|;
name|center
operator|->
name|move
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
expr_stmt|;
comment|// arrange 360 widgets around it in a circle
name|QtTestAccessibleWidget
modifier|*
name|aw
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|360
condition|;
name|i
operator|+=
name|skip
control|)
block|{
name|aw
operator|=
operator|new
name|QtTestAccessibleWidget
argument_list|(
name|w
argument_list|,
name|QString
operator|::
name|number
argument_list|(
name|i
argument_list|)
operator|.
name|toLatin1
argument_list|()
argument_list|)
expr_stmt|;
name|aw
operator|->
name|move
argument_list|(
name|int
argument_list|(
literal|200.0
operator|+
literal|100.0
operator|*
name|sin
argument_list|(
name|step
operator|*
operator|(
name|double
operator|)
name|i
argument_list|)
argument_list|)
argument_list|,
name|int
argument_list|(
literal|200.0
operator|+
literal|100.0
operator|*
name|cos
argument_list|(
name|step
operator|*
operator|(
name|double
operator|)
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|aw
operator|=
operator|new
name|QtTestAccessibleWidget
argument_list|(
name|w
argument_list|,
literal|"Earth"
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|center
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|target
init|=
literal|0
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|w
operator|->
name|show
argument_list|()
expr_stmt|;
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
comment|// let one widget rotate around center
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|360
condition|;
name|i
operator|+=
name|skip
control|)
block|{
name|aw
operator|->
name|move
argument_list|(
name|int
argument_list|(
literal|200.0
operator|+
literal|75.0
operator|*
name|sin
argument_list|(
name|step
operator|*
operator|(
name|double
operator|)
name|i
argument_list|)
argument_list|)
argument_list|,
name|int
argument_list|(
literal|200.0
operator|+
literal|75.0
operator|*
name|cos
argument_list|(
name|step
operator|*
operator|(
name|double
operator|)
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
argument_list|<
literal|45
operator|||
name|i
argument_list|>
literal|315
condition|)
block|{
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|<
literal|135
condition|)
block|{
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|<
literal|225
condition|)
block|{
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
operator|->
name|objectName
argument_list|()
argument_list|,
name|aw
operator|->
name|objectName
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
block|}
comment|// test invisible widget
name|target
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|aw
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|target
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
operator|)
argument_list|)
expr_stmt|;
name|aw
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|aw
operator|->
name|move
argument_list|(
name|center
operator|->
name|x
argument_list|()
operator|+
literal|10
argument_list|,
name|center
operator|->
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QString
argument_list|(
name|target
operator|->
name|object
argument_list|()
operator|->
name|objectName
argument_list|()
argument_list|)
operator|!=
literal|"Earth"
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|aw
operator|->
name|move
argument_list|(
name|center
operator|->
name|x
argument_list|()
operator|-
literal|10
argument_list|,
name|center
operator|->
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QString
argument_list|(
name|target
operator|->
name|object
argument_list|()
operator|->
name|objectName
argument_list|()
argument_list|)
operator|!=
literal|"Earth"
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|aw
operator|->
name|move
argument_list|(
name|center
operator|->
name|x
argument_list|()
argument_list|,
name|center
operator|->
name|y
argument_list|()
operator|+
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QString
argument_list|(
name|target
operator|->
name|object
argument_list|()
operator|->
name|objectName
argument_list|()
argument_list|)
operator|!=
literal|"Earth"
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|aw
operator|->
name|move
argument_list|(
name|center
operator|->
name|x
argument_list|()
argument_list|,
name|center
operator|->
name|y
argument_list|()
operator|-
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QString
argument_list|(
name|target
operator|->
name|object
argument_list|()
operator|->
name|objectName
argument_list|()
argument_list|)
operator|!=
literal|"Earth"
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|w
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|sliderTest
name|void
name|tst_QAccessibility
operator|::
name|sliderTest
parameter_list|()
block|{
block|{
name|QSlider
modifier|*
name|slider
init|=
operator|new
name|QSlider
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|slider
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"Slidy"
argument_list|)
argument_list|)
expr_stmt|;
name|slider
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|slider
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QAccessibleValueInterface
modifier|*
name|valueIface
init|=
name|iface
operator|->
name|valueInterface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|valueIface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|minimumValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|slider
operator|->
name|minimum
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|maximumValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|slider
operator|->
name|maximum
argument_list|()
argument_list|)
expr_stmt|;
name|slider
operator|->
name|setValue
argument_list|(
literal|50
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|slider
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|slider
operator|->
name|setValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|slider
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|slider
operator|->
name|setValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|slider
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|valueIface
operator|->
name|setCurrentValue
argument_list|(
literal|77
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
literal|77
argument_list|,
name|slider
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|slider
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|navigateCovered
name|void
name|tst_QAccessibility
operator|::
name|navigateCovered
parameter_list|()
block|{
block|{
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|w
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"Harry"
argument_list|)
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w1
init|=
operator|new
name|QWidget
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|w1
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"1"
argument_list|)
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w2
init|=
operator|new
name|QWidget
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|w2
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"2"
argument_list|)
argument_list|)
expr_stmt|;
name|w
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|w
operator|->
name|setFixedSize
argument_list|(
literal|6
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|w1
operator|->
name|setFixedSize
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|w2
operator|->
name|setFixedSize
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|w2
operator|->
name|move
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|w1
operator|->
name|raise
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface1
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w1
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface1
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface1
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface2
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w2
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface2
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface3
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
operator|-
literal|42
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
literal|0
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
literal|2
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|loop
init|=
literal|0
init|;
name|loop
operator|<
literal|2
condition|;
operator|++
name|loop
control|)
block|{
for|for
control|(
name|int
name|x
init|=
literal|0
init|;
name|x
operator|<
name|w
operator|->
name|width
argument_list|()
condition|;
operator|++
name|x
control|)
block|{
for|for
control|(
name|int
name|y
init|=
literal|0
init|;
name|y
operator|<
name|w
operator|->
name|height
argument_list|()
condition|;
operator|++
name|y
control|)
block|{
name|w1
operator|->
name|move
argument_list|(
name|x
argument_list|,
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|w1
operator|->
name|geometry
argument_list|()
operator|.
name|intersects
argument_list|(
name|w2
operator|->
name|geometry
argument_list|()
argument_list|)
condition|)
block|{
name|QVERIFY
argument_list|(
name|iface1
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface2
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covers
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface1
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covered
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covered
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface3
operator|->
name|object
argument_list|()
argument_list|,
name|iface2
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|iface3
expr_stmt|;
name|iface3
operator|=
literal|0
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface3
operator|->
name|object
argument_list|()
argument_list|,
name|iface1
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|iface3
expr_stmt|;
name|iface3
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface1
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface2
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covers
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface2
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface1
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covered
operator|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covered
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covered
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
operator|!
name|loop
condition|)
block|{
comment|// switch children for second loop
name|w2
operator|->
name|raise
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|temp
init|=
name|iface1
decl_stmt|;
name|iface1
operator|=
name|iface2
expr_stmt|;
name|iface2
operator|=
name|temp
expr_stmt|;
block|}
block|}
operator|delete
name|iface1
expr_stmt|;
name|iface1
operator|=
literal|0
expr_stmt|;
operator|delete
name|iface2
expr_stmt|;
name|iface2
operator|=
literal|0
expr_stmt|;
name|iface1
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface1
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface1
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|iface2
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|w1
operator|->
name|move
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|w2
operator|->
name|move
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|w1
operator|->
name|raise
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface1
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface2
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covers
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface1
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covered
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface1
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
operator|)
argument_list|)
expr_stmt|;
name|w1
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface1
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface1
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface2
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covers
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface2
operator|->
name|relationTo
argument_list|(
literal|0
argument_list|,
name|iface1
argument_list|,
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Covered
operator|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covered
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Covers
argument_list|,
literal|1
argument_list|,
operator|&
name|iface3
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface3
operator|==
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|iface1
expr_stmt|;
name|iface1
operator|=
literal|0
expr_stmt|;
operator|delete
name|iface2
expr_stmt|;
name|iface2
operator|=
literal|0
expr_stmt|;
operator|delete
name|w
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|navigateHierarchy
name|void
name|tst_QAccessibility
operator|::
name|navigateHierarchy
parameter_list|()
block|{
block|{
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|w
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"Hans"
argument_list|)
argument_list|)
expr_stmt|;
name|w
operator|->
name|show
argument_list|()
expr_stmt|;
name|QWidget
modifier|*
name|w1
init|=
operator|new
name|QWidget
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|w1
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"1"
argument_list|)
argument_list|)
expr_stmt|;
name|w1
operator|->
name|show
argument_list|()
expr_stmt|;
name|QWidget
modifier|*
name|w2
init|=
operator|new
name|QWidget
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|w2
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"2"
argument_list|)
argument_list|)
expr_stmt|;
name|w2
operator|->
name|show
argument_list|()
expr_stmt|;
name|QWidget
modifier|*
name|w3
init|=
operator|new
name|QWidget
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|w3
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"3"
argument_list|)
argument_list|)
expr_stmt|;
name|w3
operator|->
name|show
argument_list|()
expr_stmt|;
name|QWidget
modifier|*
name|w31
init|=
operator|new
name|QWidget
argument_list|(
name|w3
argument_list|)
decl_stmt|;
name|w31
operator|->
name|setObjectName
argument_list|(
name|QString
argument_list|(
literal|"31"
argument_list|)
argument_list|)
expr_stmt|;
name|w31
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|target
init|=
literal|0
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
operator|-
literal|42
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|42
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|15
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|child
argument_list|(
literal|15
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|child
argument_list|(
operator|-
literal|1
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interfaceW1
init|=
name|iface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interfaceW1
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interfaceW1
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interfaceW1
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w1
argument_list|)
expr_stmt|;
operator|delete
name|interfaceW1
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
literal|0
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|0
argument_list|,
operator|&
name|iface
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|42
argument_list|,
operator|&
name|iface
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
operator|-
literal|42
argument_list|,
operator|&
name|iface
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|2
argument_list|,
operator|&
name|iface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w2
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|3
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w3
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
literal|0
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|iface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w31
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
operator|-
literal|1
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|0
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|1
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w31
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
literal|0
expr_stmt|;
name|iface
operator|=
name|target
operator|->
name|parent
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|w3
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
literal|0
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
operator|delete
name|w
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_define
DECL|macro|QSETCOMPARE
define|#
directive|define
name|QSETCOMPARE
parameter_list|(
name|thetypename
parameter_list|,
name|elements
parameter_list|,
name|otherelements
parameter_list|)
define|\
value|QCOMPARE((QSet<thetypename>()<< elements), (QSet<thetypename>()<< otherelements))
end_define
begin_function
DECL|function|createWidgets
specifier|static
name|QWidget
modifier|*
name|createWidgets
parameter_list|()
block|{
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|QHBoxLayout
modifier|*
name|box
init|=
operator|new
name|QHBoxLayout
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|int
name|i
init|=
literal|0
decl_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QComboBox
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QPushButton
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QHeaderView
argument_list|(
name|Qt
operator|::
name|Vertical
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QTreeView
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QTreeWidget
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QListView
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QListWidget
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QTableView
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QTableWidget
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QCalendarWidget
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QDialogButtonBox
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QGroupBox
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QFrame
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QLineEdit
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QProgressBar
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QTabWidget
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QCheckBox
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QRadioButton
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QDial
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QScrollBar
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QSlider
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QDateTimeEdit
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QDoubleSpinBox
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QSpinBox
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QLabel
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QLCDNumber
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QStackedWidget
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QToolBox
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QLabel
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|->
name|addWidget
argument_list|(
operator|new
name|QTextEdit
argument_list|(
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"widget text %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
operator|++
argument_list|)
argument_list|,
name|w
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Not in the list      * QAbstractItemView, QGraphicsView, QScrollArea,      * QToolButton, QDockWidget, QFocusFrame, QMainWindow, QMenu, QMenuBar, QSizeGrip, QSplashScreen, QSplitterHandle,      * QStatusBar, QSvgWidget, QTabBar, QToolBar, QWorkspace, QSplitter      */
return|return
name|w
return|;
block|}
end_function
begin_function
DECL|function|accessibleName
name|void
name|tst_QAccessibility
operator|::
name|accessibleName
parameter_list|()
block|{
name|QWidget
modifier|*
name|toplevel
init|=
name|createWidgets
argument_list|()
decl_stmt|;
name|toplevel
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QLayout
modifier|*
name|lout
init|=
name|toplevel
operator|->
name|layout
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|lout
operator|->
name|count
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|QLayoutItem
modifier|*
name|item
init|=
name|lout
operator|->
name|itemAt
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QWidget
modifier|*
name|child
init|=
name|item
operator|->
name|widget
argument_list|()
decl_stmt|;
name|QString
name|name
init|=
name|tr
argument_list|(
literal|"Widget Name %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|child
operator|->
name|setAccessibleName
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|acc
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|child
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|acc
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|QString
name|desc
init|=
name|tr
argument_list|(
literal|"Widget Description %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|child
operator|->
name|setAccessibleDescription
argument_list|(
name|desc
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|acc
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Description
argument_list|,
literal|0
argument_list|)
argument_list|,
name|desc
argument_list|)
expr_stmt|;
block|}
operator|delete
name|toplevel
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|textAttributes
name|void
name|tst_QAccessibility
operator|::
name|textAttributes
parameter_list|()
block|{
name|QTextEdit
name|textEdit
decl_stmt|;
name|int
name|startOffset
decl_stmt|;
name|int
name|endOffset
decl_stmt|;
name|QString
name|attributes
decl_stmt|;
name|QString
name|text
argument_list|(
literal|"<html><head></head><body>"
literal|"Hello,<b>this</b> is an<i><b>example</b> text</i>."
literal|"<span style=\"font-family: monospace\">Multiple fonts are used.</span>"
literal|"Multiple<span style=\"font-size: 8pt\">text sizes</span> are used."
literal|"Let's give some color to<span style=\"color:#f0f1f2; background-color:#14f01e\">Qt</span>."
literal|"</body></html>"
argument_list|)
decl_stmt|;
name|textEdit
operator|.
name|setText
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|textEdit
argument_list|)
decl_stmt|;
name|QAccessibleTextInterface
modifier|*
name|textInterface
init|=
name|interface
operator|->
name|textInterface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|textInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textInterface
operator|->
name|characterCount
argument_list|()
argument_list|,
literal|112
argument_list|)
expr_stmt|;
name|attributes
operator|=
name|textInterface
operator|->
name|attributes
argument_list|(
literal|10
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|attributes
operator|.
name|prepend
argument_list|(
literal|';'
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";font-weight:bold;"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|attributes
operator|=
name|textInterface
operator|->
name|attributes
argument_list|(
literal|18
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|18
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|25
argument_list|)
expr_stmt|;
name|attributes
operator|.
name|prepend
argument_list|(
literal|';'
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";font-weight:bold;"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";font-style:italic;"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|attributes
operator|=
name|textInterface
operator|->
name|attributes
argument_list|(
literal|34
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|31
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|55
argument_list|)
expr_stmt|;
name|attributes
operator|.
name|prepend
argument_list|(
literal|';'
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";font-family:\"monospace\";"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|attributes
operator|=
name|textInterface
operator|->
name|attributes
argument_list|(
literal|65
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|64
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|74
argument_list|)
expr_stmt|;
name|attributes
operator|.
name|prepend
argument_list|(
literal|';'
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";font-size:8pt;"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|attributes
operator|=
name|textInterface
operator|->
name|attributes
argument_list|(
literal|110
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|109
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|111
argument_list|)
expr_stmt|;
name|attributes
operator|.
name|prepend
argument_list|(
literal|';'
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";background-color:rgb(20,240,30);"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|attributes
operator|.
name|contains
argument_list|(
name|QLatin1String
argument_list|(
literal|";color:rgb(240,241,242);"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|hideShowTest
name|void
name|tst_QAccessibility
operator|::
name|hideShowTest
parameter_list|()
block|{
name|QWidget
modifier|*
specifier|const
name|window
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|QWidget
modifier|*
specifier|const
name|child
init|=
operator|new
name|QWidget
argument_list|(
name|window
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|state
argument_list|(
name|window
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|state
argument_list|(
name|child
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// show() and veryfy that both window and child are not invisible and get ObjectShow events.
name|window
operator|->
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|state
argument_list|(
name|window
argument_list|)
operator|^
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|state
argument_list|(
name|child
argument_list|)
operator|^
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|window
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectShow
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|child
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectShow
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// hide() and veryfy that both window and child are invisible and get ObjectHide events.
name|window
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|state
argument_list|(
name|window
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|state
argument_list|(
name|child
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|window
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectHide
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|child
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectHide
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
operator|delete
name|window
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|userActionCount
name|void
name|tst_QAccessibility
operator|::
name|userActionCount
parameter_list|()
block|{
name|QWidget
name|widget
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|test
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|test
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|test
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
literal|0
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
operator|-
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|test
expr_stmt|;
name|test
operator|=
literal|0
expr_stmt|;
name|QFrame
name|frame
decl_stmt|;
name|test
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|frame
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|test
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|test
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
literal|0
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
operator|-
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|test
expr_stmt|;
name|test
operator|=
literal|0
expr_stmt|;
name|QLineEdit
name|lineEdit
decl_stmt|;
name|test
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|lineEdit
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|test
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|test
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
literal|0
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|userActionCount
argument_list|(
operator|-
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|test
expr_stmt|;
name|test
operator|=
literal|0
expr_stmt|;
block|}
end_function
begin_function
DECL|function|actionText
name|void
name|tst_QAccessibility
operator|::
name|actionText
parameter_list|()
block|{
name|QWidget
modifier|*
name|widget
init|=
operator|new
name|QWidget
decl_stmt|;
name|widget
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|test
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|widget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|test
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|test
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|actionText
argument_list|(
literal|1
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|actionText
argument_list|(
literal|0
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|actionText
argument_list|(
literal|1
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|SetFocus
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
operator|-
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"SetFocus"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|test
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|SetFocus
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"SetFocus"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|test
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|doAction
name|void
name|tst_QAccessibility
operator|::
name|doAction
parameter_list|()
block|{
name|QSKIP
argument_list|(
literal|"TODO: Implement me"
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|applicationTest
name|void
name|tst_QAccessibility
operator|::
name|applicationTest
parameter_list|()
block|{
name|QLatin1String
name|name
init|=
name|QLatin1String
argument_list|(
literal|"My Name"
argument_list|)
decl_stmt|;
name|qApp
operator|->
name|setApplicationName
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|qApp
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Application
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
block|}
end_function
begin_function
DECL|function|mainWindowTest
name|void
name|tst_QAccessibility
operator|::
name|mainWindowTest
parameter_list|()
block|{
name|QMainWindow
modifier|*
name|mw
init|=
operator|new
name|QMainWindow
decl_stmt|;
name|mw
operator|->
name|resize
argument_list|(
literal|300
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|mw
operator|->
name|show
argument_list|()
expr_stmt|;
comment|// triggers layout
name|QLatin1String
name|name
init|=
name|QLatin1String
argument_list|(
literal|"I am the main window"
argument_list|)
decl_stmt|;
name|mw
operator|->
name|setWindowTitle
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWaitForWindowShown
argument_list|(
name|mw
argument_list|)
expr_stmt|;
name|QVERIFY_EVENT
argument_list|(
name|mw
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectShow
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|mw
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Window
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
operator|delete
name|mw
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_class
DECL|class|CounterButton
class|class
name|CounterButton
super|:
specifier|public
name|QPushButton
block|{
name|Q_OBJECT
public|public:
DECL|function|CounterButton
name|CounterButton
parameter_list|(
specifier|const
name|QString
modifier|&
name|name
parameter_list|,
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QPushButton
argument_list|(
name|name
argument_list|,
name|parent
argument_list|)
member_init_list|,
name|clickCount
argument_list|(
literal|0
argument_list|)
block|{
name|connect
argument_list|(
name|this
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|(
name|bool
argument_list|)
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|incClickCount
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|member|clickCount
name|int
name|clickCount
decl_stmt|;
public|public
name|Q_SLOTS
public|:
DECL|function|incClickCount
name|void
name|incClickCount
parameter_list|()
block|{
operator|++
name|clickCount
expr_stmt|;
block|}
block|}
class|;
end_class
begin_function
DECL|function|buttonTest
name|void
name|tst_QAccessibility
operator|::
name|buttonTest
parameter_list|()
block|{
name|QWidget
name|window
decl_stmt|;
name|window
operator|.
name|setLayout
argument_list|(
operator|new
name|QVBoxLayout
argument_list|)
expr_stmt|;
comment|// Standard push button
name|CounterButton
name|pushButton
argument_list|(
literal|"Ok"
argument_list|,
operator|&
name|window
argument_list|)
decl_stmt|;
comment|// toggle button
name|QPushButton
name|toggleButton
argument_list|(
literal|"Toggle"
argument_list|,
operator|&
name|window
argument_list|)
decl_stmt|;
name|toggleButton
operator|.
name|setCheckable
argument_list|(
literal|true
argument_list|)
expr_stmt|;
comment|// standard checkbox
name|QCheckBox
name|checkBox
argument_list|(
literal|"Check me!"
argument_list|,
operator|&
name|window
argument_list|)
decl_stmt|;
comment|// tristate checkbox
name|QCheckBox
name|tristate
argument_list|(
literal|"Tristate!"
argument_list|,
operator|&
name|window
argument_list|)
decl_stmt|;
name|tristate
operator|.
name|setTristate
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
comment|// radiobutton
name|QRadioButton
name|radio
argument_list|(
literal|"Radio me!"
argument_list|,
operator|&
name|window
argument_list|)
decl_stmt|;
comment|// standard toolbutton
name|QToolButton
name|toolbutton
argument_list|(
operator|&
name|window
argument_list|)
decl_stmt|;
name|toolbutton
operator|.
name|setText
argument_list|(
literal|"Tool"
argument_list|)
expr_stmt|;
name|toolbutton
operator|.
name|setMinimumSize
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
expr_stmt|;
comment|// standard toolbutton
name|QToolButton
name|toggletool
argument_list|(
operator|&
name|window
argument_list|)
decl_stmt|;
name|toggletool
operator|.
name|setCheckable
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|toggletool
operator|.
name|setText
argument_list|(
literal|"Toggle"
argument_list|)
expr_stmt|;
name|toggletool
operator|.
name|setMinimumSize
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
expr_stmt|;
comment|// test push button
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|pushButton
argument_list|)
decl_stmt|;
name|QAccessibleActionInterface
modifier|*
name|actionInterface
init|=
name|interface
operator|->
name|actionInterface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|actionInterface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|PushButton
argument_list|)
expr_stmt|;
comment|// currently our buttons only have click as action, press and release are missing
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|actionCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Press"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|pushButton
operator|.
name|clickCount
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|actionInterface
operator|->
name|doAction
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|pushButton
operator|.
name|clickCount
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
comment|// test toggle button
name|interface
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|toggleButton
argument_list|)
expr_stmt|;
name|actionInterface
operator|=
name|interface
operator|->
name|actionInterface
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|CheckBox
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|description
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Toggles the button."
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Check"
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|toggleButton
operator|.
name|isChecked
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Checked
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|actionInterface
operator|->
name|doAction
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Uncheck"
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|toggleButton
operator|.
name|isChecked
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Checked
operator|)
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
comment|//    // test menu push button
comment|//    QVERIFY(QAccessible::queryAccessibleInterface(&menuButton,&test));
comment|//    QCOMPARE(test->role(0), QAccessible::ButtonMenu);
comment|//    QCOMPARE(test->defaultAction(0), QAccessible::Press);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Open"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::HasPopup);
comment|//    test->release();
comment|// test check box
name|interface
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|checkBox
argument_list|)
expr_stmt|;
name|actionInterface
operator|=
name|interface
operator|->
name|actionInterface
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|CheckBox
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Check"
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Checked
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|actionInterface
operator|->
name|doAction
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Uncheck"
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Checked
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|checkBox
operator|.
name|isChecked
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
comment|//    // test tristate check box
comment|//    QVERIFY(QAccessible::queryAccessibleInterface(&tristate,&test));
comment|//    QCOMPARE(test->role(0), QAccessible::CheckBox);
comment|//    QCOMPARE(test->defaultAction(0), QAccessible::Press);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Toggle"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::Normal);
comment|//    QVERIFY(test->doAction(QAccessible::Press, 0));
comment|//    QTest::qWait(500);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Check"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::Mixed);
comment|//    QVERIFY(test->doAction(QAccessible::Press, 0));
comment|//    QTest::qWait(500);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Uncheck"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::Checked);
comment|//    test->release();
comment|// test radiobutton
name|interface
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|radio
argument_list|)
expr_stmt|;
name|actionInterface
operator|=
name|interface
operator|->
name|actionInterface
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|RadioButton
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Check"
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Checked
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|actionInterface
operator|->
name|doAction
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actionInterface
operator|->
name|name
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Uncheck"
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Checked
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|checkBox
operator|.
name|isChecked
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
comment|//    // test standard toolbutton
comment|//    QVERIFY(QAccessible::queryAccessibleInterface(&toolbutton,&test));
comment|//    QCOMPARE(test->role(0), QAccessible::PushButton);
comment|//    QCOMPARE(test->defaultAction(0), QAccessible::Press);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Press"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::Normal);
comment|//    test->release();
comment|//    // toggle tool button
comment|//    QVERIFY(QAccessible::queryAccessibleInterface(&toggletool,&test));
comment|//    QCOMPARE(test->role(0), QAccessible::CheckBox);
comment|//    QCOMPARE(test->defaultAction(0), QAccessible::Press);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Check"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::Normal);
comment|//    QVERIFY(test->doAction(QAccessible::Press, 0));
comment|//    QTest::qWait(500);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Uncheck"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::Checked);
comment|//    test->release();
comment|//    // test menu toolbutton
comment|//    QVERIFY(QAccessible::queryAccessibleInterface(&menuToolButton,&test));
comment|//    QCOMPARE(test->role(0), QAccessible::ButtonMenu);
comment|//    QCOMPARE(test->defaultAction(0), 1);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Open"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::HasPopup);
comment|//    QCOMPARE(test->actionCount(0), 1);
comment|//    QCOMPARE(test->actionText(QAccessible::Press, QAccessible::Name, 0), QString("Press"));
comment|//    test->release();
comment|//    // test split menu toolbutton
comment|//    QVERIFY(QAccessible::queryAccessibleInterface(&splitToolButton,&test));
comment|//    QCOMPARE(test->childCount(), 2);
comment|//    QCOMPARE(test->role(0), QAccessible::ButtonDropDown);
comment|//    QCOMPARE(test->role(1), QAccessible::PushButton);
comment|//    QCOMPARE(test->role(2), QAccessible::ButtonMenu);
comment|//    QCOMPARE(test->defaultAction(0), QAccessible::Press);
comment|//    QCOMPARE(test->defaultAction(1), QAccessible::Press);
comment|//    QCOMPARE(test->defaultAction(2), QAccessible::Press);
comment|//    QCOMPARE(test->actionText(test->defaultAction(0), QAccessible::Name, 0), QString("Press"));
comment|//    QCOMPARE(test->state(0), (int)QAccessible::HasPopup);
comment|//    QCOMPARE(test->actionCount(0), 1);
comment|//    QCOMPARE(test->actionText(1, QAccessible::Name, 0), QString("Open"));
comment|//    QCOMPARE(test->actionText(test->defaultAction(1), QAccessible::Name, 1), QString("Press"));
comment|//    QCOMPARE(test->state(1), (int)QAccessible::Normal);
comment|//    QCOMPARE(test->actionText(test->defaultAction(2), QAccessible::Name, 2), QString("Open"));
comment|//    QCOMPARE(test->state(2), (int)QAccessible::HasPopup);
comment|//    test->release();
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|scrollBarTest
name|void
name|tst_QAccessibility
operator|::
name|scrollBarTest
parameter_list|()
block|{
comment|// Test that when we hide() a slider, the PageLeft, Indicator, and PageRight also gets the
comment|// Invisible state bit set.
enum|enum
name|SubControls
block|{
name|LineUp
init|=
literal|1
block|,
name|PageUp
init|=
literal|2
block|,
name|Position
init|=
literal|3
block|,
name|PageDown
init|=
literal|4
block|,
name|LineDown
init|=
literal|5
block|}
enum|;
name|QScrollBar
modifier|*
name|scrollBar
init|=
operator|new
name|QScrollBar
argument_list|()
decl_stmt|;
name|QAccessibleInterface
modifier|*
specifier|const
name|scrollBarInterface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|scrollBar
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarInterface
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarInterface
operator|->
name|state
argument_list|()
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarInterface
operator|->
name|state
argument_list|()
operator|^
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|scrollBar
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectShow
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|scrollBar
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarInterface
operator|->
name|state
argument_list|()
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|scrollBar
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|ObjectHide
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// Test that the left/right subcontrols are set to unavailable when the scrollBar is at the minimum/maximum.
name|scrollBar
operator|->
name|show
argument_list|()
expr_stmt|;
name|scrollBar
operator|->
name|setMinimum
argument_list|(
literal|11
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setMaximum
argument_list|(
literal|111
argument_list|)
expr_stmt|;
name|QAccessibleValueInterface
modifier|*
name|valueIface
init|=
name|scrollBarInterface
operator|->
name|valueInterface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|valueIface
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|minimumValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|scrollBar
operator|->
name|minimum
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|maximumValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|scrollBar
operator|->
name|maximum
argument_list|()
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setValue
argument_list|(
literal|50
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|scrollBar
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|scrollBar
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|valueIface
operator|->
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
name|scrollBar
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|valueIface
operator|->
name|setCurrentValue
argument_list|(
literal|77
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
literal|77
argument_list|,
name|scrollBar
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|scrollBarInterface
expr_stmt|;
operator|delete
name|scrollBar
expr_stmt|;
comment|// Test that the rects are ok.
block|{
name|QScrollBar
modifier|*
name|scrollBar
init|=
operator|new
name|QScrollBar
argument_list|(
name|Qt
operator|::
name|Horizontal
argument_list|)
decl_stmt|;
name|scrollBar
operator|->
name|resize
argument_list|(
literal|200
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
specifier|const
name|scrollBarInterface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|scrollBar
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarInterface
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setMinimum
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setMaximum
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|scrollBar
operator|->
name|setValue
argument_list|(
literal|50
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
specifier|const
name|QRect
name|scrollBarRect
init|=
name|scrollBarInterface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarRect
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
comment|// Verify that the sub-control rects are valid and inside the scrollBar rect.
for|for
control|(
name|int
name|i
init|=
name|LineUp
init|;
name|i
operator|<=
name|LineDown
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|QRect
name|testRect
init|=
name|scrollBarInterface
operator|->
name|rect
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|testRect
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|scrollBarRect
operator|.
name|contains
argument_list|(
name|testRect
argument_list|)
argument_list|)
expr_stmt|;
block|}
operator|delete
name|scrollBarInterface
expr_stmt|;
operator|delete
name|scrollBar
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|tabTest
name|void
name|tst_QAccessibility
operator|::
name|tabTest
parameter_list|()
block|{
name|QTabBar
modifier|*
name|tabBar
init|=
operator|new
name|QTabBar
argument_list|()
decl_stmt|;
name|tabBar
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
specifier|const
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|tabBar
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|interface
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|Press
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|interface
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|Press
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|// Test that the Invisible bit for the navigation buttons gets set
comment|// and cleared correctly.
name|QAccessibleInterface
modifier|*
name|child1
init|=
name|interface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|child1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child1
operator|->
name|state
argument_list|()
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
specifier|const
name|int
name|lots
init|=
literal|10
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|lots
condition|;
operator|++
name|i
control|)
name|tabBar
operator|->
name|addTab
argument_list|(
literal|"Foo"
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|(
name|child1
operator|->
name|state
argument_list|()
operator|&
name|QAccessible
operator|::
name|Invisible
operator|)
operator|==
literal|false
argument_list|)
expr_stmt|;
name|tabBar
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|child1
operator|->
name|state
argument_list|()
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|tabBar
operator|->
name|show
argument_list|()
expr_stmt|;
name|tabBar
operator|->
name|setCurrentIndex
argument_list|(
literal|0
argument_list|)
expr_stmt|;
comment|// Test that sending a focus action to a tab does not select it.
name|interface
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|Focus
argument_list|,
literal|2
argument_list|,
name|QVariantList
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabBar
operator|->
name|currentIndex
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Test that sending a press action to a tab selects it.
name|interface
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|Press
argument_list|,
literal|2
argument_list|,
name|QVariantList
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabBar
operator|->
name|currentIndex
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|delete
name|tabBar
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|tabWidgetTest
name|void
name|tst_QAccessibility
operator|::
name|tabWidgetTest
parameter_list|()
block|{
name|QTabWidget
modifier|*
name|tabWidget
init|=
operator|new
name|QTabWidget
argument_list|()
decl_stmt|;
name|tabWidget
operator|->
name|show
argument_list|()
expr_stmt|;
comment|// the interface for the tab is just a container for tabbar and stacked widget
name|QAccessibleInterface
modifier|*
specifier|const
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|tabWidget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Client
argument_list|)
expr_stmt|;
comment|// Create pages, check navigation
name|QLabel
modifier|*
name|label1
init|=
operator|new
name|QLabel
argument_list|(
literal|"Page 1"
argument_list|,
name|tabWidget
argument_list|)
decl_stmt|;
name|tabWidget
operator|->
name|addTab
argument_list|(
name|label1
argument_list|,
literal|"Tab 1"
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|label2
init|=
operator|new
name|QLabel
argument_list|(
literal|"Page 2"
argument_list|,
name|tabWidget
argument_list|)
decl_stmt|;
name|tabWidget
operator|->
name|addTab
argument_list|(
name|label2
argument_list|,
literal|"Tab 2"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|tabBarInterface
init|=
literal|0
decl_stmt|;
comment|// there is no special logic to sort the children, so the contents will be 1, the tab bar 2
name|tabBarInterface
operator|=
name|interface
operator|->
name|child
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tabBarInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabBarInterface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabBarInterface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|PageTabList
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|tabButton1Interface
init|=
name|tabBarInterface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|tabButton1Interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButton1Interface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|PageTab
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButton1Interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"Tab 1"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|tabButton2Interface
init|=
name|tabBarInterface
operator|->
name|child
argument_list|(
literal|1
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|tabButton1Interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButton2Interface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|PageTab
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButton2Interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"Tab 2"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|tabButtonLeft
init|=
name|tabBarInterface
operator|->
name|child
argument_list|(
literal|2
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|tabButtonLeft
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButtonLeft
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|PushButton
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButtonLeft
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"Scroll Left"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|tabButtonRight
init|=
name|tabBarInterface
operator|->
name|child
argument_list|(
literal|3
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|tabButtonRight
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButtonRight
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|PushButton
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tabButtonRight
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"Scroll Right"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|tabButton1Interface
expr_stmt|;
operator|delete
name|tabButton2Interface
expr_stmt|;
operator|delete
name|tabButtonLeft
expr_stmt|;
operator|delete
name|tabButtonRight
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|stackWidgetInterface
init|=
name|interface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|stackWidgetInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stackWidgetInterface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stackWidgetInterface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|LayeredPane
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|stackChild1Interface
init|=
name|stackWidgetInterface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|stackChild1Interface
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|Q_CC_INTEL
name|QCOMPARE
argument_list|(
name|stackChild1Interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QCOMPARE
argument_list|(
name|stackChild1Interface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|StaticText
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stackChild1Interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"Page 1"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|label1
argument_list|,
name|stackChild1Interface
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
comment|// Navigation in stack widgets should be consistent
name|QAccessibleInterface
modifier|*
name|parent
init|=
name|stackChild1Interface
operator|->
name|parent
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|parent
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|Q_CC_INTEL
name|QCOMPARE
argument_list|(
name|parent
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QCOMPARE
argument_list|(
name|parent
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|LayeredPane
argument_list|)
expr_stmt|;
operator|delete
name|parent
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|stackChild2Interface
init|=
name|stackWidgetInterface
operator|->
name|child
argument_list|(
literal|1
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|stackChild2Interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stackChild2Interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stackChild2Interface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|StaticText
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|label2
argument_list|,
name|stackChild2Interface
operator|->
name|object
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|label2
operator|->
name|text
argument_list|()
argument_list|,
name|stackChild2Interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|)
expr_stmt|;
name|parent
operator|=
name|stackChild2Interface
operator|->
name|parent
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|parent
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|Q_CC_INTEL
name|QCOMPARE
argument_list|(
name|parent
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QCOMPARE
argument_list|(
name|parent
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|LayeredPane
argument_list|)
expr_stmt|;
operator|delete
name|parent
expr_stmt|;
operator|delete
name|tabBarInterface
expr_stmt|;
operator|delete
name|stackChild1Interface
expr_stmt|;
operator|delete
name|stackChild2Interface
expr_stmt|;
operator|delete
name|stackWidgetInterface
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
operator|delete
name|tabWidget
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|menuTest
name|void
name|tst_QAccessibility
operator|::
name|menuTest
parameter_list|()
block|{
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|mw
operator|.
name|resize
argument_list|(
literal|300
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|QMenu
modifier|*
name|file
init|=
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|addMenu
argument_list|(
literal|"&File"
argument_list|)
decl_stmt|;
name|QMenu
modifier|*
name|fileNew
init|=
name|file
operator|->
name|addMenu
argument_list|(
literal|"&New..."
argument_list|)
decl_stmt|;
name|fileNew
operator|->
name|menuAction
argument_list|()
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+N"
argument_list|)
argument_list|)
expr_stmt|;
name|fileNew
operator|->
name|addAction
argument_list|(
literal|"Text file"
argument_list|)
expr_stmt|;
name|fileNew
operator|->
name|addAction
argument_list|(
literal|"Image file"
argument_list|)
expr_stmt|;
name|file
operator|->
name|addAction
argument_list|(
literal|"&Open"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+O"
argument_list|)
argument_list|)
expr_stmt|;
name|file
operator|->
name|addAction
argument_list|(
literal|"&Save"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+S"
argument_list|)
argument_list|)
expr_stmt|;
name|file
operator|->
name|addSeparator
argument_list|()
expr_stmt|;
name|file
operator|->
name|addAction
argument_list|(
literal|"E&xit"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Alt+F4"
argument_list|)
argument_list|)
expr_stmt|;
name|QMenu
modifier|*
name|edit
init|=
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|addMenu
argument_list|(
literal|"&Edit"
argument_list|)
decl_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"&Undo"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+Z"
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"&Redo"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+Y"
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|->
name|addSeparator
argument_list|()
expr_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"Cu&t"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+X"
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"&Copy"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+C"
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"&Paste"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Ctrl+V"
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"&Delete"
argument_list|)
operator|->
name|setShortcut
argument_list|(
name|tr
argument_list|(
literal|"Del"
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|->
name|addSeparator
argument_list|()
expr_stmt|;
name|edit
operator|->
name|addAction
argument_list|(
literal|"Pr&operties"
argument_list|)
expr_stmt|;
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|addSeparator
argument_list|()
expr_stmt|;
name|QMenu
modifier|*
name|help
init|=
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|addMenu
argument_list|(
literal|"&Help"
argument_list|)
decl_stmt|;
name|help
operator|->
name|addAction
argument_list|(
literal|"&Contents"
argument_list|)
expr_stmt|;
name|help
operator|->
name|addAction
argument_list|(
literal|"&About"
argument_list|)
expr_stmt|;
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|addAction
argument_list|(
literal|"Action!"
argument_list|)
expr_stmt|;
name|mw
operator|.
name|show
argument_list|()
expr_stmt|;
comment|// triggers layout
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|mw
operator|.
name|menuBar
argument_list|()
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|interface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuBar
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iFile
init|=
name|interface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iEdit
init|=
name|interface
operator|->
name|child
argument_list|(
literal|1
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iSeparator
init|=
name|interface
operator|->
name|child
argument_list|(
literal|2
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iHelp
init|=
name|interface
operator|->
name|child
argument_list|(
literal|3
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iAction
init|=
name|interface
operator|->
name|child
argument_list|(
literal|4
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iFile
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iEdit
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iSeparator
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Separator
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iHelp
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iAction
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|Q_WS_MAC
ifdef|#
directive|ifdef
name|Q_OS_WINCE
if|if
condition|(
operator|!
name|IsValidCEPlatform
argument_list|()
condition|)
block|{
name|QSKIP
argument_list|(
literal|"Tests do not work on Mobile platforms due to native menus"
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|QCOMPARE
argument_list|(
name|mw
operator|.
name|mapFromGlobal
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|topLeft
argument_list|()
argument_list|)
argument_list|,
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|geometry
argument_list|()
operator|.
name|topLeft
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|size
argument_list|()
argument_list|,
name|mw
operator|.
name|menuBar
argument_list|()
operator|->
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|contains
argument_list|(
name|iFile
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|contains
argument_list|(
name|iEdit
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
comment|// QVERIFY(interface->rect(0).contains(childSeparator->rect(0))); //separator might be invisible
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|contains
argument_list|(
name|iHelp
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|contains
argument_list|(
name|iAction
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QCOMPARE
argument_list|(
name|iFile
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"File"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Edit"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iSeparator
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iHelp
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Help"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iAction
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Action!"
argument_list|)
argument_list|)
expr_stmt|;
comment|// TODO: Currently not working, task to fix is #100019.
ifndef|#
directive|ifndef
name|Q_OS_MAC
name|QCOMPARE
argument_list|(
name|iFile
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|tr
argument_list|(
literal|"Alt+F"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|tr
argument_list|(
literal|"Alt+E"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iSeparator
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iHelp
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|tr
argument_list|(
literal|"Alt+H"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iAction
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QCOMPARE
argument_list|(
name|iFile
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Open"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iEdit
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Open"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iSeparator
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iHelp
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Open"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iAction
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Execute"
argument_list|)
argument_list|)
expr_stmt|;
name|bool
name|menuFade
init|=
name|qApp
operator|->
name|isEffectEnabled
argument_list|(
name|Qt
operator|::
name|UI_FadeMenu
argument_list|)
decl_stmt|;
name|int
name|menuFadeDelay
init|=
literal|300
decl_stmt|;
name|iFile
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuFade
condition|)
name|QTest
operator|::
name|qWait
argument_list|(
name|menuFadeDelay
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|file
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|edit
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|help
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|iEdit
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuFade
condition|)
name|QTest
operator|::
name|qWait
argument_list|(
name|menuFadeDelay
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|file
operator|->
name|isVisible
argument_list|()
operator|&&
name|edit
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|help
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|iSeparator
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuFade
condition|)
name|QTest
operator|::
name|qWait
argument_list|(
name|menuFadeDelay
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|file
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|edit
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|help
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|iHelp
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuFade
condition|)
name|QTest
operator|::
name|qWait
argument_list|(
name|menuFadeDelay
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|file
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|edit
operator|->
name|isVisible
argument_list|()
operator|&&
name|help
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|iAction
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuFade
condition|)
name|QTest
operator|::
name|qWait
argument_list|(
name|menuFadeDelay
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|file
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|edit
operator|->
name|isVisible
argument_list|()
operator|&&
operator|!
name|help
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|interface
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
name|interface
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|file
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|PopupMenu
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iFileNew
init|=
name|interface
operator|->
name|child
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iFileOpen
init|=
name|interface
operator|->
name|child
argument_list|(
literal|1
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iFileSave
init|=
name|interface
operator|->
name|child
argument_list|(
literal|2
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iFileSeparator
init|=
name|interface
operator|->
name|child
argument_list|(
literal|3
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iFileExit
init|=
name|interface
operator|->
name|child
argument_list|(
literal|4
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iFileNew
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileOpen
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileSave
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileSeparator
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|Separator
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileExit
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileNew
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Open"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileOpen
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Execute"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileSave
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Execute"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileSeparator
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iFileExit
operator|->
name|actionText
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|,
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Execute"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
literal|0
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface2
init|=
literal|0
decl_stmt|;
comment|// traverse siblings with navigate(Sibling, ...)
name|int
name|entry
init|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|iface
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
name|QAccessible
operator|::
name|Role
name|fileRoles
index|[
literal|5
index|]
init|=
block|{
name|QAccessible
operator|::
name|MenuItem
block|,
name|QAccessible
operator|::
name|MenuItem
block|,
name|QAccessible
operator|::
name|MenuItem
block|,
name|QAccessible
operator|::
name|Separator
block|,
name|QAccessible
operator|::
name|MenuItem
block|}
decl_stmt|;
for|for
control|(
name|int
name|child
init|=
literal|0
init|;
name|child
operator|<
literal|5
condition|;
operator|++
name|child
control|)
block|{
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
name|child
operator|+
literal|1
argument_list|,
operator|&
name|iface2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface2
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|fileRoles
index|[
name|child
index|]
argument_list|)
expr_stmt|;
operator|delete
name|iface2
expr_stmt|;
block|}
operator|delete
name|iface
expr_stmt|;
comment|// traverse menu items with navigate(Down, ...)
name|entry
operator|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|child
init|=
literal|0
init|;
name|child
operator|<
literal|4
condition|;
operator|++
name|child
control|)
block|{
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
literal|1
argument_list|,
operator|&
name|iface2
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
name|iface2
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|fileRoles
index|[
name|child
operator|+
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
operator|delete
name|iface
expr_stmt|;
comment|// traverse menu items with navigate(Up, ...)
name|entry
operator|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
operator|&
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|child
init|=
literal|3
init|;
name|child
operator|>=
literal|0
condition|;
operator|--
name|child
control|)
block|{
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
literal|1
argument_list|,
operator|&
name|iface2
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
name|iface2
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|fileRoles
index|[
name|child
index|]
argument_list|)
expr_stmt|;
block|}
operator|delete
name|iface
expr_stmt|;
comment|// "New" item
name|entry
operator|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
comment|// "New" menu
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|iface2
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
name|iface2
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|PopupMenu
argument_list|)
expr_stmt|;
comment|// "Text file" menu item
name|entry
operator|=
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|iface2
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
name|iface2
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|MenuItem
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
comment|// move mouse pointer away, since that might influence the
comment|// subsequent tests
name|QTest
operator|::
name|mouseMove
argument_list|(
operator|&
name|mw
argument_list|,
name|QPoint
argument_list|(
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
if|if
condition|(
name|menuFade
condition|)
name|QTest
operator|::
name|qWait
argument_list|(
name|menuFadeDelay
argument_list|)
expr_stmt|;
name|iFile
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
name|iFileNew
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|DefaultAction
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|file
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|fileNew
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|edit
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|help
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|mw
operator|.
name|hide
argument_list|()
expr_stmt|;
operator|delete
name|iFile
expr_stmt|;
operator|delete
name|iFileNew
expr_stmt|;
operator|delete
name|iFileOpen
expr_stmt|;
operator|delete
name|iFileSave
expr_stmt|;
operator|delete
name|iFileSeparator
expr_stmt|;
operator|delete
name|iFileExit
expr_stmt|;
comment|// Do not crash if the menu don't have a parent
name|QMenu
modifier|*
name|menu
init|=
operator|new
name|QMenu
decl_stmt|;
name|menu
operator|->
name|addAction
argument_list|(
name|QLatin1String
argument_list|(
literal|"one"
argument_list|)
argument_list|)
expr_stmt|;
name|menu
operator|->
name|addAction
argument_list|(
name|QLatin1String
argument_list|(
literal|"two"
argument_list|)
argument_list|)
expr_stmt|;
name|menu
operator|->
name|addAction
argument_list|(
name|QLatin1String
argument_list|(
literal|"three"
argument_list|)
argument_list|)
expr_stmt|;
name|iface
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|menu
argument_list|)
expr_stmt|;
name|iface2
operator|=
name|iface
operator|->
name|parent
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface2
operator|->
name|role
argument_list|()
argument_list|,
name|QAccessible
operator|::
name|Application
argument_list|)
expr_stmt|;
comment|// caused a *crash*
name|iface2
operator|->
name|state
argument_list|(
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|iface2
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|menu
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|spinBoxTest
name|void
name|tst_QAccessibility
operator|::
name|spinBoxTest
parameter_list|()
block|{
name|QSpinBox
modifier|*
specifier|const
name|spinBox
init|=
operator|new
name|QSpinBox
argument_list|()
decl_stmt|;
name|spinBox
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
specifier|const
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|spinBox
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
specifier|const
name|QRect
name|widgetRect
init|=
name|spinBox
operator|->
name|geometry
argument_list|()
decl_stmt|;
specifier|const
name|QRect
name|accessibleRect
init|=
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|accessibleRect
argument_list|,
name|widgetRect
argument_list|)
expr_stmt|;
comment|// Test that we get valid rects for all the spinbox child interfaces.
specifier|const
name|int
name|numChildren
init|=
name|interface
operator|->
name|childCount
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|1
init|;
name|i
operator|<=
name|numChildren
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|QRect
name|childRect
init|=
name|interface
operator|->
name|rect
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|childRect
operator|.
name|isNull
argument_list|()
operator|==
literal|false
argument_list|)
expr_stmt|;
block|}
name|spinBox
operator|->
name|setFocus
argument_list|()
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|keyPress
argument_list|(
name|spinBox
argument_list|,
name|Qt
operator|::
name|Key_Up
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|EventList
name|events
init|=
name|QTestAccessibility
operator|::
name|events
argument_list|()
decl_stmt|;
name|QTestAccessibilityEvent
name|expectedEvent
argument_list|(
name|spinBox
argument_list|,
literal|0
argument_list|,
operator|(
name|int
operator|)
name|QAccessible
operator|::
name|ValueChanged
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|events
operator|.
name|contains
argument_list|(
name|expectedEvent
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|spinBox
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|doubleSpinBoxTest
name|void
name|tst_QAccessibility
operator|::
name|doubleSpinBoxTest
parameter_list|()
block|{
name|QDoubleSpinBox
modifier|*
name|doubleSpinBox
init|=
operator|new
name|QDoubleSpinBox
decl_stmt|;
name|doubleSpinBox
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|doubleSpinBox
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
specifier|const
name|QRect
name|widgetRect
init|=
name|doubleSpinBox
operator|->
name|geometry
argument_list|()
decl_stmt|;
specifier|const
name|QRect
name|accessibleRect
init|=
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|accessibleRect
argument_list|,
name|widgetRect
argument_list|)
expr_stmt|;
comment|// Test that we get valid rects for all the spinbox child interfaces.
specifier|const
name|int
name|numChildren
init|=
name|interface
operator|->
name|childCount
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|1
init|;
name|i
operator|<=
name|numChildren
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|QRect
name|childRect
init|=
name|interface
operator|->
name|rect
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|childRect
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
block|}
operator|delete
name|doubleSpinBox
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|textEditTest
name|void
name|tst_QAccessibility
operator|::
name|textEditTest
parameter_list|()
block|{
block|{
name|QTextEdit
name|edit
decl_stmt|;
name|int
name|startOffset
decl_stmt|;
name|int
name|endOffset
decl_stmt|;
name|QString
name|text
init|=
literal|"hello world\nhow are you today?\n"
decl_stmt|;
name|edit
operator|.
name|setText
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|edit
operator|.
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|edit
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|4
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"hello world"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|5
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"how are you today?"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|textInterface
argument_list|()
operator|->
name|textAtOffset
argument_list|(
literal|8
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"world"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|textInterface
argument_list|()
operator|->
name|textAtOffset
argument_list|(
literal|14
argument_list|,
name|QAccessible2
operator|::
name|LineBoundary
argument_list|,
operator|&
name|startOffset
argument_list|,
operator|&
name|endOffset
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"how are you today?"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|startOffset
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|endOffset
argument_list|,
literal|30
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|6
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|textInterface
argument_list|()
operator|->
name|characterCount
argument_list|()
argument_list|,
literal|31
argument_list|)
expr_stmt|;
name|QFontMetrics
name|fm
argument_list|(
name|edit
operator|.
name|font
argument_list|()
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|textInterface
argument_list|()
operator|->
name|characterRect
argument_list|(
literal|0
argument_list|,
name|QAccessible2
operator|::
name|RelativeToParent
argument_list|)
operator|.
name|size
argument_list|()
argument_list|,
name|QSize
argument_list|(
name|fm
operator|.
name|width
argument_list|(
literal|"h"
argument_list|)
argument_list|,
name|fm
operator|.
name|height
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|textInterface
argument_list|()
operator|->
name|characterRect
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|RelativeToParent
argument_list|)
operator|.
name|size
argument_list|()
argument_list|,
name|QSize
argument_list|(
name|fm
operator|.
name|width
argument_list|(
literal|" "
argument_list|)
argument_list|,
name|fm
operator|.
name|height
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|textInterface
argument_list|()
operator|->
name|characterRect
argument_list|(
literal|6
argument_list|,
name|QAccessible2
operator|::
name|RelativeToParent
argument_list|)
operator|.
name|size
argument_list|()
argument_list|,
name|QSize
argument_list|(
name|fm
operator|.
name|width
argument_list|(
literal|"w"
argument_list|)
argument_list|,
name|fm
operator|.
name|height
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|textBrowserTest
name|void
name|tst_QAccessibility
operator|::
name|textBrowserTest
parameter_list|()
block|{
block|{
name|QTextBrowser
name|textBrowser
decl_stmt|;
name|QString
name|text
init|=
name|QLatin1String
argument_list|(
literal|"Hello world\nhow are you today?\n"
argument_list|)
decl_stmt|;
name|textBrowser
operator|.
name|setText
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|textBrowser
operator|.
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|textBrowser
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|StaticText
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|4
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Hello world"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|5
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"how are you today?"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|6
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|listViewTest
name|void
name|tst_QAccessibility
operator|::
name|listViewTest
parameter_list|()
block|{
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table1 interface is no longer supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
block|{
name|QListView
name|listView
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|listView
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
block|}
block|{
name|QListWidget
name|listView
decl_stmt|;
name|listView
operator|.
name|addItem
argument_list|(
name|tr
argument_list|(
literal|"A"
argument_list|)
argument_list|)
expr_stmt|;
name|listView
operator|.
name|addItem
argument_list|(
name|tr
argument_list|(
literal|"B"
argument_list|)
argument_list|)
expr_stmt|;
name|listView
operator|.
name|addItem
argument_list|(
name|tr
argument_list|(
literal|"C"
argument_list|)
argument_list|)
expr_stmt|;
name|listView
operator|.
name|resize
argument_list|(
literal|400
argument_list|,
literal|400
argument_list|)
expr_stmt|;
name|listView
operator|.
name|show
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|1
argument_list|)
expr_stmt|;
comment|// Need this for indexOfchild to work.
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|(
operator|&
name|listView
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|listView
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
operator|(
name|int
operator|)
name|QAccessible
operator|::
name|Client
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|iface
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
operator|(
name|int
operator|)
name|QAccessible
operator|::
name|List
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child
decl_stmt|;
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|child
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|iface
operator|=
name|child
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"A"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|2
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"B"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|3
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"C"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|childA
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|childA
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|childA
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|childA
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childA
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"A"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|childA
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|childB
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|2
argument_list|,
operator|&
name|childB
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|childB
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|childB
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childB
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"B"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|childB
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|childC
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|3
argument_list|,
operator|&
name|childC
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|childC
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|childC
argument_list|)
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childC
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"C"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|childC
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// Check for events
name|QTest
operator|::
name|mouseClick
argument_list|(
name|listView
operator|.
name|viewport
argument_list|()
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|listView
operator|.
name|visualItemRect
argument_list|(
name|listView
operator|.
name|item
argument_list|(
literal|1
argument_list|)
argument_list|)
operator|.
name|center
argument_list|()
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|mouseClick
argument_list|(
name|listView
operator|.
name|viewport
argument_list|()
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|listView
operator|.
name|visualItemRect
argument_list|(
name|listView
operator|.
name|item
argument_list|(
literal|2
argument_list|)
argument_list|)
operator|.
name|center
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|listView
operator|.
name|viewport
argument_list|()
argument_list|,
literal|2
argument_list|,
name|QAccessible
operator|::
name|Selection
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|listView
operator|.
name|viewport
argument_list|()
argument_list|,
literal|3
argument_list|,
name|QAccessible
operator|::
name|Selection
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|mdiAreaTest
name|void
name|tst_QAccessibility
operator|::
name|mdiAreaTest
parameter_list|()
block|{
block|{
name|QMdiArea
name|mdiArea
decl_stmt|;
name|mdiArea
operator|.
name|resize
argument_list|(
literal|400
argument_list|,
literal|300
argument_list|)
expr_stmt|;
name|mdiArea
operator|.
name|show
argument_list|()
expr_stmt|;
specifier|const
name|int
name|subWindowCount
init|=
literal|3
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|subWindowCount
condition|;
operator|++
name|i
control|)
name|mdiArea
operator|.
name|addSubWindow
argument_list|(
operator|new
name|QWidget
argument_list|,
name|Qt
operator|::
name|Dialog
argument_list|)
operator|->
name|show
argument_list|()
expr_stmt|;
name|QList
argument_list|<
name|QMdiSubWindow
modifier|*
argument_list|>
name|subWindows
init|=
name|mdiArea
operator|.
name|subWindowList
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|subWindows
operator|.
name|count
argument_list|()
argument_list|,
name|subWindowCount
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|mdiArea
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
name|subWindowCount
argument_list|)
expr_stmt|;
comment|// Right, right, right, ...
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|subWindowCount
condition|;
operator|++
name|i
control|)
block|{
name|QAccessibleInterface
modifier|*
name|destination
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
name|i
operator|+
literal|1
argument_list|,
operator|&
name|destination
argument_list|)
decl_stmt|;
if|if
condition|(
name|i
operator|==
name|subWindowCount
operator|-
literal|1
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|subWindows
operator|.
name|at
argument_list|(
name|i
operator|+
literal|1
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
block|}
block|}
comment|// Left, left, left, ...
for|for
control|(
name|int
name|i
init|=
name|subWindowCount
init|;
name|i
operator|>
literal|0
condition|;
operator|--
name|i
control|)
block|{
name|QAccessibleInterface
modifier|*
name|destination
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
name|i
argument_list|,
operator|&
name|destination
argument_list|)
decl_stmt|;
if|if
condition|(
name|i
operator|==
literal|1
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|subWindows
operator|.
name|at
argument_list|(
name|i
operator|-
literal|2
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
block|}
block|}
comment|// ### Add test for Up and Down.
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|mdiSubWindowTest
name|void
name|tst_QAccessibility
operator|::
name|mdiSubWindowTest
parameter_list|()
block|{
block|{
name|QMdiArea
name|mdiArea
decl_stmt|;
name|mdiArea
operator|.
name|show
argument_list|()
expr_stmt|;
name|qApp
operator|->
name|setActiveWindow
argument_list|(
operator|&
name|mdiArea
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|150
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|bool
name|isSubWindowsPlacedNextToEachOther
init|=
literal|false
decl_stmt|;
specifier|const
name|int
name|subWindowCount
init|=
literal|5
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|subWindowCount
condition|;
operator|++
name|i
control|)
block|{
name|QMdiSubWindow
modifier|*
name|window
init|=
name|mdiArea
operator|.
name|addSubWindow
argument_list|(
operator|new
name|QPushButton
argument_list|(
literal|"QAccessibilityTest"
argument_list|)
argument_list|)
decl_stmt|;
name|window
operator|->
name|show
argument_list|()
expr_stmt|;
comment|// Parts of this test requires that the sub windows are placed next
comment|// to each other. In order to achieve that QMdiArea must have
comment|// a width which is larger than subWindow->width() * subWindowCount.
if|if
condition|(
name|i
operator|==
literal|0
condition|)
block|{
name|int
name|minimumWidth
init|=
name|window
operator|->
name|width
argument_list|()
operator|*
name|subWindowCount
operator|+
literal|20
decl_stmt|;
name|mdiArea
operator|.
name|resize
argument_list|(
name|mdiArea
operator|.
name|size
argument_list|()
operator|.
name|expandedTo
argument_list|(
name|QSize
argument_list|(
name|minimumWidth
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|mdiArea
operator|.
name|width
argument_list|()
operator|>=
name|minimumWidth
condition|)
name|isSubWindowsPlacedNextToEachOther
operator|=
literal|true
expr_stmt|;
block|}
block|}
name|QList
argument_list|<
name|QMdiSubWindow
modifier|*
argument_list|>
name|subWindows
init|=
name|mdiArea
operator|.
name|subWindowList
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|subWindows
operator|.
name|count
argument_list|()
argument_list|,
name|subWindowCount
argument_list|)
expr_stmt|;
name|QMdiSubWindow
modifier|*
name|testWindow
init|=
name|subWindows
operator|.
name|at
argument_list|(
literal|3
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|testWindow
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|testWindow
argument_list|)
decl_stmt|;
comment|// childCount
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// setText / text
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setWindowTitle
argument_list|(
name|QLatin1String
argument_list|(
literal|"ReplaceMe"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"ReplaceMe"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"ReplaceMe"
argument_list|)
argument_list|)
expr_stmt|;
name|interface
operator|->
name|setText
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|,
name|QLatin1String
argument_list|(
literal|"TitleSetOnWindow"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"TitleSetOnWindow"
argument_list|)
argument_list|)
expr_stmt|;
name|interface
operator|->
name|setText
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|,
name|QLatin1String
argument_list|(
literal|"TitleSetOnChild"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"TitleSetOnChild"
argument_list|)
argument_list|)
expr_stmt|;
name|mdiArea
operator|.
name|setActiveSubWindow
argument_list|(
name|testWindow
argument_list|)
expr_stmt|;
comment|// state
name|QAccessible
operator|::
name|State
name|state
init|=
name|QAccessible
operator|::
name|Normal
operator||
name|QAccessible
operator|::
name|Focusable
operator||
name|QAccessible
operator|::
name|Focused
operator||
name|QAccessible
operator|::
name|Movable
operator||
name|QAccessible
operator|::
name|Sizeable
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
argument_list|,
name|state
argument_list|)
expr_stmt|;
specifier|const
name|QRect
name|originalGeometry
init|=
name|testWindow
operator|->
name|geometry
argument_list|()
decl_stmt|;
name|testWindow
operator|->
name|showMaximized
argument_list|()
expr_stmt|;
name|state
operator|&=
operator|~
name|QAccessible
operator|::
name|Sizeable
expr_stmt|;
name|state
operator|&=
operator|~
name|QAccessible
operator|::
name|Movable
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
argument_list|,
name|state
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|showNormal
argument_list|()
expr_stmt|;
name|testWindow
operator|->
name|move
argument_list|(
operator|-
literal|10
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Offscreen
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Invisible
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setEnabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Unavailable
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setEnabled
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|qApp
operator|->
name|setActiveWindow
argument_list|(
operator|&
name|mdiArea
argument_list|)
expr_stmt|;
name|mdiArea
operator|.
name|setActiveSubWindow
argument_list|(
name|testWindow
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setFocus
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|testWindow
operator|->
name|isAncestorOf
argument_list|(
name|qApp
operator|->
name|focusWidget
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Focused
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|setGeometry
argument_list|(
name|originalGeometry
argument_list|)
expr_stmt|;
if|if
condition|(
name|isSubWindowsPlacedNextToEachOther
condition|)
block|{
comment|// This part of the test can only be run if the sub windows are
comment|// placed next to each other.
name|QAccessibleInterface
modifier|*
name|destination
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|destination
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|testWindow
operator|->
name|widget
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
literal|0
argument_list|,
operator|&
name|destination
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|subWindows
operator|.
name|at
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
literal|0
argument_list|,
operator|&
name|destination
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|subWindows
operator|.
name|at
argument_list|(
literal|4
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
block|}
comment|// rect
specifier|const
name|QPoint
name|globalPos
init|=
name|testWindow
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QRect
argument_list|(
name|globalPos
argument_list|,
name|testWindow
operator|->
name|size
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QRect
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QRect
argument_list|()
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|showMinimized
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QRect
argument_list|()
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|showNormal
argument_list|()
expr_stmt|;
name|testWindow
operator|->
name|widget
argument_list|()
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QRect
argument_list|()
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|widget
argument_list|()
operator|->
name|show
argument_list|()
expr_stmt|;
specifier|const
name|QRect
name|widgetGeometry
init|=
name|testWindow
operator|->
name|contentsRect
argument_list|()
decl_stmt|;
specifier|const
name|QPoint
name|globalWidgetPos
init|=
name|QPoint
argument_list|(
name|globalPos
operator|.
name|x
argument_list|()
operator|+
name|widgetGeometry
operator|.
name|x
argument_list|()
argument_list|,
name|globalPos
operator|.
name|y
argument_list|()
operator|+
name|widgetGeometry
operator|.
name|y
argument_list|()
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QRect
argument_list|(
name|globalWidgetPos
argument_list|,
name|widgetGeometry
operator|.
name|size
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
comment|// childAt
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childAt
argument_list|(
operator|-
literal|10
argument_list|,
literal|0
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childAt
argument_list|(
name|globalPos
operator|.
name|x
argument_list|()
argument_list|,
name|globalPos
operator|.
name|y
argument_list|()
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childAt
argument_list|(
name|globalWidgetPos
operator|.
name|x
argument_list|()
argument_list|,
name|globalWidgetPos
operator|.
name|y
argument_list|()
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|testWindow
operator|->
name|widget
argument_list|()
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childAt
argument_list|(
name|globalWidgetPos
operator|.
name|x
argument_list|()
argument_list|,
name|globalWidgetPos
operator|.
name|y
argument_list|()
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lineEditTest
name|void
name|tst_QAccessibility
operator|::
name|lineEditTest
parameter_list|()
block|{
name|QLineEdit
modifier|*
name|le
init|=
operator|new
name|QLineEdit
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|le
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|le
operator|->
name|show
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Sizeable
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Movable
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|bool
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Focusable
argument_list|)
argument_list|,
name|le
operator|->
name|isActiveWindow
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Selectable
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|HasPopup
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|bool
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Focused
argument_list|)
argument_list|,
name|le
operator|->
name|hasFocus
argument_list|()
argument_list|)
expr_stmt|;
name|QString
name|secret
argument_list|(
name|QLatin1String
argument_list|(
literal|"secret"
argument_list|)
argument_list|)
decl_stmt|;
name|le
operator|->
name|setText
argument_list|(
name|secret
argument_list|)
expr_stmt|;
name|le
operator|->
name|setEchoMode
argument_list|(
name|QLineEdit
operator|::
name|Normal
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Protected
operator|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
argument_list|,
name|secret
argument_list|)
expr_stmt|;
name|le
operator|->
name|setEchoMode
argument_list|(
name|QLineEdit
operator|::
name|NoEcho
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Protected
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|le
operator|->
name|setEchoMode
argument_list|(
name|QLineEdit
operator|::
name|Password
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Protected
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|le
operator|->
name|setEchoMode
argument_list|(
name|QLineEdit
operator|::
name|PasswordEchoOnEdit
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Protected
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|le
operator|->
name|setEchoMode
argument_list|(
name|QLineEdit
operator|::
name|Normal
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Protected
operator|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
argument_list|,
name|secret
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|toplevel
init|=
operator|new
name|QWidget
decl_stmt|;
name|le
operator|->
name|setParent
argument_list|(
name|toplevel
argument_list|)
expr_stmt|;
name|toplevel
operator|->
name|show
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Sizeable
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Movable
operator|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|bool
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Focusable
argument_list|)
argument_list|,
name|le
operator|->
name|isActiveWindow
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Selectable
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|HasPopup
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|bool
argument_list|(
name|iface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Focused
argument_list|)
argument_list|,
name|le
operator|->
name|hasFocus
argument_list|()
argument_list|)
expr_stmt|;
name|QLineEdit
modifier|*
name|le2
init|=
operator|new
name|QLineEdit
argument_list|(
name|toplevel
argument_list|)
decl_stmt|;
name|le2
operator|->
name|show
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|le2
operator|->
name|activateWindow
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|le
operator|->
name|setFocus
argument_list|(
name|Qt
operator|::
name|TabFocusReason
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|le2
operator|->
name|setFocus
argument_list|(
name|Qt
operator|::
name|TabFocusReason
argument_list|)
expr_stmt|;
name|QTRY_VERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|le2
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|Focus
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|le
operator|->
name|setText
argument_list|(
name|QLatin1String
argument_list|(
literal|"500"
argument_list|)
argument_list|)
expr_stmt|;
name|le
operator|->
name|setValidator
argument_list|(
operator|new
name|QIntValidator
argument_list|()
argument_list|)
expr_stmt|;
name|iface
operator|->
name|setText
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|,
name|QLatin1String
argument_list|(
literal|"This text is not a number"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|le
operator|->
name|text
argument_list|()
argument_list|,
name|QLatin1String
argument_list|(
literal|"500"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|le
expr_stmt|;
operator|delete
name|le2
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// IA2
name|QString
name|cite
init|=
literal|"I always pass on good advice. It is the only thing to do with it. It is never of any use to oneself. --Oscar Wilde"
decl_stmt|;
name|QLineEdit
modifier|*
name|le3
init|=
operator|new
name|QLineEdit
argument_list|(
name|cite
argument_list|,
name|toplevel
argument_list|)
decl_stmt|;
name|iface
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|le3
argument_list|)
expr_stmt|;
name|QAccessibleTextInterface
modifier|*
name|textIface
init|=
name|iface
operator|->
name|textInterface
argument_list|()
decl_stmt|;
name|le3
operator|->
name|deselect
argument_list|()
expr_stmt|;
name|le3
operator|->
name|setCursorPosition
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|cursorPosition
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QTRY_VERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|le3
argument_list|,
literal|0
argument_list|,
name|QAccessible
operator|::
name|TextCaretMoved
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|selectionCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|int
name|start
decl_stmt|,
name|end
decl_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|text
argument_list|(
literal|0
argument_list|,
literal|8
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"I always"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|0
argument_list|,
name|QAccessible2
operator|::
name|CharBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"I"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|start
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|end
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textBeforeOffset
argument_list|(
literal|0
argument_list|,
name|QAccessible2
operator|::
name|CharBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAfterOffset
argument_list|(
literal|0
argument_list|,
name|QAccessible2
operator|::
name|CharBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|" "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|start
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|end
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|CharBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"a"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|start
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|end
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textBeforeOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|CharBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"w"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAfterOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|CharBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"y"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"always"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|start
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|end
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|2
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"always"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|7
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"always"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|8
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|" "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|25
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"advice"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|92
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"oneself"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textBeforeOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|" "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAfterOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|WordBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|" "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|SentenceBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"I always pass on good advice. "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|start
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|end
argument_list|,
literal|30
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textBeforeOffset
argument_list|(
literal|40
argument_list|,
name|QAccessible2
operator|::
name|SentenceBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"I always pass on good advice. "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAfterOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|SentenceBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"It is the only thing to do with it. "
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|ParagraphBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|cite
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|start
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|end
argument_list|,
name|cite
operator|.
name|length
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|LineBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|cite
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|textIface
operator|->
name|textAtOffset
argument_list|(
literal|5
argument_list|,
name|QAccessible2
operator|::
name|NoBoundary
argument_list|,
operator|&
name|start
argument_list|,
operator|&
name|end
argument_list|)
argument_list|,
name|cite
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|toplevel
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|workspaceTest
name|void
name|tst_QAccessibility
operator|::
name|workspaceTest
parameter_list|()
block|{
block|{
name|QWorkspace
name|workspace
decl_stmt|;
name|workspace
operator|.
name|resize
argument_list|(
literal|400
argument_list|,
literal|300
argument_list|)
expr_stmt|;
name|workspace
operator|.
name|show
argument_list|()
expr_stmt|;
specifier|const
name|int
name|subWindowCount
init|=
literal|3
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|subWindowCount
condition|;
operator|++
name|i
control|)
block|{
name|QWidget
modifier|*
name|window
init|=
name|workspace
operator|.
name|addWindow
argument_list|(
operator|new
name|QWidget
argument_list|)
decl_stmt|;
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|window
operator|->
name|move
argument_list|(
name|window
operator|->
name|x
argument_list|()
operator|+
literal|1
argument_list|,
name|window
operator|->
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|window
operator|->
name|show
argument_list|()
expr_stmt|;
name|window
operator|->
name|resize
argument_list|(
literal|70
argument_list|,
name|window
operator|->
name|height
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QWidgetList
name|subWindows
init|=
name|workspace
operator|.
name|windowList
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|subWindows
operator|.
name|count
argument_list|()
argument_list|,
name|subWindowCount
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|workspace
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
name|subWindowCount
argument_list|)
expr_stmt|;
comment|// Right, right, right, ...
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|subWindowCount
condition|;
operator|++
name|i
control|)
block|{
name|QAccessibleInterface
modifier|*
name|destination
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
name|i
operator|+
literal|1
argument_list|,
operator|&
name|destination
argument_list|)
decl_stmt|;
if|if
condition|(
name|i
operator|==
name|subWindowCount
operator|-
literal|1
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|subWindows
operator|.
name|at
argument_list|(
name|i
operator|+
literal|1
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
block|}
block|}
comment|// Left, left, left, ...
for|for
control|(
name|int
name|i
init|=
name|subWindowCount
init|;
name|i
operator|>
literal|0
condition|;
operator|--
name|i
control|)
block|{
name|QAccessibleInterface
modifier|*
name|destination
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
name|i
argument_list|,
operator|&
name|destination
argument_list|)
decl_stmt|;
if|if
condition|(
name|i
operator|==
literal|1
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|destination
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|destination
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|subWindows
operator|.
name|at
argument_list|(
name|i
operator|-
literal|2
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|destination
expr_stmt|;
block|}
block|}
comment|// ### Add test for Up and Down.
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|dialogButtonBoxTest
name|void
name|tst_QAccessibility
operator|::
name|dialogButtonBoxTest
parameter_list|()
block|{
block|{
name|QDialogButtonBox
name|box
argument_list|(
name|QDialogButtonBox
operator|::
name|Reset
operator||
name|QDialogButtonBox
operator|::
name|Help
operator||
name|QDialogButtonBox
operator|::
name|Ok
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|box
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|box
operator|.
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Grouping
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|PushButton
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|2
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|PushButton
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|role
argument_list|(
literal|3
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|PushButton
argument_list|)
expr_stmt|;
name|QStringList
name|actualOrder
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|child
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|leftmost
decl_stmt|;
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|child
argument_list|)
expr_stmt|;
comment|// first find the leftmost button
while|while
condition|(
name|child
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
literal|1
argument_list|,
operator|&
name|leftmost
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
operator|delete
name|child
expr_stmt|;
name|child
operator|=
name|leftmost
expr_stmt|;
block|}
name|leftmost
operator|=
name|child
expr_stmt|;
comment|// then traverse from left to right to find the correct order of the buttons
name|int
name|right
init|=
literal|0
decl_stmt|;
while|while
condition|(
name|right
operator|!=
operator|-
literal|1
condition|)
block|{
name|actualOrder
operator|<<
name|leftmost
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|right
operator|=
name|leftmost
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
literal|1
argument_list|,
operator|&
name|child
argument_list|)
expr_stmt|;
operator|delete
name|leftmost
expr_stmt|;
name|leftmost
operator|=
name|child
expr_stmt|;
block|}
name|QStringList
name|expectedOrder
decl_stmt|;
name|QDialogButtonBox
operator|::
name|ButtonLayout
name|btnlout
init|=
name|QDialogButtonBox
operator|::
name|ButtonLayout
argument_list|(
name|QApplication
operator|::
name|style
argument_list|()
operator|->
name|styleHint
argument_list|(
name|QStyle
operator|::
name|SH_DialogButtonLayout
argument_list|)
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|btnlout
condition|)
block|{
case|case
name|QDialogButtonBox
operator|::
name|WinLayout
case|:
name|expectedOrder
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"Reset"
argument_list|)
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"OK"
argument_list|)
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"Help"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QDialogButtonBox
operator|::
name|GnomeLayout
case|:
case|case
name|QDialogButtonBox
operator|::
name|KdeLayout
case|:
case|case
name|QDialogButtonBox
operator|::
name|MacLayout
case|:
name|expectedOrder
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"Help"
argument_list|)
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"Reset"
argument_list|)
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"OK"
argument_list|)
expr_stmt|;
break|break;
block|}
name|QCOMPARE
argument_list|(
name|actualOrder
argument_list|,
name|expectedOrder
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
block|{
name|QDialogButtonBox
name|box
argument_list|(
name|QDialogButtonBox
operator|::
name|Reset
operator||
name|QDialogButtonBox
operator|::
name|Help
operator||
name|QDialogButtonBox
operator|::
name|Ok
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
decl_stmt|;
comment|// Test up and down navigation
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|box
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|box
operator|.
name|setOrientation
argument_list|(
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|box
operator|.
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child
decl_stmt|;
name|QStringList
name|actualOrder
decl_stmt|;
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|child
argument_list|)
expr_stmt|;
comment|// first find the topmost button
name|QAccessibleInterface
modifier|*
name|other
decl_stmt|;
while|while
condition|(
name|child
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
literal|1
argument_list|,
operator|&
name|other
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
operator|delete
name|child
expr_stmt|;
name|child
operator|=
name|other
expr_stmt|;
block|}
name|other
operator|=
name|child
expr_stmt|;
comment|// then traverse from top to bottom to find the correct order of the buttons
name|actualOrder
operator|.
name|clear
argument_list|()
expr_stmt|;
name|int
name|right
init|=
literal|0
decl_stmt|;
while|while
condition|(
name|right
operator|!=
operator|-
literal|1
condition|)
block|{
name|actualOrder
operator|<<
name|other
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|right
operator|=
name|other
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
literal|1
argument_list|,
operator|&
name|child
argument_list|)
expr_stmt|;
operator|delete
name|other
expr_stmt|;
name|other
operator|=
name|child
expr_stmt|;
block|}
name|QStringList
name|expectedOrder
decl_stmt|;
name|expectedOrder
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"OK"
argument_list|)
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"Reset"
argument_list|)
operator|<<
name|QDialogButtonBox
operator|::
name|tr
argument_list|(
literal|"Help"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|actualOrder
argument_list|,
name|expectedOrder
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|dialTest
name|void
name|tst_QAccessibility
operator|::
name|dialTest
parameter_list|()
block|{
block|{
name|QDial
name|dial
decl_stmt|;
name|dial
operator|.
name|setValue
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|dial
operator|.
name|value
argument_list|()
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|dial
operator|.
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|dial
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
comment|// Child count; 1 = SpeedoMeter, 2 = SliderHandle.
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Dial
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Slider
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|2
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Indicator
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
operator|::
name|number
argument_list|(
name|dial
operator|.
name|value
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QString
operator|::
name|number
argument_list|(
name|dial
operator|.
name|value
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Value
argument_list|,
literal|2
argument_list|)
argument_list|,
name|QString
operator|::
name|number
argument_list|(
name|dial
operator|.
name|value
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"QDial"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|1
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"SpeedoMeter"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|2
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"SliderHandle"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|3
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|""
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|1
argument_list|)
argument_list|,
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|state
argument_list|(
literal|2
argument_list|)
argument_list|,
name|interface
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator||
name|QAccessible
operator|::
name|HotTracked
argument_list|)
expr_stmt|;
comment|// Rect
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|,
name|dial
operator|.
name|geometry
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|dial
operator|.
name|geometry
argument_list|()
operator|.
name|contains
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|2
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
operator|.
name|contains
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|2
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|interface
operator|->
name|rect
argument_list|(
literal|3
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|rubberBandTest
name|void
name|tst_QAccessibility
operator|::
name|rubberBandTest
parameter_list|()
block|{
name|QRubberBand
name|rubberBand
argument_list|(
name|QRubberBand
operator|::
name|Rectangle
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|rubberBand
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Border
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|abstractScrollAreaTest
name|void
name|tst_QAccessibility
operator|::
name|abstractScrollAreaTest
parameter_list|()
block|{
block|{
name|QAbstractScrollArea
name|abstractScrollArea
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|abstractScrollArea
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childAt
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|abstractScrollArea
operator|.
name|resize
argument_list|(
literal|400
argument_list|,
literal|400
argument_list|)
expr_stmt|;
name|abstractScrollArea
operator|.
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
specifier|const
name|QRect
name|globalGeometry
init|=
name|QRect
argument_list|(
name|abstractScrollArea
operator|.
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|,
name|abstractScrollArea
operator|.
name|size
argument_list|()
argument_list|)
decl_stmt|;
comment|// Viewport.
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|viewport
init|=
name|abstractScrollArea
operator|.
name|viewport
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|viewport
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|viewport
argument_list|,
name|interface
argument_list|,
literal|1
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
comment|// Horizontal scrollBar.
name|abstractScrollArea
operator|.
name|setHorizontalScrollBarPolicy
argument_list|(
name|Qt
operator|::
name|ScrollBarAlwaysOn
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|horizontalScrollBar
init|=
name|abstractScrollArea
operator|.
name|horizontalScrollBar
argument_list|()
decl_stmt|;
name|QWidget
modifier|*
name|horizontalScrollBarContainer
init|=
name|horizontalScrollBar
operator|->
name|parentWidget
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|horizontalScrollBarContainer
argument_list|,
name|interface
argument_list|,
literal|2
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
comment|// Horizontal scrollBar widgets.
name|QLabel
modifier|*
name|secondLeftLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"L2"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|secondLeftLabel
argument_list|,
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|firstLeftLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"L1"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|firstLeftLabel
argument_list|,
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|secondRightLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"R2"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|secondRightLabel
argument_list|,
name|Qt
operator|::
name|AlignRight
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|firstRightLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"R1"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|firstRightLabel
argument_list|,
name|Qt
operator|::
name|AlignRight
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|// Vertical scrollBar.
name|abstractScrollArea
operator|.
name|setVerticalScrollBarPolicy
argument_list|(
name|Qt
operator|::
name|ScrollBarAlwaysOn
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|verticalScrollBar
init|=
name|abstractScrollArea
operator|.
name|verticalScrollBar
argument_list|()
decl_stmt|;
name|QWidget
modifier|*
name|verticalScrollBarContainer
init|=
name|verticalScrollBar
operator|->
name|parentWidget
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|verticalScrollBarContainer
argument_list|,
name|interface
argument_list|,
literal|3
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
comment|// Vertical scrollBar widgets.
name|QLabel
modifier|*
name|secondTopLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"T2"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|secondTopLabel
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|firstTopLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"T1"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|firstTopLabel
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|secondBottomLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"B2"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|secondBottomLabel
argument_list|,
name|Qt
operator|::
name|AlignBottom
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QLabel
modifier|*
name|firstBottomLabel
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"B1"
argument_list|)
argument_list|)
decl_stmt|;
name|abstractScrollArea
operator|.
name|addScrollBarWidget
argument_list|(
name|firstBottomLabel
argument_list|,
name|Qt
operator|::
name|AlignBottom
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
comment|// CornerWidget.
name|abstractScrollArea
operator|.
name|setCornerWidget
argument_list|(
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"C"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|cornerWidget
init|=
name|abstractScrollArea
operator|.
name|cornerWidget
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|cornerWidget
argument_list|,
name|interface
argument_list|,
literal|4
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
comment|// Test navigate.
name|QAccessibleInterface
modifier|*
name|target
init|=
literal|0
decl_stmt|;
comment|// viewport -> Up -> NOTHING
specifier|const
name|int
name|viewportIndex
init|=
name|indexOfChild
argument_list|(
name|interface
argument_list|,
name|viewport
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|viewportIndex
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
name|viewportIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// viewport -> Left -> NOTHING
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
name|viewportIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// viewport -> Down -> horizontalScrollBarContainer
specifier|const
name|int
name|horizontalScrollBarContainerIndex
init|=
name|indexOfChild
argument_list|(
name|interface
argument_list|,
name|horizontalScrollBarContainer
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|horizontalScrollBarContainerIndex
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
name|viewportIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QObject
operator|*
argument_list|>
argument_list|(
name|horizontalScrollBarContainer
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
comment|// horizontalScrollBarContainer -> Left -> NOTHING
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
name|horizontalScrollBarContainerIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// horizontalScrollBarContainer -> Down -> NOTHING
name|QVERIFY
argument_list|(
name|horizontalScrollBarContainerIndex
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
name|horizontalScrollBarContainerIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// horizontalScrollBarContainer -> Right -> cornerWidget
specifier|const
name|int
name|cornerWidgetIndex
init|=
name|indexOfChild
argument_list|(
name|interface
argument_list|,
name|cornerWidget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|cornerWidgetIndex
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
name|horizontalScrollBarContainerIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QObject
operator|*
argument_list|>
argument_list|(
name|cornerWidget
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
comment|// cornerWidget -> Down -> NOTHING
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
name|cornerWidgetIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// cornerWidget -> Right -> NOTHING
name|QVERIFY
argument_list|(
name|cornerWidgetIndex
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
name|cornerWidgetIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// cornerWidget -> Up ->  verticalScrollBarContainer
specifier|const
name|int
name|verticalScrollBarContainerIndex
init|=
name|indexOfChild
argument_list|(
name|interface
argument_list|,
name|verticalScrollBarContainer
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|verticalScrollBarContainerIndex
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
name|cornerWidgetIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QObject
operator|*
argument_list|>
argument_list|(
name|verticalScrollBarContainer
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
comment|// verticalScrollBarContainer -> Right -> NOTHING
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Right
argument_list|,
name|verticalScrollBarContainerIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// verticalScrollBarContainer -> Up -> NOTHING
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
name|verticalScrollBarContainerIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|target
argument_list|)
expr_stmt|;
comment|// verticalScrollBarContainer -> Left -> viewport
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Left
argument_list|,
name|verticalScrollBarContainerIndex
argument_list|,
operator|&
name|target
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|target
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|target
operator|->
name|object
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QObject
operator|*
argument_list|>
argument_list|(
name|viewport
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|target
expr_stmt|;
name|target
operator|=
literal|0
expr_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|interface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|interface
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|scrollAreaTest
name|void
name|tst_QAccessibility
operator|::
name|scrollAreaTest
parameter_list|()
block|{
block|{
name|QScrollArea
name|scrollArea
decl_stmt|;
name|scrollArea
operator|.
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|scrollArea
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// The viewport.
operator|delete
name|interface
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|tableWidgetTest
name|void
name|tst_QAccessibility
operator|::
name|tableWidgetTest
parameter_list|()
block|{
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table1 interface is no longer supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
block|{
name|QWidget
modifier|*
name|topLevel
init|=
operator|new
name|QWidget
decl_stmt|;
name|QTableWidget
modifier|*
name|w
init|=
operator|new
name|QTableWidget
argument_list|(
literal|8
argument_list|,
literal|4
argument_list|,
name|topLevel
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|r
init|=
literal|0
init|;
name|r
operator|<
literal|8
condition|;
operator|++
name|r
control|)
block|{
for|for
control|(
name|int
name|c
init|=
literal|0
init|;
name|c
operator|<
literal|4
condition|;
operator|++
name|c
control|)
block|{
name|w
operator|->
name|setItem
argument_list|(
name|r
argument_list|,
name|c
argument_list|,
operator|new
name|QTableWidgetItem
argument_list|(
name|tr
argument_list|(
literal|"%1,%2"
argument_list|)
operator|.
name|arg
argument_list|(
name|c
argument_list|)
operator|.
name|arg
argument_list|(
name|r
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|w
operator|->
name|resize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|topLevel
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|client
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|client
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Client
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|client
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|view
init|=
literal|0
decl_stmt|;
name|client
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|view
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|view
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Table
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|ifRow
decl_stmt|;
name|view
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|2
argument_list|,
operator|&
name|ifRow
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|ifRow
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Row
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|item
decl_stmt|;
name|int
name|entry
init|=
name|ifRow
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|item
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|item
argument_list|,
operator|(
name|QAccessibleInterface
operator|*
operator|)
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|ifRow
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|2
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"0,0"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|ifRow
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|3
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"1,0"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|client
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|ifRow
expr_stmt|;
operator|delete
name|view
expr_stmt|;
operator|delete
name|client
expr_stmt|;
operator|delete
name|w
expr_stmt|;
operator|delete
name|topLevel
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_class
DECL|class|QtTestTableModel
class|class
name|QtTestTableModel
super|:
specifier|public
name|QAbstractTableModel
block|{
name|Q_OBJECT
signals|signals:
name|void
name|invalidIndexEncountered
parameter_list|()
specifier|const
function_decl|;
public|public:
DECL|function|QtTestTableModel
name|QtTestTableModel
parameter_list|(
name|int
name|rows
init|=
literal|0
parameter_list|,
name|int
name|columns
init|=
literal|0
parameter_list|,
name|QObject
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QAbstractTableModel
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|row_count
argument_list|(
name|rows
argument_list|)
member_init_list|,
name|column_count
argument_list|(
name|columns
argument_list|)
block|{}
DECL|function|rowCount
name|int
name|rowCount
parameter_list|(
specifier|const
name|QModelIndex
modifier|&
init|=
name|QModelIndex
argument_list|()
parameter_list|)
specifier|const
block|{
return|return
name|row_count
return|;
block|}
DECL|function|columnCount
name|int
name|columnCount
parameter_list|(
specifier|const
name|QModelIndex
modifier|&
init|=
name|QModelIndex
argument_list|()
parameter_list|)
specifier|const
block|{
return|return
name|column_count
return|;
block|}
DECL|function|data
name|QVariant
name|data
parameter_list|(
specifier|const
name|QModelIndex
modifier|&
name|idx
parameter_list|,
name|int
name|role
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|idx
operator|.
name|isValid
argument_list|()
operator|||
name|idx
operator|.
name|row
argument_list|()
operator|>=
name|row_count
operator|||
name|idx
operator|.
name|column
argument_list|()
operator|>=
name|column_count
condition|)
block|{
name|qWarning
argument_list|()
operator|<<
literal|"Invalid modelIndex [%d,%d,%p]"
operator|<<
name|idx
expr_stmt|;
emit|emit
name|invalidIndexEncountered
argument_list|()
emit|;
return|return
name|QVariant
argument_list|()
return|;
block|}
if|if
condition|(
name|role
operator|==
name|Qt
operator|::
name|DisplayRole
operator|||
name|role
operator|==
name|Qt
operator|::
name|EditRole
condition|)
return|return
name|QString
argument_list|(
literal|"[%1,%2,%3]"
argument_list|)
operator|.
name|arg
argument_list|(
name|idx
operator|.
name|row
argument_list|()
argument_list|)
operator|.
name|arg
argument_list|(
name|idx
operator|.
name|column
argument_list|()
argument_list|)
operator|.
name|arg
argument_list|(
literal|0
argument_list|)
return|;
return|return
name|QVariant
argument_list|()
return|;
block|}
DECL|function|removeLastRow
name|void
name|removeLastRow
parameter_list|()
block|{
name|beginRemoveRows
argument_list|(
name|QModelIndex
argument_list|()
argument_list|,
name|row_count
operator|-
literal|1
argument_list|,
name|row_count
operator|-
literal|1
argument_list|)
expr_stmt|;
operator|--
name|row_count
expr_stmt|;
name|endRemoveRows
argument_list|()
expr_stmt|;
block|}
DECL|function|removeAllRows
name|void
name|removeAllRows
parameter_list|()
block|{
name|beginRemoveRows
argument_list|(
name|QModelIndex
argument_list|()
argument_list|,
literal|0
argument_list|,
name|row_count
operator|-
literal|1
argument_list|)
expr_stmt|;
name|row_count
operator|=
literal|0
expr_stmt|;
name|endRemoveRows
argument_list|()
expr_stmt|;
block|}
DECL|function|removeLastColumn
name|void
name|removeLastColumn
parameter_list|()
block|{
name|beginRemoveColumns
argument_list|(
name|QModelIndex
argument_list|()
argument_list|,
name|column_count
operator|-
literal|1
argument_list|,
name|column_count
operator|-
literal|1
argument_list|)
expr_stmt|;
operator|--
name|column_count
expr_stmt|;
name|endRemoveColumns
argument_list|()
expr_stmt|;
block|}
DECL|function|removeAllColumns
name|void
name|removeAllColumns
parameter_list|()
block|{
name|beginRemoveColumns
argument_list|(
name|QModelIndex
argument_list|()
argument_list|,
literal|0
argument_list|,
name|column_count
operator|-
literal|1
argument_list|)
expr_stmt|;
name|column_count
operator|=
literal|0
expr_stmt|;
name|endRemoveColumns
argument_list|()
expr_stmt|;
block|}
DECL|function|reset
name|void
name|reset
parameter_list|()
block|{
name|QAbstractTableModel
operator|::
name|reset
argument_list|()
expr_stmt|;
block|}
DECL|member|row_count
name|int
name|row_count
decl_stmt|;
DECL|member|column_count
name|int
name|column_count
decl_stmt|;
block|}
class|;
end_class
begin_class
DECL|class|QtTestDelegate
class|class
name|QtTestDelegate
super|:
specifier|public
name|QItemDelegate
block|{
public|public:
DECL|function|QtTestDelegate
name|QtTestDelegate
parameter_list|(
name|QWidget
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QItemDelegate
argument_list|(
name|parent
argument_list|)
block|{}
DECL|function|sizeHint
specifier|virtual
name|QSize
name|sizeHint
parameter_list|(
specifier|const
name|QStyleOptionViewItem
modifier|&
comment|/*option*/
parameter_list|,
specifier|const
name|QModelIndex
modifier|&
comment|/*index*/
parameter_list|)
specifier|const
block|{
return|return
name|QSize
argument_list|(
literal|100
argument_list|,
literal|50
argument_list|)
return|;
block|}
block|}
class|;
end_class
begin_function
DECL|function|tableViewTest
name|void
name|tst_QAccessibility
operator|::
name|tableViewTest
parameter_list|()
block|{
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table1 interface is no longer supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
block|{
name|QtTestTableModel
modifier|*
name|model
init|=
operator|new
name|QtTestTableModel
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
decl_stmt|;
name|QTableView
modifier|*
name|w
init|=
operator|new
name|QTableView
argument_list|()
decl_stmt|;
name|w
operator|->
name|setModel
argument_list|(
name|model
argument_list|)
expr_stmt|;
name|w
operator|->
name|setItemDelegate
argument_list|(
operator|new
name|QtTestDelegate
argument_list|(
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|w
operator|->
name|resize
argument_list|(
literal|450
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|w
operator|->
name|resizeColumnsToContents
argument_list|()
expr_stmt|;
name|w
operator|->
name|resizeRowsToContents
argument_list|()
expr_stmt|;
name|w
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|client
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|table2
decl_stmt|;
name|client
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|table2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|table2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Row
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|toprow
init|=
literal|0
decl_stmt|;
name|table2
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|toprow
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|toprow
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|toprow
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|RowHeader
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|toprow
operator|->
name|role
argument_list|(
literal|2
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|ColumnHeader
argument_list|)
expr_stmt|;
operator|delete
name|toprow
expr_stmt|;
comment|// call childAt() for each child until we reach the bottom,
comment|// and do it for each row in the table
for|for
control|(
name|int
name|y
init|=
literal|1
init|;
name|y
operator|<
literal|5
condition|;
operator|++
name|y
control|)
block|{
comment|// this includes the special header
for|for
control|(
name|int
name|x
init|=
literal|1
init|;
name|x
operator|<
literal|6
condition|;
operator|++
name|x
control|)
block|{
name|QCOMPARE
argument_list|(
name|client
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Client
argument_list|)
expr_stmt|;
name|QRect
name|globalRect
init|=
name|client
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|globalRect
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
comment|// make sure we don't hit the vertical header  #####
name|QPoint
name|p
init|=
name|globalRect
operator|.
name|topLeft
argument_list|()
operator|+
name|QPoint
argument_list|(
literal|8
argument_list|,
literal|8
argument_list|)
decl_stmt|;
name|p
operator|.
name|ry
argument_list|()
operator|+=
literal|50
operator|*
operator|(
name|y
operator|-
literal|1
operator|)
expr_stmt|;
name|p
operator|.
name|rx
argument_list|()
operator|+=
literal|100
operator|*
operator|(
name|x
operator|-
literal|1
operator|)
expr_stmt|;
name|int
name|index
init|=
name|client
operator|->
name|childAt
argument_list|(
name|p
operator|.
name|x
argument_list|()
argument_list|,
name|p
operator|.
name|y
argument_list|()
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|client
operator|->
name|role
argument_list|(
name|index
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Table
argument_list|)
expr_stmt|;
comment|// navigate to table/viewport
name|QAccessibleInterface
modifier|*
name|table
decl_stmt|;
name|client
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|index
argument_list|,
operator|&
name|table
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|index
operator|=
name|table
operator|->
name|childAt
argument_list|(
name|p
operator|.
name|x
argument_list|()
argument_list|,
name|p
operator|.
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|index
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table
operator|->
name|role
argument_list|(
name|index
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Row
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|row
decl_stmt|;
name|QCOMPARE
argument_list|(
name|table
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Row
argument_list|)
expr_stmt|;
comment|// navigate to the row
name|table
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|index
argument_list|,
operator|&
name|row
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|row
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|row
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|RowHeader
argument_list|)
expr_stmt|;
name|index
operator|=
name|row
operator|->
name|childAt
argument_list|(
name|p
operator|.
name|x
argument_list|()
argument_list|,
name|p
operator|.
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|index
operator|>
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|==
literal|1
operator|&&
name|y
operator|==
literal|1
condition|)
block|{
name|QCOMPARE
argument_list|(
name|row
operator|->
name|role
argument_list|(
name|index
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|RowHeader
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|row
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
name|index
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|""
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|x
operator|>
literal|1
operator|&&
name|y
operator|>
literal|1
condition|)
block|{
name|QCOMPARE
argument_list|(
name|row
operator|->
name|role
argument_list|(
name|index
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Cell
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|row
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
name|index
argument_list|)
argument_list|,
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"[%1,%2,0]"
argument_list|)
operator|.
name|arg
argument_list|(
name|y
operator|-
literal|2
argument_list|)
operator|.
name|arg
argument_list|(
name|x
operator|-
literal|2
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|x
operator|==
literal|1
condition|)
block|{
name|QCOMPARE
argument_list|(
name|row
operator|->
name|role
argument_list|(
name|index
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|RowHeader
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|row
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
name|index
argument_list|)
argument_list|,
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"%1"
argument_list|)
operator|.
name|arg
argument_list|(
name|y
operator|-
literal|1
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|y
operator|==
literal|1
condition|)
block|{
name|QCOMPARE
argument_list|(
name|row
operator|->
name|role
argument_list|(
name|index
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|ColumnHeader
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|row
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
name|index
argument_list|)
argument_list|,
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"%1"
argument_list|)
operator|.
name|arg
argument_list|(
name|x
operator|-
literal|1
argument_list|)
argument_list|)
expr_stmt|;
block|}
operator|delete
name|table
expr_stmt|;
operator|delete
name|row
expr_stmt|;
block|}
block|}
operator|delete
name|table2
expr_stmt|;
operator|delete
name|client
expr_stmt|;
operator|delete
name|w
expr_stmt|;
operator|delete
name|model
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|table2ListTest
name|void
name|tst_QAccessibility
operator|::
name|table2ListTest
parameter_list|()
block|{
if|#
directive|if
operator|!
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table2 interface is currently only supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
name|QListWidget
modifier|*
name|listView
init|=
operator|new
name|QListWidget
decl_stmt|;
name|listView
operator|->
name|addItem
argument_list|(
literal|"Oslo"
argument_list|)
expr_stmt|;
name|listView
operator|->
name|addItem
argument_list|(
literal|"Berlin"
argument_list|)
expr_stmt|;
name|listView
operator|->
name|addItem
argument_list|(
literal|"Brisbane"
argument_list|)
expr_stmt|;
name|listView
operator|->
name|resize
argument_list|(
literal|400
argument_list|,
literal|400
argument_list|)
expr_stmt|;
name|listView
operator|->
name|show
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|1
argument_list|)
expr_stmt|;
comment|// Need this for indexOfchild to work.
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|listView
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|iface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
operator|(
name|int
operator|)
name|QAccessible
operator|::
name|List
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child1
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|child1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child1
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Oslo"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child1
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|ListItem
argument_list|)
expr_stmt|;
operator|delete
name|child1
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child2
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|2
argument_list|,
operator|&
name|child2
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child2
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Berlin"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|child2
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child3
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|3
argument_list|,
operator|&
name|child3
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child3
argument_list|)
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child3
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Brisbane"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|child3
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// Check for events
name|QTest
operator|::
name|mouseClick
argument_list|(
name|listView
operator|->
name|viewport
argument_list|()
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|listView
operator|->
name|visualItemRect
argument_list|(
name|listView
operator|->
name|item
argument_list|(
literal|1
argument_list|)
argument_list|)
operator|.
name|center
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|listView
argument_list|,
literal|2
argument_list|,
name|QAccessible
operator|::
name|Selection
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|listView
argument_list|,
literal|2
argument_list|,
name|QAccessible
operator|::
name|Focus
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|mouseClick
argument_list|(
name|listView
operator|->
name|viewport
argument_list|()
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|listView
operator|->
name|visualItemRect
argument_list|(
name|listView
operator|->
name|item
argument_list|(
literal|2
argument_list|)
argument_list|)
operator|.
name|center
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|listView
argument_list|,
literal|3
argument_list|,
name|QAccessible
operator|::
name|Selection
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTestAccessibility
operator|::
name|events
argument_list|()
operator|.
name|contains
argument_list|(
name|QTestAccessibilityEvent
argument_list|(
name|listView
argument_list|,
literal|3
argument_list|,
name|QAccessible
operator|::
name|Focus
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|listView
operator|->
name|addItem
argument_list|(
literal|"Munich"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// table 2
name|QAccessibleTable2Interface
modifier|*
name|table2
init|=
name|iface
operator|->
name|table2Interface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|table2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowCount
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell1
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell1
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Oslo"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell4
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell4
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell4
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Munich"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell4
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|ListItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell4
operator|->
name|rowIndex
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell4
operator|->
name|columnIndex
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|cell4
operator|->
name|isExpandable
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|cell4
expr_stmt|;
operator|delete
name|cell1
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|listView
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|table2TreeTest
name|void
name|tst_QAccessibility
operator|::
name|table2TreeTest
parameter_list|()
block|{
if|#
directive|if
operator|!
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table2 interface is currently only supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
name|QTreeWidget
modifier|*
name|treeView
init|=
operator|new
name|QTreeWidget
decl_stmt|;
name|treeView
operator|->
name|setColumnCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|QTreeWidgetItem
modifier|*
name|header
init|=
operator|new
name|QTreeWidgetItem
decl_stmt|;
name|header
operator|->
name|setText
argument_list|(
literal|0
argument_list|,
literal|"Artist"
argument_list|)
expr_stmt|;
name|header
operator|->
name|setText
argument_list|(
literal|1
argument_list|,
literal|"Work"
argument_list|)
expr_stmt|;
name|treeView
operator|->
name|setHeaderItem
argument_list|(
name|header
argument_list|)
expr_stmt|;
name|QTreeWidgetItem
modifier|*
name|root1
init|=
operator|new
name|QTreeWidgetItem
decl_stmt|;
name|root1
operator|->
name|setText
argument_list|(
literal|0
argument_list|,
literal|"Spain"
argument_list|)
expr_stmt|;
name|treeView
operator|->
name|addTopLevelItem
argument_list|(
name|root1
argument_list|)
expr_stmt|;
name|QTreeWidgetItem
modifier|*
name|item1
init|=
operator|new
name|QTreeWidgetItem
decl_stmt|;
name|item1
operator|->
name|setText
argument_list|(
literal|0
argument_list|,
literal|"Picasso"
argument_list|)
expr_stmt|;
name|item1
operator|->
name|setText
argument_list|(
literal|1
argument_list|,
literal|"Guernica"
argument_list|)
expr_stmt|;
name|root1
operator|->
name|addChild
argument_list|(
name|item1
argument_list|)
expr_stmt|;
name|QTreeWidgetItem
modifier|*
name|item2
init|=
operator|new
name|QTreeWidgetItem
decl_stmt|;
name|item2
operator|->
name|setText
argument_list|(
literal|0
argument_list|,
literal|"Tapies"
argument_list|)
expr_stmt|;
name|item2
operator|->
name|setText
argument_list|(
literal|1
argument_list|,
literal|"Ambrosia"
argument_list|)
expr_stmt|;
name|root1
operator|->
name|addChild
argument_list|(
name|item2
argument_list|)
expr_stmt|;
name|QTreeWidgetItem
modifier|*
name|root2
init|=
operator|new
name|QTreeWidgetItem
decl_stmt|;
name|root2
operator|->
name|setText
argument_list|(
literal|0
argument_list|,
literal|"Austria"
argument_list|)
expr_stmt|;
name|treeView
operator|->
name|addTopLevelItem
argument_list|(
name|root2
argument_list|)
expr_stmt|;
name|QTreeWidgetItem
modifier|*
name|item3
init|=
operator|new
name|QTreeWidgetItem
decl_stmt|;
name|item3
operator|->
name|setText
argument_list|(
literal|0
argument_list|,
literal|"Klimt"
argument_list|)
expr_stmt|;
name|item3
operator|->
name|setText
argument_list|(
literal|1
argument_list|,
literal|"The Kiss"
argument_list|)
expr_stmt|;
name|root2
operator|->
name|addChild
argument_list|(
name|item3
argument_list|)
expr_stmt|;
name|treeView
operator|->
name|resize
argument_list|(
literal|400
argument_list|,
literal|400
argument_list|)
expr_stmt|;
name|treeView
operator|->
name|show
argument_list|()
expr_stmt|;
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|treeView
argument_list|)
decl_stmt|;
name|QEXPECT_FAIL
argument_list|(
literal|""
argument_list|,
literal|"Implement Sibling navigation for table2 cells."
argument_list|,
name|Continue
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|iface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
operator|(
name|int
operator|)
name|QAccessible
operator|::
name|Tree
argument_list|)
expr_stmt|;
comment|// header and 2 rows (the others are not expanded, thus not visible)
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|header1
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|header1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|header1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|header1
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|header1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Artist"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|header1
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|ColumnHeader
argument_list|)
expr_stmt|;
operator|delete
name|header1
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child1
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|3
argument_list|,
operator|&
name|child1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child1
argument_list|)
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Spain"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child1
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|TreeItem
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|child1
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Expanded
operator|)
argument_list|)
expr_stmt|;
operator|delete
name|child1
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child2
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|5
argument_list|,
operator|&
name|child2
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child2
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Austria"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|child2
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// table 2
name|QAccessibleTable2Interface
modifier|*
name|table2
init|=
name|iface
operator|->
name|table2Interface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|table2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell1
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell1
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Spain"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell2
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell2
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Austria"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|TreeItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|rowIndex
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|columnIndex
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|cell2
operator|->
name|isExpandable
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cell2
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|cell2
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Expanded
operator|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnDescription
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Work"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|cell2
expr_stmt|;
operator|delete
name|cell1
expr_stmt|;
name|treeView
operator|->
name|expandAll
argument_list|()
expr_stmt|;
comment|// Need this for indexOfchild to work.
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowCount
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|cell1
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Picasso"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cell1
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|// 1 based + 2 header + 2 for root item
name|cell2
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|4
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Klimt"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|TreeItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|rowIndex
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|columnIndex
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|cell2
operator|->
name|isExpandable
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cell2
argument_list|)
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnDescription
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Artist"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnDescription
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"Work"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|table2TableTest
name|void
name|tst_QAccessibility
operator|::
name|table2TableTest
parameter_list|()
block|{
if|#
directive|if
operator|!
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table2 interface is currently only supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
name|QTableWidget
modifier|*
name|tableView
init|=
operator|new
name|QTableWidget
argument_list|(
literal|3
argument_list|,
literal|3
argument_list|)
decl_stmt|;
name|tableView
operator|->
name|setColumnCount
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|QStringList
name|hHeader
decl_stmt|;
name|hHeader
operator|<<
literal|"h1"
operator|<<
literal|"h2"
operator|<<
literal|"h3"
expr_stmt|;
name|tableView
operator|->
name|setHorizontalHeaderLabels
argument_list|(
name|hHeader
argument_list|)
expr_stmt|;
name|QStringList
name|vHeader
decl_stmt|;
name|vHeader
operator|<<
literal|"v1"
operator|<<
literal|"v2"
operator|<<
literal|"v3"
expr_stmt|;
name|tableView
operator|->
name|setVerticalHeaderLabels
argument_list|(
name|vHeader
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|9
condition|;
operator|++
name|i
control|)
block|{
name|QTableWidgetItem
modifier|*
name|item
init|=
operator|new
name|QTableWidgetItem
decl_stmt|;
name|item
operator|->
name|setText
argument_list|(
name|QString
operator|::
name|number
argument_list|(
name|i
operator|/
literal|3
argument_list|)
operator|+
name|QString
argument_list|(
literal|"."
argument_list|)
operator|+
name|QString
operator|::
name|number
argument_list|(
name|i
operator|%
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|tableView
operator|->
name|setItem
argument_list|(
name|i
operator|/
literal|3
argument_list|,
name|i
operator|%
literal|3
argument_list|,
name|item
argument_list|)
expr_stmt|;
block|}
name|tableView
operator|->
name|resize
argument_list|(
literal|600
argument_list|,
literal|600
argument_list|)
expr_stmt|;
name|tableView
operator|->
name|show
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|1
argument_list|)
expr_stmt|;
comment|// Need this for indexOfchild to work.
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|tableView
argument_list|)
decl_stmt|;
name|QEXPECT_FAIL
argument_list|(
literal|""
argument_list|,
literal|"Implement Sibling navigation for table2 cells."
argument_list|,
name|Continue
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|iface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|iface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
operator|(
name|int
operator|)
name|QAccessible
operator|::
name|Table
argument_list|)
expr_stmt|;
comment|// header and 2 rows (the others are not expanded, thus not visible)
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|9
operator|+
literal|3
operator|+
literal|3
operator|+
literal|1
argument_list|)
expr_stmt|;
comment|// cell+headers+topleft button
name|QAccessibleInterface
modifier|*
name|cornerButton
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|cornerButton
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|cornerButton
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cornerButton
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cornerButton
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Pane
argument_list|)
expr_stmt|;
operator|delete
name|cornerButton
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child1
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|3
argument_list|,
operator|&
name|child1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child1
argument_list|)
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"h2"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child1
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|ColumnHeader
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|child1
operator|->
name|state
argument_list|(
literal|0
argument_list|)
operator|&
name|QAccessible
operator|::
name|Expanded
operator|)
argument_list|)
expr_stmt|;
operator|delete
name|child1
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child2
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|11
argument_list|,
operator|&
name|child2
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|child2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child2
argument_list|)
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"1.1"
argument_list|)
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell2Iface
init|=
cast|static_cast
argument_list|<
name|QAccessibleTable2CellInterface
operator|*
argument_list|>
argument_list|(
name|child2
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|cell2Iface
operator|->
name|rowIndex
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2Iface
operator|->
name|columnIndex
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|delete
name|child2
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|child3
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|12
argument_list|,
operator|&
name|child3
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|child3
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|child3
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"1.2"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|child3
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
comment|// table 2
name|QAccessibleTable2Interface
modifier|*
name|table2
init|=
name|iface
operator|->
name|table2Interface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|table2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowCount
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell1
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell1
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell1
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"0.0"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cell1
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell2
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell2
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"0.1"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Cell
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|rowIndex
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell2
operator|->
name|columnIndex
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cell2
argument_list|)
argument_list|,
literal|7
argument_list|)
expr_stmt|;
operator|delete
name|cell2
expr_stmt|;
name|QAccessibleTable2CellInterface
modifier|*
name|cell3
decl_stmt|;
name|QVERIFY
argument_list|(
name|cell3
operator|=
name|table2
operator|->
name|cellAt
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell3
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"1.2"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell3
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Cell
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell3
operator|->
name|rowIndex
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cell3
operator|->
name|columnIndex
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|iface
operator|->
name|indexOfChild
argument_list|(
name|cell3
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
operator|delete
name|cell3
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnDescription
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"h1"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnDescription
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"h2"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|columnDescription
argument_list|(
literal|2
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"h3"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowDescription
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"v1"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowDescription
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"v2"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|table2
operator|->
name|rowDescription
argument_list|(
literal|2
argument_list|)
argument_list|,
name|QString
argument_list|(
literal|"v3"
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|iface
expr_stmt|;
operator|delete
name|tableView
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|calendarWidgetTest
name|void
name|tst_QAccessibility
operator|::
name|calendarWidgetTest
parameter_list|()
block|{
ifndef|#
directive|ifndef
name|QT_NO_CALENDARWIDGET
block|{
name|QCalendarWidget
name|calendarWidget
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|interface
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|calendarWidget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|interface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Table
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|interface
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childAt
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|calendarWidget
operator|.
name|resize
argument_list|(
literal|400
argument_list|,
literal|300
argument_list|)
expr_stmt|;
name|calendarWidget
operator|.
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|// 1 = navigationBar, 2 = view.
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
specifier|const
name|QRect
name|globalGeometry
init|=
name|QRect
argument_list|(
name|calendarWidget
operator|.
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|,
name|calendarWidget
operator|.
name|size
argument_list|()
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
argument_list|,
name|globalGeometry
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|navigationBar
init|=
literal|0
decl_stmt|;
foreach|foreach
control|(
name|QObject
modifier|*
name|child
decl|,
name|calendarWidget
operator|.
name|children
argument_list|()
control|)
block|{
if|if
condition|(
name|child
operator|->
name|objectName
argument_list|()
operator|==
name|QLatin1String
argument_list|(
literal|"qt_calendar_navigationbar"
argument_list|)
condition|)
block|{
name|navigationBar
operator|=
cast|static_cast
argument_list|<
name|QWidget
operator|*
argument_list|>
argument_list|(
name|child
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|QVERIFY
argument_list|(
name|navigationBar
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|navigationBar
argument_list|,
name|interface
argument_list|,
literal|1
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
name|QAbstractItemView
modifier|*
name|calendarView
init|=
literal|0
decl_stmt|;
foreach|foreach
control|(
name|QObject
modifier|*
name|child
decl|,
name|calendarWidget
operator|.
name|children
argument_list|()
control|)
block|{
if|if
condition|(
name|child
operator|->
name|objectName
argument_list|()
operator|==
name|QLatin1String
argument_list|(
literal|"qt_calendar_calendarview"
argument_list|)
condition|)
block|{
name|calendarView
operator|=
cast|static_cast
argument_list|<
name|QAbstractItemView
operator|*
argument_list|>
argument_list|(
name|child
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|QVERIFY
argument_list|(
name|calendarView
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|calendarView
argument_list|,
name|interface
argument_list|,
literal|2
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
comment|// Hide navigation bar.
name|calendarWidget
operator|.
name|setNavigationBarVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|navigationBar
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|verifyChild
argument_list|(
name|calendarView
argument_list|,
name|interface
argument_list|,
literal|1
argument_list|,
name|globalGeometry
argument_list|)
argument_list|)
expr_stmt|;
comment|// Show navigation bar.
name|calendarWidget
operator|.
name|setNavigationBarVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|childCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|navigationBar
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
comment|// Navigate to the navigation bar via Child.
name|QAccessibleInterface
modifier|*
name|navigationBarInterface
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|navigationBarInterface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|navigationBarInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|navigationBarInterface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|navigationBar
argument_list|)
expr_stmt|;
operator|delete
name|navigationBarInterface
expr_stmt|;
name|navigationBarInterface
operator|=
literal|0
expr_stmt|;
comment|// Navigate to the view via Child.
name|QAccessibleInterface
modifier|*
name|calendarViewInterface
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|2
argument_list|,
operator|&
name|calendarViewInterface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|calendarViewInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|calendarViewInterface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|calendarView
argument_list|)
expr_stmt|;
operator|delete
name|calendarViewInterface
expr_stmt|;
name|calendarViewInterface
operator|=
literal|0
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|doesNotExistsInterface
init|=
literal|0
decl_stmt|;
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|3
argument_list|,
operator|&
name|doesNotExistsInterface
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|doesNotExistsInterface
argument_list|)
expr_stmt|;
comment|// Navigate from navigation bar -> view (Down).
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Down
argument_list|,
literal|1
argument_list|,
operator|&
name|calendarViewInterface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|calendarViewInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|calendarViewInterface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|calendarView
argument_list|)
expr_stmt|;
operator|delete
name|calendarViewInterface
expr_stmt|;
name|calendarViewInterface
operator|=
literal|0
expr_stmt|;
comment|// Navigate from view -> navigation bar (Up).
name|QCOMPARE
argument_list|(
name|interface
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Up
argument_list|,
literal|2
argument_list|,
operator|&
name|navigationBarInterface
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|navigationBarInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|navigationBarInterface
operator|->
name|object
argument_list|()
argument_list|,
operator|(
name|QObject
operator|*
operator|)
name|navigationBar
argument_list|)
expr_stmt|;
operator|delete
name|navigationBarInterface
expr_stmt|;
name|navigationBarInterface
operator|=
literal|0
expr_stmt|;
block|}
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|// QT_NO_CALENDARWIDGET
block|}
end_function
begin_function
DECL|function|dockWidgetTest
name|void
name|tst_QAccessibility
operator|::
name|dockWidgetTest
parameter_list|()
block|{
ifndef|#
directive|ifndef
name|QT_NO_DOCKWIDGET
comment|// Set up a proper main window with two dock widgets
name|QMainWindow
modifier|*
name|mw
init|=
operator|new
name|QMainWindow
argument_list|()
decl_stmt|;
name|QFrame
modifier|*
name|central
init|=
operator|new
name|QFrame
argument_list|(
name|mw
argument_list|)
decl_stmt|;
name|mw
operator|->
name|setCentralWidget
argument_list|(
name|central
argument_list|)
expr_stmt|;
name|QMenuBar
modifier|*
name|mb
init|=
operator|new
name|QMenuBar
argument_list|(
name|mw
argument_list|)
decl_stmt|;
name|mb
operator|->
name|addAction
argument_list|(
name|tr
argument_list|(
literal|"&File"
argument_list|)
argument_list|)
expr_stmt|;
name|mw
operator|->
name|setMenuBar
argument_list|(
name|mb
argument_list|)
expr_stmt|;
name|QDockWidget
modifier|*
name|dock1
init|=
operator|new
name|QDockWidget
argument_list|(
name|mw
argument_list|)
decl_stmt|;
name|mw
operator|->
name|addDockWidget
argument_list|(
name|Qt
operator|::
name|LeftDockWidgetArea
argument_list|,
name|dock1
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|pb1
init|=
operator|new
name|QPushButton
argument_list|(
name|tr
argument_list|(
literal|"Push me"
argument_list|)
argument_list|,
name|dock1
argument_list|)
decl_stmt|;
name|dock1
operator|->
name|setWidget
argument_list|(
name|pb1
argument_list|)
expr_stmt|;
name|QDockWidget
modifier|*
name|dock2
init|=
operator|new
name|QDockWidget
argument_list|(
name|mw
argument_list|)
decl_stmt|;
name|mw
operator|->
name|addDockWidget
argument_list|(
name|Qt
operator|::
name|BottomDockWidgetArea
argument_list|,
name|dock2
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|pb2
init|=
operator|new
name|QPushButton
argument_list|(
name|tr
argument_list|(
literal|"Push me"
argument_list|)
argument_list|,
name|dock2
argument_list|)
decl_stmt|;
name|dock2
operator|->
name|setWidget
argument_list|(
name|pb2
argument_list|)
expr_stmt|;
name|mw
operator|->
name|resize
argument_list|(
literal|600
argument_list|,
literal|400
argument_list|)
expr_stmt|;
name|mw
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|accMainWindow
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|mw
argument_list|)
decl_stmt|;
comment|// 4 children: menu bar, dock1, dock2, and central widget
name|QCOMPARE
argument_list|(
name|accMainWindow
operator|->
name|childCount
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|accDock1
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|1
init|;
name|i
operator|<=
literal|4
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|accMainWindow
operator|->
name|role
argument_list|(
name|i
argument_list|)
operator|==
name|QAccessible
operator|::
name|Window
condition|)
block|{
name|accMainWindow
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|i
argument_list|,
operator|&
name|accDock1
argument_list|)
expr_stmt|;
if|if
condition|(
name|accDock1
operator|&&
name|qobject_cast
argument_list|<
name|QDockWidget
operator|*
argument_list|>
argument_list|(
name|accDock1
operator|->
name|object
argument_list|()
argument_list|)
operator|==
name|dock1
condition|)
block|{
break|break;
block|}
else|else
block|{
operator|delete
name|accDock1
expr_stmt|;
block|}
block|}
block|}
name|QVERIFY
argument_list|(
name|accDock1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accDock1
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Window
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accDock1
operator|->
name|role
argument_list|(
literal|1
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|TitleBar
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|accDock1
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|contains
argument_list|(
name|accDock1
operator|->
name|rect
argument_list|(
literal|1
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QPoint
name|globalPos
init|=
name|dock1
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|globalPos
operator|.
name|rx
argument_list|()
operator|+=
literal|5
expr_stmt|;
comment|//### query style
name|globalPos
operator|.
name|ry
argument_list|()
operator|+=
literal|5
expr_stmt|;
name|int
name|entry
init|=
name|accDock1
operator|->
name|childAt
argument_list|(
name|globalPos
operator|.
name|x
argument_list|()
argument_list|,
name|globalPos
operator|.
name|y
argument_list|()
argument_list|)
decl_stmt|;
comment|//###
name|QAccessibleInterface
modifier|*
name|accTitleBar
decl_stmt|;
name|entry
operator|=
name|accDock1
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
name|entry
argument_list|,
operator|&
name|accTitleBar
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accTitleBar
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|TitleBar
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accDock1
operator|->
name|indexOfChild
argument_list|(
name|accTitleBar
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|acc
decl_stmt|;
name|entry
operator|=
name|accTitleBar
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Ancestor
argument_list|,
literal|1
argument_list|,
operator|&
name|acc
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|acc
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|acc
operator|->
name|role
argument_list|(
literal|0
argument_list|)
argument_list|,
name|QAccessible
operator|::
name|Window
argument_list|)
expr_stmt|;
operator|delete
name|accTitleBar
expr_stmt|;
operator|delete
name|accDock1
expr_stmt|;
operator|delete
name|pb1
expr_stmt|;
operator|delete
name|pb2
expr_stmt|;
operator|delete
name|dock1
expr_stmt|;
operator|delete
name|dock2
expr_stmt|;
operator|delete
name|mw
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|// QT_NO_DOCKWIDGET
block|}
end_function
begin_function
DECL|function|comboBoxTest
name|void
name|tst_QAccessibility
operator|::
name|comboBoxTest
parameter_list|()
block|{
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_WINCE
argument_list|)
if|if
condition|(
operator|!
name|IsValidCEPlatform
argument_list|()
condition|)
block|{
name|QSKIP
argument_list|(
literal|"Test skipped on Windows Mobile test hardware"
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|QComboBox
modifier|*
name|cb
init|=
operator|new
name|QComboBox
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|cb
operator|->
name|addItems
argument_list|(
name|QStringList
argument_list|()
operator|<<
literal|"one"
operator|<<
literal|"two"
operator|<<
literal|"three"
argument_list|)
expr_stmt|;
name|w
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|acc
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|w
argument_list|)
decl_stmt|;
operator|delete
name|acc
expr_stmt|;
name|acc
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|cb
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|1
init|;
name|i
operator|<
name|acc
operator|->
name|childCount
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
name|QTRY_VERIFY
argument_list|(
name|acc
operator|->
name|rect
argument_list|(
literal|0
argument_list|)
operator|.
name|contains
argument_list|(
name|acc
operator|->
name|rect
argument_list|(
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|QCOMPARE
argument_list|(
name|acc
operator|->
name|doAction
argument_list|(
name|QAccessible
operator|::
name|Press
argument_list|,
literal|2
argument_list|)
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|400
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|accList
init|=
literal|0
decl_stmt|;
name|int
name|entry
init|=
name|acc
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|3
argument_list|,
operator|&
name|accList
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|acc2
init|=
literal|0
decl_stmt|;
name|entry
operator|=
name|accList
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Ancestor
argument_list|,
literal|1
argument_list|,
operator|&
name|acc2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|acc
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|acc2
expr_stmt|;
operator|delete
name|accList
expr_stmt|;
operator|delete
name|acc
expr_stmt|;
operator|delete
name|w
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|treeWidgetTest
name|void
name|tst_QAccessibility
operator|::
name|treeWidgetTest
parameter_list|()
block|{
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QSKIP
argument_list|(
literal|"Accessible table1 interface is no longer supported on X11."
argument_list|,
name|SkipAll
argument_list|)
expr_stmt|;
else|#
directive|else
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
decl_stmt|;
name|QTreeWidget
modifier|*
name|tree
init|=
operator|new
name|QTreeWidget
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QHBoxLayout
modifier|*
name|l
init|=
operator|new
name|QHBoxLayout
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|l
operator|->
name|addWidget
argument_list|(
name|tree
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|10
condition|;
operator|++
name|i
control|)
block|{
name|QStringList
name|strings
init|=
name|QStringList
argument_list|()
operator|<<
name|QString
operator|::
name|fromAscii
argument_list|(
literal|"row: %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"column 1"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"column 2"
argument_list|)
decl_stmt|;
name|tree
operator|->
name|addTopLevelItem
argument_list|(
operator|new
name|QTreeWidgetItem
argument_list|(
name|strings
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|w
operator|->
name|show
argument_list|()
expr_stmt|;
comment|//    QTest::qWait(1000);
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QAccessibleInterface
modifier|*
name|acc
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|tree
argument_list|)
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|accViewport
init|=
literal|0
decl_stmt|;
name|int
name|entry
init|=
name|acc
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|accViewport
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|accViewport
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|accTreeItem
init|=
literal|0
decl_stmt|;
name|entry
operator|=
name|accViewport
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Child
argument_list|,
literal|1
argument_list|,
operator|&
name|accTreeItem
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|accTreeItem2
init|=
literal|0
decl_stmt|;
name|entry
operator|=
name|accTreeItem
operator|->
name|navigate
argument_list|(
name|QAccessible
operator|::
name|Sibling
argument_list|,
literal|3
argument_list|,
operator|&
name|accTreeItem2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accTreeItem2
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QLatin1String
argument_list|(
literal|"row: 1"
argument_list|)
argument_list|)
expr_stmt|;
comment|// test selected/focused state
name|QItemSelectionModel
modifier|*
name|selModel
init|=
name|tree
operator|->
name|selectionModel
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|selModel
argument_list|)
expr_stmt|;
name|selModel
operator|->
name|select
argument_list|(
name|QItemSelection
argument_list|(
name|tree
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|,
name|tree
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|,
name|QItemSelectionModel
operator|::
name|Select
argument_list|)
expr_stmt|;
name|selModel
operator|->
name|setCurrentIndex
argument_list|(
name|tree
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QItemSelectionModel
operator|::
name|Current
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|1
init|;
name|i
operator|<
literal|10
condition|;
operator|++
name|i
control|)
block|{
name|QAccessible
operator|::
name|State
name|expected
decl_stmt|;
if|if
condition|(
name|i
operator|<=
literal|5
operator|&&
name|i
operator|>=
literal|2
condition|)
name|expected
operator|=
name|QAccessible
operator|::
name|Selected
expr_stmt|;
if|if
condition|(
name|i
operator|==
literal|3
condition|)
name|expected
operator||=
name|QAccessible
operator|::
name|Focused
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accViewport
operator|->
name|state
argument_list|(
name|i
argument_list|)
operator|&
operator|(
name|QAccessible
operator|::
name|Focused
operator||
name|QAccessible
operator|::
name|Selected
operator|)
argument_list|,
name|expected
argument_list|)
expr_stmt|;
block|}
comment|// Test sanity of its navigation functions
name|QCOMPARE
argument_list|(
name|verifyHierarchy
argument_list|(
name|acc
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|accTreeItem2
expr_stmt|;
operator|delete
name|accTreeItem
expr_stmt|;
operator|delete
name|accViewport
expr_stmt|;
operator|delete
name|acc
expr_stmt|;
operator|delete
name|w
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|labelTest
name|void
name|tst_QAccessibility
operator|::
name|labelTest
parameter_list|()
block|{
name|QString
name|text
init|=
literal|"Hello World"
decl_stmt|;
name|QLabel
modifier|*
name|label
init|=
operator|new
name|QLabel
argument_list|(
name|text
argument_list|)
decl_stmt|;
name|label
operator|->
name|show
argument_list|()
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|acc_label
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|label
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|acc_label
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|acc_label
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|,
literal|0
argument_list|)
argument_list|,
name|text
argument_list|)
expr_stmt|;
operator|delete
name|acc_label
expr_stmt|;
operator|delete
name|label
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
name|QPixmap
name|testPixmap
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
decl_stmt|;
name|testPixmap
operator|.
name|fill
argument_list|()
expr_stmt|;
name|QLabel
name|imageLabel
decl_stmt|;
name|imageLabel
operator|.
name|setPixmap
argument_list|(
name|testPixmap
argument_list|)
expr_stmt|;
name|imageLabel
operator|.
name|setToolTip
argument_list|(
literal|"Test Description"
argument_list|)
expr_stmt|;
name|acc_label
operator|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
operator|&
name|imageLabel
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|acc_label
argument_list|)
expr_stmt|;
name|QAccessibleImageInterface
modifier|*
name|imageInterface
init|=
name|acc_label
operator|->
name|imageInterface
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|imageInterface
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|imageInterface
operator|->
name|imageSize
argument_list|()
argument_list|,
name|testPixmap
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|imageInterface
operator|->
name|imageDescription
argument_list|()
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"Test Description"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|imageInterface
operator|->
name|imagePosition
argument_list|(
name|QAccessible2
operator|::
name|RelativeToParent
argument_list|)
argument_list|,
name|imageLabel
operator|.
name|geometry
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|acc_label
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|accelerators
name|void
name|tst_QAccessibility
operator|::
name|accelerators
parameter_list|()
block|{
name|QWidget
modifier|*
name|window
init|=
operator|new
name|QWidget
decl_stmt|;
name|QHBoxLayout
modifier|*
name|lay
init|=
operator|new
name|QHBoxLayout
argument_list|(
name|window
argument_list|)
decl_stmt|;
name|QLabel
modifier|*
name|label
init|=
operator|new
name|QLabel
argument_list|(
name|tr
argument_list|(
literal|"&Line edit"
argument_list|)
argument_list|,
name|window
argument_list|)
decl_stmt|;
name|QLineEdit
modifier|*
name|le
init|=
operator|new
name|QLineEdit
argument_list|(
name|window
argument_list|)
decl_stmt|;
name|lay
operator|->
name|addWidget
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|lay
operator|->
name|addWidget
argument_list|(
name|le
argument_list|)
expr_stmt|;
name|label
operator|->
name|setBuddy
argument_list|(
name|le
argument_list|)
expr_stmt|;
name|window
operator|->
name|show
argument_list|()
expr_stmt|;
name|QAccessibleInterface
modifier|*
name|accLineEdit
init|=
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|le
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QKeySequence
argument_list|(
name|Qt
operator|::
name|ALT
argument_list|)
operator|.
name|toString
argument_list|(
name|QKeySequence
operator|::
name|NativeText
argument_list|)
operator|+
name|QLatin1String
argument_list|(
literal|"L"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QKeySequence
argument_list|(
name|Qt
operator|::
name|ALT
argument_list|)
operator|.
name|toString
argument_list|(
name|QKeySequence
operator|::
name|NativeText
argument_list|)
operator|+
name|QLatin1String
argument_list|(
literal|"L"
argument_list|)
argument_list|)
expr_stmt|;
name|label
operator|->
name|setText
argument_list|(
name|tr
argument_list|(
literal|"Q&"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|label
operator|->
name|setText
argument_list|(
name|tr
argument_list|(
literal|"Q&&"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|label
operator|->
name|setText
argument_list|(
name|tr
argument_list|(
literal|"Q&& A"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|label
operator|->
name|setText
argument_list|(
name|tr
argument_list|(
literal|"Q&&&A"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QKeySequence
argument_list|(
name|Qt
operator|::
name|ALT
argument_list|)
operator|.
name|toString
argument_list|(
name|QKeySequence
operator|::
name|NativeText
argument_list|)
operator|+
name|QLatin1String
argument_list|(
literal|"A"
argument_list|)
argument_list|)
expr_stmt|;
name|label
operator|->
name|setText
argument_list|(
name|tr
argument_list|(
literal|"Q&&A"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_NO_DEBUG
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|Q_WS_MAC
argument_list|)
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QKeySequence::mnemonic: \"Q&A&B\" contains multiple occurrences of '&'"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|label
operator|->
name|setText
argument_list|(
name|tr
argument_list|(
literal|"Q&A&B"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|accLineEdit
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Accelerator
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QKeySequence
argument_list|(
name|Qt
operator|::
name|ALT
argument_list|)
operator|.
name|toString
argument_list|(
name|QKeySequence
operator|::
name|NativeText
argument_list|)
operator|+
name|QLatin1String
argument_list|(
literal|"A"
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_UNIX
argument_list|)
name|QCoreApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
operator|delete
name|window
expr_stmt|;
name|QTestAccessibility
operator|::
name|clearEvents
argument_list|()
expr_stmt|;
block|}
end_function
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QAccessibility
argument_list|)
end_macro
begin_else
else|#
directive|else
end_else
begin_comment
comment|// Q_OS_WINCE
end_comment
begin_macro
name|QTEST_NOOP_MAIN
end_macro
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// Q_OS_WINCE
end_comment
begin_include
include|#
directive|include
file|"tst_qaccessibility.moc"
end_include
end_unit
