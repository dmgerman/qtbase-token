begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2013 Digia Plc and/or its subsidiary(-ies). ** Contact: http://www.qt-project.org/legal ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and Digia.  For licensing terms and ** conditions see http://qt.digia.com/licensing.  For further information ** use the contact form at http://qt.digia.com/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 as published by the Free Software ** Foundation and appearing in the file LICENSE.LGPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU Lesser General Public License version 2.1 requirements ** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Digia gives you certain additional ** rights.  These rights are described in the Digia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU ** General Public License version 3.0 as published by the Free Software ** Foundation and appearing in the file LICENSE.GPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU General Public License version 3.0 requirements will be ** met: http://www.gnu.org/copyleft/gpl.html. ** ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtGui>
end_include
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<QTest>
end_include
begin_include
include|#
directive|include
file|<QMetaType>
end_include
begin_include
include|#
directive|include
file|<QtWidgets/qgraphicsanchorlayout.h>
end_include
begin_include
include|#
directive|include
file|<private/qgraphicsanchorlayout_p.h>
end_include
begin_define
DECL|macro|TEST_COMPLEX_CASES
define|#
directive|define
name|TEST_COMPLEX_CASES
end_define
begin_comment
comment|//---------------------- AnchorLayout helper class ----------------------------
end_comment
begin_class
DECL|class|TheAnchorLayout
class|class
name|TheAnchorLayout
super|:
specifier|public
name|QGraphicsAnchorLayout
block|{
public|public:
DECL|function|TheAnchorLayout
name|TheAnchorLayout
parameter_list|()
member_init_list|:
name|QGraphicsAnchorLayout
argument_list|()
block|{
name|setContentsMargins
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|setSpacing
argument_list|(
literal|0
argument_list|)
expr_stmt|;
block|}
DECL|function|isValid
name|bool
name|isValid
parameter_list|()
block|{
return|return
operator|!
name|QGraphicsAnchorLayoutPrivate
operator|::
name|get
argument_list|(
name|this
argument_list|)
operator|->
name|hasConflicts
argument_list|()
return|;
block|}
DECL|function|setAnchor
name|void
name|setAnchor
parameter_list|(
name|QGraphicsLayoutItem
modifier|*
name|startItem
parameter_list|,
name|Qt
operator|::
name|AnchorPoint
name|startEdge
parameter_list|,
name|QGraphicsLayoutItem
modifier|*
name|endItem
parameter_list|,
name|Qt
operator|::
name|AnchorPoint
name|endEdge
parameter_list|,
name|qreal
name|value
parameter_list|)
block|{
name|QGraphicsAnchor
modifier|*
name|anchor
init|=
name|addAnchor
argument_list|(
name|startItem
argument_list|,
name|startEdge
argument_list|,
name|endItem
argument_list|,
name|endEdge
argument_list|)
decl_stmt|;
if|if
condition|(
name|anchor
condition|)
name|anchor
operator|->
name|setSpacing
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
DECL|function|indexOf
name|int
name|indexOf
parameter_list|(
specifier|const
name|QGraphicsLayoutItem
modifier|*
name|item
parameter_list|)
specifier|const
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|count
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|itemAt
argument_list|(
name|i
argument_list|)
operator|==
name|item
condition|)
block|{
return|return
name|i
return|;
block|}
block|}
return|return
operator|-
literal|1
return|;
block|}
DECL|function|removeItem
name|void
name|removeItem
parameter_list|(
name|QGraphicsLayoutItem
modifier|*
name|item
parameter_list|)
block|{
name|removeAt
argument_list|(
name|indexOf
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|removeAnchor
name|void
name|removeAnchor
parameter_list|(
name|QGraphicsLayoutItem
modifier|*
name|startItem
parameter_list|,
name|Qt
operator|::
name|AnchorPoint
name|startEdge
parameter_list|,
name|QGraphicsLayoutItem
modifier|*
name|endItem
parameter_list|,
name|Qt
operator|::
name|AnchorPoint
name|endEdge
parameter_list|)
block|{
operator|delete
name|QGraphicsAnchorLayout
operator|::
name|anchor
argument_list|(
name|startItem
argument_list|,
name|startEdge
argument_list|,
name|endItem
argument_list|,
name|endEdge
argument_list|)
expr_stmt|;
block|}
block|}
class|;
end_class
begin_comment
comment|//-----------------------------------------------------------------------------
end_comment
begin_struct
DECL|struct|BasicLayoutTestData
struct|struct
name|BasicLayoutTestData
block|{
DECL|function|BasicLayoutTestData
specifier|inline
name|BasicLayoutTestData
parameter_list|(
name|int
name|index1
parameter_list|,
name|Qt
operator|::
name|AnchorPoint
name|edge1
parameter_list|,
name|int
name|index2
parameter_list|,
name|Qt
operator|::
name|AnchorPoint
name|edge2
parameter_list|,
name|qreal
name|distance
parameter_list|)
member_init_list|:
name|firstIndex
argument_list|(
name|index1
argument_list|)
member_init_list|,
name|firstEdge
argument_list|(
name|edge1
argument_list|)
member_init_list|,
name|secondIndex
argument_list|(
name|index2
argument_list|)
member_init_list|,
name|secondEdge
argument_list|(
name|edge2
argument_list|)
member_init_list|,
name|spacing
argument_list|(
name|distance
argument_list|)
block|{         }
DECL|member|firstIndex
name|int
name|firstIndex
decl_stmt|;
DECL|member|firstEdge
name|Qt
operator|::
name|AnchorPoint
name|firstEdge
decl_stmt|;
DECL|member|secondIndex
name|int
name|secondIndex
decl_stmt|;
DECL|member|secondEdge
name|Qt
operator|::
name|AnchorPoint
name|secondEdge
decl_stmt|;
DECL|member|spacing
name|qreal
name|spacing
decl_stmt|;
block|}
struct|;
end_struct
begin_struct
DECL|struct|AnchorItemSizeHint
struct|struct
name|AnchorItemSizeHint
block|{
DECL|function|AnchorItemSizeHint
specifier|inline
name|AnchorItemSizeHint
parameter_list|(
name|qreal
name|hmin
parameter_list|,
name|qreal
name|hpref
parameter_list|,
name|qreal
name|hmax
parameter_list|,
name|qreal
name|vmin
parameter_list|,
name|qreal
name|vpref
parameter_list|,
name|qreal
name|vmax
parameter_list|)
member_init_list|:
name|hmin
argument_list|(
name|hmin
argument_list|)
member_init_list|,
name|hpref
argument_list|(
name|hpref
argument_list|)
member_init_list|,
name|hmax
argument_list|(
name|hmax
argument_list|)
member_init_list|,
name|vmin
argument_list|(
name|vmin
argument_list|)
member_init_list|,
name|vpref
argument_list|(
name|vpref
argument_list|)
member_init_list|,
name|vmax
argument_list|(
name|vmax
argument_list|)
block|{         }
DECL|member|hmin
DECL|member|hpref
DECL|member|hmax
name|qreal
name|hmin
decl_stmt|,
name|hpref
decl_stmt|,
name|hmax
decl_stmt|;
DECL|member|vmin
DECL|member|vpref
DECL|member|vmax
name|qreal
name|vmin
decl_stmt|,
name|vpref
decl_stmt|,
name|vmax
decl_stmt|;
block|}
struct|;
end_struct
begin_comment
comment|// some test results
end_comment
begin_struct
DECL|struct|BasicLayoutTestResult
struct|struct
name|BasicLayoutTestResult
block|{
DECL|function|BasicLayoutTestResult
specifier|inline
name|BasicLayoutTestResult
parameter_list|(
name|int
name|resultIndex
parameter_list|,
specifier|const
name|QRectF
modifier|&
name|resultRect
parameter_list|)
member_init_list|:
name|index
argument_list|(
name|resultIndex
argument_list|)
member_init_list|,
name|rect
argument_list|(
name|resultRect
argument_list|)
block|{         }
DECL|member|index
name|int
name|index
decl_stmt|;
DECL|member|rect
name|QRectF
name|rect
decl_stmt|;
block|}
struct|;
end_struct
begin_typedef
DECL|typedef|BasicLayoutTestDataList
typedef|typedef
name|QList
argument_list|<
name|BasicLayoutTestData
argument_list|>
name|BasicLayoutTestDataList
typedef|;
end_typedef
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|BasicLayoutTestDataList
argument_list|)
end_macro
begin_typedef
DECL|typedef|BasicLayoutTestResultList
typedef|typedef
name|QList
argument_list|<
name|BasicLayoutTestResult
argument_list|>
name|BasicLayoutTestResultList
typedef|;
end_typedef
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|BasicLayoutTestResultList
argument_list|)
end_macro
begin_typedef
DECL|typedef|AnchorItemSizeHintList
typedef|typedef
name|QList
argument_list|<
name|AnchorItemSizeHint
argument_list|>
name|AnchorItemSizeHintList
typedef|;
end_typedef
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|AnchorItemSizeHintList
argument_list|)
end_macro
begin_comment
comment|//---------------------- Test Widget used on all tests ------------------------
end_comment
begin_class
DECL|class|TestWidget
class|class
name|TestWidget
super|:
specifier|public
name|QGraphicsWidget
block|{
public|public:
DECL|function|TestWidget
specifier|inline
name|TestWidget
parameter_list|(
name|QGraphicsItem
modifier|*
name|parent
init|=
literal|0
parameter_list|,
specifier|const
name|QString
modifier|&
name|name
init|=
name|QString
argument_list|()
parameter_list|)
member_init_list|:
name|QGraphicsWidget
argument_list|(
name|parent
argument_list|)
block|{
name|setContentsMargins
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
operator|.
name|isEmpty
argument_list|()
condition|)
name|setData
argument_list|(
literal|0
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"w%1"
argument_list|)
operator|.
name|arg
argument_list|(
name|quintptr
argument_list|(
name|this
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|setData
argument_list|(
literal|0
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
DECL|function|~TestWidget
name|~
name|TestWidget
parameter_list|()
block|{         }
protected|protected:
name|QSizeF
name|sizeHint
parameter_list|(
name|Qt
operator|::
name|SizeHint
name|which
parameter_list|,
specifier|const
name|QSizeF
modifier|&
name|constraint
init|=
name|QSizeF
argument_list|()
parameter_list|)
specifier|const
function_decl|;
block|}
class|;
end_class
begin_function
DECL|function|sizeHint
name|QSizeF
name|TestWidget
operator|::
name|sizeHint
parameter_list|(
name|Qt
operator|::
name|SizeHint
name|which
parameter_list|,
specifier|const
name|QSizeF
modifier|&
name|constraint
parameter_list|)
specifier|const
block|{
name|Q_UNUSED
argument_list|(
name|constraint
argument_list|)
expr_stmt|;
if|if
condition|(
name|which
operator|==
name|Qt
operator|::
name|MinimumSize
condition|)
block|{
return|return
name|QSizeF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|)
return|;
block|}
if|if
condition|(
name|which
operator|==
name|Qt
operator|::
name|PreferredSize
condition|)
block|{
return|return
name|QSizeF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
return|;
block|}
return|return
name|QSizeF
argument_list|(
literal|500
argument_list|,
literal|500
argument_list|)
return|;
block|}
end_function
begin_comment
comment|//-----------------------------------------------------------------------------
end_comment
begin_comment
comment|//----------------------------- Test class ------------------------------------
end_comment
begin_class
DECL|class|tst_QGraphicsAnchorLayout1
class|class
name|tst_QGraphicsAnchorLayout1
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
private|private
name|slots
private|:
name|void
name|testCount
parameter_list|()
function_decl|;
name|void
name|testRemoveAt
parameter_list|()
function_decl|;
name|void
name|testRemoveItem
parameter_list|()
function_decl|;
name|void
name|testItemAt
parameter_list|()
function_decl|;
name|void
name|testIndexOf
parameter_list|()
function_decl|;
name|void
name|testAddAndRemoveAnchor
parameter_list|()
function_decl|;
name|void
name|testIsValid
parameter_list|()
function_decl|;
name|void
name|testSpecialCases
parameter_list|()
function_decl|;
name|void
name|testBasicLayout_data
parameter_list|()
function_decl|;
name|void
name|testBasicLayout
parameter_list|()
function_decl|;
name|void
name|testNegativeSpacing_data
parameter_list|()
function_decl|;
name|void
name|testNegativeSpacing
parameter_list|()
function_decl|;
name|void
name|testMixedSpacing_data
parameter_list|()
function_decl|;
name|void
name|testMixedSpacing
parameter_list|()
function_decl|;
name|void
name|testMulti_data
parameter_list|()
function_decl|;
name|void
name|testMulti
parameter_list|()
function_decl|;
name|void
name|testCenterAnchors_data
parameter_list|()
function_decl|;
name|void
name|testCenterAnchors
parameter_list|()
function_decl|;
name|void
name|testRemoveCenterAnchor_data
parameter_list|()
function_decl|;
name|void
name|testRemoveCenterAnchor
parameter_list|()
function_decl|;
name|void
name|testSingleSizePolicy_data
parameter_list|()
function_decl|;
name|void
name|testSingleSizePolicy
parameter_list|()
function_decl|;
name|void
name|testDoubleSizePolicy_data
parameter_list|()
function_decl|;
name|void
name|testDoubleSizePolicy
parameter_list|()
function_decl|;
name|void
name|testSizeDistribution_data
parameter_list|()
function_decl|;
name|void
name|testSizeDistribution
parameter_list|()
function_decl|;
name|void
name|testSizeHint
parameter_list|()
function_decl|;
ifdef|#
directive|ifdef
name|TEST_COMPLEX_CASES
name|void
name|testComplexCases_data
parameter_list|()
function_decl|;
name|void
name|testComplexCases
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
class|;
end_class
begin_function
DECL|function|testCount
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testCount
parameter_list|()
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// adding one more anchor for already added widget should not increase the count
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// create one more widget and attach with anchor layout
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testRemoveAt
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testRemoveAt
parameter_list|()
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAt
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAt
argument_list|(
operator|-
literal|55
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAt
argument_list|(
literal|55
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAt
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
operator|delete
name|widget1
expr_stmt|;
operator|delete
name|widget2
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testRemoveItem
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testRemoveItem
parameter_list|()
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeItem
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeItem
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|indexOf
argument_list|(
name|widget1
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|indexOf
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeItem
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeItem
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|count
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
operator|delete
name|widget1
expr_stmt|;
operator|delete
name|widget2
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testItemAt
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testItemAt
parameter_list|()
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget3
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget4
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget3
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|itemAt
argument_list|(
literal|0
argument_list|)
operator|==
name|widget1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAt
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|layout
operator|->
name|itemAt
argument_list|(
literal|0
argument_list|)
operator|==
name|widget2
argument_list|)
expr_stmt|;
operator|delete
name|widget1
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testIndexOf
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testIndexOf
parameter_list|()
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget3
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget4
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|indexOf
argument_list|(
name|widget1
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget3
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|indexOf
argument_list|(
name|widget4
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|layout
operator|->
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|indexOf
argument_list|(
name|layout
operator|->
name|itemAt
argument_list|(
name|i
argument_list|)
argument_list|)
argument_list|,
name|i
argument_list|)
expr_stmt|;
block|}
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|indexOf
argument_list|(
literal|0
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testAddAndRemoveAnchor
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testAddAndRemoveAnchor
parameter_list|()
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget3
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget4
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget5
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget3
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// test setting invalid anchors
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor NULL items"
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor NULL items"
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// test removing invalid anchors
name|layout
operator|->
name|removeAnchor
argument_list|(
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|)
expr_stmt|;
comment|// anchor one horizontal edge with vertical edge. it should not add this widget as a child
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor edges of different orientations"
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// anchor two edges of a widget (to define width / height)
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
comment|// QCOMPARE( layout->count(), 5 );
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// anchor yet new widget properly
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|// remove anchor for widget1. widget1 should be removed from layout since the
comment|// last anchor was removed.
name|layout
operator|->
name|removeAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|widget1
operator|->
name|parentLayoutItem
argument_list|()
argument_list|)
expr_stmt|;
comment|// test that item is not removed from layout if other anchors remain set
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget3
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// remove all the anchors
name|layout
operator|->
name|removeAnchor
argument_list|(
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget3
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget3
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget5
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// set one anchor "another way round" to get full coverage for "removeAnchor"
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|widget1
expr_stmt|;
operator|delete
name|widget2
expr_stmt|;
operator|delete
name|widget3
expr_stmt|;
operator|delete
name|widget4
expr_stmt|;
operator|delete
name|widget5
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testIsValid
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testIsValid
parameter_list|()
block|{
comment|// Empty, valid
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// One widget, valid
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// Overconstrained one widget, invalid
comment|// ### Our understanding is that this case is valid. What happens though,
comment|//     is that the layout minimum and maximum vertical size hints become
comment|//     the same, 10.1. That means its height is fixed.
comment|//     What will "fail" then is the "setGeometry(0, 0, 100, 100)" call,
comment|//     after which the layout geometry will be (0, 0, 100, 10.1).
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// Underconstrained two widgets, valid
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
comment|// Vertically the layout has floating items. Therefore, we have a conflict
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|0.1
argument_list|)
expr_stmt|;
comment|// Horizontally the layout has floating items. Therefore, we have a conflict
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0.1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|0.1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
literal|false
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testSpecialCases
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testSpecialCases
parameter_list|()
block|{
comment|// One widget, setLayout before defining layouts
block|{
if|if
condition|(
name|QLibraryInfo
operator|::
name|isDebugBuild
argument_list|()
condition|)
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsLayout::addChildLayoutItem: QGraphicsWidget \"\""
literal|" in wrong parent; moved to correct parent"
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget1
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|,
literal|98
argument_list|,
literal|98
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|widget1
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// One widget, layout inside layout, layout inside layout inside layout
block|{
if|if
condition|(
name|QLibraryInfo
operator|::
name|isDebugBuild
argument_list|()
condition|)
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsLayout::addChildLayoutItem: QGraphicsWidget \"\""
literal|" in wrong parent; moved to correct parent"
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|TheAnchorLayout
modifier|*
name|layout1
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|TheAnchorLayout
modifier|*
name|layout2
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget2
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|widget2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// remove and add again to improve test coverage.
name|layout
operator|->
name|removeItem
argument_list|(
name|layout1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget1
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
literal|96
argument_list|,
literal|96
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget2
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|3
argument_list|,
literal|3
argument_list|,
literal|94
argument_list|,
literal|94
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// One widget, layout inside layout, setLayout after layout definition
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout1
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget1
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
literal|96
argument_list|,
literal|96
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// One widget, layout inside layout, setLayout after layout definition, widget transferred from
comment|// one layout to another
block|{
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|TheAnchorLayout
modifier|*
name|layout1
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget1
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
comment|// Additional layout + widget to improve coverage.
name|TheAnchorLayout
modifier|*
name|layout0
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|TestWidget
modifier|*
name|widget0
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
comment|// widget0 to layout0
name|layout0
operator|->
name|setAnchor
argument_list|(
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout0
operator|->
name|setAnchor
argument_list|(
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout0
operator|->
name|setAnchor
argument_list|(
name|widget0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout0
operator|->
name|setAnchor
argument_list|(
name|widget0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// layout0 to layout
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// widget1 to layout1
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// layout1 to layout
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|TheAnchorLayout
modifier|*
name|layout2
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
comment|// layout2 to layout
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// transfer widget1 to layout2
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|widget1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget1
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|51
argument_list|,
literal|2
argument_list|,
literal|47
argument_list|,
literal|96
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
comment|// One widget, set first to one layout then to another. Child reparented.
comment|// In addition widget as a direct child of another widget. Child reparented.
block|{
name|QGraphicsWidget
modifier|*
name|widget1
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout1
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|widget1
operator|->
name|setLayout
argument_list|(
name|layout1
argument_list|)
expr_stmt|;
name|TestWidget
modifier|*
name|childWidget
init|=
operator|new
name|TestWidget
argument_list|()
decl_stmt|;
comment|// childWidget to layout1
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout1
operator|->
name|setAnchor
argument_list|(
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget1
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childWidget
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|,
literal|98
argument_list|,
literal|98
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|childWidget
operator|->
name|parentLayoutItem
argument_list|()
operator|==
name|layout1
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget2
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout2
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|widget2
operator|->
name|setLayout
argument_list|(
name|layout2
argument_list|)
expr_stmt|;
comment|// childWidget to layout2
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget3
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
name|QGraphicsWidget
modifier|*
name|widget4
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
comment|// widget4 is a direct child of widget3 (i.e. not in any layout)
name|widget4
operator|->
name|setParentItem
argument_list|(
name|widget3
argument_list|)
expr_stmt|;
comment|// widget4 to layout2
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout2
operator|->
name|setAnchor
argument_list|(
name|widget4
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget2
operator|->
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childWidget
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|,
literal|98
argument_list|,
literal|98
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|childWidget
operator|->
name|parentLayoutItem
argument_list|()
operator|==
name|layout2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget4
operator|->
name|geometry
argument_list|()
argument_list|,
name|QRectF
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|,
literal|98
argument_list|,
literal|98
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|widget4
operator|->
name|parentLayoutItem
argument_list|()
operator|==
name|layout2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|widget4
operator|->
name|parentItem
argument_list|()
operator|==
name|widget2
argument_list|)
expr_stmt|;
operator|delete
name|widget4
expr_stmt|;
operator|delete
name|widget3
expr_stmt|;
operator|delete
name|widget1
expr_stmt|;
operator|delete
name|childWidget
expr_stmt|;
operator|delete
name|widget2
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testBasicLayout_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testBasicLayout_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
comment|// One widget, basic
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|40
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|10
argument_list|,
literal|150
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One, simple"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// One widget, duplicates
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|40
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|200
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One, duplicates"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// One widget, mixed
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|80
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|150
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|150
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|80
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|20
argument_list|,
literal|100
argument_list|,
literal|60
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One, mixed"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets (same layout), different ordering
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|180
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|180
argument_list|,
literal|80
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, orderings"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, duplicate anchors
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|30
argument_list|,
literal|10
argument_list|,
literal|160
argument_list|,
literal|70
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|0
argument_list|,
literal|190
argument_list|,
literal|90
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, duplicates"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, mixed
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|90
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|190
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|190
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|90
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|180
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|80
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, mixed"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 1 horizontal connection, first completely defined
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|30
argument_list|,
literal|10
argument_list|,
literal|160
argument_list|,
literal|70
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 1h connected"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 2 horizontal connections, first completely defined
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
comment|// ### QGAL is not sensible to the argument order in this case
comment|//     To achieve the desired result we must explicitly set a negative
comment|//     spacing.
comment|//<< BasicData(0, Qt::AnchorLeft, 1, Qt::AnchorRight, 100)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|100
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|10
argument_list|,
literal|60
argument_list|,
literal|70
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 2h connected"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 1 vertical connection, first completely defined
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|30
argument_list|,
literal|20
argument_list|,
literal|160
argument_list|,
literal|60
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 1v connected"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 2 vertical connections, first completely defined
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|30
argument_list|,
literal|20
argument_list|,
literal|160
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 2v connected"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 1 horizontal and 1 vertical connection, first completely defined
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|80
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|100
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|80
argument_list|,
literal|10
argument_list|,
literal|40
argument_list|,
literal|70
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 1h+1v connected"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 2 horizontal and 2 vertical connections, first completely defined
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|80
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|100
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|90
argument_list|,
literal|20
argument_list|,
literal|30
argument_list|,
literal|60
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 2h+2v connected"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 2 horizontal and 2 vertical connections, dependent on each other.
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|150
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|90
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|30
argument_list|,
literal|60
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|100
argument_list|,
literal|20
argument_list|,
literal|90
argument_list|,
literal|60
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 2h+2v connected2"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, connected, overlapping
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
comment|//<< BasicData(1, Qt::AnchorLeft, 0, Qt::AnchorRight, 30)
comment|// ### QGAL has different semantics and assumes right edges are always
comment|//     to the left of left edges. Thus we need the minus sign here.
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|40
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|40
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|60
argument_list|,
literal|40
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|40
argument_list|,
literal|20
argument_list|,
literal|150
argument_list|,
literal|70
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, connected overlapping"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testNegativeSpacing_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testNegativeSpacing_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
comment|// One widget, negative spacing
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
comment|/// ### QGAL assumes items are always inside the layout.
comment|//      In this case, the negative spacing would make the item
comment|//      grow beyond the layout edges, which is OK, but gives a
comment|//      different result.
comment|//      Changing the direction of anchors (-1 to 0 or vice-versa)
comment|//      has no effect in this case.
name|theData
comment|//<< BasicData(0, Qt::AnchorTop, -1, Qt::AnchorTop, -10)
comment|//<< BasicData(0, Qt::AnchorLeft, -1, Qt::AnchorLeft, -20)
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorRight, -30)
comment|//<< BasicData(-1, Qt::AnchorBottom, 0, Qt::AnchorBottom, -40)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|40
argument_list|)
expr_stmt|;
name|theResult
comment|//<< BasicResult(0, QRectF(20, 10, 150, 50) )
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
operator|-
literal|20
argument_list|,
operator|-
literal|10
argument_list|,
literal|250
argument_list|,
literal|150
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One, simple (n)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// One widget, duplicates, negative spacing
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|40
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|10
argument_list|)
expr_stmt|;
name|theResult
comment|// ### Same as above...
comment|//<< BasicResult(0, QRectF(10, 10, 180, 80) )
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
operator|-
literal|10
argument_list|,
operator|-
literal|10
argument_list|,
literal|220
argument_list|,
literal|120
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One, duplicates (n)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// One widget, mixed, negative spacing
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|// ### All anchors of negative spacing between the layout and an
comment|//     item are handled as to make sure the item is _outside_ the
comment|//     layout.
comment|//     To keep it inside, one _must_ use positive spacings.
comment|//<< BasicData(0, Qt::AnchorBottom, -1, Qt::AnchorTop, -80)
comment|//<< BasicData(0, Qt::AnchorRight, -1, Qt::AnchorLeft, -150)
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorLeft, -150)
comment|//<< BasicData(-1, Qt::AnchorBottom, 0, Qt::AnchorTop, -80)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|80
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|150
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|150
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|80
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|20
argument_list|,
literal|100
argument_list|,
literal|60
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One, mixed (n)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 1 horizontal connection, first completely defined, negative spacing
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|//<< BasicData(0, Qt::AnchorTop, -1, Qt::AnchorTop, -10)
comment|//<< BasicData(-1, Qt::AnchorBottom, 0, Qt::AnchorBottom, -10)
comment|//<< BasicData(0, Qt::AnchorLeft, -1, Qt::AnchorLeft, -10)
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorRight, -180)
comment|//<< BasicData(1, Qt::AnchorLeft, 0, Qt::AnchorRight, -10)
comment|//<< BasicData(-1, Qt::AnchorRight, 1, Qt::AnchorRight, -10)
comment|//<< BasicData(1, Qt::AnchorTop, -1, Qt::AnchorTop, -10)
comment|//<< BasicData(-1, Qt::AnchorBottom, 1, Qt::AnchorBottom, -20)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|180
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|20
argument_list|)
expr_stmt|;
name|theResult
comment|//<< BasicResult(0, QRectF(10, 10, 10, 80) )
comment|//<< BasicResult(1, QRectF(30, 10, 160, 70) )
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
operator|-
literal|10
argument_list|,
operator|-
literal|10
argument_list|,
literal|30
argument_list|,
literal|120
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
operator|-
literal|10
argument_list|,
literal|200
argument_list|,
literal|130
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 1h connected (n)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic case - two widgets, 2 horizontal and 2 vertical connections, dependent on each other, negative spacing
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|150
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|90
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|20
argument_list|)
expr_stmt|;
name|theResult
comment|//<< BasicResult(0, QRectF(10, 10, 30, 60) )
comment|//<< BasicResult(1, QRectF(100, 20, 90, 60) )
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
operator|-
literal|10
argument_list|,
operator|-
literal|10
argument_list|,
literal|70
argument_list|,
literal|120
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|80
argument_list|,
literal|0
argument_list|,
literal|130
argument_list|,
literal|120
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, 2h+2v connected2 (n)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testMixedSpacing_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testMixedSpacing_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
comment|// Two widgets, partial overlapping
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|15
argument_list|)
comment|//<< BasicData(1, Qt::AnchorTop, 0, Qt::AnchorBottom, 5)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|5
argument_list|)
expr_stmt|;
name|theResult
comment|//<< BasicResult(0, QRectF(50, 10, 45, 40) )
comment|//<< BasicResult(1, QRectF(40, 45, 40, 50) )
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
operator|-
literal|50
argument_list|,
literal|10
argument_list|,
literal|145
argument_list|,
literal|40
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
operator|-
literal|60
argument_list|,
literal|45
argument_list|,
literal|140
argument_list|,
literal|60
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, partial overlap"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two widgets, complete overlapping
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|25
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|10
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|65
argument_list|,
literal|5
argument_list|,
literal|35
argument_list|,
literal|35
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|40
argument_list|,
literal|5
argument_list|,
literal|60
argument_list|,
literal|35
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two, complete overlap"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|90
argument_list|,
literal|45
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Five widgets, v shaped, edges shared
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|// edges shared
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|4
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|4
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|4
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|4
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
comment|// margins
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorRight, 4, Qt::AnchorRight, -5)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|4
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|5
argument_list|)
comment|// additional details for exact size determination easily
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|25
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorRight, 3, Qt::AnchorRight, -25)
comment|//<< BasicData(-1, Qt::AnchorRight, 2, Qt::AnchorRight, -50)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|25
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|50
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorBottom, 3, Qt::AnchorTop, -50)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|3
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|25
argument_list|,
literal|25
argument_list|,
literal|25
argument_list|,
literal|25
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|,
literal|25
argument_list|,
literal|20
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|3
argument_list|,
name|QRectF
argument_list|(
literal|75
argument_list|,
literal|25
argument_list|,
literal|25
argument_list|,
literal|25
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|4
argument_list|,
name|QRectF
argument_list|(
literal|100
argument_list|,
literal|5
argument_list|,
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Five, V shape"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|125
argument_list|,
literal|75
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// ### The behavior is different in QGraphicsAnchorLayout. What happens here is
comment|//     that when the above anchors are set, the layout size hints are changed.
comment|//     In the example, the minimum item width is 5, thus the minimum layout width
comment|//     becomes 105 (50 + 5 + 50). Once that size hint is set, trying to set
comment|//     the widget size to (10, 10) is not possible because
comment|//     QGraphicsWidget::setGeometry() will enforce the minimum is respected.
if|if
condition|(
literal|0
condition|)
comment|// One widget, unsolvable
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"One widget, unsolvable"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two widgets, one has fixed size
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
comment|// not supported, use sizePolicy instead
comment|//<< BasicData(0, Qt::AnchorLeft, 0, Qt::AnchorRight, 50)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|50
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Two widgets, one has fixed size"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|150
argument_list|,
literal|150
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testMulti_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testMulti_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
comment|// Multiple widgets, all overllapping
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
specifier|const
name|int
name|n
init|=
literal|30
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorBottom, i, Qt::AnchorBottom, -40)
comment|//<< BasicData(-1, Qt::AnchorRight, i, Qt::AnchorRight, -30);
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|40
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|30
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
name|i
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|20
argument_list|,
literal|160
argument_list|,
literal|40
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Overlapping multi"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Multiple widgets, linear order
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
specifier|const
name|qreal
name|height
init|=
literal|1000.f
decl_stmt|;
specifier|const
name|qreal
name|width
init|=
literal|2000.f
decl_stmt|;
specifier|const
name|int
name|n
init|=
literal|30
decl_stmt|;
specifier|const
name|qreal
name|verticalStep
init|=
name|height
operator|/
name|qreal
argument_list|(
name|n
operator|+
literal|2
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|horizontalStep
init|=
name|width
operator|/
name|qreal
argument_list|(
name|n
operator|+
literal|2
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|==
literal|0
condition|)
block|{
comment|// First item
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|==
name|n
operator|-
literal|1
condition|)
block|{
comment|// Last item
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
comment|//<< BasicData(-1, Qt::AnchorBottom, i, Qt::AnchorBottom, -verticalStep)
comment|//<< BasicData(-1, Qt::AnchorRight, i, Qt::AnchorRight, -horizontalStep);
block|}
else|else
block|{
comment|// items in the middle
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
name|horizontalStep
argument_list|)
expr_stmt|;
comment|//<< BasicData(i+1, Qt::AnchorBottom, i, Qt::AnchorBottom, -verticalStep)
comment|//<< BasicData(i+1, Qt::AnchorRight, i, Qt::AnchorRight, -horizontalStep);
block|}
name|theResult
operator|<<
name|BasicResult
argument_list|(
name|i
argument_list|,
name|QRectF
argument_list|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|*
name|horizontalStep
argument_list|,
operator|(
name|i
operator|+
literal|1
operator|)
operator|*
name|verticalStep
argument_list|,
name|horizontalStep
argument_list|,
name|verticalStep
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
sizeof|sizeof
argument_list|(
name|qreal
argument_list|)
operator|==
literal|4
condition|)
block|{
name|qDebug
argument_list|(
literal|"Linear multi: Skipping! (qreal has too little precision, result will be wrong)"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Linear multi"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
name|width
argument_list|,
name|height
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
comment|// Multiple widgets, V shape
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
specifier|const
name|qreal
name|height
init|=
literal|100.f
decl_stmt|;
specifier|const
name|qreal
name|width
init|=
literal|200.f
decl_stmt|;
specifier|const
name|int
name|n
init|=
literal|31
decl_stmt|;
comment|// odd number please (3,5,7... )
specifier|const
name|qreal
name|verticalStep
init|=
name|height
operator|/
operator|(
literal|2.f
operator|+
operator|(
name|n
operator|+
literal|1
operator|)
operator|/
literal|2.f
operator|)
decl_stmt|;
specifier|const
name|qreal
name|horizontalStep
init|=
name|width
operator|/
operator|(
name|n
operator|+
literal|2.f
operator|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|==
literal|0
condition|)
block|{
comment|// First item
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|==
name|n
operator|-
literal|1
condition|)
block|{
comment|// Last item
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|==
operator|(
operator|(
name|n
operator|-
literal|1
operator|)
operator|/
literal|2
operator|)
condition|)
block|{
comment|// midway
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorBottom, i, Qt::AnchorBottom, -verticalStep)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|<
operator|(
operator|(
name|n
operator|-
literal|1
operator|)
operator|/
literal|2
operator|)
condition|)
block|{
comment|// before midway - going down
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// after midway - going up
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|<=
operator|(
operator|(
name|n
operator|-
literal|1
operator|)
operator|/
literal|2
operator|)
condition|)
block|{
comment|// until midway
name|theResult
operator|<<
name|BasicResult
argument_list|(
name|i
argument_list|,
name|QRectF
argument_list|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|*
name|horizontalStep
argument_list|,
operator|(
name|i
operator|+
literal|1
operator|)
operator|*
name|verticalStep
argument_list|,
name|horizontalStep
argument_list|,
name|verticalStep
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// after midway
name|theResult
operator|<<
name|BasicResult
argument_list|(
name|i
argument_list|,
name|QRectF
argument_list|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|*
name|horizontalStep
argument_list|,
operator|(
name|n
operator|-
name|i
operator|)
operator|*
name|verticalStep
argument_list|,
name|horizontalStep
argument_list|,
name|verticalStep
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
sizeof|sizeof
argument_list|(
name|qreal
argument_list|)
operator|==
literal|4
condition|)
block|{
name|qDebug
argument_list|(
literal|"V multi: Skipping! (qreal has too little precision, result will be wrong)"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QTest
operator|::
name|newRow
argument_list|(
literal|"V multi"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
name|width
argument_list|,
name|height
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
comment|// Multiple widgets, grid
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
specifier|const
name|qreal
name|height
init|=
literal|100.f
decl_stmt|;
specifier|const
name|qreal
name|width
init|=
literal|200.f
decl_stmt|;
specifier|const
name|int
name|d
init|=
literal|10
decl_stmt|;
comment|// items per dimension
specifier|const
name|int
name|n
init|=
name|d
operator|*
name|d
decl_stmt|;
specifier|const
name|qreal
name|verticalStep
init|=
name|height
operator|/
operator|(
name|d
operator|+
literal|2.f
operator|)
decl_stmt|;
specifier|const
name|qreal
name|horizontalStep
init|=
name|width
operator|/
operator|(
name|d
operator|+
literal|2.f
operator|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|%
name|d
operator|==
literal|0
condition|)
block|{
comment|// left side item
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|%
name|d
operator|==
literal|0
condition|)
block|{
comment|// rigth side item
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorRight, i, Qt::AnchorRight, -horizontalStep);
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// horizontal middle
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|horizontalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
name|horizontalStep
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|<
name|d
condition|)
block|{
comment|// top line
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
name|d
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|>=
operator|(
name|d
operator|-
literal|1
operator|)
operator|*
name|d
condition|)
block|{
comment|// bottom line
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
name|d
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
comment|//<< BasicData(-1, Qt::AnchorBottom, i, Qt::AnchorBottom, -verticalStep)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|verticalStep
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// vertical middle
name|theData
operator|<<
name|BasicData
argument_list|(
name|i
operator|-
name|d
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|verticalStep
argument_list|)
operator|<<
name|BasicData
argument_list|(
name|i
operator|+
name|d
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|i
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
name|verticalStep
argument_list|)
expr_stmt|;
block|}
name|theResult
operator|<<
name|BasicResult
argument_list|(
name|i
argument_list|,
name|QRectF
argument_list|(
operator|(
operator|(
name|i
operator|%
name|d
operator|)
operator|+
literal|1
operator|)
operator|*
name|horizontalStep
argument_list|,
operator|(
operator|(
name|i
operator|/
name|d
operator|)
operator|+
literal|1
operator|)
operator|*
name|verticalStep
argument_list|,
name|horizontalStep
argument_list|,
name|verticalStep
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
sizeof|sizeof
argument_list|(
name|qreal
argument_list|)
operator|==
literal|4
condition|)
block|{
name|qDebug
argument_list|(
literal|"Grid multi: Skipping! (qreal has too little precision, result will be wrong)"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Grid multi"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
block|}
end_function
begin_function
DECL|function|getItem
specifier|inline
name|QGraphicsLayoutItem
modifier|*
name|getItem
parameter_list|(
name|int
name|index
parameter_list|,
specifier|const
name|QList
argument_list|<
name|QGraphicsWidget
modifier|*
argument_list|>
modifier|&
name|widgets
parameter_list|,
name|QGraphicsLayoutItem
modifier|*
name|defaultItem
parameter_list|)
block|{
if|if
condition|(
name|index
operator|<
literal|0
condition|)
block|{
return|return
name|defaultItem
return|;
block|}
return|return
name|widgets
index|[
name|index
index|]
return|;
block|}
end_function
begin_function
DECL|function|fuzzierCompare
specifier|static
name|bool
name|fuzzierCompare
parameter_list|(
name|qreal
name|a
parameter_list|,
name|qreal
name|b
parameter_list|)
block|{
return|return
name|qAbs
argument_list|(
name|a
operator|-
name|b
argument_list|)
operator|<=
name|qreal
argument_list|(
literal|0.0001
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|fuzzierCompare
specifier|static
name|bool
name|fuzzierCompare
parameter_list|(
specifier|const
name|QRectF
modifier|&
name|r1
parameter_list|,
specifier|const
name|QRectF
modifier|&
name|r2
parameter_list|)
block|{
return|return
name|fuzzierCompare
argument_list|(
name|r1
operator|.
name|x
argument_list|()
argument_list|,
name|r2
operator|.
name|x
argument_list|()
argument_list|)
operator|&&
name|fuzzierCompare
argument_list|(
name|r1
operator|.
name|y
argument_list|()
argument_list|,
name|r2
operator|.
name|y
argument_list|()
argument_list|)
operator|&&
name|fuzzierCompare
argument_list|(
name|r1
operator|.
name|width
argument_list|()
argument_list|,
name|r2
operator|.
name|width
argument_list|()
argument_list|)
operator|&&
name|fuzzierCompare
argument_list|(
name|r1
operator|.
name|height
argument_list|()
argument_list|,
name|r2
operator|.
name|height
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|testBasicLayout
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testBasicLayout
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QSizeF
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestDataList
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestResultList
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
comment|// Determine amount of widgets to add.
name|int
name|widgetCount
init|=
operator|-
literal|1
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|data
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|data
index|[
name|i
index|]
decl_stmt|;
name|widgetCount
operator|=
name|qMax
argument_list|(
name|widgetCount
argument_list|,
name|item
operator|.
name|firstIndex
argument_list|)
expr_stmt|;
name|widgetCount
operator|=
name|qMax
argument_list|(
name|widgetCount
argument_list|,
name|item
operator|.
name|secondIndex
argument_list|)
expr_stmt|;
block|}
operator|++
name|widgetCount
expr_stmt|;
comment|// widgetCount is max of indices.
comment|// Create dummy widgets
name|QList
argument_list|<
name|QGraphicsWidget
modifier|*
argument_list|>
name|widgets
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|widgetCount
condition|;
operator|++
name|i
control|)
block|{
name|TestWidget
modifier|*
name|w
init|=
operator|new
name|TestWidget
argument_list|(
literal|0
argument_list|,
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"W%1"
argument_list|)
operator|.
name|arg
argument_list|(
name|i
argument_list|)
argument_list|)
decl_stmt|;
name|widgets
operator|<<
name|w
expr_stmt|;
block|}
comment|// Setup anchor layout
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|data
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|data
index|[
name|i
index|]
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|getItem
argument_list|(
name|item
operator|.
name|firstIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|firstEdge
argument_list|,
name|getItem
argument_list|(
name|item
operator|.
name|secondIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|secondEdge
argument_list|,
name|item
operator|.
name|spacing
argument_list|)
expr_stmt|;
block|}
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setContentsMargins
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|widget
operator|->
name|resize
argument_list|(
name|size
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|->
name|size
argument_list|()
argument_list|,
name|size
argument_list|)
expr_stmt|;
comment|// Validate
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|result
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestResult
name|item
init|=
name|result
index|[
name|i
index|]
decl_stmt|;
name|QRectF
name|expected
init|=
name|item
operator|.
name|rect
decl_stmt|;
name|QRectF
name|actual
init|=
name|widgets
index|[
name|item
operator|.
name|index
index|]
operator|->
name|geometry
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|fuzzierCompare
argument_list|(
name|actual
argument_list|,
name|expected
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|// Test mirrored mode
name|widget
operator|->
name|setLayoutDirection
argument_list|(
name|Qt
operator|::
name|RightToLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|activate
argument_list|()
expr_stmt|;
comment|// Validate
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|result
operator|.
name|count
argument_list|()
condition|;
operator|++
name|j
control|)
block|{
specifier|const
name|BasicLayoutTestResult
name|item
init|=
name|result
index|[
name|j
index|]
decl_stmt|;
name|QRectF
name|mirroredRect
argument_list|(
name|item
operator|.
name|rect
argument_list|)
decl_stmt|;
comment|// only valid cases are mirrored
if|if
condition|(
name|mirroredRect
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|mirroredRect
operator|.
name|moveLeft
argument_list|(
name|size
operator|.
name|width
argument_list|()
operator|-
name|item
operator|.
name|rect
operator|.
name|width
argument_list|()
operator|-
name|item
operator|.
name|rect
operator|.
name|left
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QRectF
name|expected
init|=
name|mirroredRect
decl_stmt|;
name|QRectF
name|actual
init|=
name|widgets
index|[
name|item
operator|.
name|index
index|]
operator|->
name|geometry
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|fuzzierCompare
argument_list|(
name|actual
argument_list|,
name|expected
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|qDeleteAll
argument_list|(
name|widgets
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testNegativeSpacing
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testNegativeSpacing
parameter_list|()
block|{
comment|// use the same frame
name|testBasicLayout
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testMixedSpacing
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testMixedSpacing
parameter_list|()
block|{
comment|// use the same frame
name|testBasicLayout
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testMulti
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testMulti
parameter_list|()
block|{
comment|// use the same frame
name|testBasicLayout
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testCenterAnchors_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testCenterAnchors_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
comment|// Basic center case
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorHorizontalCenter, -10)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, basic"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic center case, with invalid (shouldn't affect on result)
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorHorizontalCenter, -10)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
comment|// bogus definitions
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|666
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|999
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|333
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|222
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|111
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|444
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, basic with invalid"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic center case 2
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|)
comment|// Not supported<< BasicData(0, Qt::AnchorHorizontalCenter, 0, Qt::AnchorRight, 5)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|5
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, basic 2"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Basic center case, overrides
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|40
argument_list|)
comment|// actual data:
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|)
comment|//<< BasicData(0, Qt::AnchorHorizontalCenter, 0, Qt::AnchorRight, 5)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|5
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, overrides"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two nested
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|0
argument_list|,
literal|20
argument_list|,
literal|40
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|,
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, two nested"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|40
argument_list|,
literal|40
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two overlap
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
comment|// theData
comment|//     // horizontal
comment|//<< BasicData(-1, Qt::AnchorLeft, 0, Qt::AnchorLeft, 20)
comment|//<< BasicData(0, Qt::AnchorHorizontalCenter, 1, Qt::AnchorLeft, 0)
comment|//<< BasicData(1, Qt::AnchorHorizontalCenter, 0, Qt::AnchorRight, -5)
comment|//<< BasicData(1, Qt::AnchorRight, -1, Qt::AnchorRight, 10)
comment|//<< BasicData(0, Qt::AnchorHorizontalCenter, 0, Qt::AnchorRight, 10)
comment|//     // vertical is pretty much same as horizontal, just roles swapped
comment|//<< BasicData(-1, Qt::AnchorTop, 1, Qt::AnchorTop, 20)
comment|//<< BasicData(1, Qt::AnchorVerticalCenter, 0, Qt::AnchorTop, 0)
comment|//<< BasicData(0, Qt::AnchorVerticalCenter, 1, Qt::AnchorBottom, -5)
comment|//<< BasicData(0, Qt::AnchorBottom, -1, Qt::AnchorBottom, 10)
comment|//<< BasicData(1, Qt::AnchorVerticalCenter, 1, Qt::AnchorBottom, 10);
name|theData
comment|// horizontal
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|20
argument_list|)
comment|// vertical
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|30
argument_list|,
literal|20
argument_list|,
literal|30
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|30
argument_list|,
literal|20
argument_list|,
literal|30
argument_list|,
literal|20
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, two overlap"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|70
argument_list|,
literal|70
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Three
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|75
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|35
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|30
argument_list|,
literal|10
argument_list|,
literal|20
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|0
argument_list|,
literal|30
argument_list|,
literal|10
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|60
argument_list|,
literal|15
argument_list|,
literal|40
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, three"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two, parent center
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|// vertical is pretty much same as horizontal, just roles swapped
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
operator|-
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
comment|// horizontal
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|,
literal|30
argument_list|,
literal|80
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|,
literal|80
argument_list|,
literal|30
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, parent"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two, parent center 2
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|//<< BasicData(1, Qt::AnchorLeft, -1, Qt::AnchorHorizontalCenter, 15)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|5
argument_list|)
comment|// vertical
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|20
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|30
argument_list|,
literal|10
argument_list|,
literal|15
argument_list|,
literal|10
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|30
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, parent 2"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// Two, parent center 3
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|5
argument_list|)
comment|//<< BasicData(0, Qt::AnchorLeft, 1, Qt::AnchorRight, 100)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|100
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
comment|// vertical
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|55
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
comment|//<< BasicData(0, Qt::AnchorTop, 0, Qt::AnchorBottom, 45)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|45
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|45
argument_list|,
literal|45
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|55
argument_list|,
literal|55
argument_list|,
literal|45
argument_list|,
literal|45
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"center, parent 3"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|theData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testCenterAnchors
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testCenterAnchors
parameter_list|()
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|QTest
operator|::
name|currentDataTag
argument_list|()
argument_list|,
literal|"center, basic with invalid"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor edges of different orientations"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor edges of different orientations"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor edges of different orientations"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|QTest
operator|::
name|currentDataTag
argument_list|()
argument_list|,
literal|"center, three"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
block|}
comment|// use the same frame
name|testBasicLayout
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testRemoveCenterAnchor_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testRemoveCenterAnchor_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"removeData"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestDataList
name|theRemoveData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorHorizontalCenter, -10)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|66
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|99
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|33
argument_list|)
expr_stmt|;
name|theRemoveData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"remove, center, basic"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
operator|<<
name|theData
operator|<<
name|theRemoveData
operator|<<
name|theResult
expr_stmt|;
block|}
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestDataList
name|theRemoveData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|75
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|30
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
comment|// extra:
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|66
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|33
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|55
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|55
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|35
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|theRemoveData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|66
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|33
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|55
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|55
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|0
argument_list|,
literal|30
argument_list|,
literal|10
argument_list|,
literal|20
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|20
argument_list|,
literal|0
argument_list|,
literal|30
argument_list|,
literal|10
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|60
argument_list|,
literal|15
argument_list|,
literal|40
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"remove, center, three"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theRemoveData
operator|<<
name|theResult
expr_stmt|;
block|}
comment|// add edge (item0,edge0,item1,edge1), remove (item1,edge1,item0,edge0)
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|BasicLayoutTestDataList
name|theRemoveData
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
comment|//<< BasicData(-1, Qt::AnchorRight, 0, Qt::AnchorHorizontalCenter, -10)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|15
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|5
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|66
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|99
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|33
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|22
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|theRemoveData
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorVerticalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|5
argument_list|,
literal|5
argument_list|,
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"remove, center, basic 2"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
operator|<<
name|theData
operator|<<
name|theRemoveData
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testRemoveCenterAnchor
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testRemoveCenterAnchor
parameter_list|()
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|QTest
operator|::
name|currentDataTag
argument_list|()
argument_list|,
literal|"remove, center, three"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|QTest
operator|::
name|currentDataTag
argument_list|()
argument_list|,
literal|"remove, center, basic 2"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QGraphicsAnchorLayout::addAnchor(): Cannot anchor the item to itself"
argument_list|)
expr_stmt|;
block|}
name|QFETCH
argument_list|(
name|QSizeF
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestDataList
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestDataList
argument_list|,
name|removeData
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestResultList
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
comment|// Determine amount of widgets to add.
name|int
name|widgetCount
init|=
operator|-
literal|1
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|data
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|data
index|[
name|i
index|]
decl_stmt|;
name|widgetCount
operator|=
name|qMax
argument_list|(
name|widgetCount
argument_list|,
name|item
operator|.
name|firstIndex
argument_list|)
expr_stmt|;
name|widgetCount
operator|=
name|qMax
argument_list|(
name|widgetCount
argument_list|,
name|item
operator|.
name|secondIndex
argument_list|)
expr_stmt|;
block|}
operator|++
name|widgetCount
expr_stmt|;
comment|// widgetCount is max of indices.
comment|// Create dummy widgets
name|QList
argument_list|<
name|QGraphicsWidget
modifier|*
argument_list|>
name|widgets
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|widgetCount
condition|;
operator|++
name|i
control|)
block|{
name|TestWidget
modifier|*
name|w
init|=
operator|new
name|TestWidget
decl_stmt|;
name|widgets
operator|<<
name|w
expr_stmt|;
block|}
comment|// Setup anchor layout
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|data
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|data
index|[
name|i
index|]
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|getItem
argument_list|(
name|item
operator|.
name|firstIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|firstEdge
argument_list|,
name|getItem
argument_list|(
name|item
operator|.
name|secondIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|secondEdge
argument_list|,
name|item
operator|.
name|spacing
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|removeData
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|removeData
index|[
name|i
index|]
decl_stmt|;
name|layout
operator|->
name|removeAnchor
argument_list|(
name|getItem
argument_list|(
name|item
operator|.
name|firstIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|firstEdge
argument_list|,
name|getItem
argument_list|(
name|item
operator|.
name|secondIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|secondEdge
argument_list|)
expr_stmt|;
block|}
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setContentsMargins
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|widget
operator|->
name|resize
argument_list|(
name|size
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|->
name|size
argument_list|()
argument_list|,
name|size
argument_list|)
expr_stmt|;
comment|// Validate
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|result
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestResult
name|item
init|=
name|result
index|[
name|i
index|]
decl_stmt|;
name|QCOMPARE
argument_list|(
name|widgets
index|[
name|item
operator|.
name|index
index|]
operator|->
name|geometry
argument_list|()
argument_list|,
name|item
operator|.
name|rect
argument_list|)
expr_stmt|;
block|}
name|qDeleteAll
argument_list|(
name|widgets
argument_list|)
expr_stmt|;
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testSingleSizePolicy_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testSingleSizePolicy_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizePolicy
argument_list|>
argument_list|(
literal|"policy"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"valid"
argument_list|)
expr_stmt|;
comment|// FIXED
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: fixed ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|70
argument_list|,
literal|70
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
comment|/*     {         QSizePolicy sizePolicy( QSizePolicy::Fixed, QSizePolicy::Fixed );         QTest::newRow("single size policy: fixed too big")<< QSizeF(100, 100)<< sizePolicy<< false;     }      {         QSizePolicy sizePolicy( QSizePolicy::Fixed, QSizePolicy::Fixed );         QTest::newRow("single size policy: fixed too small")<< QSizeF(50, 50)<< sizePolicy<< false;     } */
comment|// MINIMUM
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Minimum
argument_list|,
name|QSizePolicy
operator|::
name|Minimum
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: minimum bigger ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Minimum
argument_list|,
name|QSizePolicy
operator|::
name|Minimum
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: minimum limit ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|70
argument_list|,
literal|70
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
comment|/*     {         QSizePolicy sizePolicy( QSizePolicy::Minimum, QSizePolicy::Minimum );         QTest::newRow("single size policy: minimum too small")<< QSizeF(50, 50)<< sizePolicy<< false;     } */
comment|// MAXIMUM
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Maximum
argument_list|,
name|QSizePolicy
operator|::
name|Maximum
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: maximum small ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Maximum
argument_list|,
name|QSizePolicy
operator|::
name|Maximum
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: maximum limit ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|70
argument_list|,
literal|70
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
comment|/*     {         QSizePolicy sizePolicy( QSizePolicy::Maximum, QSizePolicy::Maximum );         QTest::newRow("single size policy: maximum bigger fail")<< QSizeF(100, 100)<< sizePolicy<< false;     } */
comment|// PREFERRED
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: preferred bigger ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: preferred smaller ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
comment|/*     {         QSizePolicy sizePolicy( QSizePolicy::Preferred, QSizePolicy::Preferred );         QTest::newRow("single size policy: preferred too big")<< QSizeF(700, 700)<< sizePolicy<< false;     }      {         QSizePolicy sizePolicy( QSizePolicy::Preferred, QSizePolicy::Preferred );         QTest::newRow("single size policy: preferred too small")<< QSizeF(21, 21)<< sizePolicy<< false;     } */
comment|// MINIMUMEXPANDING
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|MinimumExpanding
argument_list|,
name|QSizePolicy
operator|::
name|MinimumExpanding
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: min.expanding bigger ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|MinimumExpanding
argument_list|,
name|QSizePolicy
operator|::
name|MinimumExpanding
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: min.expanding limit ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|70
argument_list|,
literal|70
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
comment|/*{         QSizePolicy sizePolicy( QSizePolicy::MinimumExpanding, QSizePolicy::MinimumExpanding );         QTest::newRow("single size policy: min.expanding too small")<< QSizeF(50, 50)<< sizePolicy<< false;     }*/
comment|// EXPANDING
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Expanding
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: expanding bigger ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Expanding
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: expanding smaller ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
comment|// IGNORED
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Ignored
argument_list|,
name|QSizePolicy
operator|::
name|Ignored
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: ignored bigger ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Ignored
argument_list|,
name|QSizePolicy
operator|::
name|Ignored
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"single size policy: ignored smaller ok"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
operator|<<
name|sizePolicy
operator|<<
literal|true
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testSingleSizePolicy
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testSingleSizePolicy
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QSizeF
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QSizePolicy
argument_list|,
name|policy
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|valid
argument_list|)
expr_stmt|;
comment|// create objects
name|QGraphicsWidget
name|widget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
decl_stmt|;
name|TestWidget
modifier|*
name|childWidget
init|=
operator|new
name|TestWidget
decl_stmt|;
comment|// set anchors
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|childWidget
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|widget
operator|.
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
comment|// set test case specific: policy and size
name|childWidget
operator|->
name|setSizePolicy
argument_list|(
name|policy
argument_list|)
expr_stmt|;
name|widget
operator|.
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|,
name|size
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
name|valid
argument_list|)
expr_stmt|;
specifier|const
name|QRectF
name|childRect
init|=
name|childWidget
operator|->
name|geometry
argument_list|()
decl_stmt|;
name|Q_UNUSED
argument_list|(
name|childRect
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testDoubleSizePolicy_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testDoubleSizePolicy_data
parameter_list|()
block|{
comment|// tests only horizontal direction
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizePolicy
argument_list|>
argument_list|(
literal|"policy1"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizePolicy
argument_list|>
argument_list|(
literal|"policy2"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|qreal
argument_list|>
argument_list|(
literal|"width1"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|qreal
argument_list|>
argument_list|(
literal|"width2"
argument_list|)
expr_stmt|;
comment|// layout size always 100x100 and size hints for items are 5<50<500
comment|// gabs: 10-item1-10-item2-10
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|50
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: fixed-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Minimum
argument_list|,
name|QSizePolicy
operator|::
name|Minimum
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|50
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: minimum-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Maximum
argument_list|,
name|QSizePolicy
operator|::
name|Maximum
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|35
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: maximum-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|35
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: preferred-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|MinimumExpanding
argument_list|,
name|QSizePolicy
operator|::
name|MinimumExpanding
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|50
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: min.expanding-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Expanding
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|35
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: expanding-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
comment|// QGAL handling of ignored flag is different
if|if
condition|(
literal|0
condition|)
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Ignored
argument_list|,
name|QSizePolicy
operator|::
name|Ignored
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|35
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: ignored-preferred"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
comment|/*{         QSizePolicy sizePolicy1( QSizePolicy::Fixed, QSizePolicy::Fixed );         QSizePolicy sizePolicy2( QSizePolicy::Fixed, QSizePolicy::Fixed );         const qreal width1 = -1;         const qreal width2 = 100-10-10-10-width1;         QTest::newRow("double size policy: fixed-fixed invalid")<< sizePolicy1<< sizePolicy2<< width1<< width2;     }*/
comment|/*{         QSizePolicy sizePolicy1( QSizePolicy::Minimum, QSizePolicy::Minimum );         QSizePolicy sizePolicy2( QSizePolicy::Fixed, QSizePolicy::Fixed );         const qreal width1 = -1;         const qreal width2 = 100-10-10-10-width1;         QTest::newRow("double size policy: minimum-fixed invalid")<< sizePolicy1<< sizePolicy2<< width1<< width2;     }*/
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Maximum
argument_list|,
name|QSizePolicy
operator|::
name|Maximum
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|20
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: maximum-fixed"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|,
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|20
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: preferred-fixed"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
comment|/*{         QSizePolicy sizePolicy1( QSizePolicy::MinimumExpanding, QSizePolicy::MinimumExpanding );         QSizePolicy sizePolicy2( QSizePolicy::Fixed, QSizePolicy::Fixed );         const qreal width1 = -1;         const qreal width2 = 100-10-10-10-width1;         QTest::newRow("double size policy: min.expanding-fixed invalid")<< sizePolicy1<< sizePolicy2<< width1<< width2;     }*/
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Expanding
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|20
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: expanding-fixed"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|QSizePolicy
name|sizePolicy1
argument_list|(
name|QSizePolicy
operator|::
name|Ignored
argument_list|,
name|QSizePolicy
operator|::
name|Ignored
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sizePolicy2
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
decl_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|20
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"double size policy: ignored-fixed"
argument_list|)
operator|<<
name|sizePolicy1
operator|<<
name|sizePolicy2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testDoubleSizePolicy
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testDoubleSizePolicy
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QSizePolicy
argument_list|,
name|policy1
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QSizePolicy
argument_list|,
name|policy2
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|qreal
argument_list|,
name|width1
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|qreal
argument_list|,
name|width2
argument_list|)
expr_stmt|;
comment|// create objects
name|QGraphicsWidget
name|widget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
decl_stmt|;
name|TestWidget
modifier|*
name|childWidget1
init|=
operator|new
name|TestWidget
decl_stmt|;
name|TestWidget
modifier|*
name|childWidget2
init|=
operator|new
name|TestWidget
decl_stmt|;
comment|// set anchors
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|childWidget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|childWidget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|childWidget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|childWidget2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|widget
operator|.
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
comment|// set test case specific: policy
name|childWidget1
operator|->
name|setSizePolicy
argument_list|(
name|policy1
argument_list|)
expr_stmt|;
name|childWidget2
operator|->
name|setSizePolicy
argument_list|(
name|policy2
argument_list|)
expr_stmt|;
name|widget
operator|.
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
comment|// check results:
if|if
condition|(
name|width1
operator|==
operator|-
literal|1.0f
condition|)
block|{
comment|// invalid
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
literal|false
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// valid
name|QCOMPARE
argument_list|(
name|childWidget1
operator|->
name|geometry
argument_list|()
operator|.
name|width
argument_list|()
argument_list|,
name|width1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childWidget2
operator|->
name|geometry
argument_list|()
operator|.
name|width
argument_list|()
argument_list|,
name|width2
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_typedef
DECL|typedef|SizeHintArray
typedef|typedef
name|QMap
argument_list|<
name|int
argument_list|,
name|qreal
argument_list|>
name|SizeHintArray
typedef|;
end_typedef
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|SizeHintArray
argument_list|)
end_macro
begin_function
DECL|function|testSizeDistribution_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testSizeDistribution_data
parameter_list|()
block|{
comment|// tests only horizontal direction
name|QTest
operator|::
name|addColumn
argument_list|<
name|SizeHintArray
argument_list|>
argument_list|(
literal|"sizeHints1"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|SizeHintArray
argument_list|>
argument_list|(
literal|"sizeHints2"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|qreal
argument_list|>
argument_list|(
literal|"width1"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|qreal
argument_list|>
argument_list|(
literal|"width2"
argument_list|)
expr_stmt|;
comment|// layout size always 100x100 and size policy for items is preferred-preferred
comment|// gabs: 10-item1-10-item2-10
block|{
name|SizeHintArray
name|sizeHints1
decl_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|30
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|35
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|40
argument_list|)
expr_stmt|;
name|SizeHintArray
name|sizeHints2
decl_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|35
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|300
argument_list|)
expr_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|35
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"size distribution: preferred equal"
argument_list|)
operator|<<
name|sizeHints1
operator|<<
name|sizeHints2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|SizeHintArray
name|sizeHints1
decl_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|SizeHintArray
name|sizeHints2
decl_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|100
argument_list|)
expr_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|20
decl_stmt|;
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"size distribution: preferred non-equal"
argument_list|)
operator|<<
name|sizeHints1
operator|<<
name|sizeHints2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|SizeHintArray
name|sizeHints1
decl_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|40
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|SizeHintArray
name|sizeHints2
decl_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|60
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|100
argument_list|)
expr_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|28
decl_stmt|;
comment|// got from manual calculation
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"size distribution: below preferred"
argument_list|)
operator|<<
name|sizeHints1
operator|<<
name|sizeHints2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|{
name|SizeHintArray
name|sizeHints1
decl_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|sizeHints1
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|SizeHintArray
name|sizeHints2
decl_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|,
literal|40
argument_list|)
expr_stmt|;
name|sizeHints2
operator|.
name|insert
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|,
literal|100
argument_list|)
expr_stmt|;
specifier|const
name|qreal
name|width1
init|=
literal|22
decl_stmt|;
comment|// got from manual calculation
specifier|const
name|qreal
name|width2
init|=
literal|100
operator|-
literal|10
operator|-
literal|10
operator|-
literal|10
operator|-
name|width1
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"size distribution: above preferred"
argument_list|)
operator|<<
name|sizeHints1
operator|<<
name|sizeHints2
operator|<<
name|width1
operator|<<
name|width2
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testSizeDistribution
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testSizeDistribution
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|SizeHintArray
argument_list|,
name|sizeHints1
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|SizeHintArray
argument_list|,
name|sizeHints2
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|qreal
argument_list|,
name|width1
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|qreal
argument_list|,
name|width2
argument_list|)
expr_stmt|;
comment|// sanity-check the test data - MinimumSize<= PreferredSize<= MaximumSize
name|QVERIFY
argument_list|(
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|)
operator|<=
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|)
operator|<=
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|)
operator|<=
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|)
operator|<=
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|)
argument_list|)
expr_stmt|;
comment|// create objects
name|QGraphicsWidget
name|widget
decl_stmt|;
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
decl_stmt|;
name|TestWidget
modifier|*
name|childWidget1
init|=
operator|new
name|TestWidget
decl_stmt|;
name|TestWidget
modifier|*
name|childWidget2
init|=
operator|new
name|TestWidget
decl_stmt|;
comment|// set anchors
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|childWidget1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|childWidget1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|childWidget2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|childWidget2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|widget
operator|.
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
comment|// set test case specific: size hints
name|childWidget1
operator|->
name|setMinimumWidth
argument_list|(
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|)
argument_list|)
expr_stmt|;
name|childWidget1
operator|->
name|setPreferredWidth
argument_list|(
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|)
argument_list|)
expr_stmt|;
name|childWidget1
operator|->
name|setMaximumWidth
argument_list|(
name|sizeHints1
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|)
argument_list|)
expr_stmt|;
name|childWidget2
operator|->
name|setMinimumWidth
argument_list|(
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MinimumSize
argument_list|)
argument_list|)
expr_stmt|;
name|childWidget2
operator|->
name|setPreferredWidth
argument_list|(
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|PreferredSize
argument_list|)
argument_list|)
expr_stmt|;
name|childWidget2
operator|->
name|setMaximumWidth
argument_list|(
name|sizeHints2
operator|.
name|value
argument_list|(
name|Qt
operator|::
name|MaximumSize
argument_list|)
argument_list|)
expr_stmt|;
name|widget
operator|.
name|setGeometry
argument_list|(
name|QRectF
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
comment|// check results:
if|if
condition|(
name|width1
operator|==
operator|-
literal|1.0f
condition|)
block|{
comment|// invalid
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|isValid
argument_list|()
argument_list|,
literal|false
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// valid
name|QCOMPARE
argument_list|(
name|float
argument_list|(
name|childWidget1
operator|->
name|geometry
argument_list|()
operator|.
name|width
argument_list|()
argument_list|)
argument_list|,
name|float
argument_list|(
name|width1
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|float
argument_list|(
name|childWidget2
operator|->
name|geometry
argument_list|()
operator|.
name|width
argument_list|()
argument_list|)
argument_list|,
name|float
argument_list|(
name|width2
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testSizeHint
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testSizeHint
parameter_list|()
block|{
name|QGraphicsWidget
modifier|*
name|widget
index|[
literal|5
index|]
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|5
condition|;
name|i
operator|++
control|)
block|{
name|widget
index|[
name|i
index|]
operator|=
operator|new
name|QGraphicsWidget
expr_stmt|;
name|widget
index|[
name|i
index|]
operator|->
name|setMinimumSize
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|widget
index|[
name|i
index|]
operator|->
name|setPreferredSize
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|widget
index|[
name|i
index|]
operator|->
name|setMaximumSize
argument_list|(
literal|40
argument_list|,
literal|40
argument_list|)
expr_stmt|;
block|}
comment|// one, basic
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|minimumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|preferredSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|preferredSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|maximumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
block|}
comment|// one, basic again
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
expr_stmt|;
comment|// layout->setAnchor(layout, Qt::AnchorRight, widget[0], Qt::AnchorRight, -10 );
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|10
argument_list|)
expr_stmt|;
comment|// layout->setAnchor(layout, Qt::AnchorBottom, widget[0], Qt::AnchorBottom, -10 );
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|minimumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|minimumSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|preferredSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|preferredSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|maximumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|maximumSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
block|}
comment|// two, serial
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|minimumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|minimumSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
name|widget
index|[
literal|1
index|]
operator|->
name|minimumWidth
argument_list|()
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|preferredSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|preferredSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
name|widget
index|[
literal|1
index|]
operator|->
name|preferredWidth
argument_list|()
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|maximumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|maximumSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
name|widget
index|[
literal|1
index|]
operator|->
name|maximumWidth
argument_list|()
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
block|}
comment|// two, parallel
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|minimumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|preferredSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|preferredSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|maximumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
block|}
comment|// five, serial
block|{
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
argument_list|()
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorBottom
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|0
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|1
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|2
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|2
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|3
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|3
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|widget
index|[
literal|4
index|]
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|widget
index|[
literal|4
index|]
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
name|layout
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|minimumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|minimumSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
name|widget
index|[
literal|1
index|]
operator|->
name|minimumWidth
argument_list|()
operator|+
name|widget
index|[
literal|2
index|]
operator|->
name|minimumWidth
argument_list|()
operator|+
name|widget
index|[
literal|3
index|]
operator|->
name|minimumWidth
argument_list|()
operator|+
name|widget
index|[
literal|4
index|]
operator|->
name|minimumWidth
argument_list|()
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|preferredSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|preferredSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
name|widget
index|[
literal|1
index|]
operator|->
name|preferredWidth
argument_list|()
operator|+
name|widget
index|[
literal|2
index|]
operator|->
name|preferredWidth
argument_list|()
operator|+
name|widget
index|[
literal|3
index|]
operator|->
name|preferredWidth
argument_list|()
operator|+
name|widget
index|[
literal|4
index|]
operator|->
name|preferredWidth
argument_list|()
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|->
name|maximumSize
argument_list|()
argument_list|,
name|widget
index|[
literal|0
index|]
operator|->
name|maximumSize
argument_list|()
operator|+
name|QSizeF
argument_list|(
name|widget
index|[
literal|1
index|]
operator|->
name|maximumWidth
argument_list|()
operator|+
name|widget
index|[
literal|2
index|]
operator|->
name|maximumWidth
argument_list|()
operator|+
name|widget
index|[
literal|3
index|]
operator|->
name|maximumWidth
argument_list|()
operator|+
name|widget
index|[
literal|4
index|]
operator|->
name|maximumWidth
argument_list|()
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|layout
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|5
condition|;
name|i
operator|++
control|)
block|{
operator|delete
name|widget
index|[
name|i
index|]
expr_stmt|;
block|}
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|TEST_COMPLEX_CASES
end_ifdef
begin_function
DECL|function|testComplexCases_data
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testComplexCases_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSizeF
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestDataList
argument_list|>
argument_list|(
literal|"data"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|AnchorItemSizeHintList
argument_list|>
argument_list|(
literal|"sizehint"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|BasicLayoutTestResultList
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
typedef|typedef
name|BasicLayoutTestData
name|BasicData
typedef|;
typedef|typedef
name|BasicLayoutTestResult
name|BasicResult
typedef|;
comment|// Three widgets, the same sizehint
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|AnchorItemSizeHintList
name|theSizeHint
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult1
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult2
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theSizeHint
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|theResult1
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|0
argument_list|,
literal|30
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|0
argument_list|,
literal|30
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|50
argument_list|,
literal|0
argument_list|,
literal|30
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|theResult2
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|0
argument_list|,
literal|60
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|80
argument_list|,
literal|0
argument_list|,
literal|60
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|80
argument_list|,
literal|0
argument_list|,
literal|60
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Three, the same sizehint(1)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|90
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theSizeHint
operator|<<
name|theResult1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Three, the same sizehint(2)"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|150
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theSizeHint
operator|<<
name|theResult2
expr_stmt|;
block|}
comment|// Three widgets, serial is bigger
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|AnchorItemSizeHintList
name|theSizeHint
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theSizeHint
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|100
argument_list|,
literal|200
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|0
argument_list|,
literal|70
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|90
argument_list|,
literal|0
argument_list|,
literal|35
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|90
argument_list|,
literal|0
argument_list|,
literal|35
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Three, serial is bigger"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|135
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theSizeHint
operator|<<
name|theResult
expr_stmt|;
comment|// theResult
comment|//<< BasicResult(0, QRectF(10, 0, 80, 50) )
comment|//<< BasicResult(1, QRectF(100, 0, 60, 50) )
comment|//<< BasicResult(2, QRectF(100, 0, 60, 50) )
comment|// ;
comment|// QTest::newRow("Three, serial is bigger")<< QSizeF(170, 50)<< theData<< theSizeHint<< theResult;
block|}
comment|// Three widgets, parallel is bigger
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|AnchorItemSizeHintList
name|theSizeHint
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theSizeHint
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|100
argument_list|,
literal|200
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
expr_stmt|;
comment|// ### QGAL uses a different preferred size calculation algorithm.
comment|//     This algorithm was discussed with Jan-Arve and tries to grow
comment|//     items instead of shrinking them.
comment|//     In this case, the preferred size of each item becomes:
comment|//     Item 0: 50
comment|//     Item 1: 100 (grows to avoid shrinking item 2)
comment|//     Item 2: 100
comment|//     Therefore, the preferred size of the parent widget becomes
comment|//     180 == (10 + 50 + 10 + 100 + 10)
comment|//     As we set its size to 150, each widget is shrinked in the same
comment|//     ratio, in order to achieve the width of 150 == (10 + 40 + 10 + 80 + 10)
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|0
argument_list|,
literal|40
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|60
argument_list|,
literal|0
argument_list|,
literal|80
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|60
argument_list|,
literal|0
argument_list|,
literal|80
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Three, parallel is bigger"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|150
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theSizeHint
operator|<<
name|theResult
expr_stmt|;
comment|// #ifdef PREFERRED_IS_AVERAGE
comment|//         theResult
comment|//<< BasicResult(0, QRectF(10, 0, 50, 50) )
comment|//<< BasicResult(1, QRectF(70, 0, 75, 50) )
comment|//<< BasicResult(2, QRectF(70, 0, 75, 50) )
comment|//             ;
comment|//         QTest::newRow("Three, parallel is bigger")<< QSizeF(155, 50)<< theData<< theSizeHint<< theResult;
comment|// #else
comment|//         theResult
comment|//<< BasicResult(0, QRectF(10, 0, 50, 50) )
comment|//<< BasicResult(1, QRectF(70, 0, 66.66666666666666, 50) )
comment|//<< BasicResult(2, QRectF(70, 0, 60.66666666666666, 50) )
comment|//             ;
comment|//         QTest::newRow("Three, parallel is bigger")<< QSizeF(146.66666666666666, 50)<< theData<< theSizeHint<< theResult;
comment|// #endif
block|}
comment|// Three widgets, the same sizehint, one center anchor
block|{
name|BasicLayoutTestDataList
name|theData
decl_stmt|;
name|AnchorItemSizeHintList
name|theSizeHint
decl_stmt|;
name|BasicLayoutTestResultList
name|theResult
decl_stmt|;
name|theData
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorHorizontalCenter
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorLeft
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorRight
argument_list|,
literal|10
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
operator|<<
name|BasicData
argument_list|(
operator|-
literal|1
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AnchorTop
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|theSizeHint
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
operator|<<
name|AnchorItemSizeHint
argument_list|(
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|,
literal|0
argument_list|,
literal|50
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|theResult
operator|<<
name|BasicResult
argument_list|(
literal|0
argument_list|,
name|QRectF
argument_list|(
literal|10
argument_list|,
literal|0
argument_list|,
literal|40
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|1
argument_list|,
name|QRectF
argument_list|(
literal|60
argument_list|,
literal|0
argument_list|,
literal|40
argument_list|,
literal|50
argument_list|)
argument_list|)
operator|<<
name|BasicResult
argument_list|(
literal|2
argument_list|,
name|QRectF
argument_list|(
literal|40
argument_list|,
literal|0
argument_list|,
literal|60
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
empty_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Three, the same sizehint, one center anchor"
argument_list|)
operator|<<
name|QSizeF
argument_list|(
literal|110
argument_list|,
literal|50
argument_list|)
operator|<<
name|theData
operator|<<
name|theSizeHint
operator|<<
name|theResult
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|testComplexCases
name|void
name|tst_QGraphicsAnchorLayout1
operator|::
name|testComplexCases
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QSizeF
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestDataList
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|AnchorItemSizeHintList
argument_list|,
name|sizehint
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|BasicLayoutTestResultList
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QGraphicsWidget
modifier|*
name|widget
init|=
operator|new
name|QGraphicsWidget
decl_stmt|;
comment|// Determine amount of widgets to add.
name|int
name|widgetCount
init|=
operator|-
literal|1
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|data
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|data
index|[
name|i
index|]
decl_stmt|;
name|widgetCount
operator|=
name|qMax
argument_list|(
name|widgetCount
argument_list|,
name|item
operator|.
name|firstIndex
argument_list|)
expr_stmt|;
name|widgetCount
operator|=
name|qMax
argument_list|(
name|widgetCount
argument_list|,
name|item
operator|.
name|secondIndex
argument_list|)
expr_stmt|;
block|}
operator|++
name|widgetCount
expr_stmt|;
comment|// widgetCount is max of indices.
comment|// Create dummy widgets
name|QList
argument_list|<
name|QGraphicsWidget
modifier|*
argument_list|>
name|widgets
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|widgetCount
condition|;
operator|++
name|i
control|)
block|{
name|TestWidget
modifier|*
name|w
init|=
operator|new
name|TestWidget
decl_stmt|;
name|w
operator|->
name|setMinimumWidth
argument_list|(
name|sizehint
index|[
name|i
index|]
operator|.
name|hmin
argument_list|)
expr_stmt|;
name|w
operator|->
name|setPreferredWidth
argument_list|(
name|sizehint
index|[
name|i
index|]
operator|.
name|hpref
argument_list|)
expr_stmt|;
name|w
operator|->
name|setMaximumWidth
argument_list|(
name|sizehint
index|[
name|i
index|]
operator|.
name|hmax
argument_list|)
expr_stmt|;
name|w
operator|->
name|setMinimumHeight
argument_list|(
name|sizehint
index|[
name|i
index|]
operator|.
name|vmin
argument_list|)
expr_stmt|;
name|w
operator|->
name|setPreferredHeight
argument_list|(
name|sizehint
index|[
name|i
index|]
operator|.
name|vpref
argument_list|)
expr_stmt|;
name|w
operator|->
name|setMaximumHeight
argument_list|(
name|sizehint
index|[
name|i
index|]
operator|.
name|vmax
argument_list|)
expr_stmt|;
name|widgets
operator|<<
name|w
expr_stmt|;
block|}
comment|// Setup anchor layout
name|TheAnchorLayout
modifier|*
name|layout
init|=
operator|new
name|TheAnchorLayout
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|data
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestData
name|item
init|=
name|data
index|[
name|i
index|]
decl_stmt|;
name|layout
operator|->
name|setAnchor
argument_list|(
name|getItem
argument_list|(
name|item
operator|.
name|firstIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|firstEdge
argument_list|,
name|getItem
argument_list|(
name|item
operator|.
name|secondIndex
argument_list|,
name|widgets
argument_list|,
name|layout
argument_list|)
argument_list|,
name|item
operator|.
name|secondEdge
argument_list|,
name|item
operator|.
name|spacing
argument_list|)
expr_stmt|;
block|}
name|widget
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setContentsMargins
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|widget
operator|->
name|resize
argument_list|(
name|size
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|->
name|size
argument_list|()
argument_list|,
name|size
argument_list|)
expr_stmt|;
comment|//    QTest::qWait(500); // layouting is asynchronous..
comment|// Validate
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|result
operator|.
name|count
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
specifier|const
name|BasicLayoutTestResult
name|item
init|=
name|result
index|[
name|i
index|]
decl_stmt|;
name|QCOMPARE
argument_list|(
name|widgets
index|[
name|item
operator|.
name|index
index|]
operator|->
name|geometry
argument_list|()
argument_list|,
name|item
operator|.
name|rect
argument_list|)
expr_stmt|;
block|}
comment|// Test mirrored mode
name|widget
operator|->
name|setLayoutDirection
argument_list|(
name|Qt
operator|::
name|RightToLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|activate
argument_list|()
expr_stmt|;
comment|// Validate
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|result
operator|.
name|count
argument_list|()
condition|;
operator|++
name|j
control|)
block|{
specifier|const
name|BasicLayoutTestResult
name|item
init|=
name|result
index|[
name|j
index|]
decl_stmt|;
name|QRectF
name|mirroredRect
argument_list|(
name|item
operator|.
name|rect
argument_list|)
decl_stmt|;
comment|// only valid cases are mirrored
if|if
condition|(
name|mirroredRect
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|mirroredRect
operator|.
name|moveLeft
argument_list|(
name|size
operator|.
name|width
argument_list|()
operator|-
name|item
operator|.
name|rect
operator|.
name|width
argument_list|()
operator|-
name|item
operator|.
name|rect
operator|.
name|left
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QCOMPARE
argument_list|(
name|widgets
index|[
name|item
operator|.
name|index
index|]
operator|->
name|geometry
argument_list|()
argument_list|,
name|mirroredRect
argument_list|)
expr_stmt|;
operator|delete
name|widgets
index|[
name|item
operator|.
name|index
index|]
expr_stmt|;
block|}
operator|delete
name|widget
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|//TEST_COMPLEX_CASES
end_comment
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QGraphicsAnchorLayout1
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qgraphicsanchorlayout1.moc"
end_include
begin_comment
comment|//-----------------------------------------------------------------------------
end_comment
end_unit
