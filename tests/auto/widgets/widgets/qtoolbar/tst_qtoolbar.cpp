begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2013 Digia Plc and/or its subsidiary(-ies). ** Contact: http://www.qt-project.org/legal ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and Digia.  For licensing terms and ** conditions see http://qt.digia.com/licensing.  For further information ** use the contact form at http://qt.digia.com/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 as published by the Free Software ** Foundation and appearing in the file LICENSE.LGPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU Lesser General Public License version 2.1 requirements ** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Digia gives you certain additional ** rights.  These rights are described in the Digia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU ** General Public License version 3.0 as published by the Free Software ** Foundation and appearing in the file LICENSE.GPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU General Public License version 3.0 requirements will be ** met: http://www.gnu.org/copyleft/gpl.html. ** ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<qabstractbutton.h>
end_include
begin_include
include|#
directive|include
file|<qaction.h>
end_include
begin_include
include|#
directive|include
file|<qlayout.h>
end_include
begin_include
include|#
directive|include
file|<qmainwindow.h>
end_include
begin_include
include|#
directive|include
file|<qpixmap.h>
end_include
begin_include
include|#
directive|include
file|<qstyle.h>
end_include
begin_include
include|#
directive|include
file|<qtoolbar.h>
end_include
begin_include
include|#
directive|include
file|<qwidgetaction.h>
end_include
begin_include
include|#
directive|include
file|<qtoolbutton.h>
end_include
begin_include
include|#
directive|include
file|<qlineedit.h>
end_include
begin_include
include|#
directive|include
file|<qkeysequence.h>
end_include
begin_include
include|#
directive|include
file|<qmenu.h>
end_include
begin_include
include|#
directive|include
file|<private/qtoolbarextension_p.h>
end_include
begin_macro
name|QT_FORWARD_DECLARE_CLASS
argument_list|(
argument|QAction
argument_list|)
end_macro
begin_class
DECL|class|tst_QToolBar
class|class
name|tst_QToolBar
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
public|public:
name|tst_QToolBar
parameter_list|()
constructor_decl|;
public|public
name|slots
public|:
name|void
name|slot
parameter_list|()
function_decl|;
name|void
name|slot
parameter_list|(
name|QAction
modifier|*
name|action
parameter_list|)
function_decl|;
private|private
name|slots
private|:
name|void
name|isMovable
parameter_list|()
function_decl|;
name|void
name|allowedAreas
parameter_list|()
function_decl|;
name|void
name|orientation
parameter_list|()
function_decl|;
name|void
name|addAction
parameter_list|()
function_decl|;
name|void
name|insertAction
parameter_list|()
function_decl|;
name|void
name|addSeparator
parameter_list|()
function_decl|;
name|void
name|insertSeparator
parameter_list|()
function_decl|;
name|void
name|addWidget
parameter_list|()
function_decl|;
name|void
name|insertWidget
parameter_list|()
function_decl|;
name|void
name|actionGeometry
parameter_list|()
function_decl|;
name|void
name|toggleViewAction
parameter_list|()
function_decl|;
name|void
name|iconSize
parameter_list|()
function_decl|;
name|void
name|toolButtonStyle
parameter_list|()
function_decl|;
name|void
name|actionTriggered
parameter_list|()
function_decl|;
name|void
name|visibilityChanged
parameter_list|()
function_decl|;
name|void
name|actionOwnership
parameter_list|()
function_decl|;
name|void
name|widgetAction
parameter_list|()
function_decl|;
name|void
name|accel
parameter_list|()
function_decl|;
name|void
name|task191727_layout
parameter_list|()
function_decl|;
name|void
name|task197996_visibility
parameter_list|()
function_decl|;
block|}
class|;
end_class
begin_decl_stmt
DECL|variable|triggered
name|QAction
modifier|*
name|triggered
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_constructor
DECL|function|tst_QToolBar
name|tst_QToolBar
operator|::
name|tst_QToolBar
parameter_list|()
block|{
name|qRegisterMetaType
argument_list|<
name|Qt
operator|::
name|Orientation
argument_list|>
argument_list|(
literal|"Qt::Orientation"
argument_list|)
expr_stmt|;
name|qRegisterMetaType
argument_list|<
name|Qt
operator|::
name|ToolBarAreas
argument_list|>
argument_list|(
literal|"Qt::ToolBarAreas"
argument_list|)
expr_stmt|;
name|qRegisterMetaType
argument_list|<
name|Qt
operator|::
name|ToolButtonStyle
argument_list|>
argument_list|(
literal|"Qt::ToolButtonStyle"
argument_list|)
expr_stmt|;
block|}
end_constructor
begin_function
DECL|function|slot
name|void
name|tst_QToolBar
operator|::
name|slot
parameter_list|()
block|{ }
end_function
begin_function
DECL|function|slot
name|void
name|tst_QToolBar
operator|::
name|slot
parameter_list|(
name|QAction
modifier|*
name|action
parameter_list|)
block|{
operator|::
name|triggered
operator|=
name|action
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isMovable
name|void
name|tst_QToolBar
operator|::
name|isMovable
parameter_list|()
block|{
DECL|macro|DO_TEST
define|#
directive|define
name|DO_TEST
define|\
value|do {                                                        \         QVERIFY(tb.isMovable());                                 \         tb.setMovable(false);                                   \         QVERIFY(!tb.isMovable());                                \         QCOMPARE(spy.count(), 1);                                \         QCOMPARE(spy.at(0).value(0).toBool(), tb.isMovable());   \         spy.clear();                                            \         tb.setMovable(tb.isMovable());                          \         QCOMPARE(spy.count(), 0);                                \         spy.clear();                                            \         tb.setMovable(true);                                    \         QVERIFY(tb.isMovable());                                 \         QCOMPARE(spy.count(), 1);                                \         QCOMPARE(spy.at(0).value(0).toBool(), tb.isMovable());   \         spy.clear();                                            \         tb.setMovable(tb.isMovable());                          \         QCOMPARE(spy.count(), 0);                                \         spy.clear();                                            \     } while (false)
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
name|tb
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|isMovable
argument_list|()
argument_list|,
operator|(
name|bool
operator|)
name|qApp
operator|->
name|style
argument_list|()
operator|->
name|styleHint
argument_list|(
name|QStyle
operator|::
name|SH_ToolBar_Movable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|tb
operator|.
name|isMovable
argument_list|()
condition|)
name|tb
operator|.
name|setMovable
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|movableChanged
argument_list|(
name|bool
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|DO_TEST
expr_stmt|;
name|mw
operator|.
name|addToolBar
argument_list|(
operator|&
name|tb
argument_list|)
expr_stmt|;
name|DO_TEST
expr_stmt|;
name|mw
operator|.
name|removeToolBar
argument_list|(
operator|&
name|tb
argument_list|)
expr_stmt|;
name|DO_TEST
expr_stmt|;
block|}
end_function
begin_function
DECL|function|allowedAreas
name|void
name|tst_QToolBar
operator|::
name|allowedAreas
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|allowedAreasChanged
argument_list|(
name|Qt
operator|::
name|ToolBarAreas
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
comment|// default
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
operator|(
name|int
operator|)
name|Qt
operator|::
name|AllToolBarAreas
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
comment|// a single dock window area
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
operator|(
name|int
operator|)
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
operator|(
name|int
operator|)
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
operator|(
name|int
operator|)
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|(
name|int
operator|)
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
operator|(
name|int
operator|)
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// multiple dock window areas
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
operator||
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
name|Qt
operator|::
name|TopToolBarArea
operator||
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
operator||
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
name|Qt
operator|::
name|LeftToolBarArea
operator||
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
operator||
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
name|Qt
operator|::
name|TopToolBarArea
operator||
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
operator||
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|,
name|Qt
operator|::
name|BottomToolBarArea
operator||
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|LeftToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|RightToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|TopToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isAreaAllowed
argument_list|(
name|Qt
operator|::
name|BottomToolBarArea
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|ToolBarAreas
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setAllowedAreas
argument_list|(
name|tb
operator|.
name|allowedAreas
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|orientation
name|void
name|tst_QToolBar
operator|::
name|orientation
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|orientationChanged
argument_list|(
name|Qt
operator|::
name|Orientation
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|,
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|Orientation
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|Orientation
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|,
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|Orientation
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|Orientation
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|,
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
cast|static_cast
argument_list|<
specifier|const
name|Qt
operator|::
name|Orientation
operator|*
argument_list|>
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|value
argument_list|(
literal|0
argument_list|)
operator|.
name|constData
argument_list|()
argument_list|)
argument_list|,
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setOrientation
argument_list|(
name|tb
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|addAction
name|void
name|tst_QToolBar
operator|::
name|addAction
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
block|{
name|QAction
name|action
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|{
name|QString
name|text
init|=
literal|"text"
decl_stmt|;
name|QPixmap
name|pm
argument_list|(
literal|32
argument_list|,
literal|32
argument_list|)
decl_stmt|;
name|pm
operator|.
name|fill
argument_list|(
name|Qt
operator|::
name|blue
argument_list|)
expr_stmt|;
name|QIcon
name|icon
init|=
name|pm
decl_stmt|;
name|QAction
modifier|*
name|action1
init|=
name|tb
operator|.
name|addAction
argument_list|(
name|text
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|text
argument_list|,
name|action1
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|action2
init|=
name|tb
operator|.
name|addAction
argument_list|(
name|icon
argument_list|,
name|text
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|icon
argument_list|,
name|action2
operator|->
name|icon
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|text
argument_list|,
name|action2
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|action3
init|=
name|tb
operator|.
name|addAction
argument_list|(
name|text
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|slot
argument_list|()
argument_list|)
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|text
argument_list|,
name|action3
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|action4
init|=
name|tb
operator|.
name|addAction
argument_list|(
name|icon
argument_list|,
name|text
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|slot
argument_list|()
argument_list|)
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|icon
argument_list|,
name|action4
operator|->
name|icon
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|text
argument_list|,
name|action4
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|action2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
name|action3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|3
index|]
argument_list|,
name|action4
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|insertAction
name|void
name|tst_QToolBar
operator|::
name|insertAction
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action3
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action4
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|insertAction
argument_list|(
literal|0
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|tb
operator|.
name|insertAction
argument_list|(
operator|&
name|action1
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|insertAction
argument_list|(
operator|&
name|action2
argument_list|,
operator|&
name|action3
argument_list|)
expr_stmt|;
name|tb
operator|.
name|insertAction
argument_list|(
operator|&
name|action3
argument_list|,
operator|&
name|action4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
operator|&
name|action3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|3
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|addSeparator
name|void
name|tst_QToolBar
operator|::
name|addSeparator
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|sep
init|=
name|tb
operator|.
name|addSeparator
argument_list|()
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|sep
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|insertSeparator
name|void
name|tst_QToolBar
operator|::
name|insertSeparator
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|sep
init|=
name|tb
operator|.
name|insertSeparator
argument_list|(
operator|&
name|action2
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|sep
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|addWidget
name|void
name|tst_QToolBar
operator|::
name|addWidget
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QWidget
name|w
argument_list|(
operator|&
name|tb
argument_list|)
decl_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|widget
init|=
name|tb
operator|.
name|addWidget
argument_list|(
operator|&
name|w
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
comment|// it should be possible to reuse the action returned by
comment|// addWidget() to place the widget somewhere else in the toolbar
name|tb
operator|.
name|removeAction
argument_list|(
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
name|widget
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|insertWidget
name|void
name|tst_QToolBar
operator|::
name|insertWidget
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QWidget
name|w
argument_list|(
operator|&
name|tb
argument_list|)
decl_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|widget
init|=
name|tb
operator|.
name|insertWidget
argument_list|(
operator|&
name|action2
argument_list|,
operator|&
name|w
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
comment|// it should be possible to reuse the action returned by
comment|// addWidget() to place the widget somewhere else in the toolbar
name|tb
operator|.
name|removeAction
argument_list|(
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|insertAction
argument_list|(
operator|&
name|action1
argument_list|,
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|widget
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|1
index|]
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
index|[
literal|2
index|]
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actions
argument_list|()
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QPointer
argument_list|<
name|QWidget
argument_list|>
name|widget
init|=
operator|new
name|QWidget
decl_stmt|;
name|QAction
modifier|*
name|action
init|=
name|tb
operator|.
name|addWidget
argument_list|(
name|widget
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
operator|&
name|tb
argument_list|)
expr_stmt|;
name|QToolBar
name|tb2
decl_stmt|;
name|tb
operator|.
name|removeAction
argument_list|(
name|action
argument_list|)
expr_stmt|;
name|tb2
operator|.
name|addAction
argument_list|(
name|action
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|widget
operator|&&
name|widget
operator|->
name|parent
argument_list|()
operator|==
operator|&
name|tb2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
operator|&
name|tb2
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|actionGeometry
name|void
name|tst_QToolBar
operator|::
name|actionGeometry
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action3
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action4
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action3
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action4
argument_list|)
expr_stmt|;
name|tb
operator|.
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTest
operator|::
name|qWaitForWindowExposed
argument_list|(
operator|&
name|tb
argument_list|)
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|QToolBarExtension
modifier|*
argument_list|>
name|extensions
init|=
name|tb
operator|.
name|findChildren
argument_list|<
name|QToolBarExtension
operator|*
argument_list|>
argument_list|()
decl_stmt|;
name|QRect
name|rect01
decl_stmt|;
name|QRect
name|rect02
decl_stmt|;
name|QRect
name|rect03
decl_stmt|;
name|QRect
name|rect04
decl_stmt|;
name|QMenu
modifier|*
name|popupMenu
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|extensions
operator|.
name|size
argument_list|()
operator|!=
literal|0
condition|)
block|{
name|QToolBarExtension
modifier|*
name|extension
init|=
name|extensions
operator|.
name|at
argument_list|(
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|extension
operator|->
name|isVisible
argument_list|()
condition|)
block|{
name|QRect
name|rect0
init|=
name|extension
operator|->
name|geometry
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|mouseClick
argument_list|(
name|extension
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|rect0
operator|.
name|center
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|popupMenu
operator|=
name|qobject_cast
argument_list|<
name|QMenu
operator|*
argument_list|>
argument_list|(
name|extension
operator|->
name|menu
argument_list|()
argument_list|)
expr_stmt|;
name|rect01
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|rect02
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|rect03
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action3
argument_list|)
expr_stmt|;
name|rect04
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action4
argument_list|)
expr_stmt|;
block|}
block|}
name|QRect
name|rect1
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action1
argument_list|)
decl_stmt|;
name|QRect
name|rect2
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action2
argument_list|)
decl_stmt|;
name|QRect
name|rect3
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action3
argument_list|)
decl_stmt|;
name|QRect
name|rect4
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action4
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|rect1
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect1
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect1
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|rect2
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect2
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect2
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|rect3
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect3
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect3
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|rect4
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect4
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|rect4
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|rect01
operator|.
name|isValid
argument_list|()
condition|)
name|QCOMPARE
argument_list|(
name|popupMenu
operator|->
name|actionAt
argument_list|(
name|rect01
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
else|else
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actionAt
argument_list|(
name|rect1
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
if|if
condition|(
name|rect02
operator|.
name|isValid
argument_list|()
condition|)
name|QCOMPARE
argument_list|(
name|popupMenu
operator|->
name|actionAt
argument_list|(
name|rect02
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
else|else
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actionAt
argument_list|(
name|rect2
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rect03
operator|.
name|isValid
argument_list|()
condition|)
name|QCOMPARE
argument_list|(
name|popupMenu
operator|->
name|actionAt
argument_list|(
name|rect03
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action3
argument_list|)
expr_stmt|;
else|else
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actionAt
argument_list|(
name|rect3
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action3
argument_list|)
expr_stmt|;
if|if
condition|(
name|rect04
operator|.
name|isValid
argument_list|()
condition|)
name|QCOMPARE
argument_list|(
name|popupMenu
operator|->
name|actionAt
argument_list|(
name|rect04
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action4
argument_list|)
expr_stmt|;
else|else
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|actionAt
argument_list|(
name|rect4
operator|.
name|center
argument_list|()
argument_list|)
argument_list|,
operator|&
name|action4
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toggleViewAction
name|void
name|tst_QToolBar
operator|::
name|toggleViewAction
parameter_list|()
block|{
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QAction
modifier|*
name|toggleViewAction
init|=
name|tb
operator|.
name|toggleViewAction
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
name|toggleViewAction
operator|->
name|trigger
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
name|toggleViewAction
operator|->
name|trigger
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
name|tb
argument_list|(
operator|&
name|mw
argument_list|)
decl_stmt|;
name|mw
operator|.
name|addToolBar
argument_list|(
operator|&
name|tb
argument_list|)
expr_stmt|;
name|mw
operator|.
name|show
argument_list|()
expr_stmt|;
name|QAction
modifier|*
name|toggleViewAction
init|=
name|tb
operator|.
name|toggleViewAction
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
name|toggleViewAction
operator|->
name|trigger
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
name|toggleViewAction
operator|->
name|trigger
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
name|toggleViewAction
operator|->
name|trigger
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|tb
operator|.
name|isHidden
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|iconSize
name|void
name|tst_QToolBar
operator|::
name|iconSize
parameter_list|()
block|{
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|iconSizeChanged
argument_list|(
name|QSize
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
comment|// the default is determined by the style
specifier|const
name|int
name|metric
init|=
name|tb
operator|.
name|style
argument_list|()
operator|->
name|pixelMetric
argument_list|(
name|QStyle
operator|::
name|PM_ToolBarIconSize
argument_list|)
decl_stmt|;
specifier|const
name|QSize
name|defaultIconSize
init|=
name|QSize
argument_list|(
name|metric
argument_list|,
name|metric
argument_list|)
decl_stmt|;
specifier|const
name|QSize
name|smallIconSize
init|=
name|QSize
argument_list|(
name|metric
operator|/
literal|2
argument_list|,
name|metric
operator|/
literal|2
argument_list|)
decl_stmt|;
specifier|const
name|QSize
name|largeIconSize
init|=
name|QSize
argument_list|(
name|metric
operator|*
literal|2
argument_list|,
name|metric
operator|*
literal|2
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|largeIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|largeIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|first
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|toSize
argument_list|()
argument_list|,
name|largeIconSize
argument_list|)
expr_stmt|;
comment|// no-op
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|largeIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|largeIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|first
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|toSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
comment|// no-op
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|smallIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|smallIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|first
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|toSize
argument_list|()
argument_list|,
name|smallIconSize
argument_list|)
expr_stmt|;
comment|// no-op
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|setIconSize
argument_list|(
name|smallIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|smallIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// setting the icon size to an invalid QSize will reset the
comment|// iconSize property to the default
name|tb
operator|.
name|setIconSize
argument_list|(
name|QSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|first
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|toSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
block|}
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
name|tb
decl_stmt|;
name|QSignalSpy
name|mwSpy
argument_list|(
operator|&
name|mw
argument_list|,
name|SIGNAL
argument_list|(
name|iconSizeChanged
argument_list|(
name|QSize
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|tbSpy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|iconSizeChanged
argument_list|(
name|QSize
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
comment|// the default is determined by the style
specifier|const
name|int
name|metric
init|=
name|tb
operator|.
name|style
argument_list|()
operator|->
name|pixelMetric
argument_list|(
name|QStyle
operator|::
name|PM_ToolBarIconSize
argument_list|)
decl_stmt|;
specifier|const
name|QSize
name|defaultIconSize
init|=
name|QSize
argument_list|(
name|metric
argument_list|,
name|metric
argument_list|)
decl_stmt|;
specifier|const
name|QSize
name|smallIconSize
init|=
name|QSize
argument_list|(
name|metric
operator|/
literal|2
argument_list|,
name|metric
operator|/
literal|2
argument_list|)
decl_stmt|;
specifier|const
name|QSize
name|largeIconSize
init|=
name|QSize
argument_list|(
name|metric
operator|*
literal|2
argument_list|,
name|metric
operator|*
literal|2
argument_list|)
decl_stmt|;
name|mw
operator|.
name|setIconSize
argument_list|(
name|smallIconSize
argument_list|)
expr_stmt|;
comment|// explicitly set it to the default
name|tb
operator|.
name|setIconSize
argument_list|(
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|addToolBar
argument_list|(
operator|&
name|tb
argument_list|)
expr_stmt|;
comment|// tb icon size should not change since it has been explicitly set
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|setIconSize
argument_list|(
name|largeIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|setIconSize
argument_list|(
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|setIconSize
argument_list|(
name|smallIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|defaultIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// resetting to the default should cause the toolbar to take
comment|// on the mainwindow's icon size
name|tb
operator|.
name|setIconSize
argument_list|(
name|QSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|iconSize
argument_list|()
argument_list|,
name|smallIconSize
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|first
argument_list|()
operator|.
name|first
argument_list|()
operator|.
name|toSize
argument_list|()
argument_list|,
name|smallIconSize
argument_list|)
expr_stmt|;
name|tbSpy
operator|.
name|clear
argument_list|()
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|toolButtonStyle
name|void
name|tst_QToolBar
operator|::
name|toolButtonStyle
parameter_list|()
block|{
block|{
name|QToolBar
name|tb
decl_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|toolButtonStyleChanged
argument_list|(
name|Qt
operator|::
name|ToolButtonStyle
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
comment|// no-op
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonTextOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
comment|// no-op
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonTextOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
comment|// no-op
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextBesideIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonTextBesideIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
comment|// no-op
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextBesideIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonTextBesideIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextUnderIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonTextUnderIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
comment|// no-op
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextUnderIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonTextUnderIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonFollowStyle
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonFollowStyle
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
name|tb
decl_stmt|;
name|QSignalSpy
name|mwSpy
argument_list|(
operator|&
name|mw
argument_list|,
name|SIGNAL
argument_list|(
name|toolButtonStyleChanged
argument_list|(
name|Qt
operator|::
name|ToolButtonStyle
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|tbSpy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|toolButtonStyleChanged
argument_list|(
name|Qt
operator|::
name|ToolButtonStyle
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|mw
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextBesideIcon
argument_list|)
expr_stmt|;
comment|// explicitly set the tb to the default
name|tb
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|addToolBar
argument_list|(
operator|&
name|tb
argument_list|)
expr_stmt|;
comment|// tb icon size should not change since it has been explicitly set
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|mw
operator|.
name|setToolButtonStyle
argument_list|(
name|Qt
operator|::
name|ToolButtonTextUnderIcon
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tb
operator|.
name|toolButtonStyle
argument_list|()
argument_list|,
name|Qt
operator|::
name|ToolButtonIconOnly
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|tbSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// note: there is no way to clear the explicitly set tool
comment|// button style... once you explicitly set it, the toolbar
comment|// will never follow the mainwindow again
block|}
block|}
end_function
begin_function
DECL|function|actionTriggered
name|void
name|tst_QToolBar
operator|::
name|actionTriggered
parameter_list|()
block|{
name|QToolBar
name|tb
decl_stmt|;
name|connect
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|actionTriggered
argument_list|(
name|QAction
operator|*
argument_list|)
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|slot
argument_list|(
name|QAction
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QAction
name|action1
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action2
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action3
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QAction
name|action4
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action3
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
operator|&
name|action4
argument_list|)
expr_stmt|;
name|tb
operator|.
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTest
operator|::
name|qWaitForWindowExposed
argument_list|(
operator|&
name|tb
argument_list|)
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|QToolBarExtension
modifier|*
argument_list|>
name|extensions
init|=
name|tb
operator|.
name|findChildren
argument_list|<
name|QToolBarExtension
operator|*
argument_list|>
argument_list|()
decl_stmt|;
name|QRect
name|rect01
decl_stmt|;
name|QRect
name|rect02
decl_stmt|;
name|QRect
name|rect03
decl_stmt|;
name|QRect
name|rect04
decl_stmt|;
name|QMenu
modifier|*
name|popupMenu
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|extensions
operator|.
name|size
argument_list|()
operator|!=
literal|0
condition|)
block|{
name|QToolBarExtension
modifier|*
name|extension
init|=
name|extensions
operator|.
name|at
argument_list|(
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|extension
operator|->
name|isVisible
argument_list|()
condition|)
block|{
name|QRect
name|rect0
init|=
name|extension
operator|->
name|geometry
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|mouseClick
argument_list|(
name|extension
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|rect0
operator|.
name|center
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|popupMenu
operator|=
name|qobject_cast
argument_list|<
name|QMenu
operator|*
argument_list|>
argument_list|(
name|extension
operator|->
name|menu
argument_list|()
argument_list|)
expr_stmt|;
name|rect01
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action1
argument_list|)
expr_stmt|;
name|rect02
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action2
argument_list|)
expr_stmt|;
name|rect03
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action3
argument_list|)
expr_stmt|;
name|rect04
operator|=
name|popupMenu
operator|->
name|actionGeometry
argument_list|(
operator|&
name|action4
argument_list|)
expr_stmt|;
block|}
block|}
name|QRect
name|rect1
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action1
argument_list|)
decl_stmt|;
name|QRect
name|rect2
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action2
argument_list|)
decl_stmt|;
name|QRect
name|rect3
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action3
argument_list|)
decl_stmt|;
name|QRect
name|rect4
init|=
name|tb
operator|.
name|actionGeometry
argument_list|(
operator|&
name|action4
argument_list|)
decl_stmt|;
name|QAbstractButton
modifier|*
name|button1
init|=
literal|0
decl_stmt|;
name|QAbstractButton
modifier|*
name|button2
init|=
literal|0
decl_stmt|;
name|QAbstractButton
modifier|*
name|button3
init|=
literal|0
decl_stmt|;
name|QAbstractButton
modifier|*
name|button4
init|=
literal|0
decl_stmt|;
if|if
condition|(
operator|!
name|rect01
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|button1
operator|=
name|qobject_cast
argument_list|<
name|QAbstractButton
operator|*
argument_list|>
argument_list|(
name|tb
operator|.
name|childAt
argument_list|(
name|rect1
operator|.
name|center
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|button1
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|rect02
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|button2
operator|=
name|qobject_cast
argument_list|<
name|QAbstractButton
operator|*
argument_list|>
argument_list|(
name|tb
operator|.
name|childAt
argument_list|(
name|rect2
operator|.
name|center
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|button2
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|rect03
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|button3
operator|=
name|qobject_cast
argument_list|<
name|QAbstractButton
operator|*
argument_list|>
argument_list|(
name|tb
operator|.
name|childAt
argument_list|(
name|rect3
operator|.
name|center
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|button3
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|rect04
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|button4
operator|=
name|qobject_cast
argument_list|<
name|QAbstractButton
operator|*
argument_list|>
argument_list|(
name|tb
operator|.
name|childAt
argument_list|(
name|rect4
operator|.
name|center
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|button4
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
operator|::
name|triggered
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|rect01
operator|.
name|isValid
argument_list|()
condition|)
name|QTest
operator|::
name|mouseClick
argument_list|(
name|button1
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|)
expr_stmt|;
else|else
name|QTest
operator|::
name|mouseClick
argument_list|(
name|popupMenu
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|rect01
operator|.
name|center
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|::
name|triggered
argument_list|,
operator|&
name|action1
argument_list|)
expr_stmt|;
operator|::
name|triggered
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|rect02
operator|.
name|isValid
argument_list|()
condition|)
name|QTest
operator|::
name|mouseClick
argument_list|(
name|button2
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|)
expr_stmt|;
else|else
name|QTest
operator|::
name|mouseClick
argument_list|(
name|popupMenu
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|rect02
operator|.
name|center
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|::
name|triggered
argument_list|,
operator|&
name|action2
argument_list|)
expr_stmt|;
operator|::
name|triggered
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|rect03
operator|.
name|isValid
argument_list|()
condition|)
name|QTest
operator|::
name|mouseClick
argument_list|(
name|button3
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|)
expr_stmt|;
else|else
name|QTest
operator|::
name|mouseClick
argument_list|(
name|popupMenu
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|rect03
operator|.
name|center
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|::
name|triggered
argument_list|,
operator|&
name|action3
argument_list|)
expr_stmt|;
operator|::
name|triggered
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|rect04
operator|.
name|isValid
argument_list|()
condition|)
name|QTest
operator|::
name|mouseClick
argument_list|(
name|button4
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|)
expr_stmt|;
else|else
name|QTest
operator|::
name|mouseClick
argument_list|(
name|popupMenu
argument_list|,
name|Qt
operator|::
name|LeftButton
argument_list|,
literal|0
argument_list|,
name|rect04
operator|.
name|center
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|::
name|triggered
argument_list|,
operator|&
name|action4
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|visibilityChanged
name|void
name|tst_QToolBar
operator|::
name|visibilityChanged
parameter_list|()
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
name|tb
decl_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|tb
argument_list|,
name|SIGNAL
argument_list|(
name|visibilityChanged
argument_list|(
name|bool
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|mw
operator|.
name|addToolBar
argument_list|(
operator|&
name|tb
argument_list|)
expr_stmt|;
name|mw
operator|.
name|show
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|toBool
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|hide
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|toBool
argument_list|()
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|hide
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|tb
operator|.
name|show
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|toBool
argument_list|()
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|tb
operator|.
name|show
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|actionOwnership
name|void
name|tst_QToolBar
operator|::
name|actionOwnership
parameter_list|()
block|{
block|{
name|QToolBar
modifier|*
name|tb1
init|=
operator|new
name|QToolBar
decl_stmt|;
name|QToolBar
modifier|*
name|tb2
init|=
operator|new
name|QToolBar
decl_stmt|;
name|QPointer
argument_list|<
name|QAction
argument_list|>
name|action
init|=
name|tb1
operator|->
name|addAction
argument_list|(
literal|"test"
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
name|tb1
argument_list|)
expr_stmt|;
name|tb2
operator|->
name|addAction
argument_list|(
name|action
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
name|tb1
argument_list|)
expr_stmt|;
operator|delete
name|tb1
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|action
argument_list|)
expr_stmt|;
operator|delete
name|tb2
expr_stmt|;
block|}
block|{
name|QToolBar
modifier|*
name|tb1
init|=
operator|new
name|QToolBar
decl_stmt|;
name|QToolBar
modifier|*
name|tb2
init|=
operator|new
name|QToolBar
decl_stmt|;
name|QPointer
argument_list|<
name|QAction
argument_list|>
name|action
init|=
name|tb1
operator|->
name|addAction
argument_list|(
literal|"test"
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
name|tb1
argument_list|)
expr_stmt|;
name|tb1
operator|->
name|removeAction
argument_list|(
name|action
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
name|tb1
argument_list|)
expr_stmt|;
name|tb2
operator|->
name|addAction
argument_list|(
name|action
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|action
operator|->
name|parent
argument_list|()
operator|==
name|tb1
argument_list|)
expr_stmt|;
operator|delete
name|tb1
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|action
argument_list|)
expr_stmt|;
operator|delete
name|tb2
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|widgetAction
name|void
name|tst_QToolBar
operator|::
name|widgetAction
parameter_list|()
block|{
comment|// ensure that a QWidgetAction without widget behaves like a normal action
name|QToolBar
name|tb
decl_stmt|;
name|QWidgetAction
modifier|*
name|a
init|=
operator|new
name|QWidgetAction
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|a
operator|->
name|setIconText
argument_list|(
literal|"Blah"
argument_list|)
expr_stmt|;
name|tb
operator|.
name|addAction
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
name|tb
operator|.
name|widgetForAction
argument_list|(
name|a
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QToolButton
modifier|*
name|button
init|=
name|qobject_cast
argument_list|<
name|QToolButton
operator|*
argument_list|>
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|->
name|iconText
argument_list|()
argument_list|,
name|button
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
operator|delete
name|a
expr_stmt|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|Q_OS_MAC
end_ifdef
begin_function_decl
name|QT_BEGIN_NAMESPACE
specifier|extern
name|void
name|qt_set_sequence_auto_mnemonic
parameter_list|(
name|bool
name|b
parameter_list|)
function_decl|;
end_function_decl
begin_function
name|QT_END_NAMESPACE
endif|#
directive|endif
DECL|function|accel
name|void
name|tst_QToolBar
operator|::
name|accel
parameter_list|()
block|{
ifdef|#
directive|ifdef
name|Q_OS_MAC
name|qt_set_sequence_auto_mnemonic
argument_list|(
literal|true
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
modifier|*
name|toolBar
init|=
name|mw
operator|.
name|addToolBar
argument_list|(
literal|"test"
argument_list|)
decl_stmt|;
name|QAction
modifier|*
name|action
init|=
name|toolBar
operator|->
name|addAction
argument_list|(
literal|"&test"
argument_list|)
decl_stmt|;
name|action
operator|->
name|setIconText
argument_list|(
name|action
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
comment|// we really want that mnemonic in the button!
name|QSignalSpy
name|spy
argument_list|(
name|action
argument_list|,
name|SIGNAL
argument_list|(
name|triggered
argument_list|(
name|bool
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|mw
operator|.
name|show
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|setActiveWindow
argument_list|(
operator|&
name|mw
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|QApplication
operator|::
name|activeWindow
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QWidget
operator|*
argument_list|>
argument_list|(
operator|&
name|mw
argument_list|)
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|keyClick
argument_list|(
operator|&
name|mw
argument_list|,
name|Qt
operator|::
name|Key_T
argument_list|,
name|Qt
operator|::
name|AltModifier
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|300
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|Q_OS_MAC
name|qt_set_sequence_auto_mnemonic
argument_list|(
literal|false
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|task191727_layout
name|void
name|tst_QToolBar
operator|::
name|task191727_layout
parameter_list|()
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
modifier|*
name|toolBar
init|=
name|mw
operator|.
name|addToolBar
argument_list|(
literal|"test"
argument_list|)
decl_stmt|;
name|toolBar
operator|->
name|addAction
argument_list|(
literal|"one"
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|action
init|=
name|toolBar
operator|->
name|addAction
argument_list|(
literal|"two"
argument_list|)
decl_stmt|;
name|QLineEdit
modifier|*
name|lineedit
init|=
operator|new
name|QLineEdit
decl_stmt|;
name|lineedit
operator|->
name|setMaximumWidth
argument_list|(
literal|50
argument_list|)
expr_stmt|;
name|toolBar
operator|->
name|addWidget
argument_list|(
name|lineedit
argument_list|)
expr_stmt|;
name|mw
operator|.
name|resize
argument_list|(
literal|400
argument_list|,
literal|400
argument_list|)
expr_stmt|;
name|mw
operator|.
name|show
argument_list|()
expr_stmt|;
name|QWidget
modifier|*
name|actionwidget
init|=
name|toolBar
operator|->
name|widgetForAction
argument_list|(
name|action
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|qAbs
argument_list|(
name|lineedit
operator|->
name|pos
argument_list|()
operator|.
name|x
argument_list|()
operator|-
operator|(
name|actionwidget
operator|->
name|geometry
argument_list|()
operator|.
name|right
argument_list|()
operator|+
literal|1
operator|+
name|toolBar
operator|->
name|layout
argument_list|()
operator|->
name|spacing
argument_list|()
operator|)
argument_list|)
operator|<
literal|2
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|task197996_visibility
name|void
name|tst_QToolBar
operator|::
name|task197996_visibility
parameter_list|()
block|{
name|QMainWindow
name|mw
decl_stmt|;
name|QToolBar
modifier|*
name|toolBar
init|=
operator|new
name|QToolBar
argument_list|(
operator|&
name|mw
argument_list|)
decl_stmt|;
name|mw
operator|.
name|addToolBar
argument_list|(
name|toolBar
argument_list|)
expr_stmt|;
name|toolBar
operator|->
name|addAction
argument_list|(
operator|new
name|QAction
argument_list|(
literal|"Foo"
argument_list|,
operator|&
name|mw
argument_list|)
argument_list|)
expr_stmt|;
name|QAction
modifier|*
name|pAction
init|=
operator|new
name|QAction
argument_list|(
literal|"Test"
argument_list|,
operator|&
name|mw
argument_list|)
decl_stmt|;
name|toolBar
operator|->
name|addAction
argument_list|(
name|pAction
argument_list|)
expr_stmt|;
name|pAction
operator|->
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|toolBar
operator|->
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|toolBar
operator|->
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|pAction
operator|->
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|mw
operator|.
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|toolBar
operator|->
name|widgetForAction
argument_list|(
name|pAction
argument_list|)
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|toolBar
operator|->
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|pAction
operator|->
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|toolBar
operator|->
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|pAction
operator|->
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|toolBar
operator|->
name|widgetForAction
argument_list|(
name|pAction
argument_list|)
operator|->
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QToolBar
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qtoolbar.moc"
end_include
end_unit
