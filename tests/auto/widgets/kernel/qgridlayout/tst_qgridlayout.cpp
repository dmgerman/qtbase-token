begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2014 Digia Plc and/or its subsidiary(-ies). ** Contact: http://www.qt-project.org/legal ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL21$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and Digia. For licensing terms and ** conditions see http://qt.digia.com/licensing. For further information ** use the contact form at http://qt.digia.com/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 or version 3 as published by the Free ** Software Foundation and appearing in the file LICENSE.LGPLv21 and ** LICENSE.LGPLv3 included in the packaging of this file. Please review the ** following information to ensure the GNU Lesser General Public License ** requirements will be met: https://www.gnu.org/licenses/lgpl.html and ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Digia gives you certain additional ** rights. These rights are described in the Digia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<qlayout.h>
end_include
begin_include
include|#
directive|include
file|<qapplication.h>
end_include
begin_include
include|#
directive|include
file|<qwidget.h>
end_include
begin_include
include|#
directive|include
file|<qproxystyle.h>
end_include
begin_include
include|#
directive|include
file|<qsizepolicy.h>
end_include
begin_comment
comment|//#include<QtGui>
end_comment
begin_include
include|#
directive|include
file|<QtWidgets/QLabel>
end_include
begin_include
include|#
directive|include
file|<QtWidgets/QLineEdit>
end_include
begin_include
include|#
directive|include
file|<QtWidgets/QRadioButton>
end_include
begin_include
include|#
directive|include
file|<QStyleFactory>
end_include
begin_include
include|#
directive|include
file|<QSharedPointer>
end_include
begin_comment
comment|// Make a widget frameless to prevent size constraints of title bars
end_comment
begin_comment
comment|// from interfering (Windows).
end_comment
begin_function
DECL|function|setFrameless
specifier|static
specifier|inline
name|void
name|setFrameless
parameter_list|(
name|QWidget
modifier|*
name|w
parameter_list|)
block|{
name|Qt
operator|::
name|WindowFlags
name|flags
init|=
name|w
operator|->
name|windowFlags
argument_list|()
decl_stmt|;
name|flags
operator||=
name|Qt
operator|::
name|FramelessWindowHint
expr_stmt|;
name|flags
operator|&=
operator|~
operator|(
name|Qt
operator|::
name|WindowTitleHint
operator||
name|Qt
operator|::
name|WindowSystemMenuHint
operator||
name|Qt
operator|::
name|WindowMinMaxButtonsHint
operator||
name|Qt
operator|::
name|WindowCloseButtonHint
operator|)
expr_stmt|;
name|w
operator|->
name|setWindowFlags
argument_list|(
name|flags
argument_list|)
expr_stmt|;
block|}
end_function
begin_class
DECL|class|tst_QGridLayout
class|class
name|tst_QGridLayout
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
public|public:
name|tst_QGridLayout
parameter_list|()
constructor_decl|;
specifier|virtual
name|~
name|tst_QGridLayout
parameter_list|()
destructor_decl|;
public|public
name|slots
public|:
name|void
name|initTestCase
parameter_list|()
function_decl|;
name|void
name|cleanupTestCase
parameter_list|()
function_decl|;
name|void
name|init
parameter_list|()
function_decl|;
name|void
name|cleanup
parameter_list|()
function_decl|;
private|private
name|slots
private|:
name|void
name|getItemPosition
parameter_list|()
function_decl|;
name|void
name|itemAtPosition
parameter_list|()
function_decl|;
name|void
name|badDistributionBug
parameter_list|()
function_decl|;
name|void
name|setMinAndMaxSize
parameter_list|()
function_decl|;
name|void
name|spacingAndSpacers
parameter_list|()
function_decl|;
name|void
name|spacingsAndMargins
parameter_list|()
function_decl|;
name|void
name|spacingsAndMargins_data
parameter_list|()
function_decl|;
name|void
name|minMaxSize_data
parameter_list|()
function_decl|;
name|void
name|minMaxSize
parameter_list|()
function_decl|;
name|void
name|styleDependentSpacingsAndMargins_data
parameter_list|()
function_decl|;
name|void
name|styleDependentSpacingsAndMargins
parameter_list|()
function_decl|;
name|void
name|layoutSpacing_data
parameter_list|()
function_decl|;
name|void
name|layoutSpacing
parameter_list|()
function_decl|;
name|void
name|spacing
parameter_list|()
function_decl|;
name|void
name|spacerWithSpacing
parameter_list|()
function_decl|;
name|void
name|contentsRect
parameter_list|()
function_decl|;
name|void
name|distributeMultiCell
parameter_list|()
function_decl|;
name|void
name|taskQTBUG_27420_takeAtShouldUnparentLayout
parameter_list|()
function_decl|;
name|void
name|taskQTBUG_40609_addingWidgetToItsOwnLayout
parameter_list|()
function_decl|;
name|void
name|taskQTBUG_40609_addingLayoutToItself
parameter_list|()
function_decl|;
name|void
name|replaceWidget
parameter_list|()
function_decl|;
name|void
name|dontCrashWhenExtendsToEnd
parameter_list|()
function_decl|;
private|private:
DECL|member|testWidget
name|QWidget
modifier|*
name|testWidget
decl_stmt|;
DECL|member|testLayout
name|QGridLayout
modifier|*
name|testLayout
decl_stmt|;
DECL|member|w1
name|QWidget
modifier|*
name|w1
decl_stmt|;
DECL|member|w2
name|QWidget
modifier|*
name|w2
decl_stmt|;
DECL|member|w3
name|QWidget
modifier|*
name|w3
decl_stmt|;
DECL|member|sp
name|QSpacerItem
modifier|*
name|sp
decl_stmt|;
DECL|member|m_grid
name|QGridLayout
modifier|*
name|m_grid
decl_stmt|;
DECL|member|m_toplevel
name|QWidget
modifier|*
name|m_toplevel
decl_stmt|;
block|}
class|;
end_class
begin_constructor
DECL|function|tst_QGridLayout
name|tst_QGridLayout
operator|::
name|tst_QGridLayout
parameter_list|()
block|{
name|m_grid
operator|=
literal|0
expr_stmt|;
name|m_toplevel
operator|=
literal|0
expr_stmt|;
block|}
end_constructor
begin_destructor
DECL|function|~tst_QGridLayout
name|tst_QGridLayout
operator|::
name|~
name|tst_QGridLayout
parameter_list|()
block|{
operator|delete
name|m_toplevel
expr_stmt|;
block|}
end_destructor
begin_function
DECL|function|initTestCase
name|void
name|tst_QGridLayout
operator|::
name|initTestCase
parameter_list|()
block|{
ifdef|#
directive|ifdef
name|Q_OS_WINCE
comment|//disable magic for WindowsCE
name|qApp
operator|->
name|setAutoMaximizeThreshold
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|// Create the test class
name|testWidget
operator|=
operator|new
name|QWidget
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|testLayout
operator|=
operator|new
name|QGridLayout
argument_list|(
name|testWidget
argument_list|)
expr_stmt|;
name|w1
operator|=
operator|new
name|QWidget
argument_list|(
name|testWidget
argument_list|)
expr_stmt|;
name|w1
operator|->
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|red
argument_list|)
argument_list|)
expr_stmt|;
name|testLayout
operator|->
name|addWidget
argument_list|(
name|w1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|w2
operator|=
operator|new
name|QWidget
argument_list|(
name|testWidget
argument_list|)
expr_stmt|;
name|testLayout
operator|->
name|addWidget
argument_list|(
name|w2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|w2
operator|->
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|green
argument_list|)
argument_list|)
expr_stmt|;
name|w3
operator|=
operator|new
name|QWidget
argument_list|(
name|testWidget
argument_list|)
expr_stmt|;
name|testLayout
operator|->
name|addWidget
argument_list|(
name|w3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|w3
operator|->
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|blue
argument_list|)
argument_list|)
expr_stmt|;
name|sp
operator|=
operator|new
name|QSpacerItem
argument_list|(
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|testLayout
operator|->
name|addItem
argument_list|(
name|sp
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|testWidget
operator|->
name|resize
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|testWidget
operator|->
name|show
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|cleanupTestCase
name|void
name|tst_QGridLayout
operator|::
name|cleanupTestCase
parameter_list|()
block|{
operator|delete
name|testWidget
expr_stmt|;
name|testWidget
operator|=
literal|0
expr_stmt|;
block|}
end_function
begin_function
DECL|function|init
name|void
name|tst_QGridLayout
operator|::
name|init
parameter_list|()
block|{ }
end_function
begin_function
DECL|function|cleanup
name|void
name|tst_QGridLayout
operator|::
name|cleanup
parameter_list|()
block|{ }
end_function
begin_function
DECL|function|getItemPosition
name|void
name|tst_QGridLayout
operator|::
name|getItemPosition
parameter_list|()
block|{
name|QLayoutItem
modifier|*
name|item
decl_stmt|;
name|int
name|counter
init|=
literal|0
decl_stmt|;
name|bool
name|seenW1
init|=
literal|false
decl_stmt|;
name|bool
name|seenW2
init|=
literal|false
decl_stmt|;
name|bool
name|seenW3
init|=
literal|false
decl_stmt|;
name|bool
name|seenSpacer
init|=
literal|false
decl_stmt|;
while|while
condition|(
operator|(
name|item
operator|=
name|testLayout
operator|->
name|itemAt
argument_list|(
name|counter
argument_list|)
operator|)
condition|)
block|{
name|QWidget
modifier|*
name|w
init|=
name|item
operator|->
name|widget
argument_list|()
decl_stmt|;
name|int
name|r
decl_stmt|,
name|c
decl_stmt|,
name|rs
decl_stmt|,
name|cs
decl_stmt|;
name|testLayout
operator|->
name|getItemPosition
argument_list|(
name|counter
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|c
argument_list|,
operator|&
name|rs
argument_list|,
operator|&
name|cs
argument_list|)
expr_stmt|;
comment|//        qDebug()<< "item"<< counter<< "has"<<r<< c<< rs<< cs;
if|if
condition|(
name|w
operator|==
name|w1
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|seenW1
argument_list|)
expr_stmt|;
name|seenW1
operator|=
literal|true
expr_stmt|;
name|QCOMPARE
argument_list|(
name|r
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|c
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|rs
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cs
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|w
operator|==
name|w2
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|seenW2
argument_list|)
expr_stmt|;
name|seenW2
operator|=
literal|true
expr_stmt|;
name|QCOMPARE
argument_list|(
name|r
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|c
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|rs
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cs
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|w
operator|==
name|w3
condition|)
block|{
name|QVERIFY
argument_list|(
operator|!
name|seenW3
argument_list|)
expr_stmt|;
name|seenW3
operator|=
literal|true
expr_stmt|;
name|QCOMPARE
argument_list|(
name|r
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|c
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|rs
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cs
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
operator|!
name|w
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|seenSpacer
argument_list|)
expr_stmt|;
name|seenSpacer
operator|=
literal|true
expr_stmt|;
name|QCOMPARE
argument_list|(
name|r
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|c
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|rs
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|cs
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
operator|++
name|counter
expr_stmt|;
block|}
name|QCOMPARE
argument_list|(
name|counter
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seenW1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seenW2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seenW3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seenSpacer
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|itemAtPosition
name|void
name|tst_QGridLayout
operator|::
name|itemAtPosition
parameter_list|()
block|{
name|void
modifier|*
name|table
index|[
literal|4
index|]
index|[
literal|5
index|]
init|=
block|{
block|{
name|w1
block|,
name|w3
block|,
name|w3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|0
block|,
name|w2
block|,
name|w2
block|,
name|sp
block|,
literal|0
block|}
block|,
block|{
literal|0
block|,
name|w2
block|,
name|w2
block|,
name|sp
block|,
literal|0
block|}
block|,
block|{
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
for|for
control|(
name|int
name|row
init|=
literal|0
init|;
name|row
operator|<
literal|4
condition|;
operator|++
name|row
control|)
block|{
for|for
control|(
name|int
name|col
init|=
literal|0
init|;
name|col
operator|<
literal|5
condition|;
operator|++
name|col
control|)
block|{
name|QLayoutItem
modifier|*
name|item
init|=
name|testLayout
operator|->
name|itemAtPosition
argument_list|(
name|row
argument_list|,
name|col
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|item
operator|==
name|table
index|[
name|row
index|]
index|[
name|col
index|]
operator|||
operator|(
name|item
operator|&&
name|item
operator|->
name|widget
argument_list|()
operator|==
name|table
index|[
name|row
index|]
index|[
name|col
index|]
operator|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function
begin_include
include|#
directive|include
file|"ui_sortdialog.h"
end_include
begin_function
DECL|function|badDistributionBug
name|void
name|tst_QGridLayout
operator|::
name|badDistributionBug
parameter_list|()
block|{
name|QDialog
name|dialog
decl_stmt|;
name|Ui
operator|::
name|SortDialog
name|ui
decl_stmt|;
name|ui
operator|.
name|setupUi
argument_list|(
operator|&
name|dialog
argument_list|)
expr_stmt|;
name|ui
operator|.
name|gridLayout
operator|->
name|setMargin
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|ui
operator|.
name|gridLayout
operator|->
name|setSpacing
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|ui
operator|.
name|vboxLayout
operator|->
name|setMargin
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|ui
operator|.
name|vboxLayout
operator|->
name|setSpacing
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|ui
operator|.
name|okButton
operator|->
name|setFixedHeight
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|ui
operator|.
name|moreButton
operator|->
name|setFixedHeight
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|ui
operator|.
name|primaryGroupBox
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|)
expr_stmt|;
name|ui
operator|.
name|primaryGroupBox
operator|->
name|setFixedHeight
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|QSize
name|minSize
init|=
name|dialog
operator|.
name|layout
argument_list|()
operator|->
name|minimumSize
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|minSize
operator|.
name|height
argument_list|()
argument_list|,
literal|200
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setMinAndMaxSize
name|void
name|tst_QGridLayout
operator|::
name|setMinAndMaxSize
parameter_list|()
block|{
name|QWidget
name|widget
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|widget
argument_list|)
expr_stmt|;
name|QGridLayout
name|layout
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setMargin
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setSpacing
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setSizeConstraint
argument_list|(
name|QLayout
operator|::
name|SetMinAndMaxSize
argument_list|)
expr_stmt|;
name|widget
operator|.
name|show
argument_list|()
expr_stmt|;
name|QWidget
name|leftChild
decl_stmt|;
name|leftChild
operator|.
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|red
argument_list|)
argument_list|)
expr_stmt|;
name|leftChild
operator|.
name|setMinimumSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|leftChild
operator|.
name|setMaximumSize
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
operator|&
name|leftChild
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QWidget
name|rightChild
decl_stmt|;
name|rightChild
operator|.
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|green
argument_list|)
argument_list|)
expr_stmt|;
name|rightChild
operator|.
name|setMinimumSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|rightChild
operator|.
name|setMaximumSize
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
operator|&
name|rightChild
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|minimumWidth
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|minimumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|maximumWidth
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|maximumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
specifier|static
specifier|const
name|int
name|colMin
init|=
literal|100
decl_stmt|;
name|layout
operator|.
name|setColumnMinimumWidth
argument_list|(
literal|1
argument_list|,
name|colMin
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|.
name|columnMinimumWidth
argument_list|(
literal|1
argument_list|)
argument_list|,
name|colMin
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|colMin
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|colMin
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|minimumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|maximumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setColumnStretch
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|colMin
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|QLAYOUTSIZE_MAX
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|minimumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|maximumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setColumnStretch
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|colMin
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|colMin
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|minimumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|maximumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setColumnMinimumWidth
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
specifier|static
specifier|const
name|int
name|spacerS
init|=
literal|250
decl_stmt|;
name|QSpacerItem
modifier|*
name|spacer
init|=
operator|new
name|QSpacerItem
argument_list|(
name|spacerS
argument_list|,
name|spacerS
argument_list|)
decl_stmt|;
name|layout
operator|.
name|addItem
argument_list|(
name|spacer
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|spacerS
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|QLAYOUTSIZE_MAX
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|qMax
argument_list|(
name|leftChild
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|minimumHeight
argument_list|()
argument_list|)
argument_list|,
name|spacerS
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|rightChild
operator|.
name|maximumHeight
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|spacer
operator|->
name|changeSize
argument_list|(
name|spacerS
argument_list|,
name|spacerS
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Minimum
argument_list|)
expr_stmt|;
name|layout
operator|.
name|invalidate
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|minimumWidth
argument_list|()
operator|+
name|spacerS
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|rightChild
operator|.
name|maximumWidth
argument_list|()
operator|+
name|spacerS
argument_list|)
expr_stmt|;
name|layout
operator|.
name|removeItem
argument_list|(
name|spacer
argument_list|)
expr_stmt|;
name|rightChild
operator|.
name|hide
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
name|rightChild
operator|.
name|show
argument_list|()
expr_stmt|;
name|layout
operator|.
name|removeWidget
argument_list|(
operator|&
name|rightChild
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QWidget
name|bottomChild
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|bottomChild
operator|.
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|green
argument_list|)
argument_list|)
expr_stmt|;
name|bottomChild
operator|.
name|setMinimumSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|bottomChild
operator|.
name|setMaximumSize
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
operator|&
name|bottomChild
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumHeight
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumHeight
argument_list|()
operator|+
name|bottomChild
operator|.
name|minimumHeight
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|minimumWidth
argument_list|()
argument_list|,
name|bottomChild
operator|.
name|minimumWidth
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumHeight
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumHeight
argument_list|()
operator|+
name|bottomChild
operator|.
name|maximumHeight
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|qMax
argument_list|(
name|leftChild
operator|.
name|maximumWidth
argument_list|()
argument_list|,
name|bottomChild
operator|.
name|maximumWidth
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|bottomChild
operator|.
name|hide
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
name|bottomChild
operator|.
name|show
argument_list|()
expr_stmt|;
name|layout
operator|.
name|removeWidget
argument_list|(
operator|&
name|bottomChild
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|minimumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|minimumSize
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|maximumSize
argument_list|()
argument_list|,
name|leftChild
operator|.
name|maximumSize
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_class
DECL|class|SizeHinter
class|class
name|SizeHinter
super|:
specifier|public
name|QWidget
block|{
public|public:
DECL|function|SizeHinter
name|SizeHinter
parameter_list|(
specifier|const
name|QSize
modifier|&
name|s
parameter_list|,
name|QWidget
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|sh
argument_list|(
name|s
argument_list|)
block|{ }
DECL|function|SizeHinter
name|SizeHinter
parameter_list|(
name|int
name|w
parameter_list|,
name|int
name|h
parameter_list|,
name|QWidget
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|sh
argument_list|(
name|QSize
argument_list|(
name|w
argument_list|,
name|h
argument_list|)
argument_list|)
block|{}
DECL|function|setSizeHint
name|void
name|setSizeHint
parameter_list|(
name|QSize
name|s
parameter_list|)
block|{
name|sh
operator|=
name|s
expr_stmt|;
block|}
DECL|function|sizeHint
name|QSize
name|sizeHint
parameter_list|()
specifier|const
block|{
return|return
name|sh
return|;
block|}
private|private:
DECL|member|sh
name|QSize
name|sh
decl_stmt|;
block|}
class|;
end_class
begin_function
DECL|function|spacingAndSpacers
name|void
name|tst_QGridLayout
operator|::
name|spacingAndSpacers
parameter_list|()
block|{
name|QWidget
name|widget
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|widget
argument_list|)
expr_stmt|;
name|QGridLayout
name|layout
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setMargin
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setSpacing
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|widget
operator|.
name|show
argument_list|()
expr_stmt|;
name|QSize
name|expectedSizeHint
decl_stmt|;
name|SizeHinter
name|leftChild
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
decl_stmt|;
name|leftChild
operator|.
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|red
argument_list|)
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
operator|&
name|leftChild
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|expectedSizeHint
operator|=
name|leftChild
operator|.
name|sizeHint
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|expectedSizeHint
argument_list|)
expr_stmt|;
name|SizeHinter
name|rightChild
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
decl_stmt|;
name|rightChild
operator|.
name|setPalette
argument_list|(
name|QPalette
argument_list|(
name|Qt
operator|::
name|green
argument_list|)
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
operator|&
name|rightChild
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|rightChild
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
argument_list|)
expr_stmt|;
name|expectedSizeHint
operator|+=
name|QSize
argument_list|(
name|rightChild
operator|.
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|expectedSizeHint
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setColumnMinimumWidth
argument_list|(
literal|1
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|widget
operator|.
name|adjustSize
argument_list|()
expr_stmt|;
name|expectedSizeHint
operator|+=
name|QSize
argument_list|(
literal|100
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|expectedSizeHint
argument_list|)
expr_stmt|;
name|rightChild
operator|.
name|hide
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|expectedSizeHint
operator|-=
name|QSize
argument_list|(
name|rightChild
operator|.
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|expectedSizeHint
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setColumnMinimumWidth
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|expectedSizeHint
operator|-=
name|QSize
argument_list|(
literal|100
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|expectedSizeHint
argument_list|)
expr_stmt|;
name|rightChild
operator|.
name|show
argument_list|()
expr_stmt|;
name|layout
operator|.
name|removeWidget
argument_list|(
operator|&
name|rightChild
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|sendPostedEvents
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|widget
operator|.
name|sizeHint
argument_list|()
argument_list|,
name|expectedSizeHint
argument_list|)
expr_stmt|;
block|}
end_function
begin_class
DECL|class|Qt42Style
class|class
name|Qt42Style
super|:
specifier|public
name|QProxyStyle
block|{
name|Q_OBJECT
public|public:
DECL|function|Qt42Style
name|Qt42Style
parameter_list|()
member_init_list|:
name|QProxyStyle
argument_list|(
name|QStyleFactory
operator|::
name|create
argument_list|(
literal|"windows"
argument_list|)
argument_list|)
block|{
name|spacing
operator|=
literal|6
expr_stmt|;
name|margin
operator|=
literal|9
expr_stmt|;
name|margin_toplevel
operator|=
literal|11
expr_stmt|;
block|}
specifier|virtual
name|int
name|pixelMetric
parameter_list|(
name|PixelMetric
name|metric
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|option
init|=
literal|0
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
init|=
literal|0
parameter_list|)
specifier|const
function_decl|;
DECL|member|spacing
name|int
name|spacing
decl_stmt|;
DECL|member|margin
name|int
name|margin
decl_stmt|;
DECL|member|margin_toplevel
name|int
name|margin_toplevel
decl_stmt|;
block|}
class|;
end_class
begin_function
DECL|function|pixelMetric
name|int
name|Qt42Style
operator|::
name|pixelMetric
parameter_list|(
name|PixelMetric
name|metric
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|option
comment|/*= 0*/
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
comment|/*= 0*/
parameter_list|)
specifier|const
block|{
switch|switch
condition|(
name|metric
condition|)
block|{
case|case
name|PM_DefaultLayoutSpacing
case|:
return|return
name|spacing
return|;
break|break;
case|case
name|PM_DefaultTopLevelMargin
case|:
return|return
name|margin_toplevel
return|;
break|break;
case|case
name|PM_DefaultChildMargin
case|:
return|return
name|margin
return|;
break|break;
default|default:
break|break;
block|}
return|return
name|QProxyStyle
operator|::
name|pixelMetric
argument_list|(
name|metric
argument_list|,
name|option
argument_list|,
name|widget
argument_list|)
return|;
block|}
end_function
begin_typedef
DECL|typedef|PointList
typedef|typedef
name|QList
argument_list|<
name|QPoint
argument_list|>
name|PointList
typedef|;
end_typedef
begin_class
DECL|class|SizeHinterFrame
class|class
name|SizeHinterFrame
super|:
specifier|public
name|QLabel
block|{
public|public:
DECL|function|SizeHinterFrame
name|SizeHinterFrame
parameter_list|(
name|QWidget
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QLabel
argument_list|(
name|parent
argument_list|)
block|{
name|init
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
DECL|function|SizeHinterFrame
name|SizeHinterFrame
parameter_list|(
specifier|const
name|QSize
modifier|&
name|s
parameter_list|,
name|int
name|numPixels
init|=
operator|-
literal|1
parameter_list|)
member_init_list|:
name|QLabel
argument_list|(
literal|0
argument_list|)
member_init_list|,
name|sh
argument_list|(
name|s
argument_list|)
block|{
name|init
argument_list|(
name|numPixels
argument_list|)
expr_stmt|;
block|}
DECL|function|SizeHinterFrame
name|SizeHinterFrame
parameter_list|(
name|int
name|w
parameter_list|,
name|int
name|h
parameter_list|)
member_init_list|:
name|QLabel
argument_list|(
literal|0
argument_list|)
member_init_list|,
name|sh
argument_list|(
name|QSize
argument_list|(
name|w
argument_list|,
name|h
argument_list|)
argument_list|)
block|{
name|init
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
DECL|function|setSizeHint
name|void
name|setSizeHint
parameter_list|(
specifier|const
name|QSize
modifier|&
name|s
parameter_list|)
block|{
name|sh
operator|=
name|s
expr_stmt|;
block|}
DECL|function|sizeHint
name|QSize
name|sizeHint
parameter_list|()
specifier|const
block|{
return|return
name|sh
return|;
block|}
DECL|function|setMinimumSizeHint
name|void
name|setMinimumSizeHint
parameter_list|(
specifier|const
name|QSize
modifier|&
name|s
parameter_list|)
block|{
name|msh
operator|=
name|s
expr_stmt|;
block|}
DECL|function|minimumSizeHint
name|QSize
name|minimumSizeHint
parameter_list|()
specifier|const
block|{
return|return
name|msh
return|;
block|}
specifier|virtual
name|int
name|heightForWidth
parameter_list|(
name|int
name|width
parameter_list|)
specifier|const
function_decl|;
DECL|function|setNumberOfPixels
name|void
name|setNumberOfPixels
parameter_list|(
name|int
name|numPixels
parameter_list|)
block|{
name|m_numPixels
operator|=
name|numPixels
expr_stmt|;
name|QSizePolicy
name|sp
init|=
name|sizePolicy
argument_list|()
decl_stmt|;
name|sp
operator|.
name|setHeightForWidth
argument_list|(
name|m_numPixels
operator|!=
operator|-
literal|1
argument_list|)
expr_stmt|;
name|setSizePolicy
argument_list|(
name|sp
argument_list|)
expr_stmt|;
block|}
private|private:
DECL|function|init
name|void
name|init
parameter_list|(
name|int
name|numPixels
init|=
operator|-
literal|1
parameter_list|)
block|{
name|setText
argument_list|(
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"(%1,%2)"
argument_list|)
operator|.
name|arg
argument_list|(
name|sh
operator|.
name|width
argument_list|()
argument_list|)
operator|.
name|arg
argument_list|(
name|sh
operator|.
name|height
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|setFrameStyle
argument_list|(
name|QFrame
operator|::
name|Box
operator||
name|QFrame
operator|::
name|Plain
argument_list|)
expr_stmt|;
name|setNumberOfPixels
argument_list|(
name|numPixels
argument_list|)
expr_stmt|;
block|}
private|private:
DECL|member|sh
name|QSize
name|sh
decl_stmt|;
DECL|member|msh
name|QSize
name|msh
decl_stmt|;
DECL|member|m_numPixels
name|int
name|m_numPixels
decl_stmt|;
block|}
class|;
end_class
begin_function
DECL|function|heightForWidth
name|int
name|SizeHinterFrame
operator|::
name|heightForWidth
parameter_list|(
name|int
name|width
parameter_list|)
specifier|const
block|{
comment|// Special hack if m_numPixels == -2 then we report that we are heightForWidth aware, but we
comment|// return sizeHint().width() so that it should be laid out as if we had't any hfw.
comment|// This enables us to run the tests twice and to see if we get the same results with hfw as without hfw.
if|if
condition|(
name|m_numPixels
operator|==
operator|-
literal|2
condition|)
block|{
return|return
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
return|;
block|}
if|if
condition|(
name|m_numPixels
operator|==
operator|-
literal|1
operator|||
name|width
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
comment|// this widget should always cover the same amount of pixels (provided that we don't get any rounding errors)
return|return
operator|(
name|m_numPixels
operator|)
operator|/
name|width
return|;
block|}
end_function
begin_function
DECL|function|spacingsAndMargins_data
name|void
name|tst_QGridLayout
operator|::
name|spacingsAndMargins_data
parameter_list|()
block|{
comment|// input
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"columns"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"rows"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSize
argument_list|>
argument_list|(
literal|"sizehint"
argument_list|)
expr_stmt|;
comment|// expected
name|QTest
operator|::
name|addColumn
argument_list|<
name|PointList
argument_list|>
argument_list|(
literal|"expectedpositions"
argument_list|)
expr_stmt|;
name|int
name|child_offset_y
init|=
literal|11
operator|+
literal|100
operator|+
literal|6
operator|+
literal|9
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x1 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|1
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x1 grid"
argument_list|)
operator|<<
literal|2
operator|<<
literal|1
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|,
literal|11
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
operator|+
literal|100
operator|+
literal|6
argument_list|,
name|child_offset_y
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"3x1 grid"
argument_list|)
operator|<<
literal|3
operator|<<
literal|1
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
argument_list|,
literal|11
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
operator|+
literal|100
operator|+
literal|6
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
argument_list|,
name|child_offset_y
argument_list|)
operator|)
expr_stmt|;
name|child_offset_y
operator|=
literal|11
operator|+
literal|9
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x2 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|2
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_WINCE
argument_list|)
comment|//There is not enough screenspace to run the test in original size on Windows CE. We use smaller widgets.
name|child_offset_y
operator|=
literal|11
operator|+
literal|9
operator|+
literal|50
operator|+
literal|6
operator|+
literal|50
operator|+
literal|6
operator|+
literal|50
operator|+
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x3 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|3
operator|<<
name|QSize
argument_list|(
literal|50
argument_list|,
literal|50
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
operator|+
literal|50
operator|+
literal|6
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
operator|+
literal|50
operator|+
literal|6
operator|+
literal|50
operator|+
literal|6
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
operator|+
literal|50
operator|+
literal|6
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
operator|+
literal|50
operator|+
literal|6
operator|+
literal|50
operator|+
literal|6
argument_list|)
operator|)
expr_stmt|;
else|#
directive|else
name|child_offset_y
operator|=
literal|11
operator|+
literal|9
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x3 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|3
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|)
expr_stmt|;
endif|#
directive|endif
name|child_offset_y
operator|=
literal|11
operator|+
literal|9
operator|+
literal|100
operator|+
literal|6
operator|+
literal|100
operator|+
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x2 grid"
argument_list|)
operator|<<
literal|2
operator|<<
literal|2
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
comment|// toplevel
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|,
literal|11
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|,
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|)
comment|// children
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
operator|+
literal|100
operator|+
literal|6
argument_list|,
name|child_offset_y
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
argument_list|,
name|child_offset_y
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|20
operator|+
literal|100
operator|+
literal|6
argument_list|,
name|child_offset_y
operator|+
literal|100
operator|+
literal|6
argument_list|)
operator|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|spacingsAndMargins
name|void
name|tst_QGridLayout
operator|::
name|spacingsAndMargins
parameter_list|()
block|{
comment|/*     The test tests a gridlayout as a child of a top-level widget,     and then a gridlayout as a child of a non-toplevel widget.      The expectedpositions should then contain the list of widget positions in the     first gridlayout, then followed by a list of widget positions in the second gridlayout. */
name|QFETCH
argument_list|(
name|int
argument_list|,
name|columns
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|rows
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QSize
argument_list|,
name|sizehint
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|PointList
argument_list|,
name|expectedpositions
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
operator|new
name|Qt42Style
argument_list|)
expr_stmt|;
name|QWidget
name|toplevel
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|toplevel
argument_list|)
expr_stmt|;
name|QVBoxLayout
name|vbox
argument_list|(
operator|&
name|toplevel
argument_list|)
decl_stmt|;
name|QGridLayout
name|grid1
decl_stmt|;
name|vbox
operator|.
name|addLayout
argument_list|(
operator|&
name|grid1
argument_list|)
expr_stmt|;
comment|// a layout with a top-level parent widget
name|QList
argument_list|<
name|QPointer
argument_list|<
name|SizeHinterFrame
argument_list|>
argument_list|>
name|sizehinters
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|rows
condition|;
operator|++
name|i
control|)
block|{
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|columns
condition|;
operator|++
name|j
control|)
block|{
name|SizeHinterFrame
modifier|*
name|sh
init|=
operator|new
name|SizeHinterFrame
argument_list|(
name|sizehint
argument_list|)
decl_stmt|;
name|sh
operator|->
name|setMinimumSizeHint
argument_list|(
name|sizehint
argument_list|)
expr_stmt|;
name|sizehinters
operator|.
name|append
argument_list|(
name|sh
argument_list|)
expr_stmt|;
name|grid1
operator|.
name|addWidget
argument_list|(
name|sh
argument_list|,
name|i
argument_list|,
name|j
argument_list|)
expr_stmt|;
block|}
block|}
comment|// Add the child widget
name|QWidget
name|widget
decl_stmt|;
name|vbox
operator|.
name|addWidget
argument_list|(
operator|&
name|widget
argument_list|)
expr_stmt|;
name|QGridLayout
name|grid2
decl_stmt|;
name|widget
operator|.
name|setLayout
argument_list|(
operator|&
name|grid2
argument_list|)
expr_stmt|;
comment|// add a layout to the child widget
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|rows
condition|;
operator|++
name|i
control|)
block|{
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|columns
condition|;
operator|++
name|j
control|)
block|{
name|SizeHinterFrame
modifier|*
name|sh
init|=
operator|new
name|SizeHinterFrame
argument_list|(
name|sizehint
argument_list|)
decl_stmt|;
name|sh
operator|->
name|setMinimumSizeHint
argument_list|(
name|sizehint
argument_list|)
expr_stmt|;
name|sizehinters
operator|.
name|append
argument_list|(
name|sh
argument_list|)
expr_stmt|;
name|grid2
operator|.
name|addWidget
argument_list|(
name|sh
argument_list|,
name|i
argument_list|,
name|j
argument_list|)
expr_stmt|;
block|}
block|}
name|grid1
operator|.
name|setColumnStretch
argument_list|(
name|columns
operator|-
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|grid1
operator|.
name|setRowStretch
argument_list|(
name|rows
operator|-
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|toplevel
operator|.
name|showNormal
argument_list|()
expr_stmt|;
name|toplevel
operator|.
name|adjustSize
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTest
operator|::
name|qWaitForWindowExposed
argument_list|(
operator|&
name|toplevel
argument_list|)
argument_list|)
expr_stmt|;
name|QSize
name|topsize
init|=
name|toplevel
operator|.
name|size
argument_list|()
decl_stmt|;
name|QSize
name|minimumsize
init|=
name|vbox
operator|.
name|totalMinimumSize
argument_list|()
decl_stmt|;
if|if
condition|(
name|topsize
operator|.
name|width
argument_list|()
operator|<
name|minimumsize
operator|.
name|width
argument_list|()
operator|||
name|topsize
operator|.
name|height
argument_list|()
operator|<
name|minimumsize
operator|.
name|height
argument_list|()
condition|)
name|QSKIP
argument_list|(
literal|"The screen is too small to run this test case"
argument_list|)
expr_stmt|;
comment|// We are relying on the order here...
for|for
control|(
name|int
name|pi
init|=
literal|0
init|;
name|pi
operator|<
name|sizehinters
operator|.
name|count
argument_list|()
condition|;
operator|++
name|pi
control|)
block|{
name|QPoint
name|pt
init|=
name|sizehinters
operator|.
name|at
argument_list|(
name|pi
argument_list|)
operator|->
name|mapTo
argument_list|(
operator|&
name|toplevel
argument_list|,
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|pt
argument_list|,
name|expectedpositions
operator|.
name|at
argument_list|(
name|pi
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_struct
DECL|struct|SizeInfo
struct|struct
name|SizeInfo
block|{
DECL|function|SizeInfo
name|SizeInfo
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|expected
parameter_list|,
specifier|const
name|QSize
modifier|&
name|sh
parameter_list|,
specifier|const
name|QSize
modifier|&
name|minimumSize
init|=
name|QSize
argument_list|()
parameter_list|,
specifier|const
name|QSize
modifier|&
name|maximumSize
init|=
name|QSize
argument_list|()
parameter_list|,
name|int
name|numPixelsToCover
init|=
operator|-
literal|1
parameter_list|)
block|{
name|expectedPos
operator|=
name|expected
expr_stmt|;
name|sizeHint
operator|=
name|sh
expr_stmt|;
name|minSize
operator|=
name|minimumSize
expr_stmt|;
name|maxSize
operator|=
name|maximumSize
expr_stmt|;
name|hfwNumPixels
operator|=
name|numPixelsToCover
expr_stmt|;
block|}
DECL|function|SizeInfo
name|SizeInfo
parameter_list|(
specifier|const
name|QRect
modifier|&
name|expected
parameter_list|,
specifier|const
name|QSize
modifier|&
name|sh
parameter_list|,
specifier|const
name|QSize
modifier|&
name|minimumSize
init|=
name|QSize
argument_list|()
parameter_list|,
specifier|const
name|QSize
modifier|&
name|maximumSize
init|=
name|QSize
argument_list|()
parameter_list|,
name|int
name|numPixelsToCover
init|=
operator|-
literal|1
parameter_list|)
block|{
name|expectedPos
operator|=
name|expected
operator|.
name|topLeft
argument_list|()
expr_stmt|;
name|expectedSize
operator|=
name|expected
operator|.
name|size
argument_list|()
expr_stmt|;
name|sizeHint
operator|=
name|sh
expr_stmt|;
name|minSize
operator|=
name|minimumSize
expr_stmt|;
name|maxSize
operator|=
name|maximumSize
expr_stmt|;
name|hfwNumPixels
operator|=
name|numPixelsToCover
expr_stmt|;
block|}
DECL|function|SizeInfo
name|SizeInfo
parameter_list|(
specifier|const
name|SizeInfo
modifier|&
name|other
parameter_list|)
block|{
operator|(
operator|*
name|this
operator|)
operator|=
name|other
expr_stmt|;
block|}
DECL|function|operator =
name|SizeInfo
modifier|&
name|operator
name|=
parameter_list|(
specifier|const
name|SizeInfo
modifier|&
name|other
parameter_list|)
block|{
name|expectedPos
operator|=
name|other
operator|.
name|expectedPos
expr_stmt|;
name|expectedSize
operator|=
name|other
operator|.
name|expectedSize
expr_stmt|;
name|sizeHint
operator|=
name|other
operator|.
name|sizeHint
expr_stmt|;
name|minSize
operator|=
name|other
operator|.
name|minSize
expr_stmt|;
name|maxSize
operator|=
name|other
operator|.
name|maxSize
expr_stmt|;
name|hfwNumPixels
operator|=
name|other
operator|.
name|hfwNumPixels
expr_stmt|;
return|return
operator|(
operator|*
name|this
operator|)
return|;
block|}
DECL|member|expectedPos
name|QPoint
name|expectedPos
decl_stmt|;
DECL|member|expectedSize
name|QSize
name|expectedSize
decl_stmt|;
DECL|member|sizeHint
name|QSize
name|sizeHint
decl_stmt|;
DECL|member|minSize
name|QSize
name|minSize
decl_stmt|;
DECL|member|maxSize
name|QSize
name|maxSize
decl_stmt|;
DECL|member|hfwNumPixels
name|int
name|hfwNumPixels
decl_stmt|;
block|}
struct|;
end_struct
begin_typedef
DECL|typedef|SizeInfoList
typedef|typedef
name|QList
argument_list|<
name|SizeInfo
argument_list|>
name|SizeInfoList
typedef|;
end_typedef
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|SizeInfoList
argument_list|)
end_macro
begin_function
DECL|function|minMaxSize_data
name|void
name|tst_QGridLayout
operator|::
name|minMaxSize_data
parameter_list|()
block|{
comment|// input
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"stylename"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"columns"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"rows"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"sizePolicy"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSize
argument_list|>
argument_list|(
literal|"fixedSize"
argument_list|)
expr_stmt|;
comment|//input and expected output
name|QTest
operator|::
name|addColumn
argument_list|<
name|SizeInfoList
argument_list|>
argument_list|(
literal|"sizeinfos"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"3x1 grid, extend to minimumSize"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|3
operator|<<
literal|1
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Minimum
argument_list|)
operator|<<
name|QSize
argument_list|(
literal|152
argument_list|,
literal|50
argument_list|)
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QRect
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|,
literal|43
argument_list|,
literal|30
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|75
argument_list|,
literal|75
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QRect
argument_list|(
literal|10
operator|+
literal|45
argument_list|,
literal|10
argument_list|,
literal|43
argument_list|,
literal|30
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|75
argument_list|,
literal|75
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QRect
argument_list|(
literal|10
operator|+
literal|45
operator|+
literal|44
argument_list|,
literal|10
argument_list|,
literal|42
argument_list|,
literal|30
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|75
argument_list|,
literal|75
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x1 grid, extend to minimumSize"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|1
operator|<<
literal|1
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x1 grid, extend to minimumSize"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|2
operator|<<
literal|1
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
operator|+
literal|100
operator|+
literal|1
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x1 grid, extend to minimumSize, windows"
argument_list|)
operator|<<
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"windows"
argument_list|)
operator|<<
literal|2
operator|<<
literal|1
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|11
operator|+
literal|100
operator|+
literal|6
argument_list|,
literal|11
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x2 grid, extend to minimumSize"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|1
operator|<<
literal|2
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
operator|+
literal|100
operator|+
literal|1
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x1 grid, crop to maximumSize"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|2
operator|<<
literal|1
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|110
argument_list|,
literal|110
argument_list|)
argument_list|,
name|QSize
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
operator|+
literal|100
operator|+
literal|1
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x2 grid, crop to maximumSize"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|1
operator|<<
literal|2
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|110
argument_list|,
literal|110
argument_list|)
argument_list|,
name|QSize
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
operator|+
literal|100
operator|+
literal|1
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|90
argument_list|,
literal|90
argument_list|)
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x3 grid, heightForWidth"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|1
operator|<<
literal|3
operator|<<
name|int
argument_list|(
name|QSizePolicy
operator|::
name|Preferred
argument_list|)
operator|<<
name|QSize
argument_list|()
operator|<<
operator|(
name|SizeInfoList
argument_list|()
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|QSize
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|200
argument_list|,
literal|100
argument_list|)
argument_list|,
name|QSize
argument_list|()
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
operator|+
literal|100
operator|+
literal|1
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|,
name|QSize
argument_list|()
argument_list|,
name|QSize
argument_list|()
argument_list|,
literal|100
operator|*
literal|100
argument_list|)
operator|<<
name|SizeInfo
argument_list|(
name|QPoint
argument_list|(
literal|10
argument_list|,
literal|10
operator|+
literal|100
operator|+
literal|1
operator|+
literal|50
operator|+
literal|1
argument_list|)
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|,
name|QSize
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
argument_list|)
operator|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|minMaxSize
name|void
name|tst_QGridLayout
operator|::
name|minMaxSize
parameter_list|()
block|{
comment|/*     The test tests a gridlayout as a child of a top-level widget */
comment|// input
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|stylename
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|columns
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|rows
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|sizePolicy
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QSize
argument_list|,
name|fixedSize
argument_list|)
expr_stmt|;
comment|//input and expected output
name|QFETCH
argument_list|(
name|SizeInfoList
argument_list|,
name|sizeinfos
argument_list|)
expr_stmt|;
name|QStyle
modifier|*
name|style
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|stylename
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|Qt42Style
modifier|*
name|s
init|=
operator|new
name|Qt42Style
decl_stmt|;
name|s
operator|->
name|margin_toplevel
operator|=
literal|10
expr_stmt|;
name|s
operator|->
name|margin
operator|=
literal|5
expr_stmt|;
name|s
operator|->
name|spacing
operator|=
literal|1
expr_stmt|;
name|style
operator|=
cast|static_cast
argument_list|<
name|QStyle
operator|*
argument_list|>
argument_list|(
name|s
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|style
operator|=
name|QStyleFactory
operator|::
name|create
argument_list|(
name|stylename
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|style
condition|)
block|{
name|QSKIP
argument_list|(
name|qPrintable
argument_list|(
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"Qt has been compiled without style: %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|stylename
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|m_grid
condition|)
name|m_grid
operator|=
operator|new
name|QGridLayout
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|m_toplevel
condition|)
block|{
name|m_toplevel
operator|=
operator|new
name|QWidget
argument_list|()
expr_stmt|;
name|setFrameless
argument_list|(
name|m_toplevel
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|fixedSize
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|m_toplevel
operator|->
name|setFixedSize
argument_list|(
name|fixedSize
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|m_toplevel
operator|->
name|setMinimumSize
argument_list|(
name|QSize
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|m_toplevel
operator|->
name|setMaximumSize
argument_list|(
name|QSize
argument_list|(
name|QWIDGETSIZE_MAX
argument_list|,
name|QWIDGETSIZE_MAX
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|// Do a two-pass one using the real testdata, the other pass enables heightForWidth
comment|// on the widget, but the heightForWidth() function just return sizeHint().width()
for|for
control|(
name|int
name|pass
init|=
literal|0
init|;
name|pass
operator|<
literal|2
condition|;
operator|++
name|pass
control|)
block|{
name|m_toplevel
operator|->
name|hide
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|20
argument_list|)
expr_stmt|;
comment|// Test if removeItem uninitializes data properly
while|while
condition|(
name|m_grid
operator|->
name|count
argument_list|()
condition|)
block|{
name|QLayoutItem
modifier|*
name|item
init|=
name|m_grid
operator|->
name|itemAt
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|m_grid
operator|->
name|removeItem
argument_list|(
name|item
argument_list|)
expr_stmt|;
operator|delete
name|item
operator|->
name|widget
argument_list|()
expr_stmt|;
operator|delete
name|item
expr_stmt|;
block|}
name|m_toplevel
operator|->
name|setLayout
argument_list|(
name|m_grid
argument_list|)
expr_stmt|;
comment|// a layout with a top-level parent widget
name|QList
argument_list|<
name|QPointer
argument_list|<
name|SizeHinterFrame
argument_list|>
argument_list|>
name|sizehinters
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|rows
condition|;
operator|++
name|i
control|)
block|{
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|columns
condition|;
operator|++
name|j
control|)
block|{
name|SizeInfo
name|si
init|=
name|sizeinfos
operator|.
name|at
argument_list|(
name|sizehinters
operator|.
name|count
argument_list|()
argument_list|)
decl_stmt|;
name|int
name|numpixels
init|=
name|si
operator|.
name|hfwNumPixels
decl_stmt|;
if|if
condition|(
name|pass
operator|==
literal|1
operator|&&
name|numpixels
operator|==
operator|-
literal|1
condition|)
name|numpixels
operator|=
operator|-
literal|2
expr_stmt|;
comment|//### yuk, (and don't fake it if it already tests sizehint)
name|SizeHinterFrame
modifier|*
name|sh
init|=
operator|new
name|SizeHinterFrame
argument_list|(
name|si
operator|.
name|sizeHint
argument_list|,
name|numpixels
argument_list|)
decl_stmt|;
name|QSizePolicy
name|sp
init|=
name|sh
operator|->
name|sizePolicy
argument_list|()
decl_stmt|;
name|sp
operator|.
name|setHorizontalPolicy
argument_list|(
operator|(
name|QSizePolicy
operator|::
name|Policy
operator|)
name|sizePolicy
argument_list|)
expr_stmt|;
name|sh
operator|->
name|setSizePolicy
argument_list|(
name|sp
argument_list|)
expr_stmt|;
name|sh
operator|->
name|setParent
argument_list|(
name|m_toplevel
argument_list|)
expr_stmt|;
if|if
condition|(
name|si
operator|.
name|minSize
operator|.
name|isValid
argument_list|()
condition|)
name|sh
operator|->
name|setMinimumSize
argument_list|(
name|si
operator|.
name|minSize
argument_list|)
expr_stmt|;
if|if
condition|(
name|si
operator|.
name|maxSize
operator|.
name|isValid
argument_list|()
condition|)
name|sh
operator|->
name|setMaximumSize
argument_list|(
name|si
operator|.
name|maxSize
argument_list|)
expr_stmt|;
name|sizehinters
operator|.
name|append
argument_list|(
name|sh
argument_list|)
expr_stmt|;
name|m_grid
operator|->
name|addWidget
argument_list|(
name|sh
argument_list|,
name|i
argument_list|,
name|j
argument_list|)
expr_stmt|;
block|}
block|}
name|m_toplevel
operator|->
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTest
operator|::
name|qWaitForWindowExposed
argument_list|(
name|m_toplevel
argument_list|)
argument_list|)
expr_stmt|;
name|m_toplevel
operator|->
name|adjustSize
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|240
argument_list|)
expr_stmt|;
comment|// wait for the implicit adjustSize
comment|// If the following fails we might have to wait longer.
comment|// If that does not help there is likely a problem with the implicit adjustSize in show()
if|if
condition|(
operator|!
name|fixedSize
operator|.
name|isValid
argument_list|()
condition|)
block|{
comment|// Note that this can fail if the desktop has large fonts on windows.
name|QTRY_COMPARE
argument_list|(
name|m_toplevel
operator|->
name|size
argument_list|()
argument_list|,
name|m_toplevel
operator|->
name|sizeHint
argument_list|()
argument_list|)
expr_stmt|;
block|}
comment|// We are relying on the order here...
for|for
control|(
name|int
name|pi
init|=
literal|0
init|;
name|pi
operator|<
name|sizehinters
operator|.
name|count
argument_list|()
condition|;
operator|++
name|pi
control|)
block|{
name|QPoint
name|pt
init|=
name|sizehinters
operator|.
name|at
argument_list|(
name|pi
argument_list|)
operator|->
name|mapTo
argument_list|(
name|m_toplevel
argument_list|,
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|pt
argument_list|,
name|sizeinfos
operator|.
name|at
argument_list|(
name|pi
argument_list|)
operator|.
name|expectedPos
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function
begin_class
DECL|class|CustomLayoutStyle
class|class
name|CustomLayoutStyle
super|:
specifier|public
name|QProxyStyle
block|{
name|Q_OBJECT
public|public:
DECL|function|CustomLayoutStyle
name|CustomLayoutStyle
parameter_list|()
member_init_list|:
name|QProxyStyle
argument_list|(
name|QStyleFactory
operator|::
name|create
argument_list|(
literal|"windows"
argument_list|)
argument_list|)
block|{
name|hspacing
operator|=
literal|5
expr_stmt|;
name|vspacing
operator|=
literal|10
expr_stmt|;
name|reimplementSubelementRect
operator|=
literal|false
expr_stmt|;
block|}
specifier|virtual
name|int
name|pixelMetric
parameter_list|(
name|PixelMetric
name|metric
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|option
init|=
literal|0
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
init|=
literal|0
parameter_list|)
specifier|const
function_decl|;
specifier|virtual
name|QRect
name|subElementRect
parameter_list|(
name|SubElement
name|sr
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|opt
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
parameter_list|)
specifier|const
function_decl|;
DECL|member|hspacing
name|int
name|hspacing
decl_stmt|;
DECL|member|vspacing
name|int
name|vspacing
decl_stmt|;
DECL|member|reimplementSubelementRect
name|bool
name|reimplementSubelementRect
decl_stmt|;
name|int
name|layoutSpacing
parameter_list|(
name|QSizePolicy
operator|::
name|ControlType
name|control1
parameter_list|,
name|QSizePolicy
operator|::
name|ControlType
name|control2
parameter_list|,
name|Qt
operator|::
name|Orientation
name|orientation
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|option
init|=
literal|0
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
init|=
literal|0
parameter_list|)
specifier|const
function_decl|;
block|}
class|;
end_class
begin_function
DECL|function|subElementRect
name|QRect
name|CustomLayoutStyle
operator|::
name|subElementRect
parameter_list|(
name|SubElement
name|sr
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|opt
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
parameter_list|)
specifier|const
block|{
name|QRect
name|rect
decl_stmt|;
if|if
condition|(
name|reimplementSubelementRect
condition|)
block|{
switch|switch
condition|(
name|sr
condition|)
block|{
case|case
name|SE_FrameLayoutItem
case|:
name|rect
operator|=
name|opt
operator|->
name|rect
expr_stmt|;
name|rect
operator|.
name|adjust
argument_list|(
operator|+
literal|4
argument_list|,
operator|+
literal|9
argument_list|,
operator|-
literal|4
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// The hspacing=5 and vspacing=10, so we keep it safe.
break|break;
case|case
name|SE_GroupBoxLayoutItem
case|:
name|rect
operator|=
name|opt
operator|->
name|rect
operator|.
name|adjusted
argument_list|(
literal|0
argument_list|,
operator|+
literal|10
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
if|if
condition|(
name|rect
operator|.
name|isNull
argument_list|()
condition|)
name|rect
operator|=
name|QProxyStyle
operator|::
name|subElementRect
argument_list|(
name|sr
argument_list|,
name|opt
argument_list|,
name|widget
argument_list|)
expr_stmt|;
return|return
name|rect
return|;
block|}
end_function
begin_define
DECL|macro|CT1
define|#
directive|define
name|CT1
parameter_list|(
name|c
parameter_list|)
value|CT2(c, c)
end_define
begin_define
DECL|macro|CT2
define|#
directive|define
name|CT2
parameter_list|(
name|c1
parameter_list|,
name|c2
parameter_list|)
value|((uint)c1<< 16) | (uint)c2
end_define
begin_function
DECL|function|layoutSpacing
name|int
name|CustomLayoutStyle
operator|::
name|layoutSpacing
parameter_list|(
name|QSizePolicy
operator|::
name|ControlType
name|control1
parameter_list|,
name|QSizePolicy
operator|::
name|ControlType
name|control2
parameter_list|,
name|Qt
operator|::
name|Orientation
name|orientation
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
comment|/*option = 0*/
parameter_list|,
specifier|const
name|QWidget
modifier|*
comment|/*widget = 0*/
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|orientation
operator|==
name|Qt
operator|::
name|Horizontal
condition|)
block|{
switch|switch
condition|(
name|CT2
argument_list|(
name|control1
argument_list|,
name|control2
argument_list|)
condition|)
block|{
case|case
name|CT1
argument_list|(
name|QSizePolicy
operator|::
name|PushButton
argument_list|)
case|:
return|return
literal|2
return|;
break|break;
block|}
return|return
literal|5
return|;
block|}
else|else
block|{
switch|switch
condition|(
name|CT2
argument_list|(
name|control1
argument_list|,
name|control2
argument_list|)
condition|)
block|{
case|case
name|CT1
argument_list|(
name|QSizePolicy
operator|::
name|RadioButton
argument_list|)
case|:
return|return
literal|2
return|;
break|break;
block|}
return|return
literal|10
return|;
block|}
block|}
end_function
begin_function
DECL|function|pixelMetric
name|int
name|CustomLayoutStyle
operator|::
name|pixelMetric
parameter_list|(
name|PixelMetric
name|metric
parameter_list|,
specifier|const
name|QStyleOption
modifier|*
name|option
comment|/*= 0*/
parameter_list|,
specifier|const
name|QWidget
modifier|*
name|widget
comment|/*= 0*/
parameter_list|)
specifier|const
block|{
switch|switch
condition|(
name|metric
condition|)
block|{
case|case
name|PM_LayoutLeftMargin
case|:
return|return
literal|0
return|;
break|break;
case|case
name|PM_LayoutTopMargin
case|:
return|return
literal|3
return|;
break|break;
case|case
name|PM_LayoutRightMargin
case|:
return|return
literal|6
return|;
break|break;
case|case
name|PM_LayoutBottomMargin
case|:
return|return
literal|9
return|;
break|break;
case|case
name|PM_LayoutHorizontalSpacing
case|:
return|return
name|hspacing
return|;
case|case
name|PM_LayoutVerticalSpacing
case|:
return|return
name|vspacing
return|;
break|break;
default|default:
break|break;
block|}
return|return
name|QProxyStyle
operator|::
name|pixelMetric
argument_list|(
name|metric
argument_list|,
name|option
argument_list|,
name|widget
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|styleDependentSpacingsAndMargins_data
name|void
name|tst_QGridLayout
operator|::
name|styleDependentSpacingsAndMargins_data
parameter_list|()
block|{
comment|// input
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"columns"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"rows"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QSize
argument_list|>
argument_list|(
literal|"sizehint"
argument_list|)
expr_stmt|;
comment|// expected
name|QTest
operator|::
name|addColumn
argument_list|<
name|PointList
argument_list|>
argument_list|(
literal|"expectedpositions"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x1 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|1
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x1 grid"
argument_list|)
operator|<<
literal|2
operator|<<
literal|1
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|100
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"3x1 grid"
argument_list|)
operator|<<
literal|3
operator|<<
literal|1
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|100
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|2
operator|*
literal|105
argument_list|,
literal|3
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x2 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|2
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|100
operator|+
literal|10
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x3 grid"
argument_list|)
operator|<<
literal|1
operator|<<
literal|3
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|100
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|2
operator|*
literal|110
argument_list|)
operator|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2x2 grid"
argument_list|)
operator|<<
literal|2
operator|<<
literal|2
operator|<<
name|QSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|100
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|100
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|100
operator|+
literal|5
argument_list|,
literal|3
operator|+
literal|100
operator|+
literal|10
argument_list|)
operator|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|styleDependentSpacingsAndMargins
name|void
name|tst_QGridLayout
operator|::
name|styleDependentSpacingsAndMargins
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|int
argument_list|,
name|columns
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|rows
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QSize
argument_list|,
name|sizehint
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|PointList
argument_list|,
name|expectedpositions
argument_list|)
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
operator|new
name|CustomLayoutStyle
argument_list|()
argument_list|)
expr_stmt|;
name|QWidget
name|widget
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|widget
argument_list|)
expr_stmt|;
name|QGridLayout
name|layout
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|QList
argument_list|<
name|QPointer
argument_list|<
name|SizeHinterFrame
argument_list|>
argument_list|>
name|sizehinters
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|rows
condition|;
operator|++
name|i
control|)
block|{
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|columns
condition|;
operator|++
name|j
control|)
block|{
name|SizeHinterFrame
modifier|*
name|sh
init|=
operator|new
name|SizeHinterFrame
argument_list|(
name|sizehint
argument_list|)
decl_stmt|;
name|sh
operator|->
name|setSizePolicy
argument_list|(
name|QSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
argument_list|)
expr_stmt|;
name|sh
operator|->
name|setParent
argument_list|(
operator|&
name|widget
argument_list|)
expr_stmt|;
name|sizehinters
operator|.
name|append
argument_list|(
name|sh
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
name|sh
argument_list|,
name|i
argument_list|,
name|j
argument_list|)
expr_stmt|;
block|}
block|}
name|layout
operator|.
name|setColumnStretch
argument_list|(
name|columns
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setRowStretch
argument_list|(
name|rows
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|widget
operator|.
name|show
argument_list|()
expr_stmt|;
name|widget
operator|.
name|adjustSize
argument_list|()
expr_stmt|;
name|QApplication
operator|::
name|processEvents
argument_list|()
expr_stmt|;
for|for
control|(
name|int
name|pi
init|=
literal|0
init|;
name|pi
operator|<
name|expectedpositions
operator|.
name|count
argument_list|()
condition|;
operator|++
name|pi
control|)
block|{
name|QCOMPARE
argument_list|(
name|sizehinters
operator|.
name|at
argument_list|(
name|pi
argument_list|)
operator|->
name|pos
argument_list|()
argument_list|,
name|expectedpositions
operator|.
name|at
argument_list|(
name|pi
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|layoutSpacing_data
name|void
name|tst_QGridLayout
operator|::
name|layoutSpacing_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QWidget
operator|*
argument_list|>
argument_list|(
literal|"widget"
argument_list|)
expr_stmt|;
comment|// expected
name|QTest
operator|::
name|addColumn
argument_list|<
name|PointList
argument_list|>
argument_list|(
literal|"expectedpositions"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"hSpacing"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"vSpacing"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"customSubElementRect"
argument_list|)
expr_stmt|;
name|CustomLayoutStyle
modifier|*
name|style
init|=
operator|new
name|CustomLayoutStyle
argument_list|()
decl_stmt|;
block|{
comment|// If the layoutSpacing is negative, the layouting code will call
comment|// layoutSpacing()
name|style
operator|->
name|hspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|false
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QVBoxLayout
modifier|*
name|layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|QRadioButton
modifier|*
name|rb1
init|=
operator|new
name|QRadioButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Radio 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QRadioButton
modifier|*
name|rb2
init|=
operator|new
name|QRadioButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Radio 2"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QRadioButton
modifier|*
name|rb3
init|=
operator|new
name|QRadioButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Radio 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|rb1
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|rb2
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|rb3
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|b1
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|b2
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 2"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|b3
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|b1
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|b2
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|b3
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addStretch
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|int
name|rh
init|=
name|rb1
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
decl_stmt|;
name|int
name|ph
init|=
name|b1
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1x6, radio + push buttons"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|rh
operator|+
literal|2
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|2
operator|*
operator|(
name|rh
operator|+
literal|2
operator|)
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|2
operator|*
operator|(
name|rh
operator|+
literal|2
operator|)
operator|+
operator|(
name|rh
operator|+
literal|10
operator|)
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|2
operator|*
operator|(
name|rh
operator|+
literal|2
operator|)
operator|+
operator|(
name|rh
operator|+
literal|10
operator|+
name|ph
operator|+
literal|10
operator|)
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
literal|2
operator|*
operator|(
name|rh
operator|+
literal|2
operator|)
operator|+
name|rh
operator|+
literal|10
operator|+
literal|2
operator|*
operator|(
name|ph
operator|+
literal|10
operator|)
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|{
name|style
operator|->
name|hspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|false
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QHBoxLayout
modifier|*
name|layout
init|=
operator|new
name|QHBoxLayout
argument_list|()
decl_stmt|;
name|QLineEdit
modifier|*
name|le1
init|=
operator|new
name|QLineEdit
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QLineEdit
modifier|*
name|le2
init|=
operator|new
name|QLineEdit
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QLineEdit
modifier|*
name|le3
init|=
operator|new
name|QLineEdit
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|le1
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|le2
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|le3
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|b1
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|b2
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 2"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|b3
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|b1
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|b2
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|b3
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
operator||
name|Qt
operator|::
name|AlignLeft
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addStretch
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|int
name|lw
init|=
name|le1
operator|->
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
decl_stmt|;
name|int
name|pw
init|=
name|b1
operator|->
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"6x1, line edit + push buttons"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|lw
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|2
operator|*
operator|(
name|lw
operator|+
literal|5
operator|)
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|3
operator|*
operator|(
name|lw
operator|+
literal|5
operator|)
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|3
operator|*
operator|(
name|lw
operator|+
literal|5
operator|)
operator|+
literal|1
operator|*
operator|(
name|pw
operator|+
literal|2
operator|)
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
literal|3
operator|*
operator|(
name|lw
operator|+
literal|5
operator|)
operator|+
literal|2
operator|*
operator|(
name|pw
operator|+
literal|2
operator|)
argument_list|,
literal|3
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|{
name|style
operator|->
name|hspacing
operator|=
literal|5
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|10
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|true
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QVBoxLayout
modifier|*
name|layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|QPushButton
modifier|*
name|pb1
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QGroupBox
modifier|*
name|g1
init|=
operator|new
name|QGroupBox
argument_list|(
name|QLatin1String
argument_list|(
literal|"GroupBox 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QRadioButton
modifier|*
name|rb
init|=
operator|new
name|QRadioButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Radio 1"
argument_list|)
argument_list|,
name|g1
argument_list|)
decl_stmt|;
name|QVBoxLayout
modifier|*
name|g1layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|g1layout
operator|->
name|addWidget
argument_list|(
name|rb
argument_list|)
expr_stmt|;
name|g1
operator|->
name|setLayout
argument_list|(
name|g1layout
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|pb3
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|g1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb3
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|QSize
name|psh
init|=
name|pb1
operator|->
name|sizeHint
argument_list|()
decl_stmt|;
name|QSize
name|gsh
init|=
name|g1
operator|->
name|sizeHint
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"subElementRect1"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|psh
operator|.
name|height
argument_list|()
operator|+
literal|10
operator|-
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|psh
operator|.
name|height
argument_list|()
operator|+
literal|10
operator|-
literal|10
operator|+
name|gsh
operator|.
name|height
argument_list|()
operator|+
literal|10
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|{
name|style
operator|->
name|hspacing
operator|=
literal|5
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|10
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|true
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|QFont
name|font
decl_stmt|;
name|font
operator|.
name|setPixelSize
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|w
operator|->
name|setFont
argument_list|(
name|font
argument_list|)
expr_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QGridLayout
modifier|*
name|layout
init|=
operator|new
name|QGridLayout
argument_list|()
decl_stmt|;
name|QPushButton
modifier|*
name|pb1
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb2
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 2"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb3
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb4
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 4"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb3
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb4
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|QFrame
modifier|*
name|f1
init|=
operator|new
name|QFrame
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|f1
operator|->
name|setFrameStyle
argument_list|(
name|QFrame
operator|::
name|Box
operator||
name|QFrame
operator|::
name|Plain
argument_list|)
expr_stmt|;
name|f1
operator|->
name|setMinimumSize
argument_list|(
literal|100
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|f1
operator|->
name|setSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|f1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|pb6
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 6"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb7
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 7"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb8
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 8"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb9
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 9"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb6
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb7
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb8
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb9
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|AlignTop
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setColumnStretch
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|setRowStretch
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|int
name|c
index|[
literal|3
index|]
decl_stmt|;
name|c
index|[
literal|0
index|]
operator|=
name|pb1
operator|->
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
expr_stmt|;
name|c
index|[
literal|1
index|]
operator|=
name|f1
operator|->
name|minimumSize
argument_list|()
operator|.
name|width
argument_list|()
operator|-
literal|2
operator|*
literal|4
expr_stmt|;
name|c
index|[
literal|2
index|]
operator|=
name|pb3
operator|->
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
expr_stmt|;
name|int
name|r
index|[
literal|3
index|]
decl_stmt|;
name|r
index|[
literal|0
index|]
operator|=
name|pb1
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
name|pb4
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
name|pb7
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"subElementRect2"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|c
index|[
literal|0
index|]
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|c
index|[
literal|0
index|]
operator|+
literal|5
operator|+
name|c
index|[
literal|1
index|]
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|r
index|[
literal|0
index|]
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|c
index|[
literal|0
index|]
operator|+
literal|5
operator|-
literal|4
argument_list|,
literal|3
operator|+
name|r
index|[
literal|0
index|]
operator|+
literal|10
operator|-
literal|9
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|c
index|[
literal|0
index|]
operator|+
literal|5
operator|+
name|c
index|[
literal|1
index|]
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|r
index|[
literal|0
index|]
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|r
index|[
literal|0
index|]
operator|+
literal|10
operator|+
name|r
index|[
literal|1
index|]
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|c
index|[
literal|0
index|]
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|r
index|[
literal|0
index|]
operator|+
literal|10
operator|+
name|r
index|[
literal|1
index|]
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|c
index|[
literal|0
index|]
operator|+
literal|5
operator|+
name|c
index|[
literal|1
index|]
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|r
index|[
literal|0
index|]
operator|+
literal|10
operator|+
name|r
index|[
literal|1
index|]
operator|+
literal|10
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|{
name|style
operator|->
name|hspacing
operator|=
literal|5
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|10
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|true
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QVBoxLayout
modifier|*
name|layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|QPushButton
modifier|*
name|pb1
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QGroupBox
modifier|*
name|g1
init|=
operator|new
name|QGroupBox
argument_list|(
name|QLatin1String
argument_list|(
literal|"GroupBox 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QRadioButton
modifier|*
name|rb
init|=
operator|new
name|QRadioButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Radio 1"
argument_list|)
argument_list|,
name|g1
argument_list|)
decl_stmt|;
name|QVBoxLayout
modifier|*
name|g1layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|g1layout
operator|->
name|addWidget
argument_list|(
name|rb
argument_list|)
expr_stmt|;
name|g1
operator|->
name|setLayout
argument_list|(
name|g1layout
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|pb3
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|pb1
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|g1
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|pb3
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|g1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb3
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|QSize
name|psh
init|=
name|pb1
operator|->
name|sizeHint
argument_list|()
decl_stmt|;
name|QSize
name|gsh
init|=
name|g1
operator|->
name|sizeHint
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"subElementRect1, use widgetRect"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|psh
operator|.
name|height
argument_list|()
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|psh
operator|.
name|height
argument_list|()
operator|+
literal|10
operator|+
name|gsh
operator|.
name|height
argument_list|()
operator|+
literal|10
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|{
name|style
operator|->
name|hspacing
operator|=
literal|5
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|10
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|true
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QVBoxLayout
modifier|*
name|layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|QPushButton
modifier|*
name|pb1
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QGroupBox
modifier|*
name|g1
init|=
operator|new
name|QGroupBox
argument_list|(
name|QLatin1String
argument_list|(
literal|"GroupBox 1"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|QRadioButton
modifier|*
name|rb
init|=
operator|new
name|QRadioButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Radio 1"
argument_list|)
argument_list|,
name|g1
argument_list|)
decl_stmt|;
name|QVBoxLayout
modifier|*
name|g1layout
init|=
operator|new
name|QVBoxLayout
argument_list|()
decl_stmt|;
name|g1layout
operator|->
name|addWidget
argument_list|(
name|rb
argument_list|)
expr_stmt|;
name|g1
operator|->
name|setLayout
argument_list|(
name|g1layout
argument_list|)
expr_stmt|;
name|QPushButton
modifier|*
name|pb3
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"Push 3"
argument_list|)
argument_list|,
name|w
argument_list|)
decl_stmt|;
name|pb1
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|g1
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|pb3
operator|->
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_LayoutUsesWidgetRect
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|g1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|pb3
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|QSize
name|psh
init|=
name|pb1
operator|->
name|sizeHint
argument_list|()
decl_stmt|;
name|QSize
name|gsh
init|=
name|g1
operator|->
name|sizeHint
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"subElementRect1, use layoutItemRect"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|psh
operator|.
name|height
argument_list|()
operator|+
literal|10
operator|-
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|psh
operator|.
name|height
argument_list|()
operator|+
literal|10
operator|-
literal|10
operator|+
name|gsh
operator|.
name|height
argument_list|()
operator|+
literal|10
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|{
comment|/* A 3x4 gridlayout, modified arrowpad example:          *      [PB]          * [PB]      [PB]          *      |PB|          *      |  |          *      |  |          *          * Here the bottom pushbutton has a span          */
name|style
operator|->
name|hspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|false
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QGridLayout
modifier|*
name|layout
init|=
operator|new
name|QGridLayout
argument_list|()
decl_stmt|;
name|QPushButton
modifier|*
name|left
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|up
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|right
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|down
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|up
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|left
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|right
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|down
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|int
name|pw
init|=
name|up
operator|->
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
decl_stmt|;
name|int
name|ph
init|=
name|up
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"arrowpad with span"
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|pw
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|ph
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|pw
operator|+
literal|5
operator|+
name|pw
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|ph
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|pw
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|ph
operator|+
literal|10
operator|+
name|ph
operator|+
literal|10
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
for|for
control|(
name|int
name|yoff
init|=
literal|0
init|;
name|yoff
operator|<
literal|5
condition|;
operator|++
name|yoff
control|)
block|{
for|for
control|(
name|int
name|xoff
init|=
literal|0
init|;
name|xoff
operator|<
literal|5
condition|;
operator|++
name|xoff
control|)
block|{
comment|/* A 3x4 gridlayout, modified arrowpad example:              * [empty cells]              *      [PB]              * [PB]      [PB]              *      [PB]              *              * It has 0-4 empty rows at the top and 0-4 empty columns to the left.              */
name|style
operator|->
name|hspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
operator|-
literal|1
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
literal|false
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QWidget
modifier|*
name|w
init|=
operator|new
name|QWidget
argument_list|()
decl_stmt|;
name|setFrameless
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|QGridLayout
modifier|*
name|layout
init|=
operator|new
name|QGridLayout
argument_list|()
decl_stmt|;
name|QPushButton
modifier|*
name|left
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|up
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|right
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|down
init|=
operator|new
name|QPushButton
argument_list|(
name|w
argument_list|)
decl_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|up
argument_list|,
name|yoff
operator|+
literal|0
argument_list|,
name|xoff
operator|+
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|left
argument_list|,
name|yoff
operator|+
literal|1
argument_list|,
name|xoff
operator|+
literal|0
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|right
argument_list|,
name|yoff
operator|+
literal|1
argument_list|,
name|xoff
operator|+
literal|2
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|down
argument_list|,
name|yoff
operator|+
literal|2
argument_list|,
name|xoff
operator|+
literal|1
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|w
operator|->
name|setLayout
argument_list|(
name|layout
argument_list|)
expr_stmt|;
name|int
name|pw
init|=
name|up
operator|->
name|sizeHint
argument_list|()
operator|.
name|width
argument_list|()
decl_stmt|;
name|int
name|ph
init|=
name|up
operator|->
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
decl_stmt|;
name|QByteArray
name|testName
init|=
name|QString
operator|::
name|fromLatin1
argument_list|(
literal|"arrowpad with %1 empty rows, %2 empty columns"
argument_list|)
operator|.
name|arg
argument_list|(
name|yoff
argument_list|)
operator|.
name|arg
argument_list|(
name|xoff
argument_list|)
operator|.
name|toLatin1
argument_list|()
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
name|testName
operator|.
name|data
argument_list|()
argument_list|)
operator|<<
name|w
operator|<<
operator|(
name|PointList
argument_list|()
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|pw
operator|+
literal|5
argument_list|,
literal|3
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|3
operator|+
name|ph
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|pw
operator|+
literal|5
operator|+
name|pw
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|ph
operator|+
literal|10
argument_list|)
operator|<<
name|QPoint
argument_list|(
literal|0
operator|+
name|pw
operator|+
literal|5
argument_list|,
literal|3
operator|+
name|ph
operator|+
literal|10
operator|+
name|ph
operator|+
literal|10
argument_list|)
operator|)
operator|<<
name|style
operator|->
name|hspacing
operator|<<
name|style
operator|->
name|vspacing
operator|<<
name|style
operator|->
name|reimplementSubelementRect
expr_stmt|;
block|}
block|}
block|}
end_function
begin_function
DECL|function|layoutSpacing
name|void
name|tst_QGridLayout
operator|::
name|layoutSpacing
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QWidget
operator|*
argument_list|,
name|widget
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|PointList
argument_list|,
name|expectedpositions
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|hSpacing
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|vSpacing
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|customSubElementRect
argument_list|)
expr_stmt|;
name|QWidget
name|toplevel
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|toplevel
argument_list|)
expr_stmt|;
name|CustomLayoutStyle
modifier|*
name|style
init|=
operator|new
name|CustomLayoutStyle
argument_list|()
decl_stmt|;
name|style
operator|->
name|hspacing
operator|=
name|hSpacing
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
name|vSpacing
expr_stmt|;
name|style
operator|->
name|reimplementSubelementRect
operator|=
name|customSubElementRect
expr_stmt|;
name|QApplication
operator|::
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|widget
operator|->
name|setParent
argument_list|(
operator|&
name|toplevel
argument_list|)
expr_stmt|;
name|widget
operator|->
name|resize
argument_list|(
name|widget
operator|->
name|sizeHint
argument_list|()
argument_list|)
expr_stmt|;
name|toplevel
operator|.
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTest
operator|::
name|qWaitForWindowExposed
argument_list|(
operator|&
name|toplevel
argument_list|)
argument_list|)
expr_stmt|;
name|QLayout
modifier|*
name|layout
init|=
name|widget
operator|->
name|layout
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|layout
argument_list|)
expr_stmt|;
comment|//QTest::qWait(2000);
for|for
control|(
name|int
name|pi
init|=
literal|0
init|;
name|pi
operator|<
name|expectedpositions
operator|.
name|count
argument_list|()
condition|;
operator|++
name|pi
control|)
block|{
name|QLayoutItem
modifier|*
name|item
init|=
name|layout
operator|->
name|itemAt
argument_list|(
name|pi
argument_list|)
decl_stmt|;
comment|//qDebug()<< item->widget()->pos();
name|QCOMPARE
argument_list|(
name|item
operator|->
name|widget
argument_list|()
operator|->
name|pos
argument_list|()
argument_list|,
name|expectedpositions
operator|.
name|at
argument_list|(
name|pi
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|spacing
name|void
name|tst_QGridLayout
operator|::
name|spacing
parameter_list|()
block|{
name|QWidget
name|w
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|w
argument_list|)
expr_stmt|;
name|CustomLayoutStyle
modifier|*
name|style
init|=
operator|new
name|CustomLayoutStyle
argument_list|()
decl_stmt|;
name|style
operator|->
name|hspacing
operator|=
literal|5
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|10
expr_stmt|;
name|w
operator|.
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QGridLayout
name|grid
argument_list|(
operator|&
name|w
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|style
operator|->
name|hspacing
argument_list|,
name|grid
operator|.
name|horizontalSpacing
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|style
operator|->
name|vspacing
argument_list|,
name|grid
operator|.
name|verticalSpacing
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|grid
operator|.
name|setVerticalSpacing
argument_list|(
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
literal|5
argument_list|,
name|grid
operator|.
name|horizontalSpacing
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
literal|5
argument_list|,
name|grid
operator|.
name|verticalSpacing
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|grid
operator|.
name|setVerticalSpacing
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|style
operator|->
name|hspacing
argument_list|,
name|grid
operator|.
name|horizontalSpacing
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|style
operator|->
name|vspacing
argument_list|,
name|grid
operator|.
name|verticalSpacing
argument_list|()
argument_list|)
expr_stmt|;
name|style
operator|->
name|hspacing
operator|=
literal|5
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|5
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|grid
operator|.
name|setHorizontalSpacing
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|style
operator|->
name|vspacing
operator|=
literal|20
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|horizontalSpacing
argument_list|()
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|verticalSpacing
argument_list|()
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|grid
operator|.
name|setHorizontalSpacing
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|style
operator|->
name|hspacing
operator|=
literal|20
expr_stmt|;
name|QCOMPARE
argument_list|(
name|grid
operator|.
name|spacing
argument_list|()
argument_list|,
literal|20
argument_list|)
expr_stmt|;
operator|delete
name|style
expr_stmt|;
block|}
end_function
begin_function
DECL|function|populate
name|void
name|populate
parameter_list|(
name|QGridLayout
modifier|*
name|layout
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|kind
parameter_list|)
block|{
if|if
condition|(
name|kind
operator|==
literal|0
condition|)
block|{
name|QWidget
modifier|*
name|widget
init|=
operator|new
name|QWidget
decl_stmt|;
name|widget
operator|->
name|setFixedSize
argument_list|(
literal|100
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|layout
operator|->
name|addWidget
argument_list|(
name|widget
argument_list|,
name|row
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|kind
operator|==
literal|1
condition|)
block|{
name|layout
operator|->
name|addItem
argument_list|(
operator|new
name|QSpacerItem
argument_list|(
literal|10
argument_list|,
literal|10
argument_list|)
argument_list|,
name|row
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|spacerWithSpacing
name|void
name|tst_QGridLayout
operator|::
name|spacerWithSpacing
parameter_list|()
block|{
comment|// Tests all combinations of widget (w), spacer (s) and no layoutitem (-)
comment|// to see if they are laid out correctly.
comment|// Note that a combination of "s-" or "-s" should only give the height of "s"
specifier|const
name|int
name|expectedHeight
index|[]
init|=
block|{
literal|302
block|,
comment|// www
literal|211
block|,
comment|// wws
literal|201
block|,
comment|// ww-
literal|211
block|,
comment|// wsw
literal|120
block|,
comment|// wss
literal|110
block|,
comment|// ws-
literal|201
block|,
comment|// w-w
literal|110
block|,
comment|// w-s
literal|100
block|,
comment|// w--
literal|211
block|,
comment|// sww
literal|120
block|,
comment|// sws
literal|110
block|,
comment|// sw-
literal|120
block|,
comment|// ssw
literal|30
block|,
comment|// sss
literal|20
block|,
comment|// ss-
literal|110
block|,
comment|// s-w
literal|20
block|,
comment|// s-s
literal|10
block|,
comment|// s--
literal|201
block|,
comment|// -ww
literal|110
block|,
comment|// -ws
literal|100
block|,
comment|// -w-
literal|110
block|,
comment|// -sw
literal|20
block|,
comment|// -ss
literal|10
block|,
comment|// -s-
literal|100
block|,
comment|// --w
literal|10
block|,
comment|// --s
literal|000
comment|// ---
block|}
decl_stmt|;
name|int
name|ii
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|3
condition|;
operator|++
name|i
control|)
block|{
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
literal|3
condition|;
operator|++
name|j
control|)
block|{
for|for
control|(
name|int
name|k
init|=
literal|0
init|;
name|k
operator|<
literal|3
condition|;
operator|++
name|k
control|)
block|{
name|QWidget
name|window
decl_stmt|;
name|QGridLayout
name|layout
argument_list|(
operator|&
name|window
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setSpacing
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|layout
operator|.
name|setMargin
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|populate
argument_list|(
operator|&
name|layout
argument_list|,
literal|0
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|populate
argument_list|(
operator|&
name|layout
argument_list|,
literal|1
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|populate
argument_list|(
operator|&
name|layout
argument_list|,
literal|2
argument_list|,
name|k
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|window
operator|.
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
argument_list|,
name|expectedHeight
index|[
name|ii
index|]
argument_list|)
expr_stmt|;
operator|++
name|ii
expr_stmt|;
block|}
block|}
block|}
block|}
end_function
begin_function
DECL|function|contentsRect
name|void
name|tst_QGridLayout
operator|::
name|contentsRect
parameter_list|()
block|{
name|QWidget
name|w
decl_stmt|;
name|setFrameless
argument_list|(
operator|&
name|w
argument_list|)
expr_stmt|;
name|QGridLayout
name|grid
decl_stmt|;
name|w
operator|.
name|setLayout
argument_list|(
operator|&
name|grid
argument_list|)
expr_stmt|;
name|grid
operator|.
name|addWidget
argument_list|(
operator|new
name|QPushButton
argument_list|(
operator|&
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|w
operator|.
name|show
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|QTest
operator|::
name|qWaitForWindowExposed
argument_list|(
operator|&
name|w
argument_list|)
argument_list|)
expr_stmt|;
name|int
name|l
decl_stmt|,
name|t
decl_stmt|,
name|r
decl_stmt|,
name|b
decl_stmt|;
name|grid
operator|.
name|getContentsMargins
argument_list|(
operator|&
name|l
argument_list|,
operator|&
name|t
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|b
argument_list|)
expr_stmt|;
name|QRect
name|geom
init|=
name|grid
operator|.
name|geometry
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|geom
operator|.
name|adjusted
argument_list|(
operator|+
name|l
argument_list|,
operator|+
name|t
argument_list|,
operator|-
name|r
argument_list|,
operator|-
name|b
argument_list|)
argument_list|,
name|grid
operator|.
name|contentsRect
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|distributeMultiCell
name|void
name|tst_QGridLayout
operator|::
name|distributeMultiCell
parameter_list|()
block|{
name|QWidget
name|w
decl_stmt|;
name|Qt42Style
modifier|*
name|style
init|=
operator|new
name|Qt42Style
argument_list|()
decl_stmt|;
name|style
operator|->
name|spacing
operator|=
literal|9
expr_stmt|;
name|w
operator|.
name|setStyle
argument_list|(
name|style
argument_list|)
expr_stmt|;
name|QGridLayout
name|grid
decl_stmt|;
name|w
operator|.
name|setLayout
argument_list|(
operator|&
name|grid
argument_list|)
expr_stmt|;
name|SizeHinter
name|le1
argument_list|(
literal|200
argument_list|,
literal|20
argument_list|,
operator|&
name|w
argument_list|)
decl_stmt|;
name|le1
operator|.
name|setSizePolicy
argument_list|(
name|QSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
argument_list|)
expr_stmt|;
name|SizeHinter
name|le2
argument_list|(
literal|200
argument_list|,
literal|20
argument_list|,
operator|&
name|w
argument_list|)
decl_stmt|;
name|le2
operator|.
name|setSizePolicy
argument_list|(
name|QSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Expanding
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
argument_list|)
expr_stmt|;
name|SizeHinter
name|box
argument_list|(
literal|80
argument_list|,
literal|57
argument_list|,
operator|&
name|w
argument_list|)
decl_stmt|;
name|box
operator|.
name|setSizePolicy
argument_list|(
name|QSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Expanding
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|.
name|setMinimumSize
argument_list|(
literal|80
argument_list|,
literal|57
argument_list|)
expr_stmt|;
name|grid
operator|.
name|addWidget
argument_list|(
operator|&
name|le1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|grid
operator|.
name|addWidget
argument_list|(
operator|&
name|le2
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|grid
operator|.
name|addWidget
argument_list|(
operator|&
name|box
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|box
operator|.
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
argument_list|,
literal|57
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|w
operator|.
name|sizeHint
argument_list|()
operator|.
name|height
argument_list|()
argument_list|,
literal|11
operator|+
literal|57
operator|+
literal|11
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|taskQTBUG_27420_takeAtShouldUnparentLayout
name|void
name|tst_QGridLayout
operator|::
name|taskQTBUG_27420_takeAtShouldUnparentLayout
parameter_list|()
block|{
name|QSharedPointer
argument_list|<
name|QGridLayout
argument_list|>
name|outer
argument_list|(
operator|new
name|QGridLayout
argument_list|)
decl_stmt|;
name|QPointer
argument_list|<
name|QGridLayout
argument_list|>
name|inner
init|=
operator|new
name|QGridLayout
decl_stmt|;
name|outer
operator|->
name|addLayout
argument_list|(
name|inner
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|outer
operator|->
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|inner
operator|->
name|parent
argument_list|()
argument_list|,
name|outer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|QLayoutItem
modifier|*
name|item
init|=
name|outer
operator|->
name|takeAt
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|item
operator|->
name|layout
argument_list|()
argument_list|,
name|inner
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|item
operator|->
name|layout
argument_list|()
operator|->
name|parent
argument_list|()
argument_list|)
expr_stmt|;
name|outer
operator|.
name|reset
argument_list|()
expr_stmt|;
if|if
condition|(
name|inner
condition|)
operator|delete
name|item
expr_stmt|;
comment|// success: a taken item/layout should not be deleted when the old parent is deleted
else|else
name|QVERIFY
argument_list|(
operator|!
name|inner
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|taskQTBUG_40609_addingWidgetToItsOwnLayout
name|void
name|tst_QGridLayout
operator|::
name|taskQTBUG_40609_addingWidgetToItsOwnLayout
parameter_list|()
block|{
name|QWidget
name|widget
decl_stmt|;
name|widget
operator|.
name|setObjectName
argument_list|(
literal|"9bb37ca762aeb7269b8"
argument_list|)
expr_stmt|;
name|QGridLayout
name|layout
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setObjectName
argument_list|(
literal|"d631e91a35f2b66a6dff35"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QLayout: Cannot add a null widget to QGridLayout/d631e91a35f2b66a6dff35"
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
name|Q_NULLPTR
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QLayout: Cannot add parent widget QWidget/9bb37ca762aeb7269b8 to its child layout QGridLayout/d631e91a35f2b66a6dff35"
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addWidget
argument_list|(
operator|&
name|widget
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|taskQTBUG_40609_addingLayoutToItself
name|void
name|tst_QGridLayout
operator|::
name|taskQTBUG_40609_addingLayoutToItself
parameter_list|()
block|{
name|QWidget
name|widget
decl_stmt|;
name|widget
operator|.
name|setObjectName
argument_list|(
literal|"0373d417fffe2c59c6fe543"
argument_list|)
expr_stmt|;
name|QGridLayout
name|layout
argument_list|(
operator|&
name|widget
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setObjectName
argument_list|(
literal|"5d79e1b0aed83f100e3c2"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QLayout: Cannot add a null layout to QGridLayout/5d79e1b0aed83f100e3c2"
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addLayout
argument_list|(
name|Q_NULLPTR
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|ignoreMessage
argument_list|(
name|QtWarningMsg
argument_list|,
literal|"QLayout: Cannot add layout QGridLayout/5d79e1b0aed83f100e3c2 to itself"
argument_list|)
expr_stmt|;
name|layout
operator|.
name|addLayout
argument_list|(
operator|&
name|layout
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|layout
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|replaceWidget
name|void
name|tst_QGridLayout
operator|::
name|replaceWidget
parameter_list|()
block|{
name|QWidget
name|wdg
decl_stmt|;
name|QGridLayout
modifier|*
name|l
init|=
operator|new
name|QGridLayout
argument_list|()
decl_stmt|;
specifier|const
name|int
name|itemCount
init|=
literal|9
decl_stmt|;
name|QLabel
modifier|*
name|labels
index|[
name|itemCount
index|]
decl_stmt|;
comment|// setup layout
for|for
control|(
name|int
name|n
init|=
literal|0
init|;
name|n
operator|<
name|itemCount
condition|;
operator|++
name|n
control|)
block|{
name|int
name|x
init|=
name|n
operator|%
literal|3
decl_stmt|;
name|int
name|y
init|=
name|n
operator|/
literal|3
decl_stmt|;
name|labels
index|[
name|n
index|]
operator|=
operator|new
name|QLabel
argument_list|(
name|QString
argument_list|(
literal|"label %1"
argument_list|)
operator|.
name|arg
argument_list|(
name|n
argument_list|)
argument_list|)
expr_stmt|;
name|Qt
operator|::
name|Alignment
name|align
init|=
operator|(
name|n
operator|%
literal|3
condition|?
name|Qt
operator|::
name|AlignLeft
else|:
name|Qt
operator|::
name|AlignRight
operator|)
decl_stmt|;
name|l
operator|->
name|addWidget
argument_list|(
name|labels
index|[
name|n
index|]
argument_list|,
name|x
operator|*
literal|3
argument_list|,
name|y
operator|*
literal|3
argument_list|,
operator|(
name|n
operator|%
literal|2
operator|)
operator|+
literal|1
argument_list|,
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|2
operator|+
literal|1
argument_list|,
name|align
argument_list|)
expr_stmt|;
block|}
name|wdg
operator|.
name|setLayout
argument_list|(
name|l
argument_list|)
expr_stmt|;
comment|// iterate and replace
for|for
control|(
name|int
name|n
init|=
literal|0
init|;
name|n
operator|<
name|itemCount
condition|;
name|n
operator|+=
literal|2
control|)
block|{
name|int
name|i
init|=
name|l
operator|->
name|indexOf
argument_list|(
name|labels
index|[
name|n
index|]
argument_list|)
decl_stmt|;
name|int
name|fromRow
decl_stmt|,
name|fromCol
decl_stmt|,
name|fromRowSpan
decl_stmt|,
name|fromColSpan
decl_stmt|;
name|l
operator|->
name|getItemPosition
argument_list|(
name|i
argument_list|,
operator|&
name|fromRow
argument_list|,
operator|&
name|fromCol
argument_list|,
operator|&
name|fromRowSpan
argument_list|,
operator|&
name|fromColSpan
argument_list|)
expr_stmt|;
name|Qt
operator|::
name|Alignment
name|fromAlign
init|=
name|l
operator|->
name|itemAt
argument_list|(
name|i
argument_list|)
operator|->
name|alignment
argument_list|()
decl_stmt|;
comment|// do replace
name|QPushButton
modifier|*
name|pb
init|=
operator|new
name|QPushButton
argument_list|(
literal|"replaced"
argument_list|)
decl_stmt|;
name|QLayoutItem
modifier|*
name|olditem
init|=
name|l
operator|->
name|replaceWidget
argument_list|(
name|labels
index|[
name|n
index|]
argument_list|,
name|pb
argument_list|)
decl_stmt|;
comment|// verify
name|QCOMPARE
argument_list|(
name|i
argument_list|,
name|l
operator|->
name|indexOf
argument_list|(
name|pb
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|olditem
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|l
operator|->
name|indexOf
argument_list|(
name|labels
index|[
name|n
index|]
argument_list|)
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|int
name|toRow
decl_stmt|,
name|toCol
decl_stmt|,
name|toRowSpan
decl_stmt|,
name|toColSpan
decl_stmt|;
name|l
operator|->
name|getItemPosition
argument_list|(
name|i
argument_list|,
operator|&
name|toRow
argument_list|,
operator|&
name|toCol
argument_list|,
operator|&
name|toRowSpan
argument_list|,
operator|&
name|toColSpan
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fromRow
argument_list|,
name|toRow
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fromCol
argument_list|,
name|toCol
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fromRowSpan
argument_list|,
name|toRowSpan
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fromColSpan
argument_list|,
name|toColSpan
argument_list|)
expr_stmt|;
name|Qt
operator|::
name|Alignment
name|toAlign
init|=
name|l
operator|->
name|itemAt
argument_list|(
name|i
argument_list|)
operator|->
name|alignment
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|fromAlign
argument_list|,
name|toAlign
argument_list|)
expr_stmt|;
comment|// clean up
name|olditem
operator|->
name|widget
argument_list|()
operator|->
name|deleteLater
argument_list|()
expr_stmt|;
operator|delete
name|olditem
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|dontCrashWhenExtendsToEnd
name|void
name|tst_QGridLayout
operator|::
name|dontCrashWhenExtendsToEnd
parameter_list|()
block|{
name|QWidget
name|window
decl_stmt|;
name|window
operator|.
name|resize
argument_list|(
literal|320
argument_list|,
literal|200
argument_list|)
expr_stmt|;
name|QWidget
name|parent
argument_list|(
operator|&
name|window
argument_list|)
decl_stmt|;
name|QLabel
modifier|*
name|lbl0
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"lbl0:"
argument_list|)
argument_list|)
decl_stmt|;
name|QLabel
modifier|*
name|lbl1
init|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"lbl1:"
argument_list|)
argument_list|)
decl_stmt|;
name|QPushButton
modifier|*
name|pb
init|=
operator|new
name|QPushButton
argument_list|(
name|QLatin1String
argument_list|(
literal|"pb1"
argument_list|)
argument_list|)
decl_stmt|;
name|QGridLayout
modifier|*
name|l
init|=
operator|new
name|QGridLayout
argument_list|(
operator|&
name|parent
argument_list|)
decl_stmt|;
name|l
operator|->
name|addWidget
argument_list|(
name|lbl0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|l
operator|->
name|addWidget
argument_list|(
name|lbl1
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// adding an item in the bottom right corner than spans to the end (!)...
name|l
operator|->
name|addWidget
argument_list|(
name|pb
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
comment|// ...should not cause a crash when the items are distributed....
name|l
operator|->
name|setGeometry
argument_list|(
name|QRect
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|200
argument_list|,
literal|50
argument_list|)
argument_list|)
expr_stmt|;
comment|// DONT CRASH HERE
block|}
end_function
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QGridLayout
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qgridlayout.moc"
end_include
end_unit
