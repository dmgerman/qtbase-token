begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2015 The Qt Company Ltd. ** Copyright (C) 2012 Intel Corporation. ** Contact: http://www.qt.io/licensing/ ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL21$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and The Qt Company. For licensing terms ** and conditions see http://www.qt.io/terms-conditions. For further ** information use the contact form at http://www.qt.io/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 or version 3 as published by the Free ** Software Foundation and appearing in the file LICENSE.LGPLv21 and ** LICENSE.LGPLv3 included in the packaging of this file. Please review the ** following information to ensure the GNU Lesser General Public License ** requirements will be met: https://www.gnu.org/licenses/lgpl.html and ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** As a special exception, The Qt Company gives you certain additional ** rights. These rights are described in The Qt Company LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<qcoreapplication.h>
end_include
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<qhostaddress.h>
end_include
begin_include
include|#
directive|include
file|<qplatformdefs.h>
end_include
begin_include
include|#
directive|include
file|<qdebug.h>
end_include
begin_include
include|#
directive|include
file|<qhash.h>
end_include
begin_include
include|#
directive|include
file|<qbytearray.h>
end_include
begin_include
include|#
directive|include
file|<qdatastream.h>
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|Q_OS_WIN
end_ifdef
begin_include
include|#
directive|include
file|<qt_windows.h>
end_include
begin_if
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_WINRT
argument_list|)
end_if
begin_include
include|#
directive|include
file|<winsock2.h>
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|Q_OS_ANDROID
end_ifdef
begin_include
include|#
directive|include
file|<netinet/in.h>
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_class
DECL|class|tst_QHostAddress
class|class
name|tst_QHostAddress
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
public|public:
name|tst_QHostAddress
parameter_list|()
constructor_decl|;
specifier|virtual
name|~
name|tst_QHostAddress
parameter_list|()
destructor_decl|;
public|public
name|slots
public|:
name|void
name|init
parameter_list|()
function_decl|;
name|void
name|cleanup
parameter_list|()
function_decl|;
private|private
name|slots
private|:
name|void
name|constructor_QString_data
parameter_list|()
function_decl|;
name|void
name|constructor_QString
parameter_list|()
function_decl|;
name|void
name|setAddress_QString_data
parameter_list|()
function_decl|;
name|void
name|setAddress_QString
parameter_list|()
function_decl|;
name|void
name|specialAddresses_data
parameter_list|()
function_decl|;
name|void
name|specialAddresses
parameter_list|()
function_decl|;
name|void
name|compare_data
parameter_list|()
function_decl|;
name|void
name|compare
parameter_list|()
function_decl|;
name|void
name|assignment
parameter_list|()
function_decl|;
name|void
name|scopeId
parameter_list|()
function_decl|;
name|void
name|hashKey
parameter_list|()
function_decl|;
name|void
name|streaming_data
parameter_list|()
function_decl|;
name|void
name|streaming
parameter_list|()
function_decl|;
name|void
name|parseSubnet_data
parameter_list|()
function_decl|;
name|void
name|parseSubnet
parameter_list|()
function_decl|;
name|void
name|isInSubnet_data
parameter_list|()
function_decl|;
name|void
name|isInSubnet
parameter_list|()
function_decl|;
name|void
name|isLoopback_data
parameter_list|()
function_decl|;
name|void
name|isLoopback
parameter_list|()
function_decl|;
name|void
name|isMulticast_data
parameter_list|()
function_decl|;
name|void
name|isMulticast
parameter_list|()
function_decl|;
name|void
name|convertv4v6_data
parameter_list|()
function_decl|;
name|void
name|convertv4v6
parameter_list|()
function_decl|;
block|}
class|;
end_class
begin_constructor
DECL|function|tst_QHostAddress
name|tst_QHostAddress
operator|::
name|tst_QHostAddress
parameter_list|()
block|{ }
end_constructor
begin_destructor
DECL|function|~tst_QHostAddress
name|tst_QHostAddress
operator|::
name|~
name|tst_QHostAddress
parameter_list|()
block|{ }
end_destructor
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|QHostAddress
argument_list|)
end_macro
begin_function
DECL|function|init
name|void
name|tst_QHostAddress
operator|::
name|init
parameter_list|()
block|{
name|qRegisterMetaType
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"QHostAddress"
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|cleanup
name|void
name|tst_QHostAddress
operator|::
name|cleanup
parameter_list|()
block|{
comment|// No cleanup is required.
block|}
end_function
begin_function
DECL|function|constructor_QString_data
name|void
name|tst_QHostAddress
operator|::
name|constructor_QString_data
parameter_list|()
block|{
name|setAddress_QString_data
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|constructor_QString
name|void
name|tst_QHostAddress
operator|::
name|constructor_QString
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|ok
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|protocol
argument_list|)
expr_stmt|;
name|QHostAddress
name|hostAddr
argument_list|(
name|address
argument_list|)
decl_stmt|;
if|if
condition|(
name|address
operator|==
literal|"0.0.0.0"
operator|||
name|address
operator|==
literal|"::"
condition|)
block|{
name|QVERIFY
argument_list|(
name|ok
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|isNull
argument_list|()
operator|!=
name|ok
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ok
condition|)
name|QTEST
argument_list|(
name|hostAddr
operator|.
name|toString
argument_list|()
argument_list|,
literal|"resAddr"
argument_list|)
expr_stmt|;
if|if
condition|(
name|protocol
operator|==
literal|4
condition|)
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|IPv4Protocol
operator|||
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|UnknownNetworkLayerProtocol
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|!=
name|QAbstractSocket
operator|::
name|IPv6Protocol
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|protocol
operator|==
literal|6
condition|)
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|!=
name|QAbstractSocket
operator|::
name|IPv4Protocol
operator|&&
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|!=
name|QAbstractSocket
operator|::
name|UnknownNetworkLayerProtocol
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|IPv6Protocol
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|UnknownNetworkLayerProtocol
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|setAddress_QString_data
name|void
name|tst_QHostAddress
operator|::
name|setAddress_QString_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"ok"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"resAddr"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"protocol"
argument_list|)
expr_stmt|;
comment|// 4: IPv4, 6: IPv6, other: undefined
comment|//next we fill it with data
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip4_00"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
literal|4
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip4_01"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"255.3.2.1"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"255.3.2.1"
argument_list|)
operator|<<
literal|4
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip4_03"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|" 255.3.2.1"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"255.3.2.1"
argument_list|)
operator|<<
literal|4
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip4_04"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"255.3.2.1\r "
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"255.3.2.1"
argument_list|)
operator|<<
literal|4
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip4_05"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0.0.0.0"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"0.0.0.0"
argument_list|)
operator|<<
literal|4
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip4_06"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"123.0.0"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"123.0.0.0"
argument_list|)
operator|<<
literal|4
expr_stmt|;
comment|// for the format of IPv6 addresses see also RFC 5952
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_00"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"FEDC:BA98:7654:3210:FEDC:BA98:7654:3210"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"fedc:ba98:7654:3210:fedc:ba98:7654:3210"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_01"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080:0000:0000:0000:0008:0800:200C:417A"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080::8:800:200c:417a"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_02"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080:0:0:0:8:800:200C:417A"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080::8:800:200c:417a"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_03"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080::8:800:200C:417A"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080::8:800:200c:417a"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_04"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"FF01::43"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"ff01::43"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_05"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::1"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"::1"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_06"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1::"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1::"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_07"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"::"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_08"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0:0:0:0:0:0:13.1.68.3"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"::13.1.68.3"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_09"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::13.1.68.3"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"::13.1.68.3"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_10"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0:0:0:0:0:FFFF:129.144.52.38"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"::ffff:129.144.52.38"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_11"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::FFFF:129.144.52.38"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"::ffff:129.144.52.38"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_12"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1::FFFF:129.144.52.38"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1::ffff:8190:3426"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_13"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"A:B::D:E"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"a:b::d:e"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_14"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080:0:1:0:8:800:200C:417A"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080:0:1:0:8:800:200c:417a"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_15"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080:0:1:0:8:800:200C:0"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080:0:1:0:8:800:200c:0"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_16"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080:0:1:0:8:800:0:0"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080:0:1:0:8:800::"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_17"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1080:0:0:0:8:800:0:0"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"1080::8:800:0:0"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_18"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0:1:1:1:8:800:0:0"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"0:1:1:1:8:800::"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ip6_19"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0:1:1:1:8:800:0:1"
argument_list|)
operator|<<
literal|true
operator|<<
name|QString
argument_list|(
literal|"0:1:1:1:8:800:0:1"
argument_list|)
operator|<<
literal|6
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_00"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"foobarcom"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_01"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"foo.bar.com"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_02"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|""
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_03"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_04"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|" \t\r"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip4_00"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"256.9.9.9"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip4_01"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"-1.9.9.9"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
comment|//QTest::newRow("error_ip4_02")<< QString("123.0.0")<< false<< QString()<< 0; // no longer invalid in Qt5
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip4_02"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"123.0.0."
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip4_03"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"123.0.0.0.0"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip4_04"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"255.2 3.2.1"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_00"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|":"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_01"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|":::"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_02"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::AAAA:"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_03"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|":AAAA::"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_04"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"FFFF:::129.144.52.38"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_05"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"FEDC:BA98:7654:3210:FEDC:BA98:7654:3210:1234"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_06"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"129.144.52.38::"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_07"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::129.144.52.38:129.144.52.38"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_08"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|":::129.144.52.38"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_09"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1FEDC:BA98:7654:3210:FEDC:BA98:7654:3210"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_10"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::FFFFFFFF"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_11"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::EFGH"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_12"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"ABCD:ABCD:ABCD"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_13"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::ABCD:ABCD::"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_14"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1::2::3"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_15"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1:2:::"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_16"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|":::1:2"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_17"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"1:::2"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_18"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"FEDC::7654:3210:FEDC:BA98::3210"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_19"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"ABCD:ABCD:ABCD:1.2.3.4"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"error_ip6_20"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"ABCD::ABCD::ABCD:1.2.3.4"
argument_list|)
operator|<<
literal|false
operator|<<
name|QString
argument_list|()
operator|<<
literal|0
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setAddress_QString
name|void
name|tst_QHostAddress
operator|::
name|setAddress_QString
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|ok
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|protocol
argument_list|)
expr_stmt|;
name|QHostAddress
name|hostAddr
decl_stmt|;
name|QCOMPARE
argument_list|(
name|hostAddr
operator|.
name|setAddress
argument_list|(
name|address
argument_list|)
argument_list|,
name|ok
argument_list|)
expr_stmt|;
if|if
condition|(
name|ok
condition|)
name|QTEST
argument_list|(
name|hostAddr
operator|.
name|toString
argument_list|()
argument_list|,
literal|"resAddr"
argument_list|)
expr_stmt|;
if|if
condition|(
name|protocol
operator|==
literal|4
condition|)
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|IPv4Protocol
operator|||
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|UnknownNetworkLayerProtocol
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|!=
name|QAbstractSocket
operator|::
name|IPv6Protocol
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|protocol
operator|==
literal|6
condition|)
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|!=
name|QAbstractSocket
operator|::
name|IPv4Protocol
operator|&&
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|!=
name|QAbstractSocket
operator|::
name|UnknownNetworkLayerProtocol
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|IPv6Protocol
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|hostAddr
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|UnknownNetworkLayerProtocol
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|specialAddresses_data
name|void
name|tst_QHostAddress
operator|::
name|specialAddresses_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"text"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost_1"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|LocalHost
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost_2"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"127.0.0.2"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|LocalHost
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost_3"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"127.0.0.2"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|LocalHostIPv6
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost_ipv6_4"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::1"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|LocalHostIPv6
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost_ipv6_5"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::2"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|LocalHostIPv6
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost_ipv6_6"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::1"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|LocalHost
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"null_1"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|""
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Null
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"null_2"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"bjarne"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Null
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"compare_from_null"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|""
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Broadcast
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"broadcast_1"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"255.255.255.255"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Any
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"broadcast_2"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"255.255.255.255"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Broadcast
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"any_ipv6"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|AnyIPv6
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"any_ipv4"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0.0.0.0"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|AnyIPv4
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"dual_not_ipv6"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"::"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Any
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"dual_not_ipv4"
argument_list|)
operator|<<
name|QString
argument_list|(
literal|"0.0.0.0"
argument_list|)
operator|<<
operator|(
name|int
operator|)
name|QHostAddress
operator|::
name|Any
operator|<<
literal|false
expr_stmt|;
block|}
end_function
begin_function
DECL|function|specialAddresses
name|void
name|tst_QHostAddress
operator|::
name|specialAddresses
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|(
name|QHostAddress
argument_list|(
name|text
argument_list|)
operator|==
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
operator|)
operator|==
name|result
argument_list|)
expr_stmt|;
comment|//check special address equal to itself (QTBUG-22898), note two overloads of operator==
name|QVERIFY
argument_list|(
name|QHostAddress
argument_list|(
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
argument_list|)
operator|==
name|QHostAddress
argument_list|(
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|QHostAddress
argument_list|(
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
argument_list|)
operator|==
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
argument_list|)
expr_stmt|;
name|QHostAddress
name|setter
decl_stmt|;
name|setter
operator|.
name|setAddress
argument_list|(
name|text
argument_list|)
expr_stmt|;
if|if
condition|(
name|result
condition|)
block|{
name|QVERIFY
argument_list|(
name|setter
operator|==
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QVERIFY
argument_list|(
operator|!
operator|(
operator|(
name|QHostAddress
operator|::
name|SpecialAddress
operator|)
name|address
operator|==
name|setter
operator|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|compare_data
name|void
name|tst_QHostAddress
operator|::
name|compare_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"first"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"second"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"3"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Broadcast
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Broadcast
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"5"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Broadcast
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"7"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|Q_IPV6ADDR
name|localhostv4mapped
init|=
block|{
block|{
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|255
block|,
literal|255
block|,
literal|127
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|}
block|}
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4-v4mapped"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:127.0.0.1"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4-v4mapped-2"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|localhostv4mapped
argument_list|)
operator|<<
literal|false
expr_stmt|;
block|}
end_function
begin_function
DECL|function|compare
name|void
name|tst_QHostAddress
operator|::
name|compare
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|first
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|second
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|first
operator|==
name|second
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|second
operator|==
name|first
argument_list|,
name|result
argument_list|)
expr_stmt|;
if|if
condition|(
name|result
operator|==
literal|true
condition|)
name|QCOMPARE
argument_list|(
name|qHash
argument_list|(
name|first
argument_list|)
argument_list|,
name|qHash
argument_list|(
name|second
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|assignment
name|void
name|tst_QHostAddress
operator|::
name|assignment
parameter_list|()
block|{
name|QHostAddress
name|address
decl_stmt|;
name|address
operator|=
literal|"127.0.0.1"
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
argument_list|,
name|QHostAddress
argument_list|(
literal|"127.0.0.1"
argument_list|)
argument_list|)
expr_stmt|;
name|address
operator|=
literal|"::1"
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
argument_list|,
name|QHostAddress
argument_list|(
literal|"::1"
argument_list|)
argument_list|)
expr_stmt|;
comment|// WinRT does not support sockaddr_in
ifndef|#
directive|ifndef
name|Q_OS_WINRT
name|QHostAddress
name|addr
argument_list|(
literal|"4.2.2.1"
argument_list|)
decl_stmt|;
name|sockaddr_in
name|sockAddr
decl_stmt|;
name|sockAddr
operator|.
name|sin_family
operator|=
name|AF_INET
expr_stmt|;
name|sockAddr
operator|.
name|sin_addr
operator|.
name|s_addr
operator|=
name|htonl
argument_list|(
name|addr
operator|.
name|toIPv4Address
argument_list|()
argument_list|)
expr_stmt|;
name|address
operator|.
name|setAddress
argument_list|(
operator|(
name|sockaddr
operator|*
operator|)
operator|&
name|sockAddr
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
argument_list|,
name|addr
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|// !Q_OS_WINRT
block|}
end_function
begin_function
DECL|function|scopeId
name|void
name|tst_QHostAddress
operator|::
name|scopeId
parameter_list|()
block|{
name|QHostAddress
name|address
argument_list|(
literal|"fe80::2e0:4cff:fefb:662a%eth0"
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|address
operator|.
name|scopeId
argument_list|()
argument_list|,
name|QString
argument_list|(
literal|"eth0"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
operator|.
name|toString
argument_list|()
operator|.
name|toLower
argument_list|()
argument_list|,
name|QString
argument_list|(
literal|"fe80::2e0:4cff:fefb:662a%eth0"
argument_list|)
argument_list|)
expr_stmt|;
name|QHostAddress
name|address2
argument_list|(
literal|"fe80::2e0:4cff:fefb:662a"
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|address2
operator|.
name|scopeId
argument_list|()
argument_list|,
name|QString
argument_list|()
argument_list|)
expr_stmt|;
name|address2
operator|.
name|setScopeId
argument_list|(
name|QString
argument_list|(
literal|"en0"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address2
operator|.
name|toString
argument_list|()
operator|.
name|toLower
argument_list|()
argument_list|,
name|QString
argument_list|(
literal|"fe80::2e0:4cff:fefb:662a%en0"
argument_list|)
argument_list|)
expr_stmt|;
name|address2
operator|=
name|address
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address2
operator|.
name|scopeId
argument_list|()
argument_list|,
name|QString
argument_list|(
literal|"eth0"
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address2
operator|.
name|toString
argument_list|()
operator|.
name|toLower
argument_list|()
argument_list|,
name|QString
argument_list|(
literal|"fe80::2e0:4cff:fefb:662a%eth0"
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|hashKey
name|void
name|tst_QHostAddress
operator|::
name|hashKey
parameter_list|()
block|{
name|QHash
argument_list|<
name|QHostAddress
argument_list|,
name|QString
argument_list|>
name|hostHash
decl_stmt|;
name|hostHash
operator|.
name|insert
argument_list|(
name|QHostAddress
argument_list|()
argument_list|,
literal|"ole"
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|streaming_data
name|void
name|tst_QHostAddress
operator|::
name|streaming_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"2"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|0xDEADBEEF
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"3"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"127.128.129.130"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"1080:0000:0000:0000:0008:0800:200C:417A"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"5"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"fe80::2e0:4cff:fefb:662a%eth0"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Null
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"7"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"8"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"9"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Broadcast
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"10"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"11"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"12"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"13"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"foo.bar.com"
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|streaming
name|void
name|tst_QHostAddress
operator|::
name|streaming
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QByteArray
name|ba
decl_stmt|;
name|QDataStream
name|ds1
argument_list|(
operator|&
name|ba
argument_list|,
name|QIODevice
operator|::
name|WriteOnly
argument_list|)
decl_stmt|;
name|ds1
operator|<<
name|address
expr_stmt|;
name|QCOMPARE
argument_list|(
name|ds1
operator|.
name|status
argument_list|()
argument_list|,
name|QDataStream
operator|::
name|Ok
argument_list|)
expr_stmt|;
name|QDataStream
name|ds2
argument_list|(
operator|&
name|ba
argument_list|,
name|QIODevice
operator|::
name|ReadOnly
argument_list|)
decl_stmt|;
name|QHostAddress
name|address2
decl_stmt|;
name|ds2
operator|>>
name|address2
expr_stmt|;
name|QCOMPARE
argument_list|(
name|ds2
operator|.
name|status
argument_list|()
argument_list|,
name|QDataStream
operator|::
name|Ok
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
argument_list|,
name|address2
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|parseSubnet_data
name|void
name|tst_QHostAddress
operator|::
name|parseSubnet_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"subnet"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"prefix"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"prefixLength"
argument_list|)
expr_stmt|;
comment|// invalid/error values
name|QTest
operator|::
name|newRow
argument_list|(
literal|"empty"
argument_list|)
operator|<<
name|QString
argument_list|()
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_01"
argument_list|)
operator|<<
literal|"foobar"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_02"
argument_list|)
operator|<<
literal|"   "
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_03"
argument_list|)
operator|<<
literal|"1.2.3.a"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_04"
argument_list|)
operator|<<
literal|"1.2.3.4.5"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_05"
argument_list|)
operator|<<
literal|"1.2.3.4:80"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_06"
argument_list|)
operator|<<
literal|"1.2.3.4/33"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_07"
argument_list|)
operator|<<
literal|"1.2.3.4/-1"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_08"
argument_list|)
operator|<<
literal|"1.2.3.4/256.0.0.0"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_09"
argument_list|)
operator|<<
literal|"1.2.3.4/255.253.0.0"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_10"
argument_list|)
operator|<<
literal|"1.2.3.4/255.0.0.255"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_11"
argument_list|)
operator|<<
literal|"1.2.3.4."
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_20"
argument_list|)
operator|<<
literal|"ffff::/-1"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_21"
argument_list|)
operator|<<
literal|"ffff::/129"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_22"
argument_list|)
operator|<<
literal|"ffff::/255.255.0.0"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_23"
argument_list|)
operator|<<
literal|"ffff::/ff00::"
operator|<<
name|QHostAddress
argument_list|()
operator|<<
operator|-
literal|1
expr_stmt|;
comment|// correct IPv4 with netmask
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_0"
argument_list|)
operator|<<
literal|"0.0.0.0/0.0.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_1"
argument_list|)
operator|<<
literal|"0.0.0.0/255.128.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|9
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_2"
argument_list|)
operator|<<
literal|"0.0.0.0/255.192.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|10
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_3"
argument_list|)
operator|<<
literal|"0.0.0.0/255.224.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|11
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_4"
argument_list|)
operator|<<
literal|"0.0.0.0/255.240.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|12
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_5"
argument_list|)
operator|<<
literal|"0.0.0.0/255.248.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|13
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_6"
argument_list|)
operator|<<
literal|"0.0.0.0/255.252.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|14
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_7"
argument_list|)
operator|<<
literal|"0.0.0.0/255.254.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|15
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_8"
argument_list|)
operator|<<
literal|"0.0.0.0/255.255.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|16
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_16"
argument_list|)
operator|<<
literal|"0.0.0.0/255.255.0.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|16
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_24"
argument_list|)
operator|<<
literal|"0.0.0.0/255.255.255.0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|24
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_31"
argument_list|)
operator|<<
literal|"0.0.0.0/255.255.255.254"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|31
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_32"
argument_list|)
operator|<<
literal|"0.0.0.0/255.255.255.255"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|32
expr_stmt|;
comment|// correct IPv4 with prefix
name|QTest
operator|::
name|newRow
argument_list|(
literal|"prefix_0"
argument_list|)
operator|<<
literal|"0.0.0.0/0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"prefix_1"
argument_list|)
operator|<<
literal|"0.0.0.0/1"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"prefix_9"
argument_list|)
operator|<<
literal|"0.0.0.0/9"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|9
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"prefix_31"
argument_list|)
operator|<<
literal|"0.0.0.0/31"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|31
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"prefix_32"
argument_list|)
operator|<<
literal|"0.0.0.0/32"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|32
expr_stmt|;
comment|// correct IPv4 without prefix or netmask
name|QTest
operator|::
name|newRow
argument_list|(
literal|"classA"
argument_list|)
operator|<<
literal|"10"
operator|<<
name|QHostAddress
argument_list|(
literal|"10.0.0.0"
argument_list|)
operator|<<
literal|8
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"classA+dot"
argument_list|)
operator|<<
literal|"10."
operator|<<
name|QHostAddress
argument_list|(
literal|"10.0.0.0"
argument_list|)
operator|<<
literal|8
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"classB"
argument_list|)
operator|<<
literal|"172.16"
operator|<<
name|QHostAddress
argument_list|(
literal|"172.16.0.0"
argument_list|)
operator|<<
literal|16
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"classB+dot"
argument_list|)
operator|<<
literal|"172.16."
operator|<<
name|QHostAddress
argument_list|(
literal|"172.16.0.0"
argument_list|)
operator|<<
literal|16
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"classC"
argument_list|)
operator|<<
literal|"192.168.0"
operator|<<
name|QHostAddress
argument_list|(
literal|"192.168.0.0"
argument_list|)
operator|<<
literal|24
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"classC+dot"
argument_list|)
operator|<<
literal|"192.168.0"
operator|<<
name|QHostAddress
argument_list|(
literal|"192.168.0.0"
argument_list|)
operator|<<
literal|24
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"full-ipv4"
argument_list|)
operator|<<
literal|"192.168.0.1"
operator|<<
name|QHostAddress
argument_list|(
literal|"192.168.0.1"
argument_list|)
operator|<<
literal|32
expr_stmt|;
comment|// correct IPv6 with prefix
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_01"
argument_list|)
operator|<<
literal|"::/0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_03"
argument_list|)
operator|<<
literal|"::/3"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|3
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_16"
argument_list|)
operator|<<
literal|"::/16"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|16
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_48"
argument_list|)
operator|<<
literal|"::/48"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|48
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_127"
argument_list|)
operator|<<
literal|"::/127"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|127
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_128"
argument_list|)
operator|<<
literal|"::/128"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|128
expr_stmt|;
comment|// tail bit clearing:
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_01"
argument_list|)
operator|<<
literal|"255.255.255.255/31"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.255.254"
argument_list|)
operator|<<
literal|31
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_08"
argument_list|)
operator|<<
literal|"255.255.255.255/24"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.255.0"
argument_list|)
operator|<<
literal|24
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_09"
argument_list|)
operator|<<
literal|"255.255.255.255/23"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.254.0"
argument_list|)
operator|<<
literal|23
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_10"
argument_list|)
operator|<<
literal|"255.255.255.255/22"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.252.0"
argument_list|)
operator|<<
literal|22
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_11"
argument_list|)
operator|<<
literal|"255.255.255.255/21"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.248.0"
argument_list|)
operator|<<
literal|21
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_12"
argument_list|)
operator|<<
literal|"255.255.255.255/20"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.240.0"
argument_list|)
operator|<<
literal|20
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_13"
argument_list|)
operator|<<
literal|"255.255.255.255/19"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.224.0"
argument_list|)
operator|<<
literal|19
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_14"
argument_list|)
operator|<<
literal|"255.255.255.255/18"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.192.0"
argument_list|)
operator|<<
literal|18
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_15"
argument_list|)
operator|<<
literal|"255.255.255.255/17"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.128.0"
argument_list|)
operator|<<
literal|17
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_16"
argument_list|)
operator|<<
literal|"255.255.255.255/16"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.0.0"
argument_list|)
operator|<<
literal|16
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_24"
argument_list|)
operator|<<
literal|"255.255.255.255/8"
operator|<<
name|QHostAddress
argument_list|(
literal|"255.0.0.0"
argument_list|)
operator|<<
literal|8
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_31"
argument_list|)
operator|<<
literal|"255.255.255.255/1"
operator|<<
name|QHostAddress
argument_list|(
literal|"128.0.0.0"
argument_list|)
operator|<<
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"clear_32"
argument_list|)
operator|<<
literal|"255.255.255.255/0"
operator|<<
name|QHostAddress
argument_list|(
literal|"0.0.0.0"
argument_list|)
operator|<<
literal|0
expr_stmt|;
comment|// same for IPv6:
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_01"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/127"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:fffe"
argument_list|)
operator|<<
literal|127
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_07"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/121"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff80"
argument_list|)
operator|<<
literal|121
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_08"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/120"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ff00"
argument_list|)
operator|<<
literal|120
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_16"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/112"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:0"
argument_list|)
operator|<<
literal|112
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_80"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/48"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff::"
argument_list|)
operator|<<
literal|48
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_81"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/47"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:fffe::"
argument_list|)
operator|<<
literal|47
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_82"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/46"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:fffc::"
argument_list|)
operator|<<
literal|46
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_83"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/45"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:fff8::"
argument_list|)
operator|<<
literal|45
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_84"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/44"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:fff0::"
argument_list|)
operator|<<
literal|44
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_85"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/43"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffe0::"
argument_list|)
operator|<<
literal|43
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_86"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/42"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffc0::"
argument_list|)
operator|<<
literal|42
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_87"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/41"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ff80::"
argument_list|)
operator|<<
literal|41
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_88"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/40"
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ff00::"
argument_list|)
operator|<<
literal|40
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_125"
argument_list|)
operator|<<
literal|"3fff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/3"
operator|<<
name|QHostAddress
argument_list|(
literal|"2000::"
argument_list|)
operator|<<
literal|3
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_127"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/1"
operator|<<
name|QHostAddress
argument_list|(
literal|"8000::"
argument_list|)
operator|<<
literal|1
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_clear_128"
argument_list|)
operator|<<
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff/0"
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|0
expr_stmt|;
block|}
end_function
begin_function
DECL|function|parseSubnet
name|void
name|tst_QHostAddress
operator|::
name|parseSubnet
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|subnet
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|prefix
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|prefixLength
argument_list|)
expr_stmt|;
name|QPair
argument_list|<
name|QHostAddress
argument_list|,
name|int
argument_list|>
name|result
init|=
name|QHostAddress
operator|::
name|parseSubnet
argument_list|(
name|subnet
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|result
operator|.
name|first
argument_list|,
name|prefix
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|result
operator|.
name|second
argument_list|,
name|prefixLength
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isInSubnet_data
name|void
name|tst_QHostAddress
operator|::
name|isInSubnet_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"prefix"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"prefixLength"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
comment|// invalid QHostAddresses are never in any subnets
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_01"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|32
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_02"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|32
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_03"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|8
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_04"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|0
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_05"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.255.0"
argument_list|)
operator|<<
literal|24
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_06"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|0
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_07"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|32
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_08"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|128
operator|<<
literal|false
expr_stmt|;
comment|// and no host address can be in a subnet whose prefix is invalid
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_20"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|16
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_21"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|16
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_22"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|16
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_23"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|16
operator|<<
literal|false
expr_stmt|;
comment|// negative netmasks don't make sense:
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_30"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
operator|-
literal|1
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid_31"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
operator|-
literal|1
operator|<<
literal|false
expr_stmt|;
comment|// we don't support IPv4 belonging in an IPv6 netmask and vice-versa
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4-in-v6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|0
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v6-in-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
literal|0
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4-in-v6mapped"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:255.0.0.0"
argument_list|)
operator|<<
literal|113
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4-in-v6mapped2"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:255.0.0.0"
argument_list|)
operator|<<
literal|113
operator|<<
literal|false
expr_stmt|;
comment|// IPv4 correct ones
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_0"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|0
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_0bis"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"255.255.0.0"
argument_list|)
operator|<<
literal|0
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_0ter"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"1.2.3.4"
argument_list|)
operator|<<
literal|0
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|1
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~netmask_1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"128.0.0.0"
argument_list|)
operator|<<
literal|1
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_1bis"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"224.0.0.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"128.0.0.0"
argument_list|)
operator|<<
literal|1
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~netmask_1bis"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"224.0.0.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"0.0.0.0"
argument_list|)
operator|<<
literal|1
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_8"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"127.0.0.0"
argument_list|)
operator|<<
literal|8
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~netmask_8"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"126.0.0.0"
argument_list|)
operator|<<
literal|8
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_15"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"10.0.1.255"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"10.0.0.0"
argument_list|)
operator|<<
literal|15
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"netmask_16"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"172.16.0.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"172.16.0.0"
argument_list|)
operator|<<
literal|16
operator|<<
literal|true
expr_stmt|;
comment|// the address is always in the subnet containing its address, regardless of length:
name|QTest
operator|::
name|newRow
argument_list|(
literal|"same_01"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|1
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"same_07"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|7
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"same_8"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|8
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"same_24"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|23
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"same_31"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|31
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"same_32"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|32
operator|<<
literal|true
expr_stmt|;
comment|// IPv6 correct ones:
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_0"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|0
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_0bis"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
literal|0
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_0ter"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff::"
argument_list|)
operator|<<
literal|0
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|1
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_1bis"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"fec0::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"8000::"
argument_list|)
operator|<<
literal|1
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~ipv6_netmask_1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"8000::"
argument_list|)
operator|<<
literal|1
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~ipv6_netmask_1bis"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"fec0::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::"
argument_list|)
operator|<<
literal|1
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_47"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:5::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4::"
argument_list|)
operator|<<
literal|47
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_48"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4::"
argument_list|)
operator|<<
literal|48
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~ipv6_netmask_48"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:5::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4::"
argument_list|)
operator|<<
literal|48
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_127"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4:5::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4:5::"
argument_list|)
operator|<<
literal|127
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_netmask_128"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4:5::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4:5::1"
argument_list|)
operator|<<
literal|128
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"~ipv6_netmask_128"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4:5::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2:3:4:5::0"
argument_list|)
operator|<<
literal|128
operator|<<
literal|false
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isInSubnet
name|void
name|tst_QHostAddress
operator|::
name|isInSubnet
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|prefix
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|prefixLength
argument_list|)
expr_stmt|;
name|QTEST
argument_list|(
name|address
operator|.
name|isInSubnet
argument_list|(
name|prefix
argument_list|,
name|prefixLength
argument_list|)
argument_list|,
literal|"result"
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isLoopback_data
name|void
name|tst_QHostAddress
operator|::
name|isLoopback_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"default"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"&&&"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_loop"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::1"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv4_loop"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"127.0.0.2"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"127.0.0.2"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"127.3.2.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"127.3.2.1"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"1.2.3.4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"1.2.3.4"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"10.0.0.4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"10.0.0.4"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"192.168.3.4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"192.168.3.4"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Any"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"AnyIPv4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"AnyIPv6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Broadcast"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Broadcast
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Null"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Null
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6-all-ffff"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:127.0.0.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:127.0.0.1"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:127.0.0.2"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:127.0.0.2"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:127.3.2.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:127.3.2.1"
argument_list|)
operator|<<
literal|true
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isLoopback
name|void
name|tst_QHostAddress
operator|::
name|isLoopback
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
operator|.
name|isLoopback
argument_list|()
argument_list|,
name|result
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isMulticast_data
name|void
name|tst_QHostAddress
operator|::
name|isMulticast_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|bool
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"default"
argument_list|)
operator|<<
name|QHostAddress
argument_list|()
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"invalid"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"&&&"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv6_loop"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::1"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ipv4_loop"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"127.0.0.1"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Any"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"AnyIPv4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"AnyIPv6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Broadcast"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Broadcast
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"Null"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Null
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"223.255.255.255"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"223.255.255.255"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"224.0.0.0"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"224.0.0.0"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"239.255.255.255"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"239.255.255.255"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"240.0.0.0"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"240.0.0.0"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:223.255.255.255"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:223.255.255.255"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:224.0.0.0"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:224.0.0.0"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:239.255.255.255"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:239.255.255.255"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"::ffff:240.0.0.0"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:240.0.0.0"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"fc00::"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"fc00::"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"fe80::"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"fe80::"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"fec0::"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"fec0::"
argument_list|)
operator|<<
literal|false
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ff00::"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"ff00::"
argument_list|)
operator|<<
literal|true
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
argument_list|)
operator|<<
literal|true
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isMulticast
name|void
name|tst_QHostAddress
operator|::
name|isMulticast
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|bool
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|address
operator|.
name|isMulticast
argument_list|()
argument_list|,
name|result
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|convertv4v6_data
name|void
name|tst_QHostAddress
operator|::
name|convertv4v6_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"source"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"protocol"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QHostAddress
argument_list|>
argument_list|(
literal|"result"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"any-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"any-to-v6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|Any
argument_list|)
operator|<<
literal|6
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"anyv4-to-v6"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
operator|<<
literal|6
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"anyv6-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv6
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|AnyIPv4
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4mapped-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:192.0.2.1"
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|(
literal|"192.0.2.1"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4-to-v4mapped"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"192.0.2.1"
argument_list|)
operator|<<
literal|6
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:192.0.2.1"
argument_list|)
expr_stmt|;
comment|// we won't convert 127.0.0.1 to ::1 or vice-versa:
comment|// you can connect to a v4 server socket with ::ffff:127.0.0.1, but not with ::1
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost-to-v4mapped"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
operator|<<
literal|6
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:127.0.0.1"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4mapped-to-localhost"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::ffff:127.0.0.1"
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHost
argument_list|)
expr_stmt|;
comment|// in turn, that means localhost6 doesn't convert to v4
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhost6-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
name|QHostAddress
operator|::
name|LocalHostIPv6
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|()
expr_stmt|;
comment|// some other v6 addresses that won't convert to v4
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v4compat-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::192.0.2.1"
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"localhostv4compat-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"::127.0.0.1"
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v6global-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"2001:db8::1"
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"v6multicast-to-v4"
argument_list|)
operator|<<
name|QHostAddress
argument_list|(
literal|"ff02::1"
argument_list|)
operator|<<
literal|4
operator|<<
name|QHostAddress
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|convertv4v6
name|void
name|tst_QHostAddress
operator|::
name|convertv4v6
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|source
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|protocol
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QHostAddress
argument_list|,
name|result
argument_list|)
expr_stmt|;
if|if
condition|(
name|protocol
operator|==
literal|4
condition|)
block|{
name|bool
name|ok
decl_stmt|;
name|quint32
name|v4
init|=
name|source
operator|.
name|toIPv4Address
argument_list|(
operator|&
name|ok
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|ok
argument_list|,
name|result
operator|.
name|protocol
argument_list|()
operator|==
name|QAbstractSocket
operator|::
name|IPv4Protocol
argument_list|)
expr_stmt|;
if|if
condition|(
name|ok
condition|)
name|QCOMPARE
argument_list|(
name|QHostAddress
argument_list|(
name|v4
argument_list|)
argument_list|,
name|result
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|protocol
operator|==
literal|6
condition|)
block|{
name|QCOMPARE
argument_list|(
name|QHostAddress
argument_list|(
name|source
operator|.
name|toIPv6Address
argument_list|()
argument_list|)
argument_list|,
name|result
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QHostAddress
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qhostaddress.moc"
end_include
end_unit
