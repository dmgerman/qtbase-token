begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2012 Digia Plc and/or its subsidiary(-ies). ** Contact: http://www.qt-project.org/legal ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and Digia.  For licensing terms and ** conditions see http://qt.digia.com/licensing.  For further information ** use the contact form at http://qt.digia.com/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 as published by the Free Software ** Foundation and appearing in the file LICENSE.LGPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU Lesser General Public License version 2.1 requirements ** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Digia gives you certain additional ** rights.  These rights are described in the Digia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU ** General Public License version 3.0 as published by the Free Software ** Foundation and appearing in the file LICENSE.GPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU General Public License version 3.0 requirements will be ** met: http://www.gnu.org/copyleft/gpl.html. ** ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<QtCore/qanimationgroup.h>
end_include
begin_include
include|#
directive|include
file|<QtCore/qsequentialanimationgroup.h>
end_include
begin_macro
name|Q_DECLARE_METATYPE
argument_list|(
argument|QAbstractAnimation::State
argument_list|)
end_macro
begin_class
DECL|class|tst_QSequentialAnimationGroup
class|class
name|tst_QSequentialAnimationGroup
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
public|public
name|Q_SLOTS
public|:
name|void
name|initTestCase
parameter_list|()
function_decl|;
private|private
name|slots
private|:
name|void
name|construction
parameter_list|()
function_decl|;
name|void
name|setCurrentTime
parameter_list|()
function_decl|;
name|void
name|setCurrentTimeWithUncontrolledAnimation
parameter_list|()
function_decl|;
name|void
name|seekingForwards
parameter_list|()
function_decl|;
name|void
name|seekingBackwards
parameter_list|()
function_decl|;
name|void
name|pauseAndResume
parameter_list|()
function_decl|;
name|void
name|restart
parameter_list|()
function_decl|;
name|void
name|looping
parameter_list|()
function_decl|;
name|void
name|startDelay
parameter_list|()
function_decl|;
name|void
name|clearGroup
parameter_list|()
function_decl|;
name|void
name|groupWithZeroDurationAnimations
parameter_list|()
function_decl|;
name|void
name|propagateGroupUpdateToChildren
parameter_list|()
function_decl|;
name|void
name|updateChildrenWithRunningGroup
parameter_list|()
function_decl|;
name|void
name|deleteChildrenWithRunningGroup
parameter_list|()
function_decl|;
name|void
name|startChildrenWithStoppedGroup
parameter_list|()
function_decl|;
name|void
name|stopGroupWithRunningChild
parameter_list|()
function_decl|;
name|void
name|startGroupWithRunningChild
parameter_list|()
function_decl|;
name|void
name|zeroDurationAnimation
parameter_list|()
function_decl|;
name|void
name|stopUncontrolledAnimations
parameter_list|()
function_decl|;
name|void
name|finishWithUncontrolledAnimation
parameter_list|()
function_decl|;
name|void
name|addRemoveAnimation
parameter_list|()
function_decl|;
name|void
name|currentAnimation
parameter_list|()
function_decl|;
name|void
name|currentAnimationWithZeroDuration
parameter_list|()
function_decl|;
name|void
name|insertAnimation
parameter_list|()
function_decl|;
name|void
name|clear
parameter_list|()
function_decl|;
name|void
name|pauseResume
parameter_list|()
function_decl|;
block|}
class|;
end_class
begin_function
DECL|function|initTestCase
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|initTestCase
parameter_list|()
block|{
name|qRegisterMetaType
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
literal|"QAbstractAnimation::State"
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|construction
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|construction
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|animationgroup
decl_stmt|;
block|}
end_function
begin_class
DECL|class|AnimationObject
class|class
name|AnimationObject
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
name|Q_PROPERTY
parameter_list|(
name|int
name|value
name|READ
name|value
name|WRITE
name|setValue
parameter_list|)
specifier|public
private|:
DECL|function|AnimationObject
name|AnimationObject
parameter_list|(
name|int
name|startValue
init|=
literal|0
parameter_list|)
member_init_list|:
name|v
argument_list|(
name|startValue
argument_list|)
block|{ }
DECL|function|value
name|int
name|value
parameter_list|()
specifier|const
block|{
return|return
name|v
return|;
block|}
DECL|function|setValue
name|void
name|setValue
parameter_list|(
name|int
name|value
parameter_list|)
block|{
name|v
operator|=
name|value
expr_stmt|;
block|}
DECL|member|v
name|int
name|v
decl_stmt|;
block|}
class|;
end_class
begin_class
DECL|class|TestAnimation
class|class
name|TestAnimation
super|:
specifier|public
name|QVariantAnimation
block|{
name|Q_OBJECT
public|public:
DECL|function|updateCurrentValue
specifier|virtual
name|void
name|updateCurrentValue
parameter_list|(
specifier|const
name|QVariant
modifier|&
name|value
parameter_list|)
block|{
name|Q_UNUSED
argument_list|(
argument|value
argument_list|)
block|}
empty_stmt|;
DECL|function|updateState
specifier|virtual
name|void
name|updateState
parameter_list|(
name|QAbstractAnimation
operator|::
name|State
name|newState
parameter_list|,
name|QAbstractAnimation
operator|::
name|State
name|oldState
parameter_list|)
block|{
name|Q_UNUSED
argument_list|(
argument|oldState
argument_list|)
name|Q_UNUSED
argument_list|(
argument|newState
argument_list|)
block|}
empty_stmt|;
block|}
class|;
end_class
begin_class
DECL|class|DummyPropertyAnimation
class|class
name|DummyPropertyAnimation
super|:
specifier|public
name|QPropertyAnimation
block|{
public|public:
DECL|function|DummyPropertyAnimation
name|DummyPropertyAnimation
parameter_list|(
name|QObject
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QPropertyAnimation
argument_list|(
name|parent
argument_list|)
block|{
name|setTargetObject
argument_list|(
operator|&
name|o
argument_list|)
expr_stmt|;
name|this
operator|->
name|setPropertyName
argument_list|(
literal|"value"
argument_list|)
expr_stmt|;
name|setEndValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
block|}
DECL|member|o
name|AnimationObject
name|o
decl_stmt|;
block|}
class|;
end_class
begin_class
DECL|class|UncontrolledAnimation
class|class
name|UncontrolledAnimation
super|:
specifier|public
name|QPropertyAnimation
block|{
name|Q_OBJECT
public|public:
DECL|function|UncontrolledAnimation
name|UncontrolledAnimation
parameter_list|(
name|QObject
modifier|*
name|target
parameter_list|,
name|QObject
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QPropertyAnimation
argument_list|(
name|target
argument_list|,
literal|"value"
argument_list|,
name|parent
argument_list|)
block|{
name|setDuration
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|setEndValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
block|}
DECL|function|duration
name|int
name|duration
parameter_list|()
specifier|const
block|{
return|return
operator|-
literal|1
return|;
comment|/* not time driven */
block|}
protected|protected:
DECL|function|updateCurrentTime
name|void
name|updateCurrentTime
parameter_list|(
name|int
name|currentTime
parameter_list|)
block|{
name|QPropertyAnimation
operator|::
name|updateCurrentTime
argument_list|(
name|currentTime
argument_list|)
expr_stmt|;
if|if
condition|(
name|currentTime
operator|>=
name|QPropertyAnimation
operator|::
name|duration
argument_list|()
condition|)
name|stop
argument_list|()
expr_stmt|;
block|}
block|}
class|;
end_class
begin_function
DECL|function|setCurrentTime
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|setCurrentTime
parameter_list|()
block|{
comment|// sequence operating on same object/property
name|QAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a2_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a3_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|a2_s_o1
operator|->
name|setLoopCount
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a2_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a3_s_o1
argument_list|)
expr_stmt|;
comment|// sequence operating on different object/properties
name|QAnimationGroup
modifier|*
name|sequence2
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o2
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o3
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|sequence2
operator|->
name|addAnimation
argument_list|(
name|a1_s_o2
argument_list|)
expr_stmt|;
name|sequence2
operator|->
name|addAnimation
argument_list|(
name|a1_s_o3
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence2
argument_list|)
expr_stmt|;
comment|// Current time = 1
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 250
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 251
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|251
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|251
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|251
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 750
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 1000
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1000
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1000
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1000
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 1010
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1010
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1010
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1010
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 1250
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 1500
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 1750
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
comment|// Current time = 2000
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|2000
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setCurrentTimeWithUncontrolledAnimation
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|setCurrentTimeWithUncontrolledAnimation
parameter_list|()
block|{
name|AnimationObject
name|t_o1
decl_stmt|;
comment|// sequence operating on different object/properties
name|QAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QPropertyAnimation
modifier|*
name|a1_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QPropertyAnimation
modifier|*
name|a1_s_o2
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o2
argument_list|)
expr_stmt|;
name|QPropertyAnimation
modifier|*
name|notTimeDriven
init|=
operator|new
name|UncontrolledAnimation
argument_list|(
operator|&
name|t_o1
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|totalDuration
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QAbstractAnimation
modifier|*
name|loopsForever
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|loopsForever
operator|->
name|setLoopCount
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|totalDuration
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|notTimeDriven
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|loopsForever
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
comment|// this allows the group to listen for the finish signal of its children
comment|// Current time = 1
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 250
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 500
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
name|notTimeDriven
argument_list|)
argument_list|)
expr_stmt|;
comment|// Current time = 505
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|505
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|505
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
name|notTimeDriven
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
comment|// Current time = 750 (end of notTimeDriven animation)
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|loopsForever
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
comment|// Current time = 800 (as notTimeDriven was finished at 750, loopsforever should still run)
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|800
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|800
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|loopsForever
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|loopsForever
operator|->
name|stop
argument_list|()
expr_stmt|;
comment|// this should stop the group
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|seekingForwards
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|seekingForwards
parameter_list|()
block|{
comment|// sequence operating on same object/property
name|QAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a2_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a3_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|a2_s_o1
operator|->
name|setLoopCount
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a2_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a3_s_o1
argument_list|)
expr_stmt|;
comment|// sequence operating on different object/properties
name|QAnimationGroup
modifier|*
name|sequence2
init|=
operator|new
name|QSequentialAnimationGroup
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o2
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o3
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|sequence2
operator|->
name|addAnimation
argument_list|(
name|a1_s_o2
argument_list|)
expr_stmt|;
name|sequence2
operator|->
name|addAnimation
argument_list|(
name|a1_s_o3
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence2
argument_list|)
expr_stmt|;
comment|// Current time = 1
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Current time = 1500
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// this will restart the group
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
comment|// Current time = 1750
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|seekingBackwards
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|seekingBackwards
parameter_list|()
block|{
comment|// sequence operating on same object/property
name|QAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a2_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a3_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|a2_s_o1
operator|->
name|setLoopCount
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a2_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a3_s_o1
argument_list|)
expr_stmt|;
comment|// sequence operating on different object/properties
name|QAnimationGroup
modifier|*
name|sequence2
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o2
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o3
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|sequence2
operator|->
name|addAnimation
argument_list|(
name|a1_s_o2
argument_list|)
expr_stmt|;
name|sequence2
operator|->
name|addAnimation
argument_list|(
name|a1_s_o3
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence2
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
comment|// Current time = 1600
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1600
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1600
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|350
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|100
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
comment|// Seeking backwards, current time = 1
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QEXPECT_FAIL
argument_list|(
literal|""
argument_list|,
literal|"rewinding in nested groups is considered as a restart from the children,"
literal|"hence they don't reset from their current animation"
argument_list|,
name|Continue
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QEXPECT_FAIL
argument_list|(
literal|""
argument_list|,
literal|"rewinding in nested groups is considered as a restart from the children,"
literal|"hence they don't reset from their current animation"
argument_list|,
name|Continue
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QEXPECT_FAIL
argument_list|(
literal|""
argument_list|,
literal|"rewinding in nested groups is considered as a restart from the children,"
literal|"hence they don't reset from their current animation"
argument_list|,
name|Continue
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
comment|// Current time = 2000
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|2000
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_typedef
DECL|typedef|StateList
typedef|typedef
name|QList
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
name|StateList
typedef|;
end_typedef
begin_function
DECL|function|compareStates
specifier|static
name|bool
name|compareStates
parameter_list|(
specifier|const
name|QSignalSpy
modifier|&
name|spy
parameter_list|,
specifier|const
name|StateList
modifier|&
name|expectedStates
parameter_list|)
block|{
name|bool
name|equals
init|=
literal|true
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|qMax
argument_list|(
name|expectedStates
operator|.
name|count
argument_list|()
argument_list|,
name|spy
operator|.
name|count
argument_list|()
argument_list|)
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|i
operator|>=
name|spy
operator|.
name|count
argument_list|()
operator|||
name|i
operator|>=
name|expectedStates
operator|.
name|count
argument_list|()
condition|)
block|{
name|equals
operator|=
literal|false
expr_stmt|;
break|break;
block|}
name|QList
argument_list|<
name|QVariant
argument_list|>
name|args
init|=
name|spy
operator|.
name|at
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QAbstractAnimation
operator|::
name|State
name|st
init|=
name|expectedStates
operator|.
name|at
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QAbstractAnimation
operator|::
name|State
name|actual
init|=
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|args
operator|.
name|first
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|equals
operator|&&
name|actual
operator|!=
name|st
condition|)
block|{
name|equals
operator|=
literal|false
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
operator|!
name|equals
condition|)
block|{
specifier|const
name|char
modifier|*
name|stateStrings
index|[]
init|=
block|{
literal|"Stopped"
block|,
literal|"Paused"
block|,
literal|"Running"
block|}
decl_stmt|;
name|QString
name|e
decl_stmt|,
name|a
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|qMax
argument_list|(
name|expectedStates
operator|.
name|count
argument_list|()
argument_list|,
name|spy
operator|.
name|count
argument_list|()
argument_list|)
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|i
operator|<
name|expectedStates
operator|.
name|count
argument_list|()
condition|)
block|{
name|int
name|exp
init|=
name|int
argument_list|(
name|expectedStates
operator|.
name|at
argument_list|(
name|i
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|e
operator|.
name|isEmpty
argument_list|()
condition|)
name|e
operator|+=
name|QLatin1String
argument_list|(
literal|", "
argument_list|)
expr_stmt|;
name|e
operator|+=
name|QLatin1String
argument_list|(
name|stateStrings
index|[
name|exp
index|]
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|<
name|spy
operator|.
name|count
argument_list|()
condition|)
block|{
name|QList
argument_list|<
name|QVariant
argument_list|>
name|args
init|=
name|spy
operator|.
name|at
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|QAbstractAnimation
operator|::
name|State
name|actual
init|=
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|args
operator|.
name|value
argument_list|(
literal|1
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|a
operator|.
name|isEmpty
argument_list|()
condition|)
name|a
operator|+=
name|QLatin1String
argument_list|(
literal|", "
argument_list|)
expr_stmt|;
if|if
condition|(
name|int
argument_list|(
name|actual
argument_list|)
operator|>=
literal|0
operator|&&
name|int
argument_list|(
name|actual
argument_list|)
operator|<=
literal|2
condition|)
block|{
name|a
operator|+=
name|QLatin1String
argument_list|(
name|stateStrings
index|[
name|int
argument_list|(
name|actual
argument_list|)
index|]
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|a
operator|+=
name|QLatin1String
argument_list|(
literal|"NaN"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|qDebug
argument_list|(
literal|"\n"
literal|"expected (count == %d): %s\n"
literal|"actual   (count == %d): %s\n"
argument_list|,
name|expectedStates
operator|.
name|count
argument_list|()
argument_list|,
name|qPrintable
argument_list|(
name|e
argument_list|)
argument_list|,
name|spy
operator|.
name|count
argument_list|()
argument_list|,
name|qPrintable
argument_list|(
name|a
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|equals
return|;
block|}
end_function
begin_function
DECL|function|pauseAndResume
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|pauseAndResume
parameter_list|()
block|{
comment|// sequence operating on same object/property
name|QAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a2_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a3_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|a2_s_o1
operator|->
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a2_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a3_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|QSignalSpy
name|a1StateChangedSpy
argument_list|(
name|a1_s_o1
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|seqStateChangedSpy
argument_list|(
name|sequence
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|a1StateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seqStateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
comment|// Current time = 1751
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1751
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1751
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|751
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1StateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|// Running,Paused,Stopped,Running,Stopped
name|QCOMPARE
argument_list|(
name|seqStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|// Running,Paused
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|a1StateChangedSpy
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|a1StateChangedSpy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|a1StateChangedSpy
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|a1StateChangedSpy
operator|.
name|at
argument_list|(
literal|2
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|a1StateChangedSpy
operator|.
name|at
argument_list|(
literal|3
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|a1StateChangedSpy
operator|.
name|at
argument_list|(
literal|4
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|group
operator|.
name|resume
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
operator|>=
literal|1751
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
operator|>=
literal|751
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
operator|>=
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|seqStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
comment|// Running,Paused,Running
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|2
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
operator|>=
literal|1751
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
operator|>=
literal|751
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
operator|>=
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|seqStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// Running,Paused,Running,Paused
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|3
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|group
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|seqStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|// Running,Paused,Running,Paused,Stopped
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|4
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|restart
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|restart
parameter_list|()
block|{
comment|// sequence operating on same object/property
name|QAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QSignalSpy
name|seqCurrentAnimChangedSpy
argument_list|(
name|sequence
argument_list|,
name|SIGNAL
argument_list|(
name|currentAnimationChanged
argument_list|(
name|QAbstractAnimation
operator|*
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|seqStateChangedSpy
argument_list|(
name|sequence
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|seqCurrentAnimChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seqStateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVariantAnimation
modifier|*
name|anims
index|[
literal|3
index|]
decl_stmt|;
name|QSignalSpy
modifier|*
name|animsStateChanged
index|[
literal|3
index|]
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|3
condition|;
name|i
operator|++
control|)
block|{
name|anims
index|[
name|i
index|]
operator|=
operator|new
name|DummyPropertyAnimation
expr_stmt|;
name|anims
index|[
name|i
index|]
operator|->
name|setDuration
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|animsStateChanged
index|[
name|i
index|]
operator|=
operator|new
name|QSignalSpy
argument_list|(
name|anims
index|[
name|i
index|]
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|animsStateChanged
index|[
name|i
index|]
operator|->
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|anims
index|[
literal|1
index|]
operator|->
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|anims
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|anims
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|anims
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|300
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|3
condition|;
name|i
operator|++
control|)
block|{
name|QCOMPARE
argument_list|(
name|animsStateChanged
index|[
name|i
index|]
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|animsStateChanged
index|[
name|i
index|]
operator|->
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|animsStateChanged
index|[
name|i
index|]
operator|->
name|at
argument_list|(
literal|1
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|animsStateChanged
index|[
name|i
index|]
operator|->
name|at
argument_list|(
literal|2
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|animsStateChanged
index|[
name|i
index|]
operator|->
name|at
argument_list|(
literal|3
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
name|QCOMPARE
argument_list|(
name|seqStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|seqStateChangedSpy
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|seqCurrentAnimChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|6
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|seqCurrentAnimChangedSpy
operator|.
name|count
argument_list|()
condition|;
name|i
operator|++
control|)
name|QCOMPARE
argument_list|(
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
name|anims
index|[
name|i
operator|%
literal|3
index|]
argument_list|)
argument_list|,
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
name|seqCurrentAnimChangedSpy
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|animsStateChanged
index|[
literal|0
index|]
operator|->
name|count
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|animsStateChanged
index|[
literal|1
index|]
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|animsStateChanged
index|[
literal|2
index|]
operator|->
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|seqStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|looping
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|looping
parameter_list|()
block|{
comment|// sequence operating on same object/property
name|QSequentialAnimationGroup
modifier|*
name|sequence
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|()
decl_stmt|;
name|QAbstractAnimation
modifier|*
name|a1_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QAbstractAnimation
modifier|*
name|a2_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QAbstractAnimation
modifier|*
name|a3_s_o1
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|QSignalSpy
name|a1Spy
argument_list|(
name|a1_s_o1
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|a2Spy
argument_list|(
name|a2_s_o1
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|a3Spy
argument_list|(
name|a3_s_o1
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|seqSpy
argument_list|(
name|sequence
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|a1Spy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|a2Spy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|a3Spy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|seqSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|a2_s_o1
operator|->
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a1_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a2_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|addAnimation
argument_list|(
name|a3_s_o1
argument_list|)
expr_stmt|;
name|sequence
operator|->
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QSignalSpy
name|groupSpy
argument_list|(
operator|&
name|group
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|groupSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|sequence
argument_list|)
expr_stmt|;
name|group
operator|.
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
comment|// Current time = 1750
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// this animation is at the beginning because it is the current one inside sequence
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentAnimation
argument_list|()
argument_list|,
name|a3_s_o1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1Spy
operator|.
name|count
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|// Running,Paused,Stopped,Running,Stopped
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|a1Spy
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2Spy
operator|.
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// Running,Stopped,Running,Stopped
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|a3Spy
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|seqSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|// Running,Paused
name|QCOMPARE
argument_list|(
name|groupSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|// Running,Paused
comment|// Looping, current time = duration + 1
name|group
operator|.
name|setCurrentTime
argument_list|(
name|group
operator|.
name|duration
argument_list|()
operator|+
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|// this animation is at the end because it was run on the previous loop
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoop
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|sequence
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3_s_o1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1Spy
operator|.
name|count
argument_list|()
argument_list|,
literal|7
argument_list|)
expr_stmt|;
comment|// Running,Paused,Stopped,Running,Stopped,Running,Stopped
name|QCOMPARE
argument_list|(
name|a2Spy
operator|.
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|// Running, Stopped, Running, Stopped
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|a3Spy
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|seqSpy
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|groupSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|startDelay
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|startDelay
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|addPause
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|group
operator|.
name|addPause
argument_list|(
literal|125
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|totalDuration
argument_list|()
argument_list|,
literal|375
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
operator|==
literal|375
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|clearGroup
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|clearGroup
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
specifier|static
specifier|const
name|int
name|animationCount
init|=
literal|20
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|animationCount
operator|/
literal|2
condition|;
operator|++
name|i
control|)
block|{
name|QSequentialAnimationGroup
modifier|*
name|subGroup
init|=
operator|new
name|QSequentialAnimationGroup
argument_list|(
operator|&
name|group
argument_list|)
decl_stmt|;
name|group
operator|.
name|addPause
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|subGroup
operator|->
name|addPause
argument_list|(
literal|10
argument_list|)
expr_stmt|;
block|}
name|QCOMPARE
argument_list|(
name|group
operator|.
name|animationCount
argument_list|()
argument_list|,
name|animationCount
argument_list|)
expr_stmt|;
name|QPointer
argument_list|<
name|QAbstractAnimation
argument_list|>
name|children
index|[
name|animationCount
index|]
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|animationCount
condition|;
operator|++
name|i
control|)
block|{
name|QVERIFY
argument_list|(
name|group
operator|.
name|animationAt
argument_list|(
name|i
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|children
index|[
name|i
index|]
operator|=
name|group
operator|.
name|animationAt
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
name|group
operator|.
name|clear
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|animationCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|animationCount
condition|;
operator|++
name|i
control|)
name|QVERIFY
argument_list|(
name|children
index|[
name|i
index|]
operator|.
name|isNull
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|groupWithZeroDurationAnimations
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|groupWithZeroDurationAnimations
parameter_list|()
block|{
name|QObject
name|o
decl_stmt|;
name|QObject
name|o2
decl_stmt|;
name|o
operator|.
name|setProperty
argument_list|(
literal|"myProperty"
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|o
operator|.
name|setProperty
argument_list|(
literal|"myOtherProperty"
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|o2
operator|.
name|setProperty
argument_list|(
literal|"myProperty"
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|o2
operator|.
name|setProperty
argument_list|(
literal|"myOtherProperty"
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QVariantAnimation
modifier|*
name|a1
init|=
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|o
argument_list|,
literal|"myProperty"
argument_list|)
decl_stmt|;
name|a1
operator|->
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|a1
operator|->
name|setEndValue
argument_list|(
literal|43
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|a1
argument_list|)
expr_stmt|;
comment|//this should just run fine and change nothing
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
name|a1
argument_list|)
argument_list|)
expr_stmt|;
name|QVariantAnimation
modifier|*
name|a2
init|=
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|o2
argument_list|,
literal|"myOtherProperty"
argument_list|)
decl_stmt|;
name|a2
operator|->
name|setDuration
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|a2
operator|->
name|setEndValue
argument_list|(
literal|31
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|a2
argument_list|)
expr_stmt|;
name|QVariantAnimation
modifier|*
name|a3
init|=
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|o
argument_list|,
literal|"myProperty"
argument_list|)
decl_stmt|;
name|a3
operator|->
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|a3
operator|->
name|setEndValue
argument_list|(
literal|44
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|a3
argument_list|)
expr_stmt|;
name|QVariantAnimation
modifier|*
name|a4
init|=
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|o
argument_list|,
literal|"myOtherProperty"
argument_list|)
decl_stmt|;
name|a4
operator|->
name|setDuration
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|a4
operator|->
name|setEndValue
argument_list|(
literal|75
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|a4
argument_list|)
expr_stmt|;
name|QVariantAnimation
modifier|*
name|a5
init|=
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|o2
argument_list|,
literal|"myProperty"
argument_list|)
decl_stmt|;
name|a5
operator|->
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|a5
operator|->
name|setEndValue
argument_list|(
literal|12
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|a5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|43
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|int
name|o2val
init|=
name|o2
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|o2val
operator|>
literal|13
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|o2val
operator|<
literal|31
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|43
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|44
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|31
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a4
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a5
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|500
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|44
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|75
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o2
operator|.
name|property
argument_list|(
literal|"myOtherProperty"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|31
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a4
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a5
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|propagateGroupUpdateToChildren
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|propagateGroupUpdateToChildren
parameter_list|()
block|{
comment|// this test verifies if group state changes are updating its children correctly
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QObject
name|o
decl_stmt|;
name|o
operator|.
name|setProperty
argument_list|(
literal|"ole"
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"ole"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QPropertyAnimation
name|anim1
argument_list|(
operator|&
name|o
argument_list|,
literal|"ole"
argument_list|)
decl_stmt|;
name|anim1
operator|.
name|setEndValue
argument_list|(
literal|43
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|setDuration
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|anim1
operator|.
name|currentValue
argument_list|()
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|o
operator|.
name|property
argument_list|(
literal|"ole"
argument_list|)
operator|.
name|toInt
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|TestAnimation
name|anim2
decl_stmt|;
name|anim2
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim2
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim2
operator|.
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|anim2
operator|.
name|currentValue
argument_list|()
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|currentValue
argument_list|()
operator|.
name|toInt
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim2
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|updateChildrenWithRunningGroup
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|updateChildrenWithRunningGroup
parameter_list|()
block|{
comment|// assert that its possible to modify a child's state directly while their group is running
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|TestAnimation
name|anim
decl_stmt|;
name|anim
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim
operator|.
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|QSignalSpy
name|groupStateChangedSpy
argument_list|(
operator|&
name|group
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|childStateChangedSpy
argument_list|(
operator|&
name|anim
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|groupStateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|childStateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|groupStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|groupStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|groupStateChangedSpy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|childStateChangedSpy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
comment|// starting directly a running child will not have any effect
name|anim
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|groupStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|childStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|anim
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
comment|// in the animation stops directly, the group will still be running
name|anim
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|deleteChildrenWithRunningGroup
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|deleteChildrenWithRunningGroup
parameter_list|()
block|{
comment|// test if children can be activated when their group is stopped
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QVariantAnimation
modifier|*
name|anim1
init|=
operator|new
name|TestAnimation
decl_stmt|;
name|anim1
operator|->
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
name|anim1
operator|->
name|duration
argument_list|()
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QTRY_VERIFY
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
operator|>
literal|0
argument_list|)
expr_stmt|;
operator|delete
name|anim1
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|animationCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|//that's the invariant
block|}
end_function
begin_function
DECL|function|startChildrenWithStoppedGroup
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|startChildrenWithStoppedGroup
parameter_list|()
block|{
comment|// test if children can be activated when their group is stopped
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|TestAnimation
name|anim1
decl_stmt|;
name|anim1
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|TestAnimation
name|anim2
decl_stmt|;
name|anim2
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim2
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim2
operator|.
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim2
argument_list|)
expr_stmt|;
name|group
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|start
argument_list|()
expr_stmt|;
name|anim2
operator|.
name|start
argument_list|()
expr_stmt|;
name|anim2
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|stopGroupWithRunningChild
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|stopGroupWithRunningChild
parameter_list|()
block|{
comment|// children that started independently will not be affected by a group stop
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|TestAnimation
name|anim1
decl_stmt|;
name|anim1
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|TestAnimation
name|anim2
decl_stmt|;
name|anim2
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim2
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim2
operator|.
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim2
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|start
argument_list|()
expr_stmt|;
name|anim2
operator|.
name|start
argument_list|()
expr_stmt|;
name|anim2
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|group
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|anim1
operator|.
name|stop
argument_list|()
expr_stmt|;
name|anim2
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|startGroupWithRunningChild
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|startGroupWithRunningChild
parameter_list|()
block|{
comment|// as the group has precedence over its children, starting a group will restart all the children
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|TestAnimation
modifier|*
name|anim1
init|=
operator|new
name|TestAnimation
argument_list|()
decl_stmt|;
name|anim1
operator|->
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|TestAnimation
modifier|*
name|anim2
init|=
operator|new
name|TestAnimation
argument_list|()
decl_stmt|;
name|anim2
operator|->
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim2
operator|->
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim2
operator|->
name|setDuration
argument_list|(
literal|200
argument_list|)
expr_stmt|;
name|QSignalSpy
name|stateChangedSpy1
argument_list|(
name|anim1
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QSignalSpy
name|stateChangedSpy2
argument_list|(
name|anim2
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|stateChangedSpy1
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|stateChangedSpy2
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stateChangedSpy1
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stateChangedSpy2
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim2
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|start
argument_list|()
expr_stmt|;
name|anim2
operator|->
name|start
argument_list|()
expr_stmt|;
name|anim2
operator|->
name|pause
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|stateChangedSpy1
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|stateChangedSpy2
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|stateChangedSpy1
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Stopped
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|compareStates
argument_list|(
name|stateChangedSpy2
argument_list|,
operator|(
name|StateList
argument_list|()
operator|<<
name|QAbstractAnimation
operator|::
name|Running
operator|<<
name|QAbstractAnimation
operator|::
name|Paused
operator|)
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|300
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stateChangedSpy2
operator|.
name|count
argument_list|()
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|stateChangedSpy2
operator|.
name|at
argument_list|(
literal|2
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|stateChangedSpy2
operator|.
name|at
argument_list|(
literal|3
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|group
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|zeroDurationAnimation
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|zeroDurationAnimation
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|TestAnimation
modifier|*
name|anim1
init|=
operator|new
name|TestAnimation
argument_list|()
decl_stmt|;
name|anim1
operator|->
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim1
operator|->
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|TestAnimation
modifier|*
name|anim2
init|=
operator|new
name|TestAnimation
argument_list|()
decl_stmt|;
name|anim2
operator|->
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|anim2
operator|->
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim2
operator|->
name|setDuration
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|DummyPropertyAnimation
modifier|*
name|anim3
init|=
operator|new
name|DummyPropertyAnimation
decl_stmt|;
name|anim3
operator|->
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|anim3
operator|->
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QSignalSpy
name|stateChangedSpy
argument_list|(
name|anim1
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|stateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim2
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim3
argument_list|)
expr_stmt|;
name|group
operator|.
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|stateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|stateChangedSpy
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qvariant_cast
argument_list|<
name|QAbstractAnimation
operator|::
name|State
argument_list|>
argument_list|(
name|stateChangedSpy
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|.
name|first
argument_list|()
argument_list|)
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
comment|//now let's try to seek to the next loop
name|group
operator|.
name|setCurrentTime
argument_list|(
name|group
operator|.
name|duration
argument_list|()
operator|+
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim2
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim3
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim3
operator|->
name|o
operator|.
name|value
argument_list|()
argument_list|,
literal|100
argument_list|)
expr_stmt|;
comment|//anim3 should have been run
block|}
end_function
begin_function
DECL|function|stopUncontrolledAnimations
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|stopUncontrolledAnimations
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|AnimationObject
name|o1
decl_stmt|;
name|UncontrolledAnimation
name|notTimeDriven
argument_list|(
operator|&
name|o1
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|totalDuration
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|TestAnimation
name|loopsForever
decl_stmt|;
name|loopsForever
operator|.
name|setStartValue
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|loopsForever
operator|.
name|setEndValue
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|loopsForever
operator|.
name|setDuration
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|loopsForever
operator|.
name|setLoopCount
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|notTimeDriven
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|loopsForever
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|notTimeDriven
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|loopsForever
operator|.
name|stop
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|loopsForever
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|finishWithUncontrolledAnimation
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|finishWithUncontrolledAnimation
parameter_list|()
block|{
name|AnimationObject
name|o1
decl_stmt|;
comment|//1st case:
comment|//first we test a group with one uncontrolled animation
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|UncontrolledAnimation
name|notTimeDriven
argument_list|(
operator|&
name|o1
argument_list|,
operator|&
name|group
argument_list|)
decl_stmt|;
name|QSignalSpy
name|spy
argument_list|(
operator|&
name|group
argument_list|,
name|SIGNAL
argument_list|(
name|finished
argument_list|()
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|spy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|300
argument_list|)
expr_stmt|;
comment|//wait for the end of notTimeDriven
name|QTRY_COMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
specifier|const
name|int
name|actualDuration
init|=
name|notTimeDriven
operator|.
name|currentLoopTime
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
name|actualDuration
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|//2nd case:
comment|// lets make sure the seeking will work again
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|DummyPropertyAnimation
name|anim
argument_list|(
operator|&
name|group
argument_list|)
decl_stmt|;
name|QSignalSpy
name|animStateChangedSpy
argument_list|(
operator|&
name|anim
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|animStateChangedSpy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|300
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
name|actualDuration
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|anim
argument_list|)
argument_list|)
expr_stmt|;
comment|//3rd case:
comment|//now let's add a perfectly defined animation at the end
name|QCOMPARE
argument_list|(
name|animStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|notTimeDriven
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|animStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|300
argument_list|)
expr_stmt|;
comment|//wait for the end of notTimeDriven
name|QTRY_COMPARE
argument_list|(
name|notTimeDriven
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|anim
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|animStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|300
argument_list|)
expr_stmt|;
comment|//wait for the end of anim
name|QTRY_COMPARE
argument_list|(
name|anim
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
name|anim
operator|.
name|duration
argument_list|()
argument_list|)
expr_stmt|;
comment|//we should simply be at the end
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|animStateChangedSpy
operator|.
name|count
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
name|notTimeDriven
operator|.
name|currentLoopTime
argument_list|()
operator|+
name|anim
operator|.
name|currentLoopTime
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|addRemoveAnimation
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|addRemoveAnimation
parameter_list|()
block|{
comment|//this test is specific to the sequential animation group
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QAbstractAnimation
modifier|*
name|anim1
init|=
operator|new
name|QPropertyAnimation
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim1
argument_list|)
expr_stmt|;
comment|//let's append an animation
name|QAbstractAnimation
modifier|*
name|anim2
init|=
operator|new
name|QPropertyAnimation
decl_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
name|anim2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
literal|500
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim1
argument_list|)
expr_stmt|;
comment|//let's prepend an animation
name|QAbstractAnimation
modifier|*
name|anim0
init|=
operator|new
name|QPropertyAnimation
decl_stmt|;
name|group
operator|.
name|insertAnimation
argument_list|(
literal|0
argument_list|,
name|anim0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
literal|750
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim0
argument_list|)
expr_stmt|;
comment|//anim0 has become the new currentAnimation
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|300
argument_list|)
expr_stmt|;
comment|//anim0 | anim1 | anim2
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|300
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|group
operator|.
name|removeAnimation
argument_list|(
name|anim0
argument_list|)
expr_stmt|;
comment|//anim1 | anim2
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|group
operator|.
name|insertAnimation
argument_list|(
literal|0
argument_list|,
name|anim0
argument_list|)
expr_stmt|;
comment|//anim0 | anim1 | anim2
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|300
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|300
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim1
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|50
argument_list|)
expr_stmt|;
name|group
operator|.
name|removeAnimation
argument_list|(
name|anim1
argument_list|)
expr_stmt|;
comment|//anim0 | anim2
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
name|anim2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim0
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|currentAnimation
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|currentAnimation
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QVERIFY
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QPropertyAnimation
name|anim
decl_stmt|;
name|anim
operator|.
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|anim
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|currentAnimationWithZeroDuration
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|currentAnimationWithZeroDuration
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|QVERIFY
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QPropertyAnimation
name|zero1
decl_stmt|;
name|zero1
operator|.
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QPropertyAnimation
name|zero2
decl_stmt|;
name|zero2
operator|.
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QPropertyAnimation
name|anim
decl_stmt|;
name|QPropertyAnimation
name|zero3
decl_stmt|;
name|zero3
operator|.
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QPropertyAnimation
name|zero4
decl_stmt|;
name|zero4
operator|.
name|setDuration
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|zero1
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|zero2
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|anim
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|zero3
argument_list|)
expr_stmt|;
name|group
operator|.
name|addAnimation
argument_list|(
operator|&
name|zero4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|zero1
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|anim
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|zero4
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|.
name|setDirection
argument_list|(
name|QAbstractAnimation
operator|::
name|Backward
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|zero1
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentAnimation
argument_list|()
argument_list|,
cast|static_cast
argument_list|<
name|QAbstractAnimation
operator|*
argument_list|>
argument_list|(
operator|&
name|anim
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|insertAnimation
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|insertAnimation
parameter_list|()
block|{
name|QSequentialAnimationGroup
name|group
decl_stmt|;
name|group
operator|.
name|setLoopCount
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|QPropertyAnimation
modifier|*
name|anim
init|=
operator|new
name|DummyPropertyAnimation
argument_list|(
operator|&
name|group
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
name|anim
operator|->
name|duration
argument_list|()
argument_list|)
expr_stmt|;
name|group
operator|.
name|setCurrentTime
argument_list|(
literal|300
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoop
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|//this will crash if the sequential group calls duration on the created animation
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|group
argument_list|)
expr_stmt|;
block|}
end_function
begin_class
DECL|class|SequentialAnimationGroup
class|class
name|SequentialAnimationGroup
super|:
specifier|public
name|QSequentialAnimationGroup
block|{
name|Q_OBJECT
public|public
name|slots
public|:
DECL|function|clear
name|void
name|clear
parameter_list|()
block|{
name|QSequentialAnimationGroup
operator|::
name|clear
argument_list|()
expr_stmt|;
block|}
DECL|function|refill
name|void
name|refill
parameter_list|()
block|{
name|stop
argument_list|()
expr_stmt|;
name|clear
argument_list|()
expr_stmt|;
operator|new
name|DummyPropertyAnimation
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|start
argument_list|()
expr_stmt|;
block|}
block|}
class|;
end_class
begin_function
DECL|function|clear
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|clear
parameter_list|()
block|{
name|SequentialAnimationGroup
name|group
decl_stmt|;
name|QPointer
argument_list|<
name|QAbstractAnimation
argument_list|>
name|anim1
init|=
operator|new
name|DummyPropertyAnimation
argument_list|(
operator|&
name|group
argument_list|)
decl_stmt|;
name|group
operator|.
name|connect
argument_list|(
name|anim1
argument_list|,
name|SIGNAL
argument_list|(
name|finished
argument_list|()
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|clear
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
operator|new
name|DummyPropertyAnimation
argument_list|(
operator|&
name|group
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|animationCount
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
name|anim1
operator|->
name|duration
argument_list|()
operator|+
literal|100
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|group
operator|.
name|animationCount
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAbstractAnimation
operator|::
name|Stopped
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|anim1
operator|=
operator|new
name|DummyPropertyAnimation
argument_list|(
operator|&
name|group
argument_list|)
expr_stmt|;
name|group
operator|.
name|connect
argument_list|(
name|anim1
argument_list|,
name|SIGNAL
argument_list|(
name|finished
argument_list|()
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|refill
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
name|anim1
operator|->
name|duration
argument_list|()
operator|+
literal|100
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAbstractAnimation
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|anim1
operator|==
literal|0
argument_list|)
expr_stmt|;
comment|//anim1 should have been deleted
block|}
end_function
begin_function
DECL|function|pauseResume
name|void
name|tst_QSequentialAnimationGroup
operator|::
name|pauseResume
parameter_list|()
block|{
name|QObject
name|dummy
decl_stmt|;
name|dummy
operator|.
name|setProperty
argument_list|(
literal|"foo"
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QParallelAnimationGroup
name|group
decl_stmt|;
name|QPropertyAnimation
modifier|*
name|anim
init|=
operator|new
name|QPropertyAnimation
argument_list|(
operator|&
name|dummy
argument_list|,
literal|"foo"
argument_list|,
operator|&
name|group
argument_list|)
decl_stmt|;
name|anim
operator|->
name|setDuration
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|anim
operator|->
name|setEndValue
argument_list|(
literal|250
argument_list|)
expr_stmt|;
name|QSignalSpy
name|spy
argument_list|(
name|anim
argument_list|,
name|SIGNAL
argument_list|(
name|stateChanged
argument_list|(
name|QAbstractAnimation
operator|::
name|State
argument_list|,
name|QAbstractAnimation
operator|::
name|State
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|spy
operator|.
name|isValid
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|duration
argument_list|()
argument_list|,
literal|250
argument_list|)
expr_stmt|;
name|group
operator|.
name|start
argument_list|()
expr_stmt|;
name|QTest
operator|::
name|qWait
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|QTRY_COMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
specifier|const
name|int
name|currentTime
init|=
name|group
operator|.
name|currentLoopTime
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
name|currentTime
argument_list|)
expr_stmt|;
name|group
operator|.
name|pause
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
name|currentTime
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Paused
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
name|currentTime
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|spy
operator|.
name|clear
argument_list|()
expr_stmt|;
name|group
operator|.
name|resume
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|group
operator|.
name|currentLoopTime
argument_list|()
argument_list|,
name|currentTime
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|->
name|state
argument_list|()
argument_list|,
name|QAnimationGroup
operator|::
name|Running
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|anim
operator|->
name|currentLoopTime
argument_list|()
argument_list|,
name|currentTime
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|spy
operator|.
name|count
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QSequentialAnimationGroup
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qsequentialanimationgroup.moc"
end_include
end_unit
