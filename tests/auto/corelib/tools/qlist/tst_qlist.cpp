begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2016 The Qt Company Ltd. ** Contact: https://www.qt.io/licensing/ ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:GPL-EXCEPT$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and The Qt Company. For licensing terms ** and conditions see https://www.qt.io/terms-conditions. For further ** information use the contact form at https://www.qt.io/contact-us. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU ** General Public License version 3 as published by the Free Software ** Foundation with exceptions as appearing in the file LICENSE.GPL3-EXCEPT ** included in the packaging of this file. Please review the following ** information to ensure the GNU General Public License requirements will ** be met: https://www.gnu.org/licenses/gpl-3.0.html. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<QList>
end_include
begin_class
template|template
parameter_list|<
name|typename
name|T
parameter_list|,
name|class
name|MemoryLayout
parameter_list|>
class|class
DECL|class|is_qlist_array_memory_layout
name|is_qlist_array_memory_layout
block|{
DECL|struct|No
DECL|member|c
struct|struct
name|No
block|{
name|char
name|c
decl_stmt|;
block|}
struct|;
DECL|struct|Yes
DECL|member|n
struct|struct
name|Yes
block|{
name|No
name|n
index|[
literal|2
index|]
decl_stmt|;
block|}
struct|;
name|Q_STATIC_ASSERT
argument_list|(
argument|sizeof(No) != sizeof(Yes)
argument_list|)
empty_stmt|;
specifier|static
name|No
name|check
parameter_list|(
modifier|...
parameter_list|)
function_decl|;
specifier|static
name|Yes
name|check
parameter_list|(
name|MemoryLayout
parameter_list|)
function_decl|;
public|public:
DECL|enumerator|value
enum|enum
block|{
name|value
init|=
sizeof|sizeof
argument_list|(
name|check
argument_list|(
typename|typename
name|QList
argument_list|<
name|T
argument_list|>
operator|::
name|MemoryLayout
argument_list|()
argument_list|)
argument_list|)
operator|==
expr|sizeof
operator|(
name|Yes
operator|)
block|}
enum|;
block|}
class|;
end_class
begin_struct
DECL|struct|Movable
struct|struct
name|Movable
block|{
DECL|function|Movable
name|Movable
parameter_list|(
name|char
name|input
init|=
literal|'j'
parameter_list|)
member_init_list|:
name|i
argument_list|(
name|input
argument_list|)
member_init_list|,
name|state
argument_list|(
name|Constructed
argument_list|)
block|{
operator|++
name|liveCount
expr_stmt|;
block|}
DECL|function|Movable
name|Movable
parameter_list|(
specifier|const
name|Movable
modifier|&
name|other
parameter_list|)
member_init_list|:
name|i
argument_list|(
name|other
operator|.
name|i
argument_list|)
member_init_list|,
name|state
argument_list|(
name|Constructed
argument_list|)
block|{
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
operator|++
name|liveCount
expr_stmt|;
block|}
DECL|function|~Movable
name|~
name|Movable
parameter_list|()
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
operator|--
name|liveCount
expr_stmt|;
name|state
operator|=
name|Destructed
expr_stmt|;
block|}
DECL|function|operator ==
name|bool
name|operator
name|==
parameter_list|(
specifier|const
name|Movable
modifier|&
name|other
parameter_list|)
specifier|const
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
return|return
name|i
operator|==
name|other
operator|.
name|i
return|;
block|}
DECL|function|operator <
name|bool
name|operator
name|<
parameter_list|(
specifier|const
name|Movable
modifier|&
name|other
parameter_list|)
specifier|const
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
return|return
name|i
operator|<
name|other
operator|.
name|i
return|;
block|}
DECL|function|operator =
name|Movable
modifier|&
name|operator
name|=
parameter_list|(
specifier|const
name|Movable
modifier|&
name|other
parameter_list|)
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|i
operator|=
name|other
operator|.
name|i
expr_stmt|;
return|return
operator|*
name|this
return|;
block|}
DECL|member|i
name|char
name|i
decl_stmt|;
DECL|function|getLiveCount
specifier|static
name|int
name|getLiveCount
parameter_list|()
block|{
return|return
name|liveCount
return|;
block|}
private|private:
DECL|member|liveCount
specifier|static
name|int
name|liveCount
decl_stmt|;
DECL|enum|State
DECL|enumerator|Constructed
DECL|enumerator|Destructed
enum|enum
name|State
block|{
name|Constructed
init|=
literal|106
block|,
name|Destructed
init|=
literal|110
block|}
enum|;
DECL|member|state
name|uchar
name|state
decl_stmt|;
DECL|function|check
specifier|static
name|void
name|check
parameter_list|(
specifier|const
name|uchar
name|state1
parameter_list|,
specifier|const
name|uchar
name|state2
parameter_list|)
block|{
name|QCOMPARE
argument_list|(
name|state1
argument_list|,
name|state2
argument_list|)
expr_stmt|;
block|}
block|}
struct|;
end_struct
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
sizeof|sizeof
argument_list|(
name|Movable
argument_list|)
operator|<
sizeof|sizeof
argument_list|(
name|void
operator|*
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_decl_stmt
DECL|member|liveCount
name|int
name|Movable
operator|::
name|liveCount
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_function_decl
name|QT_BEGIN_NAMESPACE
name|Q_DECLARE_TYPEINFO
parameter_list|(
name|Movable
parameter_list|,
name|Q_MOVABLE_TYPE
parameter_list|)
function_decl|;
end_function_decl
begin_function_decl
name|QT_END_NAMESPACE
name|Q_DECLARE_METATYPE
parameter_list|(
name|Movable
parameter_list|)
function_decl|;
end_function_decl
begin_function
DECL|function|qHash
name|int
name|qHash
parameter_list|(
specifier|const
name|Movable
modifier|&
name|movable
parameter_list|)
block|{
return|return
name|qHash
argument_list|(
name|movable
operator|.
name|i
argument_list|)
return|;
block|}
end_function
begin_struct
DECL|struct|Optimal
struct|struct
name|Optimal
block|{
DECL|function|Optimal
name|Optimal
parameter_list|(
name|char
name|input
init|=
literal|'j'
parameter_list|)
member_init_list|:
name|i
argument_list|(
name|input
argument_list|)
member_init_list|,
name|state
argument_list|(
name|Constructed
argument_list|)
block|{
operator|++
name|liveCount
expr_stmt|;
block|}
DECL|function|Optimal
name|Optimal
parameter_list|(
specifier|const
name|Optimal
modifier|&
name|other
parameter_list|)
member_init_list|:
name|i
argument_list|(
name|other
operator|.
name|i
argument_list|)
member_init_list|,
name|state
argument_list|(
name|Constructed
argument_list|)
block|{
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
operator|++
name|liveCount
expr_stmt|;
block|}
DECL|function|~Optimal
name|~
name|Optimal
parameter_list|()
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
operator|--
name|liveCount
expr_stmt|;
name|state
operator|=
name|Destructed
expr_stmt|;
block|}
DECL|function|operator ==
name|bool
name|operator
name|==
parameter_list|(
specifier|const
name|Optimal
modifier|&
name|other
parameter_list|)
specifier|const
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
return|return
name|i
operator|==
name|other
operator|.
name|i
return|;
block|}
DECL|function|operator <
name|bool
name|operator
name|<
parameter_list|(
specifier|const
name|Optimal
modifier|&
name|other
parameter_list|)
specifier|const
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
return|return
name|i
operator|<
name|other
operator|.
name|i
return|;
block|}
DECL|function|operator =
name|Optimal
modifier|&
name|operator
name|=
parameter_list|(
specifier|const
name|Optimal
modifier|&
name|other
parameter_list|)
block|{
name|check
argument_list|(
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|check
argument_list|(
name|other
operator|.
name|state
argument_list|,
name|Constructed
argument_list|)
expr_stmt|;
name|i
operator|=
name|other
operator|.
name|i
expr_stmt|;
return|return
operator|*
name|this
return|;
block|}
DECL|member|i
name|char
name|i
decl_stmt|;
DECL|function|getLiveCount
specifier|static
name|int
name|getLiveCount
parameter_list|()
block|{
return|return
name|liveCount
return|;
block|}
private|private:
DECL|member|liveCount
specifier|static
name|int
name|liveCount
decl_stmt|;
DECL|enum|State
DECL|enumerator|Constructed
DECL|enumerator|Destructed
enum|enum
name|State
block|{
name|Constructed
init|=
literal|106
block|,
name|Destructed
init|=
literal|110
block|}
enum|;
DECL|member|state
name|uchar
name|state
decl_stmt|;
DECL|member|padding
name|char
name|padding
index|[
sizeof|sizeof
argument_list|(
name|void
operator|*
argument_list|)
operator|-
literal|2
index|]
decl_stmt|;
DECL|function|check
specifier|static
name|void
name|check
parameter_list|(
specifier|const
name|uchar
name|state1
parameter_list|,
specifier|const
name|uchar
name|state2
parameter_list|)
block|{
name|QCOMPARE
argument_list|(
name|state1
argument_list|,
name|state2
argument_list|)
expr_stmt|;
block|}
block|}
struct|;
end_struct
begin_expr_stmt
DECL|variable|sizeof
name|Q_STATIC_ASSERT
argument_list|(
sizeof|sizeof
argument_list|(
name|Optimal
argument_list|)
operator|==
sizeof|sizeof
argument_list|(
name|void
operator|*
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_decl_stmt
DECL|member|liveCount
name|int
name|Optimal
operator|::
name|liveCount
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_function_decl
name|QT_BEGIN_NAMESPACE
name|Q_DECLARE_TYPEINFO
parameter_list|(
name|Optimal
parameter_list|,
name|Q_MOVABLE_TYPE
parameter_list|)
function_decl|;
end_function_decl
begin_function_decl
name|QT_END_NAMESPACE
name|Q_DECLARE_METATYPE
parameter_list|(
name|Optimal
parameter_list|)
function_decl|;
end_function_decl
begin_function
DECL|function|qHash
name|int
name|qHash
parameter_list|(
specifier|const
name|Optimal
modifier|&
name|key
parameter_list|)
block|{
return|return
name|qHash
argument_list|(
name|key
operator|.
name|i
argument_list|)
return|;
block|}
end_function
begin_struct
DECL|struct|Complex
struct|struct
name|Complex
block|{
DECL|function|Complex
name|Complex
parameter_list|(
name|int
name|val
init|=
literal|0
parameter_list|)
member_init_list|:
name|value
argument_list|(
name|val
argument_list|)
member_init_list|,
name|checkSum
argument_list|(
name|this
argument_list|)
block|{
operator|++
name|liveCount
expr_stmt|;
block|}
DECL|function|Complex
name|Complex
parameter_list|(
name|Complex
specifier|const
modifier|&
name|other
parameter_list|)
member_init_list|:
name|value
argument_list|(
name|other
operator|.
name|value
argument_list|)
member_init_list|,
name|checkSum
argument_list|(
name|this
argument_list|)
block|{
operator|++
name|liveCount
expr_stmt|;
block|}
DECL|function|operator =
name|Complex
modifier|&
name|operator
name|=
parameter_list|(
name|Complex
specifier|const
modifier|&
name|other
parameter_list|)
block|{
name|check
argument_list|()
expr_stmt|;
name|other
operator|.
name|check
argument_list|()
expr_stmt|;
name|value
operator|=
name|other
operator|.
name|value
expr_stmt|;
return|return
operator|*
name|this
return|;
block|}
DECL|function|~Complex
name|~
name|Complex
parameter_list|()
block|{
operator|--
name|liveCount
expr_stmt|;
name|check
argument_list|()
expr_stmt|;
block|}
DECL|function|operator int
name|operator
name|int
parameter_list|()
specifier|const
block|{
return|return
name|value
return|;
block|}
DECL|function|operator ==
name|bool
name|operator
name|==
parameter_list|(
name|Complex
specifier|const
modifier|&
name|other
parameter_list|)
specifier|const
block|{
name|check
argument_list|()
expr_stmt|;
name|other
operator|.
name|check
argument_list|()
expr_stmt|;
return|return
name|value
operator|==
name|other
operator|.
name|value
return|;
block|}
DECL|function|operator <
name|bool
name|operator
name|<
parameter_list|(
name|Complex
specifier|const
modifier|&
name|other
parameter_list|)
specifier|const
block|{
name|check
argument_list|()
expr_stmt|;
name|other
operator|.
name|check
argument_list|()
expr_stmt|;
return|return
name|value
operator|<
name|other
operator|.
name|value
return|;
block|}
DECL|function|check
name|void
name|check
parameter_list|()
specifier|const
block|{
name|QVERIFY
argument_list|(
name|this
operator|==
name|checkSum
argument_list|)
expr_stmt|;
block|}
DECL|function|getLiveCount
specifier|static
name|int
name|getLiveCount
parameter_list|()
block|{
return|return
name|liveCount
return|;
block|}
private|private:
DECL|member|liveCount
specifier|static
name|int
name|liveCount
decl_stmt|;
DECL|member|value
name|int
name|value
decl_stmt|;
DECL|member|checkSum
name|void
modifier|*
name|checkSum
decl_stmt|;
block|}
struct|;
end_struct
begin_decl_stmt
DECL|member|liveCount
name|int
name|Complex
operator|::
name|liveCount
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_expr_stmt
DECL|variable|Complex
name|Q_DECLARE_METATYPE
argument_list|(
name|Complex
argument_list|)
expr_stmt|;
end_expr_stmt
begin_comment
comment|// Tests depend on the fact that:
end_comment
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|!
name|QTypeInfo
argument_list|<
name|int
argument_list|>
operator|::
name|isStatic
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|!
name|QTypeInfo
argument_list|<
name|int
argument_list|>
operator|::
name|isComplex
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|!
name|QTypeInfo
argument_list|<
name|Movable
argument_list|>
operator|::
name|isStatic
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
DECL|variable|isComplex
name|Q_STATIC_ASSERT
argument_list|(
name|QTypeInfo
argument_list|<
name|Movable
argument_list|>
operator|::
name|isComplex
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|!
name|QTypeInfo
argument_list|<
name|Optimal
argument_list|>
operator|::
name|isStatic
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
DECL|variable|isComplex
name|Q_STATIC_ASSERT
argument_list|(
name|QTypeInfo
argument_list|<
name|Optimal
argument_list|>
operator|::
name|isComplex
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
DECL|variable|isStatic
name|Q_STATIC_ASSERT
argument_list|(
name|QTypeInfo
argument_list|<
name|Complex
argument_list|>
operator|::
name|isStatic
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
DECL|variable|isComplex
name|Q_STATIC_ASSERT
argument_list|(
name|QTypeInfo
argument_list|<
name|Complex
argument_list|>
operator|::
name|isComplex
argument_list|)
expr_stmt|;
end_expr_stmt
begin_comment
comment|// iow:
end_comment
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|int
argument_list|,
name|QListData
operator|::
name|NotIndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|int
argument_list|,
name|QListData
operator|::
name|IndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Optimal
argument_list|,
name|QListData
operator|::
name|InlineWithPaddingLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Optimal
argument_list|,
name|QListData
operator|::
name|NotArrayCompatibleLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Optimal
argument_list|,
name|QListData
operator|::
name|NotIndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Optimal
argument_list|,
name|QListData
operator|::
name|ArrayCompatibleLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Optimal
argument_list|,
name|QListData
operator|::
name|IndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Movable
argument_list|,
name|QListData
operator|::
name|InlineWithPaddingLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Movable
argument_list|,
name|QListData
operator|::
name|NotArrayCompatibleLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Movable
argument_list|,
name|QListData
operator|::
name|NotIndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Movable
argument_list|,
name|QListData
operator|::
name|ArrayCompatibleLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Movable
argument_list|,
name|QListData
operator|::
name|IndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Complex
argument_list|,
name|QListData
operator|::
name|InlineWithPaddingLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Complex
argument_list|,
name|QListData
operator|::
name|NotArrayCompatibleLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Complex
argument_list|,
name|QListData
operator|::
name|NotIndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
operator|!
name|is_qlist_array_memory_layout
argument_list|<
name|Complex
argument_list|,
name|QListData
operator|::
name|ArrayCompatibleLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|Q_STATIC_ASSERT
argument_list|(
operator|(
name|is_qlist_array_memory_layout
argument_list|<
name|Complex
argument_list|,
name|QListData
operator|::
name|IndirectLayout
argument_list|>
operator|::
name|value
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt
begin_class
DECL|class|tst_QList
class|class
name|tst_QList
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
private|private
name|slots
private|:
name|void
name|lengthOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|lengthMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|lengthComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|lengthSignature
parameter_list|()
specifier|const
function_decl|;
name|void
name|appendOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|appendMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|appendComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|prepend
parameter_list|()
specifier|const
function_decl|;
name|void
name|midOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|midMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|midComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|atOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|atMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|atComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|firstOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|firstMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|firstComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|lastOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|lastMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|lastComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|constFirst
parameter_list|()
specifier|const
function_decl|;
name|void
name|constLast
parameter_list|()
specifier|const
function_decl|;
name|void
name|beginOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|beginMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|beginComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|endOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|endMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|endComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|containsOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|containsMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|containsComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|countOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|countMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|countComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|emptyOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|emptyMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|emptyComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|endsWithOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|endsWithMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|endsWithComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|lastIndexOfOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|lastIndexOfMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|lastIndexOfComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|moveOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|moveMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|moveComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeAllOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeAllMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeAllComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeAtOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeAtMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeAtComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeOneOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeOneMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|removeOneComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|replaceOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|replaceMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|replaceComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|reverseIteratorsOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|reverseIteratorsMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|reverseIteratorsComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|startsWithOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|startsWithMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|startsWithComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|swapOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|swapMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|swapComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeAtOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeAtMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeAtComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeFirstOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeFirstMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeFirstComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeLastOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeLastMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|takeLastComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|toSetOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|toSetMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|toSetComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|toStdListOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|toStdListMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|toStdListComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|toVectorOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|toVectorMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|toVectorComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|valueOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|valueMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|valueComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|testOperatorsOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|testOperatorsMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|testOperatorsComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|testSTLIteratorsOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|testSTLIteratorsMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|testSTLIteratorsComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|initializeList
parameter_list|()
specifier|const
function_decl|;
name|void
name|constSharedNullOptimal
parameter_list|()
specifier|const
function_decl|;
name|void
name|constSharedNullMovable
parameter_list|()
specifier|const
function_decl|;
name|void
name|constSharedNullComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|setSharableInt_data
parameter_list|()
specifier|const
function_decl|;
name|void
name|setSharableInt
parameter_list|()
specifier|const
function_decl|;
name|void
name|setSharableComplex_data
parameter_list|()
specifier|const
function_decl|;
name|void
name|setSharableComplex
parameter_list|()
specifier|const
function_decl|;
name|void
name|eraseValidIteratorsOnSharedList
parameter_list|()
specifier|const
function_decl|;
name|void
name|insertWithValidIteratorsOnSharedList
parameter_list|()
specifier|const
function_decl|;
DECL|function|qhashOptimal
name|void
name|qhashOptimal
parameter_list|()
specifier|const
block|{
name|qhash
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
block|}
DECL|function|qhashMovable
name|void
name|qhashMovable
parameter_list|()
specifier|const
block|{
name|qhash
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
block|}
DECL|function|qhashComplex
name|void
name|qhashComplex
parameter_list|()
specifier|const
block|{
name|qhash
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
block|}
name|void
name|reserve
parameter_list|()
specifier|const
function_decl|;
private|private:
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|length
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|append
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|mid
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|at
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|first
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|last
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|begin
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|end
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|contains
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|count
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|empty
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|endsWith
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|lastIndexOf
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|move
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|qhash
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|removeAll
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|removeAt
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|removeOne
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|replace
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|reverseIterators
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|startsWith
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|swap
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|takeAt
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|takeFirst
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|takeLast
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|toSet
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|toStdList
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|toVector
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|value
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|testOperators
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|testSTLIterators
parameter_list|()
specifier|const
function_decl|;
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
name|void
name|constSharedNull
parameter_list|()
specifier|const
function_decl|;
DECL|member|dummyForGuard
name|int
name|dummyForGuard
decl_stmt|;
block|}
class|;
end_class
begin_struct
DECL|struct|SimpleValue
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
struct|struct
name|SimpleValue
block|{
DECL|function|at
specifier|static
name|T
name|at
parameter_list|(
name|int
name|index
parameter_list|)
block|{
return|return
name|values
index|[
name|index
operator|%
name|maxSize
index|]
return|;
block|}
DECL|member|maxSize
specifier|static
specifier|const
name|uint
name|maxSize
init|=
literal|7
decl_stmt|;
DECL|member|values
specifier|static
specifier|const
name|T
name|values
index|[
name|maxSize
index|]
decl_stmt|;
block|}
struct|;
end_struct
begin_decl_stmt
template|template
parameter_list|<>
DECL|member|values
specifier|const
name|Optimal
name|SimpleValue
argument_list|<
name|Optimal
argument_list|>
operator|::
name|values
index|[]
init|=
block|{
literal|10
block|,
literal|20
block|,
literal|30
block|,
literal|40
block|,
literal|100
block|,
literal|101
block|,
literal|102
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
template|template
parameter_list|<>
DECL|member|values
specifier|const
name|Movable
name|SimpleValue
argument_list|<
name|Movable
argument_list|>
operator|::
name|values
index|[]
init|=
block|{
literal|10
block|,
literal|20
block|,
literal|30
block|,
literal|40
block|,
literal|100
block|,
literal|101
block|,
literal|102
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
template|template
parameter_list|<>
DECL|member|values
specifier|const
name|Complex
name|SimpleValue
argument_list|<
name|Complex
argument_list|>
operator|::
name|values
index|[]
init|=
block|{
literal|10
block|,
literal|20
block|,
literal|30
block|,
literal|40
block|,
literal|100
block|,
literal|101
block|,
literal|102
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|// Make some macros for the tests to use in order to be slightly more readable...
end_comment
begin_define
DECL|macro|T_FOO
define|#
directive|define
name|T_FOO
value|SimpleValue<T>::at(0)
end_define
begin_define
DECL|macro|T_BAR
define|#
directive|define
name|T_BAR
value|SimpleValue<T>::at(1)
end_define
begin_define
DECL|macro|T_BAZ
define|#
directive|define
name|T_BAZ
value|SimpleValue<T>::at(2)
end_define
begin_define
DECL|macro|T_CAT
define|#
directive|define
name|T_CAT
value|SimpleValue<T>::at(3)
end_define
begin_define
DECL|macro|T_DOG
define|#
directive|define
name|T_DOG
value|SimpleValue<T>::at(4)
end_define
begin_define
DECL|macro|T_BLAH
define|#
directive|define
name|T_BLAH
value|SimpleValue<T>::at(5)
end_define
begin_define
DECL|macro|T_WEEE
define|#
directive|define
name|T_WEEE
value|SimpleValue<T>::at(6)
end_define
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|length
name|void
name|tst_QList
operator|::
name|length
parameter_list|()
specifier|const
block|{
comment|/* Empty list. */
block|{
specifier|const
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|length
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
comment|/* One entry. */
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|length
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
comment|/* Two entries. */
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|length
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
comment|/* Three entries. */
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|length
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|lengthOptimal
name|void
name|tst_QList
operator|::
name|lengthOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|length
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lengthMovable
name|void
name|tst_QList
operator|::
name|lengthMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|length
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lengthComplex
name|void
name|tst_QList
operator|::
name|lengthComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|length
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lengthSignature
name|void
name|tst_QList
operator|::
name|lengthSignature
parameter_list|()
specifier|const
block|{
comment|/* Constness. */
block|{
specifier|const
name|QList
argument_list|<
name|int
argument_list|>
name|list
decl_stmt|;
comment|/* The function should be const. */
name|list
operator|.
name|length
argument_list|()
expr_stmt|;
block|}
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|append
name|void
name|tst_QList
operator|::
name|append
parameter_list|()
specifier|const
block|{
comment|/* test append(const QList<T>&) function */
name|T
name|one
argument_list|(
name|T_FOO
argument_list|)
decl_stmt|;
name|T
name|two
argument_list|(
name|T_BAR
argument_list|)
decl_stmt|;
name|T
name|three
argument_list|(
name|T_BAZ
argument_list|)
decl_stmt|;
name|T
name|four
argument_list|(
name|T_CAT
argument_list|)
decl_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|list1
decl_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|list2
decl_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|listTotal
decl_stmt|;
name|list1
operator|.
name|append
argument_list|(
name|one
argument_list|)
expr_stmt|;
name|list1
operator|.
name|append
argument_list|(
name|two
argument_list|)
expr_stmt|;
name|list2
operator|.
name|append
argument_list|(
name|three
argument_list|)
expr_stmt|;
name|list2
operator|.
name|append
argument_list|(
name|four
argument_list|)
expr_stmt|;
name|list1
operator|.
name|append
argument_list|(
name|list2
argument_list|)
expr_stmt|;
name|listTotal
operator|.
name|append
argument_list|(
name|one
argument_list|)
expr_stmt|;
name|listTotal
operator|.
name|append
argument_list|(
name|two
argument_list|)
expr_stmt|;
name|listTotal
operator|.
name|append
argument_list|(
name|three
argument_list|)
expr_stmt|;
name|listTotal
operator|.
name|append
argument_list|(
name|four
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list1
argument_list|,
name|listTotal
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|appendOptimal
name|void
name|tst_QList
operator|::
name|appendOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|append
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|appendMovable
name|void
name|tst_QList
operator|::
name|appendMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|append
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|appendComplex
name|void
name|tst_QList
operator|::
name|appendComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|append
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|prepend
name|void
name|tst_QList
operator|::
name|prepend
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|int
modifier|*
argument_list|>
name|list
decl_stmt|;
name|int
modifier|*
name|t1
init|=
operator|new
name|int
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|list
operator|.
name|prepend
argument_list|(
name|t1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
name|t1
argument_list|)
expr_stmt|;
name|int
modifier|*
name|t2
init|=
operator|new
name|int
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|list
operator|.
name|prepend
argument_list|(
name|t2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
name|t2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|==
name|t1
argument_list|)
expr_stmt|;
name|int
modifier|*
name|t3
init|=
operator|new
name|int
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|list
operator|.
name|prepend
argument_list|(
name|t3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
name|t3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|==
name|t2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|2
argument_list|)
operator|==
name|t1
argument_list|)
expr_stmt|;
name|list
operator|.
name|removeAll
argument_list|(
name|t2
argument_list|)
expr_stmt|;
operator|delete
name|t2
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
name|t3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|==
name|t1
argument_list|)
expr_stmt|;
name|int
modifier|*
name|t4
init|=
operator|new
name|int
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|list
operator|.
name|prepend
argument_list|(
name|t4
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
name|t4
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|==
name|t3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|2
argument_list|)
operator|==
name|t1
argument_list|)
expr_stmt|;
name|qDeleteAll
argument_list|(
name|list
argument_list|)
expr_stmt|;
name|list
operator|.
name|clear
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|mid
name|void
name|tst_QList
operator|::
name|mid
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_CAT
operator|<<
name|T_DOG
operator|<<
name|T_BLAH
operator|<<
name|T_WEEE
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|mid
argument_list|(
literal|3
argument_list|,
literal|3
argument_list|)
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_CAT
operator|<<
name|T_DOG
operator|<<
name|T_BLAH
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|list1
decl_stmt|;
name|QCOMPARE
argument_list|(
name|list1
operator|.
name|mid
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|)
operator|.
name|length
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|midOptimal
name|void
name|tst_QList
operator|::
name|midOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|mid
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|midMovable
name|void
name|tst_QList
operator|::
name|midMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|mid
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|midComplex
name|void
name|tst_QList
operator|::
name|midComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|mid
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|at
name|void
name|tst_QList
operator|::
name|at
parameter_list|()
specifier|const
block|{
comment|// test at() and make sure it functions correctly with some simple list manipulation.
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
comment|// create a list
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|2
argument_list|)
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// append an item
name|list
operator|<<
name|T_CAT
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|2
argument_list|)
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|3
argument_list|)
argument_list|,
name|T_CAT
argument_list|)
expr_stmt|;
comment|// remove an item
name|list
operator|.
name|removeAt
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|2
argument_list|)
argument_list|,
name|T_CAT
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|atOptimal
name|void
name|tst_QList
operator|::
name|atOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|at
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|atMovable
name|void
name|tst_QList
operator|::
name|atMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|at
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|atComplex
name|void
name|tst_QList
operator|::
name|atComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|at
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|first
name|void
name|tst_QList
operator|::
name|first
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|first
argument_list|()
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
comment|// remove an item, make sure it still works
name|list
operator|.
name|pop_front
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|first
argument_list|()
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|firstOptimal
name|void
name|tst_QList
operator|::
name|firstOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|first
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|firstMovable
name|void
name|tst_QList
operator|::
name|firstMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|first
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|firstComplex
name|void
name|tst_QList
operator|::
name|firstComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|first
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|constFirst
name|void
name|tst_QList
operator|::
name|constFirst
parameter_list|()
specifier|const
block|{
comment|// Based on tst_QVector::constFirst()
name|QList
argument_list|<
name|int
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
literal|69
operator|<<
literal|42
operator|<<
literal|3
expr_stmt|;
comment|// test it starts ok
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|69
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|int
argument_list|>
name|listCopy
init|=
name|list
decl_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|69
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|69
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
comment|// test removal changes
name|list
operator|.
name|removeAt
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|69
argument_list|)
expr_stmt|;
name|listCopy
operator|=
name|list
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
comment|// test prepend changes
name|list
operator|.
name|prepend
argument_list|(
literal|23
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|23
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|listCopy
operator|=
name|list
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|23
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constFirst
argument_list|()
argument_list|,
literal|23
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|constLast
name|void
name|tst_QList
operator|::
name|constLast
parameter_list|()
specifier|const
block|{
comment|// Based on tst_QVector::constLast()
name|QList
argument_list|<
name|int
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
literal|69
operator|<<
literal|42
operator|<<
literal|3
expr_stmt|;
comment|// test it starts ok
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constLast
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|int
argument_list|>
name|listCopy
init|=
name|list
decl_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constLast
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constLast
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
comment|// test removal changes
name|list
operator|.
name|removeLast
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constLast
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constLast
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|listCopy
operator|=
name|list
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constLast
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constLast
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
comment|// test prepend changes
name|list
operator|.
name|append
argument_list|(
literal|23
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constLast
argument_list|()
argument_list|,
literal|23
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constLast
argument_list|()
argument_list|,
literal|42
argument_list|)
expr_stmt|;
name|listCopy
operator|=
name|list
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|constLast
argument_list|()
argument_list|,
literal|23
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|listCopy
operator|.
name|constLast
argument_list|()
argument_list|,
literal|23
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|listCopy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isSharedWith
argument_list|(
name|listCopy
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listCopy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|last
name|void
name|tst_QList
operator|::
name|last
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|last
argument_list|()
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
comment|// remove an item, make sure it still works
name|list
operator|.
name|pop_back
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|last
argument_list|()
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lastOptimal
name|void
name|tst_QList
operator|::
name|lastOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|last
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lastMovable
name|void
name|tst_QList
operator|::
name|lastMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|last
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lastComplex
name|void
name|tst_QList
operator|::
name|lastComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|last
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|begin
name|void
name|tst_QList
operator|::
name|begin
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|list
operator|.
name|begin
argument_list|()
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
comment|// remove an item, make sure it still works
name|list
operator|.
name|pop_front
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|list
operator|.
name|begin
argument_list|()
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|beginOptimal
name|void
name|tst_QList
operator|::
name|beginOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|begin
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|beginMovable
name|void
name|tst_QList
operator|::
name|beginMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|begin
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|beginComplex
name|void
name|tst_QList
operator|::
name|beginComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|begin
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|end
name|void
name|tst_QList
operator|::
name|end
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
operator|--
name|list
operator|.
name|end
argument_list|()
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
comment|// remove an item, make sure it still works
name|list
operator|.
name|pop_back
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
operator|--
name|list
operator|.
name|end
argument_list|()
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|endOptimal
name|void
name|tst_QList
operator|::
name|endOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|end
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|endMovable
name|void
name|tst_QList
operator|::
name|endMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|end
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|endComplex
name|void
name|tst_QList
operator|::
name|endComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|end
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|contains
name|void
name|tst_QList
operator|::
name|contains
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|contains
argument_list|(
name|T_FOO
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|contains
argument_list|(
name|T_BLAH
argument_list|)
operator|!=
literal|true
argument_list|)
expr_stmt|;
comment|// add it and make sure it matches
name|list
operator|.
name|append
argument_list|(
name|T_BLAH
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|contains
argument_list|(
name|T_BLAH
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|containsOptimal
name|void
name|tst_QList
operator|::
name|containsOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|contains
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|containsMovable
name|void
name|tst_QList
operator|::
name|containsMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|contains
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|containsComplex
name|void
name|tst_QList
operator|::
name|containsComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|contains
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|count
name|void
name|tst_QList
operator|::
name|count
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
comment|// starts empty
name|QVERIFY
argument_list|(
name|list
operator|.
name|count
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
comment|// goes up
name|list
operator|.
name|append
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|count
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
comment|// and up
name|list
operator|.
name|append
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|count
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
comment|// and down
name|list
operator|.
name|pop_back
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|count
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
comment|// and empty. :)
name|list
operator|.
name|pop_back
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|count
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|countOptimal
name|void
name|tst_QList
operator|::
name|countOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|count
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|countMovable
name|void
name|tst_QList
operator|::
name|countMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|count
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|countComplex
name|void
name|tst_QList
operator|::
name|countComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|count
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|empty
name|void
name|tst_QList
operator|::
name|empty
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
comment|// make sure it starts empty
name|QVERIFY
argument_list|(
name|list
operator|.
name|empty
argument_list|()
argument_list|)
expr_stmt|;
comment|// and doesn't stay empty
name|list
operator|.
name|append
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|empty
argument_list|()
argument_list|)
expr_stmt|;
comment|// and goes back to being empty
name|list
operator|.
name|pop_back
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|empty
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|emptyOptimal
name|void
name|tst_QList
operator|::
name|emptyOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|empty
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|emptyMovable
name|void
name|tst_QList
operator|::
name|emptyMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|empty
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|emptyComplex
name|void
name|tst_QList
operator|::
name|emptyComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|empty
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|endsWith
name|void
name|tst_QList
operator|::
name|endsWith
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// test it returns correctly in both cases
name|QVERIFY
argument_list|(
name|list
operator|.
name|endsWith
argument_list|(
name|T_BAZ
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|endsWith
argument_list|(
name|T_BAR
argument_list|)
argument_list|)
expr_stmt|;
comment|// remove an item and make sure the end item changes
name|list
operator|.
name|pop_back
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|endsWith
argument_list|(
name|T_BAR
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|endsWithOptimal
name|void
name|tst_QList
operator|::
name|endsWithOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|endsWith
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|endsWithMovable
name|void
name|tst_QList
operator|::
name|endsWithMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|endsWith
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|endsWithComplex
name|void
name|tst_QList
operator|::
name|endsWithComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|endsWith
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|lastIndexOf
name|void
name|tst_QList
operator|::
name|lastIndexOf
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// one instance of the target item
name|QVERIFY
argument_list|(
name|list
operator|.
name|lastIndexOf
argument_list|(
name|T_BAZ
argument_list|)
operator|==
literal|2
argument_list|)
expr_stmt|;
comment|// shouldn't find this
name|QVERIFY
argument_list|(
name|list
operator|.
name|lastIndexOf
argument_list|(
name|T_WEEE
argument_list|)
operator|==
operator|-
literal|1
argument_list|)
expr_stmt|;
comment|// multiple instances
name|list
operator|.
name|append
argument_list|(
name|T_BAZ
argument_list|)
expr_stmt|;
name|list
operator|.
name|append
argument_list|(
name|T_BAZ
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|lastIndexOf
argument_list|(
name|T_BAZ
argument_list|)
operator|==
literal|4
argument_list|)
expr_stmt|;
comment|// search from the middle to find the last one
name|QVERIFY
argument_list|(
name|list
operator|.
name|lastIndexOf
argument_list|(
name|T_BAZ
argument_list|,
literal|3
argument_list|)
operator|==
literal|3
argument_list|)
expr_stmt|;
comment|// try to find none
name|QVERIFY
argument_list|(
name|list
operator|.
name|lastIndexOf
argument_list|(
name|T_BAZ
argument_list|,
literal|1
argument_list|)
operator|==
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lastIndexOfOptimal
name|void
name|tst_QList
operator|::
name|lastIndexOfOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|lastIndexOf
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lastIndexOfMovable
name|void
name|tst_QList
operator|::
name|lastIndexOfMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|lastIndexOf
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|lastIndexOfComplex
name|void
name|tst_QList
operator|::
name|lastIndexOfComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|lastIndexOf
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|move
name|void
name|tst_QList
operator|::
name|move
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// move an item
name|list
operator|.
name|move
argument_list|(
literal|0
argument_list|,
name|list
operator|.
name|count
argument_list|()
operator|-
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
argument_list|)
expr_stmt|;
comment|// move it back
name|list
operator|.
name|move
argument_list|(
name|list
operator|.
name|count
argument_list|()
operator|-
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// move an item in the middle
name|list
operator|.
name|move
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAR
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|moveOptimal
name|void
name|tst_QList
operator|::
name|moveOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|move
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|moveMovable
name|void
name|tst_QList
operator|::
name|moveMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|move
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|moveComplex
name|void
name|tst_QList
operator|::
name|moveComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|move
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|removeAll
name|void
name|tst_QList
operator|::
name|removeAll
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// remove one instance
name|list
operator|.
name|removeAll
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// many instances
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|list
operator|.
name|removeAll
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// try remove something that doesn't exist
name|list
operator|.
name|removeAll
argument_list|(
name|T_WEEE
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeAllOptimal
name|void
name|tst_QList
operator|::
name|removeAllOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeAll
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeAllMovable
name|void
name|tst_QList
operator|::
name|removeAllMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeAll
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeAllComplex
name|void
name|tst_QList
operator|::
name|removeAllComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeAll
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|removeAt
name|void
name|tst_QList
operator|::
name|removeAt
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// middle
name|list
operator|.
name|removeAt
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// start
name|list
operator|.
name|removeAt
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// final
name|list
operator|.
name|removeAt
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeAtOptimal
name|void
name|tst_QList
operator|::
name|removeAtOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeAt
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeAtMovable
name|void
name|tst_QList
operator|::
name|removeAtMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeAt
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeAtComplex
name|void
name|tst_QList
operator|::
name|removeAtComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeAt
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|removeOne
name|void
name|tst_QList
operator|::
name|removeOne
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// middle
name|list
operator|.
name|removeOne
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// start
name|list
operator|.
name|removeOne
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// last
name|list
operator|.
name|removeOne
argument_list|(
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
argument_list|)
expr_stmt|;
comment|// make sure it really only removes one :)
name|list
operator|<<
name|T_FOO
operator|<<
name|T_FOO
expr_stmt|;
name|list
operator|.
name|removeOne
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
argument_list|)
expr_stmt|;
comment|// try remove something that doesn't exist
name|list
operator|.
name|removeOne
argument_list|(
name|T_WEEE
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeOneOptimal
name|void
name|tst_QList
operator|::
name|removeOneOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeOne
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeOneMovable
name|void
name|tst_QList
operator|::
name|removeOneMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeOne
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|removeOneComplex
name|void
name|tst_QList
operator|::
name|removeOneComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|removeOne
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|replace
name|void
name|tst_QList
operator|::
name|replace
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// start
name|list
operator|.
name|replace
argument_list|(
literal|0
argument_list|,
name|T_CAT
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_CAT
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// middle
name|list
operator|.
name|replace
argument_list|(
literal|1
argument_list|,
name|T_DOG
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_CAT
operator|<<
name|T_DOG
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// end
name|list
operator|.
name|replace
argument_list|(
literal|2
argument_list|,
name|T_BLAH
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_CAT
operator|<<
name|T_DOG
operator|<<
name|T_BLAH
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|replaceOptimal
name|void
name|tst_QList
operator|::
name|replaceOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|replace
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|replaceMovable
name|void
name|tst_QList
operator|::
name|replaceMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|replace
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|replaceComplex
name|void
name|tst_QList
operator|::
name|replaceComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|replace
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|reverseIterators
name|void
name|tst_QList
operator|::
name|reverseIterators
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|v
decl_stmt|;
name|v
operator|<<
name|T_CAT
operator|<<
name|T_DOG
operator|<<
name|T_BLAH
operator|<<
name|T_BAZ
expr_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|vr
init|=
name|v
decl_stmt|;
name|std
operator|::
name|reverse
argument_list|(
name|vr
operator|.
name|begin
argument_list|()
argument_list|,
name|vr
operator|.
name|end
argument_list|()
argument_list|)
expr_stmt|;
specifier|const
name|QList
argument_list|<
name|T
argument_list|>
modifier|&
name|cvr
init|=
name|vr
decl_stmt|;
name|QVERIFY
argument_list|(
name|std
operator|::
name|equal
argument_list|(
name|v
operator|.
name|begin
argument_list|()
argument_list|,
name|v
operator|.
name|end
argument_list|()
argument_list|,
name|vr
operator|.
name|rbegin
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|std
operator|::
name|equal
argument_list|(
name|v
operator|.
name|begin
argument_list|()
argument_list|,
name|v
operator|.
name|end
argument_list|()
argument_list|,
name|vr
operator|.
name|crbegin
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|std
operator|::
name|equal
argument_list|(
name|v
operator|.
name|begin
argument_list|()
argument_list|,
name|v
operator|.
name|end
argument_list|()
argument_list|,
name|cvr
operator|.
name|rbegin
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|std
operator|::
name|equal
argument_list|(
name|vr
operator|.
name|rbegin
argument_list|()
argument_list|,
name|vr
operator|.
name|rend
argument_list|()
argument_list|,
name|v
operator|.
name|begin
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|std
operator|::
name|equal
argument_list|(
name|vr
operator|.
name|crbegin
argument_list|()
argument_list|,
name|vr
operator|.
name|crend
argument_list|()
argument_list|,
name|v
operator|.
name|begin
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|std
operator|::
name|equal
argument_list|(
name|cvr
operator|.
name|rbegin
argument_list|()
argument_list|,
name|cvr
operator|.
name|rend
argument_list|()
argument_list|,
name|v
operator|.
name|begin
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|reverseIteratorsOptimal
name|void
name|tst_QList
operator|::
name|reverseIteratorsOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|reverseIterators
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|reverseIteratorsMovable
name|void
name|tst_QList
operator|::
name|reverseIteratorsMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|reverseIterators
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|reverseIteratorsComplex
name|void
name|tst_QList
operator|::
name|reverseIteratorsComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|reverseIterators
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|startsWith
name|void
name|tst_QList
operator|::
name|startsWith
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// make sure it starts ok
name|QVERIFY
argument_list|(
name|list
operator|.
name|startsWith
argument_list|(
name|T_FOO
argument_list|)
argument_list|)
expr_stmt|;
comment|// remove an item
name|list
operator|.
name|removeFirst
argument_list|()
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|startsWith
argument_list|(
name|T_BAR
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|startsWithOptimal
name|void
name|tst_QList
operator|::
name|startsWithOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|startsWith
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|startsWithMovable
name|void
name|tst_QList
operator|::
name|startsWithMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|startsWith
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|startsWithComplex
name|void
name|tst_QList
operator|::
name|startsWithComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|startsWith
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|swap
name|void
name|tst_QList
operator|::
name|swap
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// swap
name|list
operator|.
name|swap
argument_list|(
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAZ
operator|<<
name|T_BAR
operator|<<
name|T_FOO
argument_list|)
expr_stmt|;
comment|// swap again
name|list
operator|.
name|swap
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAR
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|list2
decl_stmt|;
name|list2
operator|<<
name|T_DOG
operator|<<
name|T_BLAH
expr_stmt|;
name|list
operator|.
name|swap
argument_list|(
name|list2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_DOG
operator|<<
name|T_BLAH
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list2
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAR
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|swapOptimal
name|void
name|tst_QList
operator|::
name|swapOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|swap
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|swapMovable
name|void
name|tst_QList
operator|::
name|swapMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|swap
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|swapComplex
name|void
name|tst_QList
operator|::
name|swapComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|swap
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|takeAt
name|void
name|tst_QList
operator|::
name|takeAt
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeAt
argument_list|(
literal|0
argument_list|)
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeAt
argument_list|(
literal|1
argument_list|)
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeAt
argument_list|(
literal|0
argument_list|)
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeAtOptimal
name|void
name|tst_QList
operator|::
name|takeAtOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeAt
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeAtMovable
name|void
name|tst_QList
operator|::
name|takeAtMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeAt
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeAtComplex
name|void
name|tst_QList
operator|::
name|takeAtComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeAt
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|takeFirst
name|void
name|tst_QList
operator|::
name|takeFirst
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeFirst
argument_list|()
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeFirst
argument_list|()
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeFirst
argument_list|()
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeFirstOptimal
name|void
name|tst_QList
operator|::
name|takeFirstOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeFirst
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeFirstMovable
name|void
name|tst_QList
operator|::
name|takeFirstMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeFirst
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeFirstComplex
name|void
name|tst_QList
operator|::
name|takeFirstComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeFirst
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|takeLast
name|void
name|tst_QList
operator|::
name|takeLast
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeLast
argument_list|()
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeLast
argument_list|()
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|takeLast
argument_list|()
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeLastOptimal
name|void
name|tst_QList
operator|::
name|takeLastOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeLast
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeLastMovable
name|void
name|tst_QList
operator|::
name|takeLastMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeLast
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|takeLastComplex
name|void
name|tst_QList
operator|::
name|takeLastComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|takeLast
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|toSet
name|void
name|tst_QList
operator|::
name|toSet
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// no duplicates
name|QCOMPARE
argument_list|(
name|list
operator|.
name|toSet
argument_list|()
argument_list|,
name|QSet
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// duplicates (is this more of a QSet test?)
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|toSet
argument_list|()
argument_list|,
name|QSet
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toSetOptimal
name|void
name|tst_QList
operator|::
name|toSetOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toSet
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toSetMovable
name|void
name|tst_QList
operator|::
name|toSetMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toSet
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toSetComplex
name|void
name|tst_QList
operator|::
name|toSetComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toSet
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|toStdList
name|void
name|tst_QList
operator|::
name|toStdList
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// yuck.
name|std
operator|::
name|list
argument_list|<
name|T
argument_list|>
name|slist
decl_stmt|;
name|slist
operator|.
name|push_back
argument_list|(
name|T_FOO
argument_list|)
expr_stmt|;
name|slist
operator|.
name|push_back
argument_list|(
name|T_BAR
argument_list|)
expr_stmt|;
name|slist
operator|.
name|push_back
argument_list|(
name|T_BAZ
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|toStdList
argument_list|()
argument_list|,
name|slist
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toStdListOptimal
name|void
name|tst_QList
operator|::
name|toStdListOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toStdList
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toStdListMovable
name|void
name|tst_QList
operator|::
name|toStdListMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toStdList
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toStdListComplex
name|void
name|tst_QList
operator|::
name|toStdListComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toStdList
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|toVector
name|void
name|tst_QList
operator|::
name|toVector
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|toVector
argument_list|()
argument_list|,
name|QVector
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toVectorOptimal
name|void
name|tst_QList
operator|::
name|toVectorOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toVector
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toVectorMovable
name|void
name|tst_QList
operator|::
name|toVectorMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toVector
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|toVectorComplex
name|void
name|tst_QList
operator|::
name|toVectorComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|toVector
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|value
name|void
name|tst_QList
operator|::
name|value
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// test real values
name|QCOMPARE
argument_list|(
name|list
operator|.
name|value
argument_list|(
literal|0
argument_list|)
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|value
argument_list|(
literal|2
argument_list|)
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
comment|// test empty default
name|QCOMPARE
argument_list|(
name|list
operator|.
name|value
argument_list|(
literal|3
argument_list|)
argument_list|,
name|T
argument_list|()
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|value
argument_list|(
operator|-
literal|1
argument_list|)
argument_list|,
name|T
argument_list|()
argument_list|)
expr_stmt|;
comment|// test defaults
name|T
name|defaultT
argument_list|(
name|T_WEEE
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|value
argument_list|(
operator|-
literal|1
argument_list|,
name|defaultT
argument_list|)
argument_list|,
name|defaultT
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|value
argument_list|(
literal|3
argument_list|,
name|defaultT
argument_list|)
argument_list|,
name|defaultT
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|valueOptimal
name|void
name|tst_QList
operator|::
name|valueOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|value
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|valueMovable
name|void
name|tst_QList
operator|::
name|valueMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|value
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|valueComplex
name|void
name|tst_QList
operator|::
name|valueComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|value
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|testOperators
name|void
name|tst_QList
operator|::
name|testOperators
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
name|QList
argument_list|<
name|T
argument_list|>
name|listtwo
decl_stmt|;
name|listtwo
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
comment|// test equal
name|QVERIFY
argument_list|(
name|list
operator|==
name|listtwo
argument_list|)
expr_stmt|;
comment|// not equal
name|listtwo
operator|.
name|append
argument_list|(
name|T_CAT
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|!=
name|listtwo
argument_list|)
expr_stmt|;
comment|// +=
name|list
operator|+=
name|listtwo
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|7
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listtwo
operator|.
name|size
argument_list|()
operator|==
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_CAT
argument_list|)
expr_stmt|;
comment|// =
name|list
operator|=
name|listtwo
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|listtwo
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
argument_list|,
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
operator|<<
name|T_CAT
argument_list|)
expr_stmt|;
comment|// []
name|QCOMPARE
argument_list|(
name|list
index|[
literal|0
index|]
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
index|[
name|list
operator|.
name|size
argument_list|()
operator|-
literal|1
index|]
argument_list|,
name|T_CAT
argument_list|)
expr_stmt|;
comment|//<,>,<=,>=
name|QVERIFY
argument_list|(
operator|!
operator|(
name|list
operator|<
name|listtwo
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|list
operator|>
name|listtwo
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|<=
name|listtwo
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|>=
name|listtwo
argument_list|)
expr_stmt|;
name|listtwo
operator|.
name|push_back
argument_list|(
name|T_CAT
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|<
name|listtwo
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|list
operator|>
name|listtwo
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|<=
name|listtwo
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
operator|(
name|list
operator|>=
name|listtwo
operator|)
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listtwo
operator|>
name|list
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|listtwo
operator|>=
name|list
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testOperatorsOptimal
name|void
name|tst_QList
operator|::
name|testOperatorsOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|testOperators
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testOperatorsMovable
name|void
name|tst_QList
operator|::
name|testOperatorsMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|testOperators
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testOperatorsComplex
name|void
name|tst_QList
operator|::
name|testOperatorsComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|testOperators
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|testSTLIterators
name|void
name|tst_QList
operator|::
name|testSTLIterators
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list
decl_stmt|;
comment|// create a list
name|list
operator|<<
name|T_FOO
operator|<<
name|T_BAR
operator|<<
name|T_BAZ
expr_stmt|;
typename|typename
name|QList
argument_list|<
name|T
argument_list|>
operator|::
name|iterator
name|it
init|=
name|list
operator|.
name|begin
argument_list|()
decl_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|it
operator|++
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|it
operator|++
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|it
operator|++
expr_stmt|;
name|QCOMPARE
argument_list|(
name|it
argument_list|,
name|list
operator|.
name|end
argument_list|()
argument_list|)
expr_stmt|;
name|it
operator|--
expr_stmt|;
comment|// walk backwards
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_BAZ
argument_list|)
expr_stmt|;
name|it
operator|--
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|it
operator|--
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
comment|// test erase
name|it
operator|=
name|list
operator|.
name|erase
argument_list|(
name|it
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
comment|// test multiple erase
name|it
operator|=
name|list
operator|.
name|erase
argument_list|(
name|it
argument_list|,
name|it
operator|+
literal|2
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|it
argument_list|,
name|list
operator|.
name|end
argument_list|()
argument_list|)
expr_stmt|;
comment|// insert again
name|it
operator|=
name|list
operator|.
name|insert
argument_list|(
name|it
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
comment|// insert again
name|it
operator|=
name|list
operator|.
name|insert
argument_list|(
name|it
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
operator|++
argument_list|,
name|T_BAR
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|*
name|it
argument_list|,
name|T_FOO
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testSTLIteratorsOptimal
name|void
name|tst_QList
operator|::
name|testSTLIteratorsOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|testSTLIterators
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testSTLIteratorsMovable
name|void
name|tst_QList
operator|::
name|testSTLIteratorsMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|testSTLIterators
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|testSTLIteratorsComplex
name|void
name|tst_QList
operator|::
name|testSTLIteratorsComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|testSTLIterators
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|initializeList
name|void
name|tst_QList
operator|::
name|initializeList
parameter_list|()
specifier|const
block|{
ifdef|#
directive|ifdef
name|Q_COMPILER_INITIALIZER_LISTS
name|QList
argument_list|<
name|int
argument_list|>
name|v1
argument_list|{
literal|2
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|}
decl_stmt|;
name|QCOMPARE
argument_list|(
name|v1
argument_list|,
name|QList
argument_list|<
name|int
argument_list|>
argument_list|()
operator|<<
literal|2
operator|<<
literal|3
operator|<<
literal|4
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|v1
argument_list|,
operator|(
name|QList
argument_list|<
name|int
argument_list|>
block|{
literal|2
block|,
literal|3
block|,
literal|4
block|}
operator|)
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|QList
argument_list|<
name|int
argument_list|>
argument_list|>
name|v2
argument_list|{
name|v1
argument_list|,
block|{
literal|1
block|}
argument_list|,
name|QList
argument_list|<
name|int
argument_list|>
argument_list|()
argument_list|,
block|{
literal|2
block|,
literal|3
block|,
literal|4
block|}
argument_list|}
decl_stmt|;
name|QList
argument_list|<
name|QList
argument_list|<
name|int
argument_list|>
argument_list|>
name|v3
decl_stmt|;
name|v3
operator|<<
name|v1
operator|<<
operator|(
name|QList
argument_list|<
name|int
argument_list|>
argument_list|()
operator|<<
literal|1
operator|)
operator|<<
name|QList
argument_list|<
name|int
argument_list|>
argument_list|()
operator|<<
name|v1
expr_stmt|;
name|QCOMPARE
argument_list|(
name|v3
argument_list|,
name|v2
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|constSharedNull
name|void
name|tst_QList
operator|::
name|constSharedNull
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|list2
decl_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_NO_UNSHARABLE_CONTAINERS
argument_list|)
name|QList
argument_list|<
name|T
argument_list|>
name|list1
decl_stmt|;
name|list1
operator|.
name|setSharable
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list1
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|list2
operator|.
name|setSharable
argument_list|(
literal|true
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|QVERIFY
argument_list|(
operator|!
name|list2
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|constSharedNullOptimal
name|void
name|tst_QList
operator|::
name|constSharedNullOptimal
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Optimal
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|constSharedNull
argument_list|<
name|Optimal
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Optimal
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|constSharedNullMovable
name|void
name|tst_QList
operator|::
name|constSharedNullMovable
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Movable
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|constSharedNull
argument_list|<
name|Movable
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Movable
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|constSharedNullComplex
name|void
name|tst_QList
operator|::
name|constSharedNullComplex
parameter_list|()
specifier|const
block|{
specifier|const
name|int
name|liveCount
init|=
name|Complex
operator|::
name|getLiveCount
argument_list|()
decl_stmt|;
name|constSharedNull
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|liveCount
argument_list|,
name|Complex
operator|::
name|getLiveCount
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|class
name|T
parameter_list|>
DECL|function|generateSetSharableData
name|void
name|generateSetSharableData
parameter_list|()
block|{
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_NO_UNSHARABLE_CONTAINERS
argument_list|)
name|QTest
operator|::
name|addColumn
argument_list|<
name|QList
argument_list|<
name|T
argument_list|>
argument_list|>
argument_list|(
literal|"list"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|int
argument_list|>
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"null"
argument_list|)
operator|<<
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
literal|0
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"non-empty"
argument_list|)
operator|<<
operator|(
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
operator|<<
name|T
argument_list|(
literal|0
argument_list|)
operator|<<
name|T
argument_list|(
literal|1
argument_list|)
operator|<<
name|T
argument_list|(
literal|2
argument_list|)
operator|<<
name|T
argument_list|(
literal|3
argument_list|)
operator|<<
name|T
argument_list|(
literal|4
argument_list|)
operator|)
operator|<<
literal|5
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
template|template
parameter_list|<
name|class
name|T
parameter_list|>
DECL|function|runSetSharableTest
name|void
name|runSetSharableTest
parameter_list|()
block|{
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_NO_UNSHARABLE_CONTAINERS
argument_list|)
name|QFETCH
argument_list|(
name|QList
argument_list|<
name|T
argument_list|>
argument_list|,
name|list
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|int
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|list
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
comment|// Shared with QTest
name|list
operator|.
name|setSharable
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|size
argument_list|()
argument_list|,
name|size
argument_list|)
expr_stmt|;
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|copy
argument_list|(
name|list
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|copy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|copy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|list
operator|.
name|setSharable
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|list
operator|.
name|isDetached
argument_list|()
operator|||
name|list
operator|.
name|isSharedWith
argument_list|(
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|copy
argument_list|(
name|list
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
name|copy
operator|.
name|isDetached
argument_list|()
operator|||
name|copy
operator|.
name|isSharedWith
argument_list|(
name|QList
argument_list|<
name|T
argument_list|>
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|copy
operator|.
name|size
argument_list|()
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|copy
argument_list|,
name|list
argument_list|)
expr_stmt|;
block|}
name|list
operator|.
name|setSharable
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|copy
argument_list|(
name|list
argument_list|)
decl_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|copy
operator|.
name|isDetached
argument_list|()
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|copy
operator|.
name|isSharedWith
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|list
operator|.
name|size
argument_list|()
condition|;
operator|++
name|i
control|)
name|QCOMPARE
argument_list|(
name|int
argument_list|(
name|list
index|[
name|i
index|]
argument_list|)
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|size
argument_list|()
argument_list|,
name|size
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|setSharableInt_data
name|void
name|tst_QList
operator|::
name|setSharableInt_data
parameter_list|()
specifier|const
block|{
name|generateSetSharableData
argument_list|<
name|int
argument_list|>
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setSharableComplex_data
name|void
name|tst_QList
operator|::
name|setSharableComplex_data
parameter_list|()
specifier|const
block|{
name|generateSetSharableData
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setSharableInt
name|void
name|tst_QList
operator|::
name|setSharableInt
parameter_list|()
specifier|const
block|{
name|runSetSharableTest
argument_list|<
name|int
argument_list|>
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setSharableComplex
name|void
name|tst_QList
operator|::
name|setSharableComplex
parameter_list|()
specifier|const
block|{
name|runSetSharableTest
argument_list|<
name|Complex
argument_list|>
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|eraseValidIteratorsOnSharedList
name|void
name|tst_QList
operator|::
name|eraseValidIteratorsOnSharedList
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|int
argument_list|>
name|a
decl_stmt|,
name|b
decl_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|30
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|int
argument_list|>
operator|::
name|iterator
name|i
init|=
name|a
operator|.
name|begin
argument_list|()
decl_stmt|;
operator|++
name|i
expr_stmt|;
name|b
operator|=
name|a
expr_stmt|;
name|a
operator|.
name|erase
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|b
operator|.
name|size
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|size
argument_list|()
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|30
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|40
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|50
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|60
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|size
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|i
operator|=
name|a
operator|.
name|begin
argument_list|()
expr_stmt|;
name|b
operator|=
name|a
expr_stmt|;
operator|++
name|i
expr_stmt|;
name|QList
argument_list|<
name|int
argument_list|>
operator|::
name|iterator
name|j
init|=
name|i
decl_stmt|;
operator|++
name|j
expr_stmt|;
operator|++
name|j
expr_stmt|;
name|a
operator|.
name|erase
argument_list|(
name|i
argument_list|,
name|j
argument_list|)
expr_stmt|;
comment|// remove 3 elements
name|QCOMPARE
argument_list|(
name|b
operator|.
name|size
argument_list|()
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|size
argument_list|()
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|50
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|insertWithValidIteratorsOnSharedList
name|void
name|tst_QList
operator|::
name|insertWithValidIteratorsOnSharedList
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|int
argument_list|>
name|a
decl_stmt|,
name|b
decl_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|a
operator|.
name|push_back
argument_list|(
literal|30
argument_list|)
expr_stmt|;
name|QList
argument_list|<
name|int
argument_list|>
operator|::
name|iterator
name|i
init|=
name|a
operator|.
name|begin
argument_list|()
decl_stmt|;
operator|++
name|i
expr_stmt|;
name|b
operator|=
name|a
expr_stmt|;
name|a
operator|.
name|insert
argument_list|(
name|i
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|size
argument_list|()
argument_list|,
name|b
operator|.
name|size
argument_list|()
operator|+
literal|1
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|b
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|a
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|,
literal|15
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
DECL|function|qhash
name|void
name|tst_QList
operator|::
name|qhash
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|T
argument_list|>
name|l1
decl_stmt|,
name|l2
decl_stmt|;
name|QCOMPARE
argument_list|(
name|qHash
argument_list|(
name|l1
argument_list|)
argument_list|,
name|qHash
argument_list|(
name|l2
argument_list|)
argument_list|)
expr_stmt|;
name|l1
operator|<<
name|T_BAR
expr_stmt|;
name|l2
operator|<<
name|T_BAR
expr_stmt|;
name|QCOMPARE
argument_list|(
name|qHash
argument_list|(
name|l1
argument_list|)
argument_list|,
name|qHash
argument_list|(
name|l2
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|reserve
name|void
name|tst_QList
operator|::
name|reserve
parameter_list|()
specifier|const
block|{
comment|// Note:
comment|// This test depends on QList's current behavior that ints are stored in the array itself.
comment|// This test would not work for QList<Complex>.
name|int
name|capacity
init|=
literal|100
decl_stmt|;
name|QList
argument_list|<
name|int
argument_list|>
name|list
decl_stmt|;
name|list
operator|.
name|reserve
argument_list|(
name|capacity
argument_list|)
expr_stmt|;
name|list
operator|<<
literal|0
expr_stmt|;
name|int
modifier|*
name|data
init|=
operator|&
name|list
index|[
literal|0
index|]
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|1
init|;
name|i
operator|<
name|capacity
condition|;
name|i
operator|++
control|)
block|{
name|list
operator|<<
name|i
expr_stmt|;
name|QCOMPARE
argument_list|(
operator|&
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
name|QList
argument_list|<
name|int
argument_list|>
name|copy
init|=
name|list
decl_stmt|;
name|list
operator|.
name|reserve
argument_list|(
name|capacity
operator|/
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|size
argument_list|()
argument_list|,
name|capacity
argument_list|)
expr_stmt|;
comment|// we didn't shrink the size!
name|copy
operator|=
name|list
expr_stmt|;
name|list
operator|.
name|reserve
argument_list|(
name|capacity
operator|*
literal|2
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|list
operator|.
name|size
argument_list|()
argument_list|,
name|capacity
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|&
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|!=
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_macro
name|QTEST_APPLESS_MAIN
argument_list|(
argument|tst_QList
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qlist.moc"
end_include
end_unit
