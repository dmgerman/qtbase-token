begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2015 The Qt Company Ltd. ** Contact: http://www.qt.io/licensing/ ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL21$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and The Qt Company. For licensing terms ** and conditions see http://www.qt.io/terms-conditions. For further ** information use the contact form at http://www.qt.io/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 or version 3 as published by the Free ** Software Foundation and appearing in the file LICENSE.LGPLv21 and ** LICENSE.LGPLv3 included in the packaging of this file. Please review the ** following information to ensure the GNU Lesser General Public License ** requirements will be met: https://www.gnu.org/licenses/lgpl.html and ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** As a special exception, The Qt Company gives you certain additional ** rights. These rights are described in The Qt Company LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<QtTest/QtTest>
end_include
begin_include
include|#
directive|include
file|<private/qfontengine_p.h>
end_include
begin_include
include|#
directive|include
file|<private/qtextengine_p.h>
end_include
begin_include
include|#
directive|include
file|<qtextlayout.h>
end_include
begin_include
include|#
directive|include
file|<qfontdatabase.h>
end_include
begin_include
include|#
directive|include
file|<qfontinfo.h>
end_include
begin_class
DECL|class|tst_QTextScriptEngine
class|class
name|tst_QTextScriptEngine
super|:
specifier|public
name|QObject
block|{
name|Q_OBJECT
public|public:
name|tst_QTextScriptEngine
parameter_list|()
constructor_decl|;
specifier|virtual
name|~
name|tst_QTextScriptEngine
parameter_list|()
destructor_decl|;
public|public
name|slots
public|:
name|void
name|initTestCase
parameter_list|()
function_decl|;
name|void
name|init
parameter_list|()
function_decl|;
name|void
name|cleanup
parameter_list|()
function_decl|;
private|private
name|slots
private|:
name|void
name|devanagari_data
parameter_list|()
function_decl|;
name|void
name|devanagari
parameter_list|()
function_decl|;
name|void
name|bengali_data
parameter_list|()
function_decl|;
name|void
name|bengali
parameter_list|()
function_decl|;
name|void
name|gurmukhi_data
parameter_list|()
function_decl|;
name|void
name|gurmukhi
parameter_list|()
function_decl|;
comment|// gujarati missing
name|void
name|oriya_data
parameter_list|()
function_decl|;
name|void
name|oriya
parameter_list|()
function_decl|;
name|void
name|tamil_data
parameter_list|()
function_decl|;
name|void
name|tamil
parameter_list|()
function_decl|;
name|void
name|telugu_data
parameter_list|()
function_decl|;
name|void
name|telugu
parameter_list|()
function_decl|;
name|void
name|kannada_data
parameter_list|()
function_decl|;
name|void
name|kannada
parameter_list|()
function_decl|;
name|void
name|malayalam_data
parameter_list|()
function_decl|;
name|void
name|malayalam
parameter_list|()
function_decl|;
name|void
name|sinhala_data
parameter_list|()
function_decl|;
name|void
name|sinhala
parameter_list|()
function_decl|;
name|void
name|khmer_data
parameter_list|()
function_decl|;
name|void
name|khmer
parameter_list|()
function_decl|;
name|void
name|linearB_data
parameter_list|()
function_decl|;
name|void
name|linearB
parameter_list|()
function_decl|;
name|void
name|greek_data
parameter_list|()
function_decl|;
name|void
name|greek
parameter_list|()
function_decl|;
name|void
name|mirroredChars_data
parameter_list|()
function_decl|;
name|void
name|mirroredChars
parameter_list|()
function_decl|;
name|void
name|controlInSyllable_qtbug14204
parameter_list|()
function_decl|;
name|void
name|combiningMarks_qtbug15675_data
parameter_list|()
function_decl|;
name|void
name|combiningMarks_qtbug15675
parameter_list|()
function_decl|;
name|void
name|thaiIsolatedSaraAm
parameter_list|()
function_decl|;
name|void
name|thaiWithZWJ
parameter_list|()
function_decl|;
name|void
name|thaiMultipleVowels
parameter_list|()
function_decl|;
private|private:
DECL|member|haveTestFonts
name|bool
name|haveTestFonts
decl_stmt|;
block|}
class|;
end_class
begin_constructor
DECL|function|tst_QTextScriptEngine
name|tst_QTextScriptEngine
operator|::
name|tst_QTextScriptEngine
parameter_list|()
member_init_list|:
name|haveTestFonts
argument_list|(
name|qgetenv
argument_list|(
literal|"QT_HAVE_TEST_FONTS"
argument_list|)
operator|==
name|QByteArray
argument_list|(
literal|"1"
argument_list|)
argument_list|)
block|{ }
end_constructor
begin_destructor
DECL|function|~tst_QTextScriptEngine
name|tst_QTextScriptEngine
operator|::
name|~
name|tst_QTextScriptEngine
parameter_list|()
block|{ }
end_destructor
begin_function
DECL|function|initTestCase
name|void
name|tst_QTextScriptEngine
operator|::
name|initTestCase
parameter_list|()
block|{
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
block|{
name|qWarning
argument_list|(
literal|"Some of these tests depend on the internals of some test fonts which are not freely "
literal|"distributable.\n"
literal|"These tests will be skipped.\n"
literal|"If you have the fonts available, set QT_HAVE_TEST_FONTS=1 in your environment and "
literal|"run the test again."
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|init
name|void
name|tst_QTextScriptEngine
operator|::
name|init
parameter_list|()
block|{ }
end_function
begin_function
DECL|function|cleanup
name|void
name|tst_QTextScriptEngine
operator|::
name|cleanup
parameter_list|()
block|{ }
end_function
begin_struct
DECL|struct|ShapeTable
struct|struct
name|ShapeTable
block|{
DECL|member|unicode
name|unsigned
name|short
name|unicode
index|[
literal|16
index|]
decl_stmt|;
DECL|member|glyphs
name|unsigned
name|short
name|glyphs
index|[
literal|16
index|]
decl_stmt|;
block|}
struct|;
end_struct
begin_function
DECL|function|prepareShapingTest
specifier|static
name|void
name|prepareShapingTest
parameter_list|(
specifier|const
name|QFont
modifier|&
name|font
parameter_list|,
specifier|const
name|ShapeTable
modifier|*
name|shape_table
parameter_list|)
block|{
for|for
control|(
specifier|const
name|ShapeTable
modifier|*
name|s
init|=
name|shape_table
init|;
name|s
operator|->
name|unicode
index|[
literal|0
index|]
condition|;
operator|++
name|s
control|)
block|{
name|QByteArray
name|testName
init|=
name|font
operator|.
name|family
argument_list|()
operator|.
name|toLatin1
argument_list|()
operator|+
literal|':'
decl_stmt|;
name|QString
name|string
decl_stmt|;
for|for
control|(
specifier|const
name|ushort
modifier|*
name|u
init|=
name|s
operator|->
name|unicode
init|;
operator|*
name|u
condition|;
operator|++
name|u
control|)
block|{
name|string
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
operator|*
name|u
argument_list|)
argument_list|)
expr_stmt|;
name|testName
operator|.
name|append
argument_list|(
literal|" 0x"
operator|+
name|QByteArray
operator|::
name|number
argument_list|(
operator|*
name|u
argument_list|,
literal|16
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|QVector
argument_list|<
name|ushort
argument_list|>
name|glyphs
decl_stmt|;
for|for
control|(
specifier|const
name|ushort
modifier|*
name|g
init|=
name|s
operator|->
name|glyphs
init|;
operator|*
name|g
condition|;
operator|++
name|g
control|)
name|glyphs
operator|.
name|append
argument_list|(
operator|*
name|g
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
name|testName
operator|.
name|constData
argument_list|()
argument_list|)
operator|<<
name|font
operator|<<
name|string
operator|<<
name|glyphs
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|doShapingTests
specifier|static
name|void
name|doShapingTests
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QFont
argument_list|,
name|font
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|,
name|glyphs
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|string
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
name|QTextLayout
name|layout
argument_list|(
name|string
argument_list|,
name|font
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|e
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
operator|!
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|isEmpty
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
operator|->
name|fontEngine
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
operator|->
name|type
argument_list|()
operator|==
name|QFontEngine
operator|::
name|Box
condition|)
name|QSKIP
argument_list|(
literal|"OpenType support missing for script"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|fontEngine
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
operator|->
name|fontDef
operator|.
name|family
argument_list|,
name|font
operator|.
name|family
argument_list|()
argument_list|)
expr_stmt|;
name|ushort
name|nglyphs
init|=
name|glyphs
operator|.
name|size
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|glyphs
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|,
name|nglyphs
argument_list|)
expr_stmt|;
for|for
control|(
name|ushort
name|i
init|=
literal|0
init|;
name|i
operator|<
name|glyphs
operator|.
name|size
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
name|ushort
name|glyph
init|=
operator|(
name|e
operator|->
name|layoutData
operator|->
name|glyphLayout
operator|.
name|glyphs
index|[
name|i
index|]
operator|&
literal|0xffffff
operator|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|glyph
argument_list|,
name|glyphs
operator|.
name|at
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
comment|// decomposed shaping
if|if
condition|(
name|string
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
literal|0x1fc1
operator|||
name|string
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|==
literal|0x1fed
condition|)
return|return;
if|if
condition|(
name|string
operator|.
name|normalized
argument_list|(
name|QString
operator|::
name|NormalizationForm_D
argument_list|)
operator|.
name|normalized
argument_list|(
name|QString
operator|::
name|NormalizationForm_C
argument_list|)
operator|!=
name|string
condition|)
return|return;
name|QTextLayout
name|decomposedLayout
argument_list|(
name|string
operator|.
name|normalized
argument_list|(
name|QString
operator|::
name|NormalizationForm_D
argument_list|)
argument_list|,
name|font
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|de
init|=
name|decomposedLayout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|de
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|de
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|de
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|,
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|)
expr_stmt|;
for|for
control|(
name|ushort
name|i
init|=
literal|0
init|;
name|i
operator|<
name|nglyphs
condition|;
operator|++
name|i
control|)
block|{
name|ushort
name|glyph
init|=
operator|(
name|e
operator|->
name|layoutData
operator|->
name|glyphLayout
operator|.
name|glyphs
index|[
name|i
index|]
operator|&
literal|0xffffff
operator|)
decl_stmt|;
name|ushort
name|glyph2
init|=
operator|(
name|de
operator|->
name|layoutData
operator|->
name|glyphLayout
operator|.
name|glyphs
index|[
name|i
index|]
operator|&
literal|0xffffff
operator|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|glyph2
argument_list|,
name|glyph
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function
begin_function
DECL|function|devanagari_data
name|void
name|tst_QTextScriptEngine
operator|::
name|devanagari_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Devanagari
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Raghindi"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Raghindi"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
comment|// Ka
block|{
block|{
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0080
block|,
literal|0x0051
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ka
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00c8
block|,
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka MatraI
block|{
block|{
literal|0x0915
block|,
literal|0x093f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d1
block|,
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka
block|{
block|{
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0080
block|,
literal|0x005b
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka MatraI
block|{
block|{
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x093f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d1
block|,
literal|0x0080
block|,
literal|0x005b
block|,
literal|0x0
block|}
block|}
block|,
comment|// MatraI
block|{
block|{
literal|0x093f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d4
block|,
literal|0x029c
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Nukta
block|{
block|{
literal|0x0915
block|,
literal|0x093c
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00a4
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0930
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0110
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra Halant Ka
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0158
block|,
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x200d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00e2
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x200d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0158
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Raghindi"
argument_list|)
expr_stmt|;
block|}
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Devanagari
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Mangal"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Mangal"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
comment|// Ka
block|{
block|{
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0080
block|,
literal|0x0051
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ka
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00c8
block|,
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka MatraI
block|{
block|{
literal|0x0915
block|,
literal|0x093f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d1
block|,
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka
block|{
block|{
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0080
block|,
literal|0x005b
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka MatraI
block|{
block|{
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x093f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d1
block|,
literal|0x0080
block|,
literal|0x005b
block|,
literal|0x0
block|}
block|}
block|,
comment|// MatraI
block|{
block|{
literal|0x093f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d4
block|,
literal|0x029c
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Nukta
block|{
block|{
literal|0x0915
block|,
literal|0x093c
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00a4
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0930
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0110
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra Halant Ka
block|{
block|{
literal|0x0915
block|,
literal|0x094d
block|,
literal|0x0930
block|,
literal|0x094d
block|,
literal|0x0915
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0158
block|,
literal|0x0080
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x92b
block|,
literal|0x94d
block|,
literal|0x930
block|,
literal|0x0
block|}
block|,
block|{
literal|0x125
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x92b
block|,
literal|0x93c
block|,
literal|0x94d
block|,
literal|0x930
block|,
literal|0x0
block|}
block|,
block|{
literal|0x149
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find mangal"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|devanagari
name|void
name|tst_QTextScriptEngine
operator|::
name|devanagari
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|bengali_data
name|void
name|tst_QTextScriptEngine
operator|::
name|bengali_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Bengali
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Akaash"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Akaash"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
comment|// Ka
block|{
block|{
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0151
block|,
literal|0x017d
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ka
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x019b
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka MatraI
block|{
block|{
literal|0x0995
block|,
literal|0x09bf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0173
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0151
block|,
literal|0x0276
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka MatraI
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x09bf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0173
block|,
literal|0x0151
block|,
literal|0x0276
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Nukta
block|{
block|{
literal|0x0995
block|,
literal|0x09bc
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0151
block|,
literal|0x0171
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01f4
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra Halant Ka
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x025c
block|,
literal|0x0276
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ya + Halant
block|{
block|{
literal|0x09af
block|,
literal|0x09cd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x016a
block|,
literal|0x017d
block|,
literal|0x0
block|}
block|}
block|,
comment|// Da Halant Ya -> Da Ya-Phala
block|{
block|{
literal|0x09a6
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01e5
block|,
literal|0x0
block|}
block|}
block|,
comment|// A Halant Ya -> A Ya-phala
block|{
block|{
literal|0x0985
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0145
block|,
literal|0x01cf
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Ka
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x026f
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Ka
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0164
block|,
literal|0x017d
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Ka
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x026f
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant ZWNJ Ka
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0151
block|,
literal|0x017d
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant ZWJ Ka
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x025c
block|,
literal|0x0151
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Ra
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0207
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Ra
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0164
block|,
literal|0x017d
block|,
literal|0x016b
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Ra
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x026f
block|,
literal|0x016b
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Ba
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x09ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x022f
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Ba
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x09ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0164
block|,
literal|0x017d
block|,
literal|0x0167
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Ba
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x09ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x026f
block|,
literal|0x0167
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Dha
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x09a7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01d3
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Dha
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x09a7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0164
block|,
literal|0x017d
block|,
literal|0x0163
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Dha
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x09a7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x026f
block|,
literal|0x0163
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka MatraAU
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x09cc
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0179
block|,
literal|0x0151
block|,
literal|0x0276
block|,
literal|0x017e
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ba Halant Ba
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x09ac
block|,
literal|0x09cd
block|,
literal|0x09ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0232
block|,
literal|0x0276
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x9b0
block|,
literal|0x9cd
block|,
literal|0x995
block|,
literal|0x9be
block|,
literal|0x982
block|,
literal|0x0
block|}
block|,
block|{
literal|0x151
block|,
literal|0x276
block|,
literal|0x172
block|,
literal|0x143
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x9b0
block|,
literal|0x9cd
block|,
literal|0x995
block|,
literal|0x9be
block|,
literal|0x983
block|,
literal|0x0
block|}
block|,
block|{
literal|0x151
block|,
literal|0x276
block|,
literal|0x172
block|,
literal|0x144
block|,
literal|0x0
block|}
block|}
block|,
comment|// test decomposed two parts matras
block|{
block|{
literal|0x995
block|,
literal|0x9c7
block|,
literal|0x9be
block|,
literal|0x0
block|}
block|,
block|{
literal|0x179
block|,
literal|0x151
block|,
literal|0x172
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x995
block|,
literal|0x9c7
block|,
literal|0x9d7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x179
block|,
literal|0x151
block|,
literal|0x17e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Akaash"
argument_list|)
expr_stmt|;
block|}
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Bengali
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Mukti Narrow"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Mukti Narrow"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
comment|// Ka
block|{
block|{
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0073
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00b9
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ka
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0109
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka MatraI
block|{
block|{
literal|0x0995
block|,
literal|0x09bf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0095
block|,
literal|0x0073
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0073
block|,
literal|0x00e1
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka MatraI
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x09bf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0095
block|,
literal|0x0073
block|,
literal|0x00e1
block|,
literal|0x0
block|}
block|}
block|,
comment|// MatraI
block|{
block|{
literal|0x09bf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0095
block|,
literal|0x01c8
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Nukta
block|{
block|{
literal|0x0995
block|,
literal|0x09bc
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0073
block|,
literal|0x0093
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra
block|{
block|{
literal|0x0995
block|,
literal|0x09cd
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00e5
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant Ra Halant Ka
block|{
block|{
literal|0x995
block|,
literal|0x9cd
block|,
literal|0x9b0
block|,
literal|0x9cd
block|,
literal|0x995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x234
block|,
literal|0x24e
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ya + Halant
block|{
block|{
literal|0x09af
block|,
literal|0x09cd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00d2
block|,
literal|0x0
block|}
block|}
block|,
comment|// Da Halant Ya -> Da Ya-Phala
block|{
block|{
literal|0x09a6
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0084
block|,
literal|0x00e2
block|,
literal|0x0
block|}
block|}
block|,
comment|// A Halant Ya -> A Ya-phala
block|{
block|{
literal|0x0985
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0067
block|,
literal|0x00e2
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Ka
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x0995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0188
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Ka
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200c
block|,
literal|0x995
block|,
literal|0x0
block|}
block|,
block|{
literal|0xcc
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Ka
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200d
block|,
literal|0x995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x247
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant ZWNJ Ka
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200d
block|,
literal|0x995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x247
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ka Halant ZWJ Ka
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200d
block|,
literal|0x995
block|,
literal|0x0
block|}
block|,
block|{
literal|0x247
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Ra
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00f8
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Ra
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x09b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0xcc
block|,
literal|0x8d
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Ra
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200d
block|,
literal|0x9b0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x247
block|,
literal|0x8d
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Ba
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x09ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0139
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Ba
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200c
block|,
literal|0x9ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0xcc
block|,
literal|0x89
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Ba
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x200d
block|,
literal|0x9ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x247
block|,
literal|0x89
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant Dha
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x09a7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0145
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWNJ Dha
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200c
block|,
literal|0x09a7
block|,
literal|0x0
block|}
block|,
block|{
literal|0xcc
block|,
literal|0x85
block|,
literal|0x0
block|}
block|}
block|,
comment|// Na Halant ZWJ Dha
block|{
block|{
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x09a7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x247
block|,
literal|0x85
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ka MatraAU
block|{
block|{
literal|0x9b0
block|,
literal|0x9cd
block|,
literal|0x995
block|,
literal|0x9cc
block|,
literal|0x0
block|}
block|,
block|{
literal|0x232
block|,
literal|0x73
block|,
literal|0xe1
block|,
literal|0xa0
block|,
literal|0x0
block|}
block|}
block|,
comment|// Ra Halant Ba Halant Ba
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x09ac
block|,
literal|0x09cd
block|,
literal|0x09ac
block|,
literal|0x0
block|}
block|,
block|{
literal|0x013b
block|,
literal|0x00e1
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Mukti"
argument_list|)
expr_stmt|;
block|}
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Bengali
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Likhan"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Likhan"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x9a8
block|,
literal|0x9cd
block|,
literal|0x9af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x1ca
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x09b8
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x020e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x09b6
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01f4
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x09b7
block|,
literal|0x09cd
block|,
literal|0x09af
block|,
literal|0x0
block|}
block|,
block|{
literal|0x01fe
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x09b0
block|,
literal|0x09cd
block|,
literal|0x09a8
block|,
literal|0x09cd
block|,
literal|0x200d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x10b
block|,
literal|0x167
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Likhan"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|bengali
name|void
name|tst_QTextScriptEngine
operator|::
name|bengali
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|gurmukhi_data
name|void
name|tst_QTextScriptEngine
operator|::
name|gurmukhi_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Gurmukhi
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Lohit Punjabi"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Lohit Punjabi"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0xA15
block|,
literal|0xA4D
block|,
literal|0xa39
block|,
literal|0x0
block|}
block|,
block|{
literal|0x3b
block|,
literal|0x8b
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Lohit Punjabi"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|gurmukhi
name|void
name|tst_QTextScriptEngine
operator|::
name|gurmukhi
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|oriya_data
name|void
name|tst_QTextScriptEngine
operator|::
name|oriya_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Oriya
argument_list|)
operator|.
name|contains
argument_list|(
literal|"utkal"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"utkal"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0xb15
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb30
block|,
literal|0x0
block|}
block|,
block|{
literal|0x150
block|,
literal|0x125
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb2c
block|,
literal|0x0
block|}
block|,
block|{
literal|0x151
block|,
literal|0x120
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb28
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb2c
block|,
literal|0x0
block|}
block|,
block|{
literal|0x152
block|,
literal|0x120
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb28
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb2c
block|,
literal|0x0
block|}
block|,
block|{
literal|0x152
block|,
literal|0x120
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb28
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb30
block|,
literal|0x0
block|}
block|,
block|{
literal|0x176
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb38
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb30
block|,
literal|0x0
block|}
block|,
block|{
literal|0x177
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb28
block|,
literal|0xb4d
block|,
literal|0xb24
block|,
literal|0xb4d
block|,
literal|0xb30
block|,
literal|0xb4d
block|,
literal|0xb2f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x176
block|,
literal|0x124
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find utkal"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|oriya
name|void
name|tst_QTextScriptEngine
operator|::
name|oriya
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|tamil_data
name|void
name|tst_QTextScriptEngine
operator|::
name|tamil_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Tamil
argument_list|)
operator|.
name|contains
argument_list|(
literal|"AkrutiTml1"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"AkrutiTml1"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x0b95
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x004e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bae
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x009e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b9a
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0058
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b99
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0053
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bb0
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00a8
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0ba4
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x008e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b9f
block|,
literal|0x0bc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0062
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b95
block|,
literal|0x0bc6
block|,
literal|0x0
block|}
block|,
block|{
literal|0x000a
block|,
literal|0x0031
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b95
block|,
literal|0x0bca
block|,
literal|0x0
block|}
block|,
block|{
literal|0x000a
block|,
literal|0x0031
block|,
literal|0x0007
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b95
block|,
literal|0x0bc6
block|,
literal|0x0bbe
block|,
literal|0x0
block|}
block|,
block|{
literal|0x000a
block|,
literal|0x0031
block|,
literal|0x007
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b95
block|,
literal|0x0bcd
block|,
literal|0x0bb7
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0049
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b95
block|,
literal|0x0bcd
block|,
literal|0x0bb7
block|,
literal|0x0bca
block|,
literal|0x0
block|}
block|,
block|{
literal|0x000a
block|,
literal|0x0049
block|,
literal|0x007
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b95
block|,
literal|0x0bcd
block|,
literal|0x0bb7
block|,
literal|0x0bc6
block|,
literal|0x0bbe
block|,
literal|0x0
block|}
block|,
block|{
literal|0x000a
block|,
literal|0x0049
block|,
literal|0x007
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b9f
block|,
literal|0x0bbf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x005f
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b9f
block|,
literal|0x0bc0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0060
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bb2
block|,
literal|0x0bc0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00ab
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bb2
block|,
literal|0x0bbf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00aa
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bb0
block|,
literal|0x0bcd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00a4
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bb0
block|,
literal|0x0bbf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00a5
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0bb0
block|,
literal|0x0bc0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00a6
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b83
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0025
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0b83
block|,
literal|0x0b95
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0025
block|,
literal|0x0031
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb95
block|,
literal|0xbc6
block|,
literal|0xbbe
block|,
literal|0x0
block|}
block|,
block|{
literal|0xa
block|,
literal|0x31
block|,
literal|0x7
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb95
block|,
literal|0xbc7
block|,
literal|0xbbe
block|,
literal|0x0
block|}
block|,
block|{
literal|0xb
block|,
literal|0x31
block|,
literal|0x7
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xb95
block|,
literal|0xbc6
block|,
literal|0xbd7
block|,
literal|0x0
block|}
block|,
block|{
literal|0xa
block|,
literal|0x31
block|,
literal|0x40
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find AkrutiTml1"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|tamil
name|void
name|tst_QTextScriptEngine
operator|::
name|tamil
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|telugu_data
name|void
name|tst_QTextScriptEngine
operator|::
name|telugu_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Telugu
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Pothana2000"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Pothana2000"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0x0
block|}
block|,
block|{
literal|0xbb
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc37
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4b
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc37
block|,
literal|0xc4d
block|,
literal|0x0
block|}
block|,
block|{
literal|0xe0
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc37
block|,
literal|0xc4d
block|,
literal|0xc23
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4b
block|,
literal|0x91
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc30
block|,
literal|0x0
block|}
block|,
block|{
literal|0x5a
block|,
literal|0xb2
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc30
block|,
literal|0xc4d
block|,
literal|0x0
block|}
block|,
block|{
literal|0xbb
block|,
literal|0xb2
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc30
block|,
literal|0xc4d
block|,
literal|0xc15
block|,
literal|0x0
block|}
block|,
block|{
literal|0x5a
block|,
literal|0xb2
block|,
literal|0x83
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc30
block|,
literal|0xc3f
block|,
literal|0x0
block|}
block|,
block|{
literal|0xe2
block|,
literal|0xb2
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc15
block|,
literal|0xc48
block|,
literal|0x0
block|}
block|,
block|{
literal|0xe6
block|,
literal|0xb3
block|,
literal|0x83
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc4d
block|,
literal|0xc30
block|,
literal|0xc48
block|,
literal|0x0
block|}
block|,
block|{
literal|0xe6
block|,
literal|0xb3
block|,
literal|0x9f
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc15
block|,
literal|0xc46
block|,
literal|0xc56
block|,
literal|0x0
block|}
block|,
block|{
literal|0xe6
block|,
literal|0xb3
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Pothana2000"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|telugu
name|void
name|tst_QTextScriptEngine
operator|::
name|telugu
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|kannada_data
name|void
name|tst_QTextScriptEngine
operator|::
name|kannada_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Kannada
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Sampige"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Sampige"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x0ca8
block|,
literal|0x0ccd
block|,
literal|0x0ca8
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0049
block|,
literal|0x00ba
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0ca8
block|,
literal|0x0ccd
block|,
literal|0x0ca1
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0049
block|,
literal|0x00b3
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0caf
block|,
literal|0x0cc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x004f
block|,
literal|0x005d
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0ce0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x006a
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0ce6
block|,
literal|0x0ce7
block|,
literal|0x0ce8
block|,
literal|0x0
block|}
block|,
block|{
literal|0x006b
block|,
literal|0x006c
block|,
literal|0x006d
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0cb5
block|,
literal|0x0ccb
block|,
literal|0x0
block|}
block|,
block|{
literal|0x015f
block|,
literal|0x0067
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0cb0
block|,
literal|0x0ccd
block|,
literal|0x0cae
block|,
literal|0x0
block|}
block|,
block|{
literal|0x004e
block|,
literal|0x0082
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0cb0
block|,
literal|0x0ccd
block|,
literal|0x0c95
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0036
block|,
literal|0x0082
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0c95
block|,
literal|0x0ccd
block|,
literal|0x0cb0
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0036
block|,
literal|0x00c1
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0cb0
block|,
literal|0x0ccd
block|,
literal|0x200d
block|,
literal|0x0c95
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0050
block|,
literal|0x00a7
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Sampige"
argument_list|)
expr_stmt|;
block|}
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Kannada
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Tunga"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Tunga"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x0cb7
block|,
literal|0x0cc6
block|,
literal|0x0
block|}
block|,
block|{
literal|0x00b0
block|,
literal|0x006c
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0cb7
block|,
literal|0x0ccd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0163
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc95
block|,
literal|0xcbf
block|,
literal|0xcd5
block|,
literal|0x0
block|}
block|,
block|{
literal|0x114
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc95
block|,
literal|0xcc6
block|,
literal|0xcd5
block|,
literal|0x0
block|}
block|,
block|{
literal|0x90
block|,
literal|0x6c
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc95
block|,
literal|0xcc6
block|,
literal|0xcd6
block|,
literal|0x0
block|}
block|,
block|{
literal|0x90
block|,
literal|0x6c
block|,
literal|0x74
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc95
block|,
literal|0xcc6
block|,
literal|0xcc2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x90
block|,
literal|0x6c
block|,
literal|0x69
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xc95
block|,
literal|0xcca
block|,
literal|0xcd5
block|,
literal|0x0
block|}
block|,
block|{
literal|0x90
block|,
literal|0x6c
block|,
literal|0x69
block|,
literal|0x73
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Tunga"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|kannada
name|void
name|tst_QTextScriptEngine
operator|::
name|kannada
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|malayalam_data
name|void
name|tst_QTextScriptEngine
operator|::
name|malayalam_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Malayalam
argument_list|)
operator|.
name|contains
argument_list|(
literal|"AkrutiMal2"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"AkrutiMal2"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x0d15
block|,
literal|0x0d46
block|,
literal|0x0
block|}
block|,
block|{
literal|0x005e
block|,
literal|0x0034
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d15
block|,
literal|0x0d47
block|,
literal|0x0
block|}
block|,
block|{
literal|0x005f
block|,
literal|0x0034
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d15
block|,
literal|0x0d4b
block|,
literal|0x0
block|}
block|,
block|{
literal|0x005f
block|,
literal|0x0034
block|,
literal|0x0058
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d15
block|,
literal|0x0d48
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0060
block|,
literal|0x0034
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d15
block|,
literal|0x0d4a
block|,
literal|0x0
block|}
block|,
block|{
literal|0x005e
block|,
literal|0x0034
block|,
literal|0x0058
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d30
block|,
literal|0x0d4d
block|,
literal|0x0d15
block|,
literal|0x0
block|}
block|,
block|{
literal|0x009e
block|,
literal|0x0034
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d15
block|,
literal|0x0d4d
block|,
literal|0x0d35
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0034
block|,
literal|0x007a
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d15
block|,
literal|0x0d4d
block|,
literal|0x0d2f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0034
block|,
literal|0x00a2
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d1f
block|,
literal|0x0d4d
block|,
literal|0x0d1f
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0069
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d26
block|,
literal|0x0d4d
block|,
literal|0x0d26
block|,
literal|0x0
block|}
block|,
block|{
literal|0x0074
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d30
block|,
literal|0x0d4d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x009e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d30
block|,
literal|0x0d4d
block|,
literal|0x200c
block|,
literal|0x0
block|}
block|,
block|{
literal|0x009e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x0d30
block|,
literal|0x0d4d
block|,
literal|0x200d
block|,
literal|0x0
block|}
block|,
block|{
literal|0x009e
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd15
block|,
literal|0xd46
block|,
literal|0xd3e
block|,
literal|0x0
block|}
block|,
block|{
literal|0x5e
block|,
literal|0x34
block|,
literal|0x58
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd15
block|,
literal|0xd47
block|,
literal|0xd3e
block|,
literal|0x0
block|}
block|,
block|{
literal|0x5f
block|,
literal|0x34
block|,
literal|0x58
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd15
block|,
literal|0xd46
block|,
literal|0xd57
block|,
literal|0x0
block|}
block|,
block|{
literal|0x5e
block|,
literal|0x34
block|,
literal|0x65
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd15
block|,
literal|0xd57
block|,
literal|0x0
block|}
block|,
block|{
literal|0x34
block|,
literal|0x65
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find AkrutiMal2"
argument_list|)
expr_stmt|;
block|}
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Malayalam
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Rachana"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Rachana"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0xd37
block|,
literal|0xd4d
block|,
literal|0xd1f
block|,
literal|0xd4d
block|,
literal|0xd30
block|,
literal|0xd40
block|,
literal|0x0
block|}
block|,
block|{
literal|0x385
block|,
literal|0xa3
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd2f
block|,
literal|0xd4d
block|,
literal|0xd15
block|,
literal|0xd4d
block|,
literal|0xd15
block|,
literal|0xd41
block|,
literal|0x0
block|}
block|,
block|{
literal|0x2ff
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd33
block|,
literal|0xd4d
block|,
literal|0xd33
block|,
literal|0x0
block|}
block|,
block|{
literal|0x3f8
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd2f
block|,
literal|0xd4d
block|,
literal|0xd15
block|,
literal|0xd4d
block|,
literal|0xd15
block|,
literal|0xd41
block|,
literal|0x0
block|}
block|,
block|{
literal|0x2ff
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd30
block|,
literal|0xd4d
block|,
literal|0x200d
block|,
literal|0xd35
block|,
literal|0xd4d
block|,
literal|0xd35
block|,
literal|0x0
block|}
block|,
block|{
literal|0xf3
block|,
literal|0x350
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Rachana"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|malayalam
name|void
name|tst_QTextScriptEngine
operator|::
name|malayalam
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|sinhala_data
name|void
name|tst_QTextScriptEngine
operator|::
name|sinhala_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Sinhala
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Malithi Web"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Malithi Web"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0xd9a
block|,
literal|0xdd9
block|,
literal|0xdcf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4a
block|,
literal|0x61
block|,
literal|0x42
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd9a
block|,
literal|0xdd9
block|,
literal|0xddf
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4a
block|,
literal|0x61
block|,
literal|0x50
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd9a
block|,
literal|0xdd9
block|,
literal|0xdca
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4a
block|,
literal|0x62
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd9a
block|,
literal|0xddc
block|,
literal|0xdca
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4a
block|,
literal|0x61
block|,
literal|0x42
block|,
literal|0x41
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd9a
block|,
literal|0xdda
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4a
block|,
literal|0x62
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0xd9a
block|,
literal|0xddd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x4a
block|,
literal|0x61
block|,
literal|0x42
block|,
literal|0x41
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Malithi Web"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|sinhala
name|void
name|tst_QTextScriptEngine
operator|::
name|sinhala
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|khmer_data
name|void
name|tst_QTextScriptEngine
operator|::
name|khmer_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Khmer
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Khmer OS"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Khmer OS"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x179a
block|,
literal|0x17cd
block|,
literal|0x0
block|}
block|,
block|{
literal|0x24c
block|,
literal|0x27f
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x179f
block|,
literal|0x17c5
block|,
literal|0x0
block|}
block|,
block|{
literal|0x273
block|,
literal|0x203
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x1790
block|,
literal|0x17d2
block|,
literal|0x1784
block|,
literal|0x17c3
block|,
literal|0x0
block|}
block|,
block|{
literal|0x275
block|,
literal|0x242
block|,
literal|0x182
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x179a
block|,
literal|0x0
block|}
block|,
block|{
literal|0x24c
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x1781
block|,
literal|0x17d2
block|,
literal|0x1798
block|,
literal|0x17c2
block|,
literal|0x0
block|}
block|,
block|{
literal|0x274
block|,
literal|0x233
block|,
literal|0x197
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x1798
block|,
literal|0x17b6
block|,
literal|0x0
block|}
block|,
block|{
literal|0x1cb
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x179a
block|,
literal|0x17b8
block|,
literal|0x0
block|}
block|,
block|{
literal|0x24c
block|,
literal|0x26a
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x1787
block|,
literal|0x17b6
block|,
literal|0x0
block|}
block|,
block|{
literal|0x1ba
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x1798
block|,
literal|0x17d2
block|,
literal|0x1796
block|,
literal|0x17bb
block|,
literal|0x0
block|}
block|,
block|{
literal|0x24a
block|,
literal|0x195
block|,
literal|0x26d
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Khmer OS"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|khmer
name|void
name|tst_QTextScriptEngine
operator|::
name|khmer
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|linearB_data
name|void
name|tst_QTextScriptEngine
operator|::
name|linearB_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Any
argument_list|)
operator|.
name|contains
argument_list|(
literal|"Penuturesu"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"Penuturesu"
argument_list|)
decl_stmt|;
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0xd800
block|,
literal|0xdc01
block|,
literal|0xd800
block|,
literal|0xdc02
block|,
literal|0xd800
block|,
literal|0xdc03
block|,
literal|0
block|}
block|,
block|{
literal|0x5
block|,
literal|0x6
block|,
literal|0x7
block|,
literal|0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find Penuturesu"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|linearB
name|void
name|tst_QTextScriptEngine
operator|::
name|linearB
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|greek_data
name|void
name|tst_QTextScriptEngine
operator|::
name|greek_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|>
argument_list|(
literal|"glyphs"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|haveTestFonts
condition|)
name|QSKIP
argument_list|(
literal|"Test fonts are not available"
argument_list|)
expr_stmt|;
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Any
argument_list|)
operator|.
name|contains
argument_list|(
literal|"DejaVu Sans"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"DejaVu Sans"
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|uc
init|=
literal|0x1f00
init|;
name|uc
operator|<=
literal|0x1fff
condition|;
operator|++
name|uc
control|)
block|{
name|QString
name|string
decl_stmt|;
name|string
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
name|uc
argument_list|)
argument_list|)
expr_stmt|;
name|QByteArray
name|testName
init|=
name|f
operator|.
name|family
argument_list|()
operator|.
name|toLatin1
argument_list|()
operator|+
literal|": 0x"
operator|+
name|QByteArray
operator|::
name|number
argument_list|(
name|uc
argument_list|,
literal|16
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
name|testName
operator|.
name|constData
argument_list|()
argument_list|)
operator|<<
name|f
operator|<<
name|string
operator|<<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|()
expr_stmt|;
block|}
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find DejaVu Sans"
argument_list|)
expr_stmt|;
block|}
block|{
if|if
condition|(
name|QFontDatabase
argument_list|()
operator|.
name|families
argument_list|(
name|QFontDatabase
operator|::
name|Any
argument_list|)
operator|.
name|contains
argument_list|(
literal|"SBL Greek"
argument_list|)
condition|)
block|{
name|QFont
name|f
argument_list|(
literal|"SBL Greek"
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|uc
init|=
literal|0x1f00
init|;
name|uc
operator|<=
literal|0x1fff
condition|;
operator|++
name|uc
control|)
block|{
name|QString
name|string
decl_stmt|;
name|string
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
name|uc
argument_list|)
argument_list|)
expr_stmt|;
name|QByteArray
name|testName
init|=
name|f
operator|.
name|family
argument_list|()
operator|.
name|toLatin1
argument_list|()
operator|+
literal|": 0x"
operator|+
name|QByteArray
operator|::
name|number
argument_list|(
name|uc
argument_list|,
literal|16
argument_list|)
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
name|testName
operator|.
name|constData
argument_list|()
argument_list|)
operator|<<
name|f
operator|<<
name|string
operator|<<
name|QVector
argument_list|<
name|ushort
argument_list|>
argument_list|()
expr_stmt|;
block|}
specifier|const
name|ShapeTable
name|shape_table
index|[]
init|=
block|{
block|{
block|{
literal|0x3b1
block|,
literal|0x300
block|,
literal|0x313
block|,
literal|0x0
block|}
block|,
block|{
literal|0xb8
block|,
literal|0x3d3
block|,
literal|0x3c7
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0x3b1
block|,
literal|0x313
block|,
literal|0x300
block|,
literal|0x0
block|}
block|,
block|{
literal|0xd4
block|,
literal|0x0
block|}
block|}
block|,
block|{
block|{
literal|0
block|}
block|,
block|{
literal|0
block|}
block|}
block|}
decl_stmt|;
name|prepareShapingTest
argument_list|(
name|f
argument_list|,
name|shape_table
argument_list|)
expr_stmt|;
block|}
else|else
name|QSKIP
argument_list|(
literal|"couldn't find SBL_grk"
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|greek
name|void
name|tst_QTextScriptEngine
operator|::
name|greek
parameter_list|()
block|{
name|doShapingTests
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|mirroredChars_data
name|void
name|tst_QTextScriptEngine
operator|::
name|mirroredChars_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"s"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"()"
argument_list|)
operator|<<
name|QStringLiteral
argument_list|(
literal|"()"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"[]"
argument_list|)
operator|<<
name|QStringLiteral
argument_list|(
literal|"[]"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
literal|"{}"
argument_list|)
operator|<<
name|QStringLiteral
argument_list|(
literal|"{}"
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|mirroredChars
name|void
name|tst_QTextScriptEngine
operator|::
name|mirroredChars
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|glyph_t
name|leftParenthesis
decl_stmt|;
name|glyph_t
name|rightParenthesis
decl_stmt|;
block|{
name|QTextLayout
name|layout
argument_list|(
name|s
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setCacheEnabled
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|layout
operator|.
name|beginLayout
argument_list|()
expr_stmt|;
name|layout
operator|.
name|createLine
argument_list|()
expr_stmt|;
name|layout
operator|.
name|endLayout
argument_list|()
expr_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|e
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
specifier|const
name|QGlyphLayout
name|glyphLayout
init|=
name|e
operator|->
name|shapedGlyphs
argument_list|(
operator|&
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
name|leftParenthesis
operator|=
name|glyphLayout
operator|.
name|glyphs
index|[
literal|0
index|]
expr_stmt|;
name|rightParenthesis
operator|=
name|glyphLayout
operator|.
name|glyphs
index|[
literal|1
index|]
expr_stmt|;
block|}
block|{
name|QTextLayout
name|layout
argument_list|(
name|s
argument_list|)
decl_stmt|;
name|layout
operator|.
name|setFlags
argument_list|(
name|Qt
operator|::
name|TextForceRightToLeft
argument_list|)
expr_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|e
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
specifier|const
name|QGlyphLayout
name|glyphLayout
init|=
name|e
operator|->
name|shapedGlyphs
argument_list|(
operator|&
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|glyphLayout
operator|.
name|glyphs
index|[
literal|0
index|]
argument_list|,
name|rightParenthesis
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|glyphLayout
operator|.
name|glyphs
index|[
literal|1
index|]
argument_list|,
name|leftParenthesis
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|controlInSyllable_qtbug14204
name|void
name|tst_QTextScriptEngine
operator|::
name|controlInSyllable_qtbug14204
parameter_list|()
block|{
name|QSKIP
argument_list|(
literal|"Result differs for HarfBuzz-NG, skip test."
argument_list|)
expr_stmt|;
name|QFontDatabase
name|db
decl_stmt|;
if|if
condition|(
operator|!
name|db
operator|.
name|families
argument_list|()
operator|.
name|contains
argument_list|(
name|QStringLiteral
argument_list|(
literal|"Aparajita"
argument_list|)
argument_list|)
condition|)
name|QSKIP
argument_list|(
literal|"couldn't find 'Aparajita' font"
argument_list|)
expr_stmt|;
name|QFont
name|font
argument_list|(
name|QStringLiteral
argument_list|(
literal|"Aparajita"
argument_list|)
argument_list|)
decl_stmt|;
name|font
operator|.
name|setStyleStrategy
argument_list|(
name|QFont
operator|::
name|NoFontMerging
argument_list|)
expr_stmt|;
name|QString
name|s
decl_stmt|;
name|s
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
literal|0x0915
argument_list|)
argument_list|)
expr_stmt|;
name|s
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
literal|0x094d
argument_list|)
argument_list|)
expr_stmt|;
name|s
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
literal|0x200d
argument_list|)
argument_list|)
expr_stmt|;
name|s
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
literal|0x0915
argument_list|)
argument_list|)
expr_stmt|;
name|QTextLayout
name|layout
argument_list|(
name|s
argument_list|,
name|font
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QFontEngine
modifier|*
name|fe
init|=
name|e
operator|->
name|fontEngine
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|fe
operator|->
name|type
argument_list|()
operator|==
name|QFontEngine
operator|::
name|Box
condition|)
name|QSKIP
argument_list|(
literal|"OpenType support missing for script"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fe
operator|->
name|fontDef
operator|.
name|family
argument_list|,
name|font
operator|.
name|family
argument_list|()
argument_list|)
expr_stmt|;
name|e
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
specifier|const
name|ushort
modifier|*
name|log_clusters
init|=
name|e
operator|->
name|logClusters
argument_list|(
operator|&
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|0
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|1
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|2
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|3
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|combiningMarks_qtbug15675_data
name|void
name|tst_QTextScriptEngine
operator|::
name|combiningMarks_qtbug15675_data
parameter_list|()
block|{
name|QTest
operator|::
name|addColumn
argument_list|<
name|QFont
argument_list|>
argument_list|(
literal|"font"
argument_list|)
expr_stmt|;
name|QTest
operator|::
name|addColumn
argument_list|<
name|QString
argument_list|>
argument_list|(
literal|"string"
argument_list|)
expr_stmt|;
name|QSKIP
argument_list|(
literal|"Result differs for HarfBuzz-NG, skip test."
argument_list|)
expr_stmt|;
name|bool
name|hasTests
init|=
literal|false
decl_stmt|;
name|QStringList
name|families
decl_stmt|;
name|families
operator|<<
name|QStringLiteral
argument_list|(
literal|"Monaco"
argument_list|)
expr_stmt|;
name|families
operator|<<
name|QStringLiteral
argument_list|(
literal|"DejaVu Sans Mono"
argument_list|)
expr_stmt|;
foreach|foreach
control|(
specifier|const
name|QString
modifier|&
name|family
decl|,
name|families
control|)
block|{
name|QFont
name|font
argument_list|(
name|family
argument_list|)
decl_stmt|;
name|font
operator|.
name|setStyleStrategy
argument_list|(
name|QFont
operator|::
name|NoFontMerging
argument_list|)
expr_stmt|;
if|if
condition|(
name|QFontInfo
argument_list|(
name|font
argument_list|)
operator|.
name|family
argument_list|()
operator|!=
name|family
condition|)
continue|continue;
name|hasTests
operator|=
literal|true
expr_stmt|;
name|QString
name|s
argument_list|(
name|QStringLiteral
argument_list|(
literal|"ab cd"
argument_list|)
argument_list|)
decl_stmt|;
for|for
control|(
name|ushort
name|uc
init|=
literal|0x0300
init|;
name|uc
operator|<
literal|0x0370
condition|;
operator|++
name|uc
control|)
block|{
name|s
index|[
literal|2
index|]
operator|=
name|QChar
argument_list|(
name|uc
argument_list|)
expr_stmt|;
name|QByteArray
name|testName
init|=
name|family
operator|.
name|toLatin1
argument_list|()
operator|+
literal|": ab<U+"
operator|+
name|QByteArray
operator|::
name|number
argument_list|(
name|uc
argument_list|,
literal|16
argument_list|)
operator|.
name|rightJustified
argument_list|(
literal|4
argument_list|,
literal|'0'
argument_list|)
operator|+
literal|">cd"
decl_stmt|;
name|QTest
operator|::
name|newRow
argument_list|(
name|testName
operator|.
name|constData
argument_list|()
argument_list|)
operator|<<
name|font
operator|<<
name|s
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|hasTests
condition|)
name|QSKIP
argument_list|(
literal|"Couldn't find required fonts, skip test."
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|combiningMarks_qtbug15675
name|void
name|tst_QTextScriptEngine
operator|::
name|combiningMarks_qtbug15675
parameter_list|()
block|{
name|QFETCH
argument_list|(
name|QFont
argument_list|,
name|font
argument_list|)
expr_stmt|;
name|QFETCH
argument_list|(
name|QString
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|QTextLayout
name|layout
argument_list|(
name|string
argument_list|,
name|font
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QFontEngine
modifier|*
name|fe
init|=
name|e
operator|->
name|fontEngine
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|fe
operator|->
name|type
argument_list|()
operator|==
name|QFontEngine
operator|::
name|Box
condition|)
name|QSKIP
argument_list|(
literal|"OpenType support missing for script"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fe
operator|->
name|fontDef
operator|.
name|family
argument_list|,
name|font
operator|.
name|family
argument_list|()
argument_list|)
expr_stmt|;
name|e
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
specifier|const
name|int
name|diff
init|=
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
operator|-
name|string
operator|.
name|size
argument_list|()
decl_stmt|;
name|QVERIFY
argument_list|(
name|diff
operator|>=
operator|-
literal|1
operator|&&
name|diff
operator|<=
literal|1
argument_list|)
expr_stmt|;
comment|// could compose or decompose exactly one character
specifier|const
name|ushort
modifier|*
name|log_clusters
init|=
name|e
operator|->
name|logClusters
argument_list|(
operator|&
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|0
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|1
index|]
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|2
index|]
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|3
index|]
argument_list|,
name|ushort
argument_list|(
literal|3
operator|+
name|diff
argument_list|)
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|4
index|]
argument_list|,
name|ushort
argument_list|(
literal|4
operator|+
name|diff
argument_list|)
argument_list|)
expr_stmt|;
specifier|const
name|QGlyphLayout
name|glyphLayout
init|=
name|e
operator|->
name|shapedGlyphs
argument_list|(
operator|&
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|glyphLayout
operator|.
name|numGlyphs
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
operator|(
name|diff
operator|>=
literal|0
operator|&&
name|i
operator|==
literal|2
operator|)
operator|||
operator|(
name|diff
operator|>
literal|0
operator|&&
name|i
operator|==
literal|2
operator|+
name|diff
operator|)
condition|)
name|QCOMPARE
argument_list|(
name|glyphLayout
operator|.
name|advances
index|[
name|i
index|]
operator|.
name|toInt
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
else|else
name|QVERIFY
argument_list|(
name|glyphLayout
operator|.
name|advances
index|[
name|i
index|]
operator|.
name|toInt
argument_list|()
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|thaiIsolatedSaraAm
name|void
name|tst_QTextScriptEngine
operator|::
name|thaiIsolatedSaraAm
parameter_list|()
block|{
name|QFontDatabase
name|db
decl_stmt|;
if|if
condition|(
operator|!
name|db
operator|.
name|families
argument_list|()
operator|.
name|contains
argument_list|(
literal|"Waree"
argument_list|)
condition|)
name|QSKIP
argument_list|(
literal|"couldn't find 'Waree' font"
argument_list|)
expr_stmt|;
name|QFont
name|font
argument_list|(
name|QStringLiteral
argument_list|(
literal|"Waree"
argument_list|)
argument_list|)
decl_stmt|;
name|font
operator|.
name|setStyleStrategy
argument_list|(
name|QFont
operator|::
name|NoFontMerging
argument_list|)
expr_stmt|;
name|QString
name|s
decl_stmt|;
name|s
operator|.
name|append
argument_list|(
name|QChar
argument_list|(
literal|0x0e33
argument_list|)
argument_list|)
expr_stmt|;
name|QTextLayout
name|layout
argument_list|(
name|s
argument_list|,
name|font
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|QFontEngine
modifier|*
name|fe
init|=
name|e
operator|->
name|fontEngine
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|fe
operator|->
name|type
argument_list|()
operator|==
name|QFontEngine
operator|::
name|Box
condition|)
name|QSKIP
argument_list|(
literal|"OpenType support missing for script"
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|fe
operator|->
name|fontDef
operator|.
name|family
argument_list|,
name|font
operator|.
name|family
argument_list|()
argument_list|)
expr_stmt|;
name|e
operator|->
name|shape
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|QVERIFY
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
operator|>
literal|0
argument_list|)
expr_stmt|;
specifier|const
name|ushort
modifier|*
name|log_clusters
init|=
name|e
operator|->
name|logClusters
argument_list|(
operator|&
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
name|QCOMPARE
argument_list|(
name|log_clusters
index|[
literal|0
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|thaiWithZWJ
name|void
name|tst_QTextScriptEngine
operator|::
name|thaiWithZWJ
parameter_list|()
block|{
name|QFontDatabase
name|db
decl_stmt|;
if|if
condition|(
operator|!
name|db
operator|.
name|families
argument_list|()
operator|.
name|contains
argument_list|(
literal|"Waree"
argument_list|)
condition|)
name|QSKIP
argument_list|(
literal|"couldn't find 'Waree' font"
argument_list|)
expr_stmt|;
name|QFont
name|font
argument_list|(
name|QStringLiteral
argument_list|(
literal|"Waree"
argument_list|)
argument_list|)
decl_stmt|;
name|font
operator|.
name|setStyleStrategy
argument_list|(
name|QFont
operator|::
name|NoFontMerging
argument_list|)
expr_stmt|;
name|QString
name|s
argument_list|(
name|QString
operator|::
name|fromUtf8
argument_list|(
literal|"\xe0\xb8\xa3\xe2\x80\x8d\xe0\xb8\xa3\xe2\x80"
literal|"\x8c\x2e\xe0\xb8\xa3\x2e\xe2\x80\x9c\xe0\xb8"
literal|"\xa3\xe2\x80\xa6\xe0\xb8\xa3\xe2\x80\x9d\xe0"
literal|"\xb8\xa3\xa0\xe0\xb8\xa3\xe6\x9c\xac\xe0\xb8\xa3"
argument_list|)
operator|+
name|QChar
argument_list|(
literal|0x0363
argument_list|)
comment|/*superscript 'a', for testing Inherited class*/
argument_list|)
decl_stmt|;
name|QTextLayout
name|layout
argument_list|(
name|s
argument_list|,
name|font
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
argument_list|,
literal|11
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|item
init|=
literal|0
init|;
name|item
operator|<
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
condition|;
operator|++
name|item
control|)
name|e
operator|->
name|shape
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|0
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|7
argument_list|)
argument_list|)
expr_stmt|;
comment|// Thai: The ZWJ and ZWNJ characters are inherited, so should be part of the thai script
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|1
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Common: The smart quotes cannot be handled by thai, so should be a separate item
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|2
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Thai: Thai character
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|3
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Common: Ellipsis
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|4
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Thai: Thai character
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|5
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Common: Smart quote
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|6
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Thai: Thai character
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|7
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Common: \xA0 = non-breaking space. Could be useful to have in thai, but not currently implemented
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|8
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Thai: Thai character
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|9
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
comment|// Japanese: Kanji for tree
name|QCOMPARE
argument_list|(
name|e
operator|->
name|layoutData
operator|->
name|items
index|[
literal|10
index|]
operator|.
name|num_glyphs
argument_list|,
name|ushort
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
comment|// Thai: Thai character followed by superscript "a" which is of inherited type
comment|//A quick sanity check - check all the characters are individual clusters
name|unsigned
name|short
modifier|*
name|logClusters
init|=
name|e
operator|->
name|layoutData
operator|->
name|logClustersPtr
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|7
condition|;
name|i
operator|++
control|)
name|QCOMPARE
argument_list|(
name|logClusters
index|[
name|i
index|]
argument_list|,
name|ushort
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|10
condition|;
name|i
operator|++
control|)
name|QCOMPARE
argument_list|(
name|logClusters
index|[
name|i
operator|+
literal|7
index|]
argument_list|,
name|ushort
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|// A thai implementation could either remove the ZWJ and ZWNJ characters, or hide them.
comment|// The current implementation hides them, so we test for that.
comment|// The only characters that we should be hiding are the ZWJ and ZWNJ characters in position 1 and 3.
specifier|const
name|QGlyphLayout
name|glyphLayout
init|=
name|e
operator|->
name|layoutData
operator|->
name|glyphLayout
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|18
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|==
literal|17
condition|)
name|QCOMPARE
argument_list|(
name|glyphLayout
operator|.
name|advances
index|[
name|i
index|]
operator|.
name|toInt
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|i
operator|==
literal|1
operator|||
name|i
operator|==
literal|3
condition|)
name|QCOMPARE
argument_list|(
name|glyphLayout
operator|.
name|advances
index|[
name|i
index|]
operator|.
name|toInt
argument_list|()
argument_list|,
literal|0
argument_list|)
expr_stmt|;
else|else
name|QVERIFY
argument_list|(
name|glyphLayout
operator|.
name|advances
index|[
name|i
index|]
operator|.
name|toInt
argument_list|()
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|thaiMultipleVowels
name|void
name|tst_QTextScriptEngine
operator|::
name|thaiMultipleVowels
parameter_list|()
block|{
name|QString
name|s
argument_list|(
name|QString
operator|::
name|fromUtf8
argument_list|(
literal|"\xe0\xb8\xaa"
argument_list|)
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|100
condition|;
name|i
operator|++
control|)
name|s
operator|+=
name|QChar
argument_list|(
literal|0x0E47
argument_list|)
expr_stmt|;
comment|// Add lots of "VOWEL SIGN MAI TAI KHU N/S-T"  stacked on top of the character
name|s
operator|+=
name|QChar
argument_list|(
literal|0x200D
argument_list|)
expr_stmt|;
comment|// Now add a zero width joiner (which adds a circle which is hidden)
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|100
condition|;
name|i
operator|++
control|)
name|s
operator|+=
name|QChar
argument_list|(
literal|0x0E47
argument_list|)
expr_stmt|;
comment|//Add lots of "VOWEL SIGN MAI TAI KHU N/S-T"  stacked on top of the ZWJ
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
literal|10
condition|;
name|i
operator|++
control|)
name|s
operator|+=
name|s
expr_stmt|;
comment|//Repeat the string to make it more likely to crash if we have a buffer overflow
name|QTextLayout
name|layout
argument_list|(
name|s
argument_list|)
decl_stmt|;
name|QTextEngine
modifier|*
name|e
init|=
name|layout
operator|.
name|engine
argument_list|()
decl_stmt|;
name|e
operator|->
name|itemize
argument_list|()
expr_stmt|;
for|for
control|(
name|int
name|item
init|=
literal|0
init|;
name|item
operator|<
name|e
operator|->
name|layoutData
operator|->
name|items
operator|.
name|size
argument_list|()
condition|;
operator|++
name|item
control|)
name|e
operator|->
name|shape
argument_list|(
name|item
argument_list|)
expr_stmt|;
comment|// If we haven't crashed at this point, then the test has passed.
block|}
end_function
begin_macro
name|QTEST_MAIN
argument_list|(
argument|tst_QTextScriptEngine
argument_list|)
end_macro
begin_include
include|#
directive|include
file|"tst_qtextscriptengine.moc"
end_include
end_unit
