begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2013 Digia Plc and/or its subsidiary(-ies). ** Contact: http://www.qt-project.org/legal ** ** This file is part of the test suite of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and Digia.  For licensing terms and ** conditions see http://qt.digia.com/licensing.  For further information ** use the contact form at http://qt.digia.com/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 as published by the Free Software ** Foundation and appearing in the file LICENSE.LGPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU Lesser General Public License version 2.1 requirements ** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Digia gives you certain additional ** rights.  These rights are described in the Digia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU ** General Public License version 3.0 as published by the Free Software ** Foundation and appearing in the file LICENSE.GPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU General Public License version 3.0 requirements will be ** met: http://www.gnu.org/copyleft/gpl.html. ** ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_PRINTER
end_ifndef
begin_include
include|#
directive|include
file|"printdialogpanel.h"
end_include
begin_include
include|#
directive|include
file|"utils.h"
end_include
begin_include
include|#
directive|include
file|<QPrinter>
end_include
begin_include
include|#
directive|include
file|<QPrinterInfo>
end_include
begin_include
include|#
directive|include
file|<QPrintDialog>
end_include
begin_include
include|#
directive|include
file|<QPrintPreviewDialog>
end_include
begin_include
include|#
directive|include
file|<QPageSetupDialog>
end_include
begin_include
include|#
directive|include
file|<QApplication>
end_include
begin_include
include|#
directive|include
file|<QDesktopWidget>
end_include
begin_include
include|#
directive|include
file|<QGroupBox>
end_include
begin_include
include|#
directive|include
file|<QCheckBox>
end_include
begin_include
include|#
directive|include
file|<QLabel>
end_include
begin_include
include|#
directive|include
file|<QPushButton>
end_include
begin_include
include|#
directive|include
file|<QGridLayout>
end_include
begin_include
include|#
directive|include
file|<QFormLayout>
end_include
begin_include
include|#
directive|include
file|<QVBoxLayout>
end_include
begin_include
include|#
directive|include
file|<QDoubleSpinBox>
end_include
begin_include
include|#
directive|include
file|<QPainter>
end_include
begin_include
include|#
directive|include
file|<QFont>
end_include
begin_include
include|#
directive|include
file|<QFontMetrics>
end_include
begin_include
include|#
directive|include
file|<QDateTime>
end_include
begin_include
include|#
directive|include
file|<QDebug>
end_include
begin_include
include|#
directive|include
file|<QTextStream>
end_include
begin_include
include|#
directive|include
file|<QDir>
end_include
begin_decl_stmt
DECL|variable|printerModeComboData
specifier|const
name|FlagData
name|printerModeComboData
index|[]
init|=
block|{
block|{
literal|"ScreenResolution"
block|,
name|QPrinter
operator|::
name|ScreenResolution
block|}
block|,
block|{
literal|"PrinterResolution"
block|,
name|QPrinter
operator|::
name|PrinterResolution
block|}
block|,
block|{
literal|"HighResolution"
block|,
name|QPrinter
operator|::
name|HighResolution
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_if
if|#
directive|if
name|QT_VERSION
operator|<
literal|0x050300
end_if
begin_decl_stmt
DECL|variable|pageSizeComboData
specifier|const
name|FlagData
name|pageSizeComboData
index|[]
init|=
block|{
block|{
literal|"A4"
block|,
name|QPrinter
operator|::
name|A4
block|}
block|,
block|{
literal|"B5"
block|,
name|QPrinter
operator|::
name|B5
block|}
block|,
block|{
literal|"Letter"
block|,
name|QPrinter
operator|::
name|Letter
block|}
block|,
block|{
literal|"Legal"
block|,
name|QPrinter
operator|::
name|Legal
block|}
block|,
block|{
literal|"Executive"
block|,
name|QPrinter
operator|::
name|Executive
block|}
block|,
block|{
literal|"A0"
block|,
name|QPrinter
operator|::
name|A0
block|}
block|,
block|{
literal|"A1"
block|,
name|QPrinter
operator|::
name|A1
block|}
block|,
block|{
literal|"A2"
block|,
name|QPrinter
operator|::
name|A2
block|}
block|,
block|{
literal|"A3"
block|,
name|QPrinter
operator|::
name|A3
block|}
block|,
block|{
literal|"A5"
block|,
name|QPrinter
operator|::
name|A5
block|}
block|,
block|{
literal|"A6"
block|,
name|QPrinter
operator|::
name|A6
block|}
block|,
block|{
literal|"A7"
block|,
name|QPrinter
operator|::
name|A7
block|}
block|,
block|{
literal|"A8"
block|,
name|QPrinter
operator|::
name|A8
block|}
block|,
block|{
literal|"A9"
block|,
name|QPrinter
operator|::
name|A9
block|}
block|,
block|{
literal|"B0"
block|,
name|QPrinter
operator|::
name|B0
block|}
block|,
block|{
literal|"B1"
block|,
name|QPrinter
operator|::
name|B1
block|}
block|,
block|{
literal|"B10"
block|,
name|QPrinter
operator|::
name|B10
block|}
block|,
block|{
literal|"B2"
block|,
name|QPrinter
operator|::
name|B2
block|}
block|,
block|{
literal|"B3"
block|,
name|QPrinter
operator|::
name|B3
block|}
block|,
block|{
literal|"B4"
block|,
name|QPrinter
operator|::
name|B4
block|}
block|,
block|{
literal|"B6"
block|,
name|QPrinter
operator|::
name|B6
block|}
block|,
block|{
literal|"B7"
block|,
name|QPrinter
operator|::
name|B7
block|}
block|,
block|{
literal|"B8"
block|,
name|QPrinter
operator|::
name|B8
block|}
block|,
block|{
literal|"B9"
block|,
name|QPrinter
operator|::
name|B9
block|}
block|,
block|{
literal|"C5E"
block|,
name|QPrinter
operator|::
name|C5E
block|}
block|,
block|{
literal|"Comm10E"
block|,
name|QPrinter
operator|::
name|Comm10E
block|}
block|,
block|{
literal|"DLE"
block|,
name|QPrinter
operator|::
name|DLE
block|}
block|,
block|{
literal|"Folio"
block|,
name|QPrinter
operator|::
name|Folio
block|}
block|,
block|{
literal|"Ledger"
block|,
name|QPrinter
operator|::
name|Ledger
block|}
block|,
block|{
literal|"Tabloid"
block|,
name|QPrinter
operator|::
name|Tabloid
block|}
block|,
block|{
literal|"Custom"
block|,
name|QPrinter
operator|::
name|Custom
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_decl_stmt
DECL|variable|printRangeComboData
specifier|const
name|FlagData
name|printRangeComboData
index|[]
init|=
block|{
block|{
literal|"AllPages"
block|,
name|QPrinter
operator|::
name|AllPages
block|}
block|,
block|{
literal|"Selection"
block|,
name|QPrinter
operator|::
name|Selection
block|}
block|,
block|{
literal|"PageRange"
block|,
name|QPrinter
operator|::
name|PageRange
block|}
block|,
block|{
literal|"CurrentPage"
block|,
name|QPrinter
operator|::
name|CurrentPage
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|pageOrderComboData
specifier|const
name|FlagData
name|pageOrderComboData
index|[]
init|=
block|{
block|{
literal|"FirstPageFirst"
block|,
name|QPrinter
operator|::
name|FirstPageFirst
block|}
block|,
block|{
literal|"LastPageFirst"
block|,
name|QPrinter
operator|::
name|LastPageFirst
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|duplexModeComboData
specifier|const
name|FlagData
name|duplexModeComboData
index|[]
init|=
block|{
block|{
literal|"DuplexNone"
block|,
name|QPrinter
operator|::
name|DuplexNone
block|}
block|,
block|{
literal|"DuplexAuto"
block|,
name|QPrinter
operator|::
name|DuplexAuto
block|}
block|,
block|{
literal|"DuplexLongSide"
block|,
name|QPrinter
operator|::
name|DuplexLongSide
block|}
block|,
block|{
literal|"DuplexShortSide"
block|,
name|QPrinter
operator|::
name|DuplexShortSide
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|paperSourceComboData
specifier|const
name|FlagData
name|paperSourceComboData
index|[]
init|=
block|{
block|{
literal|"OnlyOne"
block|,
name|QPrinter
operator|::
name|OnlyOne
block|}
block|,
block|{
literal|"Lower"
block|,
name|QPrinter
operator|::
name|Lower
block|}
block|,
block|{
literal|"Middle"
block|,
name|QPrinter
operator|::
name|Middle
block|}
block|,
block|{
literal|"Manual"
block|,
name|QPrinter
operator|::
name|Manual
block|}
block|,
block|{
literal|"Envelope"
block|,
name|QPrinter
operator|::
name|Envelope
block|}
block|,
block|{
literal|"EnvelopeManual"
block|,
name|QPrinter
operator|::
name|EnvelopeManual
block|}
block|,
block|{
literal|"Auto"
block|,
name|QPrinter
operator|::
name|Auto
block|}
block|,
block|{
literal|"Tractor"
block|,
name|QPrinter
operator|::
name|Tractor
block|}
block|,
block|{
literal|"SmallFormat"
block|,
name|QPrinter
operator|::
name|SmallFormat
block|}
block|,
block|{
literal|"LargeFormat"
block|,
name|QPrinter
operator|::
name|LargeFormat
block|}
block|,
block|{
literal|"LargeCapacity"
block|,
name|QPrinter
operator|::
name|LargeCapacity
block|}
block|,
block|{
literal|"Cassette"
block|,
name|QPrinter
operator|::
name|Cassette
block|}
block|,
block|{
literal|"FormSource"
block|,
name|QPrinter
operator|::
name|FormSource
block|}
block|,
block|{
literal|"DuplexLongSide"
block|,
name|QPrinter
operator|::
name|DuplexLongSide
block|}
block|,
block|{
literal|"DuplexShortSide"
block|,
name|QPrinter
operator|::
name|DuplexShortSide
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|colorModeComboData
specifier|const
name|FlagData
name|colorModeComboData
index|[]
init|=
block|{
block|{
literal|"GrayScale"
block|,
name|QPrinter
operator|::
name|GrayScale
block|}
block|,
block|{
literal|"Color"
block|,
name|QPrinter
operator|::
name|Color
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|unitsComboData
specifier|const
name|FlagData
name|unitsComboData
index|[]
init|=
block|{
block|{
literal|"Millimeter"
block|,
name|QPageLayout
operator|::
name|Millimeter
block|}
block|,
block|{
literal|"Inch"
block|,
name|QPageLayout
operator|::
name|Inch
block|}
block|,
block|{
literal|"Point"
block|,
name|QPageLayout
operator|::
name|Point
block|}
block|,
block|{
literal|"Pica"
block|,
name|QPageLayout
operator|::
name|Pica
block|}
block|,
block|{
literal|"Didot"
block|,
name|QPageLayout
operator|::
name|Didot
block|}
block|,
block|{
literal|"Cicero"
block|,
name|QPageLayout
operator|::
name|Cicero
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|orientationComboData
specifier|const
name|FlagData
name|orientationComboData
index|[]
init|=
block|{
block|{
literal|"Portrait"
block|,
name|QPageLayout
operator|::
name|Portrait
block|}
block|,
block|{
literal|"Landscape"
block|,
name|QPageLayout
operator|::
name|Landscape
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|layoutModeComboData
specifier|const
name|FlagData
name|layoutModeComboData
index|[]
init|=
block|{
block|{
literal|"StandardMode"
block|,
name|QPageLayout
operator|::
name|StandardMode
block|}
block|,
block|{
literal|"FullPageMode"
block|,
name|QPageLayout
operator|::
name|FullPageMode
block|}
block|, }
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|printDialogOptions
specifier|const
name|FlagData
name|printDialogOptions
index|[]
init|=
block|{
block|{
literal|"PrintToFile"
block|,
name|QPrintDialog
operator|::
name|PrintToFile
block|}
block|,
block|{
literal|"PrintSelection"
block|,
name|QPrintDialog
operator|::
name|PrintSelection
block|}
block|,
block|{
literal|"PrintPageRange"
block|,
name|QPrintDialog
operator|::
name|PrintPageRange
block|}
block|,
block|{
literal|"PrintShowPageSize"
block|,
name|QPrintDialog
operator|::
name|PrintShowPageSize
block|}
block|,
block|{
literal|"PrintCollateCopies"
block|,
name|QPrintDialog
operator|::
name|PrintCollateCopies
block|}
block|,
block|{
literal|"PrintCurrentPage"
block|,
name|QPrintDialog
operator|::
name|PrintCurrentPage
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_function
DECL|function|operator <<
name|QTextStream
modifier|&
name|operator
name|<<
parameter_list|(
name|QTextStream
modifier|&
name|s
parameter_list|,
specifier|const
name|QSizeF
modifier|&
name|size
parameter_list|)
block|{
name|s
operator|<<
name|size
operator|.
name|width
argument_list|()
operator|<<
literal|'x'
operator|<<
name|size
operator|.
name|height
argument_list|()
expr_stmt|;
return|return
name|s
return|;
block|}
end_function
begin_function
DECL|function|operator <<
name|QTextStream
modifier|&
name|operator
name|<<
parameter_list|(
name|QTextStream
modifier|&
name|s
parameter_list|,
specifier|const
name|QRectF
modifier|&
name|rect
parameter_list|)
block|{
name|s
operator|<<
name|rect
operator|.
name|width
argument_list|()
operator|<<
literal|'x'
operator|<<
name|rect
operator|.
name|height
argument_list|()
operator|<<
name|forcesign
operator|<<
name|rect
operator|.
name|x
argument_list|()
operator|<<
name|rect
operator|.
name|y
argument_list|()
operator|<<
name|noforcesign
expr_stmt|;
return|return
name|s
return|;
block|}
end_function
begin_function
DECL|function|operator <<
name|QTextStream
modifier|&
name|operator
name|<<
parameter_list|(
name|QTextStream
modifier|&
name|s
parameter_list|,
specifier|const
name|QPrinter
modifier|&
name|printer
parameter_list|)
block|{
name|s
operator|<<
literal|'"'
operator|<<
name|printer
operator|.
name|printerName
argument_list|()
operator|<<
literal|"\"\nPaper #"
operator|<<
name|printer
operator|.
name|paperSize
argument_list|()
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050000
operator|<<
literal|" \""
operator|<<
name|printer
operator|.
name|paperName
argument_list|()
operator|<<
literal|'"'
endif|#
directive|endif
operator|<<
operator|(
name|printer
operator|.
name|orientation
argument_list|()
operator|==
name|QPrinter
operator|::
name|Portrait
condition|?
literal|", Portrait"
else|:
literal|", Landscape"
operator|)
expr_stmt|;
if|if
condition|(
name|printer
operator|.
name|fullPage
argument_list|()
condition|)
name|s
operator|<<
literal|", full page"
expr_stmt|;
name|s
operator|<<
literal|"\nPaper size: "
operator|<<
name|printer
operator|.
name|paperSize
argument_list|(
name|QPrinter
operator|::
name|Point
argument_list|)
operator|<<
literal|"pt "
operator|<<
name|printer
operator|.
name|paperSize
argument_list|(
name|QPrinter
operator|::
name|Millimeter
argument_list|)
operator|<<
literal|"mm "
operator|<<
literal|"\n            "
operator|<<
name|printer
operator|.
name|paperSize
argument_list|(
name|QPrinter
operator|::
name|DevicePixel
argument_list|)
operator|<<
literal|"device pt "
operator|<<
name|printer
operator|.
name|paperSize
argument_list|(
name|QPrinter
operator|::
name|Inch
argument_list|)
operator|<<
literal|"inch "
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050000
operator|<<
literal|"\nPagedPaintDevSize: "
operator|<<
name|printer
operator|.
name|pageSizeMM
argument_list|()
operator|<<
literal|"mm"
endif|#
directive|endif
operator|<<
literal|"\nLogical resolution : "
operator|<<
name|printer
operator|.
name|logicalDpiX
argument_list|()
operator|<<
literal|','
operator|<<
name|printer
operator|.
name|logicalDpiY
argument_list|()
operator|<<
literal|"DPI"
operator|<<
literal|"\nPhysical resolution: "
operator|<<
name|printer
operator|.
name|physicalDpiX
argument_list|()
operator|<<
literal|','
operator|<<
name|printer
operator|.
name|physicalDpiY
argument_list|()
operator|<<
literal|"DPI"
operator|<<
literal|"\nPaperRect: "
operator|<<
name|printer
operator|.
name|paperRect
argument_list|(
name|QPrinter
operator|::
name|Point
argument_list|)
operator|<<
literal|"pt "
operator|<<
name|printer
operator|.
name|paperRect
argument_list|(
name|QPrinter
operator|::
name|Millimeter
argument_list|)
operator|<<
literal|"mm "
operator|<<
literal|"\n           "
operator|<<
name|printer
operator|.
name|paperRect
argument_list|(
name|QPrinter
operator|::
name|DevicePixel
argument_list|)
operator|<<
literal|"device pt"
operator|<<
literal|"\nPageRect:  "
operator|<<
name|printer
operator|.
name|pageRect
argument_list|(
name|QPrinter
operator|::
name|Point
argument_list|)
operator|<<
literal|"pt "
operator|<<
name|printer
operator|.
name|pageRect
argument_list|(
name|QPrinter
operator|::
name|Millimeter
argument_list|)
operator|<<
literal|"mm "
operator|<<
literal|"\n           "
operator|<<
name|printer
operator|.
name|pageRect
argument_list|(
name|QPrinter
operator|::
name|DevicePixel
argument_list|)
operator|<<
literal|"device pt"
expr_stmt|;
return|return
name|s
return|;
block|}
end_function
begin_comment
comment|// Print a page with a rectangular frame, vertical / horizontal rulers in cm and printer info.
end_comment
begin_function
DECL|function|drawHorizCmRuler
specifier|static
name|void
name|drawHorizCmRuler
parameter_list|(
name|QPainter
modifier|&
name|painter
parameter_list|,
name|int
name|x1
parameter_list|,
name|int
name|x2
parameter_list|,
name|int
name|y
parameter_list|)
block|{
name|painter
operator|.
name|drawLine
argument_list|(
name|x1
argument_list|,
name|y
argument_list|,
name|x2
argument_list|,
name|y
argument_list|)
expr_stmt|;
specifier|const
name|int
name|dpI
init|=
name|painter
operator|.
name|device
argument_list|()
operator|->
name|logicalDpiX
argument_list|()
decl_stmt|;
specifier|const
name|int
name|dpCm
init|=
name|qRound
argument_list|(
name|double
argument_list|(
name|dpI
argument_list|)
operator|/
literal|2.54
argument_list|)
decl_stmt|;
specifier|const
name|int
name|h
init|=
name|dpCm
operator|/
literal|2
decl_stmt|;
specifier|const
name|QFontMetrics
name|fm
argument_list|(
name|painter
operator|.
name|font
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|cm
init|=
literal|0
init|,
name|x
init|=
name|x1
init|;
name|x
operator|<
name|x2
condition|;
name|x
operator|+=
name|dpCm
operator|,
operator|++
name|cm
control|)
block|{
name|painter
operator|.
name|drawLine
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|x
argument_list|,
name|y
operator|-
name|h
argument_list|)
expr_stmt|;
if|if
condition|(
name|cm
condition|)
block|{
specifier|const
name|QString
name|n
init|=
name|QString
operator|::
name|number
argument_list|(
name|cm
argument_list|)
decl_stmt|;
specifier|const
name|QRect
name|br
init|=
name|fm
operator|.
name|boundingRect
argument_list|(
name|n
argument_list|)
decl_stmt|;
name|painter
operator|.
name|drawText
argument_list|(
name|x
operator|-
name|br
operator|.
name|width
argument_list|()
operator|/
literal|2
argument_list|,
name|y
operator|-
name|h
operator|-
literal|10
argument_list|,
name|n
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function
begin_function
DECL|function|drawVertCmRuler
specifier|static
name|void
name|drawVertCmRuler
parameter_list|(
name|QPainter
modifier|&
name|painter
parameter_list|,
name|int
name|x
parameter_list|,
name|int
name|y1
parameter_list|,
name|int
name|y2
parameter_list|)
block|{
name|painter
operator|.
name|drawLine
argument_list|(
name|x
argument_list|,
name|y1
argument_list|,
name|x
argument_list|,
name|y2
argument_list|)
expr_stmt|;
specifier|const
name|int
name|dpI
init|=
name|painter
operator|.
name|device
argument_list|()
operator|->
name|logicalDpiY
argument_list|()
decl_stmt|;
specifier|const
name|int
name|dpCm
init|=
name|qRound
argument_list|(
name|double
argument_list|(
name|dpI
argument_list|)
operator|/
literal|2.54
argument_list|)
decl_stmt|;
specifier|const
name|int
name|h
init|=
name|dpCm
operator|/
literal|2
decl_stmt|;
specifier|const
name|QFontMetrics
name|fm
argument_list|(
name|painter
operator|.
name|font
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|cm
init|=
literal|0
init|,
name|y
init|=
name|y1
init|;
name|y
operator|<
name|y2
condition|;
name|y
operator|+=
name|dpCm
operator|,
operator|++
name|cm
control|)
block|{
name|painter
operator|.
name|drawLine
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|x
operator|+
name|h
argument_list|,
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|cm
condition|)
block|{
specifier|const
name|QString
name|n
init|=
name|QString
operator|::
name|number
argument_list|(
name|cm
argument_list|)
decl_stmt|;
specifier|const
name|QRect
name|br
init|=
name|fm
operator|.
name|boundingRect
argument_list|(
name|n
argument_list|)
decl_stmt|;
name|painter
operator|.
name|drawText
argument_list|(
name|x
operator|+
name|h
operator|+
literal|10
argument_list|,
name|y
operator|+
name|br
operator|.
name|height
argument_list|()
operator|/
literal|2
argument_list|,
name|n
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function
begin_function
DECL|function|print
specifier|static
name|void
name|print
parameter_list|(
name|QPrinter
modifier|*
name|printer
parameter_list|)
block|{
name|QPainter
name|painter
argument_list|(
name|printer
argument_list|)
decl_stmt|;
specifier|const
name|QRectF
name|pageF
init|=
name|printer
operator|->
name|pageRect
argument_list|()
decl_stmt|;
name|QFont
name|font
init|=
name|painter
operator|.
name|font
argument_list|()
decl_stmt|;
name|font
operator|.
name|setFamily
argument_list|(
literal|"Courier"
argument_list|)
expr_stmt|;
name|font
operator|.
name|setPointSize
argument_list|(
literal|10
argument_list|)
expr_stmt|;
comment|// Format message.
specifier|const
name|int
name|charHeight
init|=
name|QFontMetrics
argument_list|(
name|font
argument_list|)
operator|.
name|boundingRect
argument_list|(
literal|'X'
argument_list|)
operator|.
name|height
argument_list|()
decl_stmt|;
name|QString
name|msg
decl_stmt|;
name|QTextStream
name|str
argument_list|(
operator|&
name|msg
argument_list|)
decl_stmt|;
name|str
operator|<<
literal|"Qt "
operator|<<
name|QT_VERSION_STR
expr_stmt|;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050000
name|str
operator|<<
literal|' '
operator|<<
name|QGuiApplication
operator|::
name|platformName
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|str
operator|<<
literal|' '
operator|<<
name|QDateTime
operator|::
name|currentDateTime
argument_list|()
operator|.
name|toString
argument_list|()
operator|<<
literal|"\nFont: "
operator|<<
name|font
operator|.
name|family
argument_list|()
operator|<<
literal|' '
operator|<<
name|font
operator|.
name|pointSize
argument_list|()
operator|<<
literal|'\n'
operator|<<
operator|*
name|printer
expr_stmt|;
if|if
condition|(
operator|!
name|painter
operator|.
name|device
argument_list|()
operator|->
name|logicalDpiY
argument_list|()
operator|||
operator|!
name|painter
operator|.
name|device
argument_list|()
operator|->
name|logicalDpiX
argument_list|()
condition|)
block|{
name|qWarning
argument_list|()
operator|<<
name|Q_FUNC_INFO
operator|<<
literal|"Bailing out due to invalid DPI: "
operator|<<
name|msg
expr_stmt|;
return|return;
block|}
name|painter
operator|.
name|drawRect
argument_list|(
name|pageF
argument_list|)
expr_stmt|;
name|drawHorizCmRuler
argument_list|(
name|painter
argument_list|,
name|pageF
operator|.
name|x
argument_list|()
argument_list|,
name|pageF
operator|.
name|right
argument_list|()
argument_list|,
name|pageF
operator|.
name|height
argument_list|()
operator|/
literal|2
argument_list|)
expr_stmt|;
name|drawVertCmRuler
argument_list|(
name|painter
argument_list|,
name|pageF
operator|.
name|x
argument_list|()
operator|+
name|pageF
operator|.
name|width
argument_list|()
operator|/
literal|2
argument_list|,
name|pageF
operator|.
name|top
argument_list|()
argument_list|,
name|pageF
operator|.
name|bottom
argument_list|()
argument_list|)
expr_stmt|;
name|painter
operator|.
name|setFont
argument_list|(
name|font
argument_list|)
expr_stmt|;
name|QPointF
name|textPoint
init|=
name|pageF
operator|.
name|topLeft
argument_list|()
operator|+
name|QPoint
argument_list|(
literal|10
argument_list|,
name|charHeight
operator|+
literal|10
argument_list|)
decl_stmt|;
foreach|foreach
control|(
specifier|const
name|QString
modifier|&
name|line
decl|,
name|msg
operator|.
name|split
argument_list|(
literal|'\n'
argument_list|)
control|)
block|{
name|painter
operator|.
name|drawText
argument_list|(
name|textPoint
argument_list|,
name|line
argument_list|)
expr_stmt|;
name|textPoint
operator|.
name|ry
argument_list|()
operator|+=
operator|(
literal|15
operator|*
name|charHeight
operator|)
operator|/
literal|10
expr_stmt|;
block|}
name|painter
operator|.
name|end
argument_list|()
expr_stmt|;
block|}
end_function
begin_class
DECL|class|PrintPreviewDialog
class|class
name|PrintPreviewDialog
super|:
specifier|public
name|QPrintPreviewDialog
block|{
name|Q_OBJECT
public|public:
DECL|function|PrintPreviewDialog
specifier|explicit
name|PrintPreviewDialog
parameter_list|(
name|QPrinter
modifier|*
name|printer
parameter_list|,
name|QWidget
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QPrintPreviewDialog
argument_list|(
name|printer
argument_list|,
name|parent
argument_list|)
block|{
name|connect
argument_list|(
name|this
argument_list|,
name|SIGNAL
argument_list|(
name|paintRequested
argument_list|(
name|QPrinter
operator|*
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|slotPaintRequested
argument_list|(
name|QPrinter
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
public|public
name|slots
public|:
DECL|function|slotPaintRequested
name|void
name|slotPaintRequested
parameter_list|(
name|QPrinter
modifier|*
name|p
parameter_list|)
block|{
name|print
argument_list|(
name|p
argument_list|)
expr_stmt|;
block|}
block|}
class|;
end_class
begin_constructor
DECL|function|PrintDialogPanel
name|PrintDialogPanel
operator|::
name|PrintDialogPanel
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|m_blockSignals
argument_list|(
literal|true
argument_list|)
block|{
if|#
directive|if
name|QT_VERSION
operator|<
literal|0x050300
name|m_printerLayout
operator|.
name|setOutputFormat
argument_list|(
name|QPrinter
operator|::
name|PdfFormat
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|m_panel
operator|.
name|setupUi
argument_list|(
name|this
argument_list|)
expr_stmt|;
comment|// Setup the Create box
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_printerModeCombo
argument_list|,
name|printerModeComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|printerModeComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_createButton
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|createPrinter
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_deleteButton
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|deletePrinter
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
comment|// Setup the Page Layout box
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|,
name|unitsComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|unitsComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|,
name|SIGNAL
argument_list|(
name|currentIndexChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|unitsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
for|for
control|(
name|int
name|i
init|=
name|QPageSize
operator|::
name|A4
init|;
name|i
operator|<
name|QPageSize
operator|::
name|LastPageSize
condition|;
operator|++
name|i
control|)
block|{
name|QPageSize
operator|::
name|PageSizeId
name|id
init|=
name|QPageSize
operator|::
name|PageSizeId
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|m_panel
operator|.
name|m_pageSizeCombo
operator|->
name|addItem
argument_list|(
name|QPageSize
operator|::
name|name
argument_list|(
name|id
argument_list|)
argument_list|,
name|QVariant
argument_list|(
name|id
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|#
directive|else
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_pageSizeCombo
argument_list|,
name|pageSizeComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|pageSizeComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|connect
argument_list|(
name|m_panel
operator|.
name|m_pageSizeCombo
argument_list|,
name|SIGNAL
argument_list|(
name|currentIndexChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|pageSizeChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_pageWidth
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|double
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|pageDimensionsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_pageHeight
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|double
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|pageDimensionsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_orientationCombo
argument_list|,
name|orientationComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|orientationComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_orientationCombo
argument_list|,
name|SIGNAL
argument_list|(
name|currentIndexChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|orientationChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_leftMargin
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|double
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|marginsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_topMargin
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|double
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|marginsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_rightMargin
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|double
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|marginsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_bottomMargin
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|double
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|marginsChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|,
name|layoutModeComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|layoutModeComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|,
name|SIGNAL
argument_list|(
name|currentIndexChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|layoutModeChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
comment|// Setup the Print Job box
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|addItem
argument_list|(
name|tr
argument_list|(
literal|"Print to PDF"
argument_list|)
argument_list|,
name|QVariant
argument_list|(
literal|"PdfFormat"
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
foreach|foreach
control|(
specifier|const
name|QString
modifier|&
name|name
decl|,
name|QPrinterInfo
operator|::
name|availablePrinterNames
argument_list|()
control|)
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|addItem
argument_list|(
name|name
argument_list|,
name|QVariant
argument_list|(
name|name
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
foreach|foreach
control|(
specifier|const
name|QPrinterInfo
modifier|&
name|printer
decl|,
name|QPrinterInfo
operator|::
name|availablePrinters
argument_list|()
control|)
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|addItem
argument_list|(
name|printer
operator|.
name|printerName
argument_list|()
argument_list|,
name|QVariant
argument_list|(
name|printer
operator|.
name|printerName
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|connect
argument_list|(
name|m_panel
operator|.
name|m_printerCombo
argument_list|,
name|SIGNAL
argument_list|(
name|currentIndexChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|printerChanged
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_printRangeCombo
argument_list|,
name|printRangeComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|printRangeComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_pageOrderCombo
argument_list|,
name|pageOrderComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|pageOrderComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_duplexModeCombo
argument_list|,
name|duplexModeComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|duplexModeComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_paperSourceCombo
argument_list|,
name|paperSourceComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|paperSourceComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|populateCombo
argument_list|(
name|m_panel
operator|.
name|m_colorModeCombo
argument_list|,
name|colorModeComboData
argument_list|,
sizeof|sizeof
argument_list|(
name|colorModeComboData
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
comment|// Setup the Dialogs box
name|m_panel
operator|.
name|m_dialogOptionsGroupBox
operator|->
name|populateOptions
argument_list|(
name|printDialogOptions
argument_list|,
sizeof|sizeof
argument_list|(
name|printDialogOptions
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|FlagData
argument_list|)
argument_list|)
expr_stmt|;
name|QPrintDialog
name|dialog
decl_stmt|;
name|m_panel
operator|.
name|m_dialogOptionsGroupBox
operator|->
name|setValue
argument_list|(
name|dialog
operator|.
name|options
argument_list|()
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_printButton
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|showPrintDialog
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_printPreviewButton
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|showPreviewDialog
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|m_panel
operator|.
name|m_pageSetupButton
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|showPageSetupDialog
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|enablePanels
argument_list|()
expr_stmt|;
name|m_blockSignals
operator|=
literal|false
expr_stmt|;
block|}
end_constructor
begin_destructor
DECL|function|~PrintDialogPanel
name|PrintDialogPanel
operator|::
name|~
name|PrintDialogPanel
parameter_list|()
block|{ }
end_destructor
begin_function
DECL|function|enablePanels
name|void
name|PrintDialogPanel
operator|::
name|enablePanels
parameter_list|()
block|{
specifier|const
name|bool
name|exists
init|=
operator|!
name|m_printer
operator|.
name|isNull
argument_list|()
decl_stmt|;
name|m_panel
operator|.
name|m_createButton
operator|->
name|setEnabled
argument_list|(
operator|!
name|exists
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_printerModeCombo
operator|->
name|setEnabled
argument_list|(
operator|!
name|exists
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_deleteButton
operator|->
name|setEnabled
argument_list|(
name|exists
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_pageLayoutGroupBox
operator|->
name|setEnabled
argument_list|(
name|exists
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_printJobGroupBox
operator|->
name|setEnabled
argument_list|(
name|exists
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_dialogsGroupBox
operator|->
name|setEnabled
argument_list|(
name|exists
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|createPrinter
name|void
name|PrintDialogPanel
operator|::
name|createPrinter
parameter_list|()
block|{
specifier|const
name|QPrinter
operator|::
name|PrinterMode
name|mode
init|=
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|PrinterMode
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_printerModeCombo
argument_list|)
decl_stmt|;
name|m_printer
operator|.
name|reset
argument_list|(
operator|new
name|QPrinter
argument_list|(
name|mode
argument_list|)
argument_list|)
expr_stmt|;
comment|// Can set only once.
name|retrieveSettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|enablePanels
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|deletePrinter
name|void
name|PrintDialogPanel
operator|::
name|deletePrinter
parameter_list|()
block|{
name|m_printer
operator|.
name|reset
argument_list|()
expr_stmt|;
name|enablePanels
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|customPageSize
name|QSizeF
name|PrintDialogPanel
operator|::
name|customPageSize
parameter_list|()
specifier|const
block|{
return|return
name|QSizeF
argument_list|(
name|m_panel
operator|.
name|m_pageWidth
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_pageHeight
operator|->
name|value
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_comment
comment|// Apply the settings to the QPrinter
end_comment
begin_function
DECL|function|applySettings
name|void
name|PrintDialogPanel
operator|::
name|applySettings
parameter_list|(
name|QPrinter
modifier|*
name|printer
parameter_list|)
specifier|const
block|{
name|QString
name|printerName
init|=
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|currentData
argument_list|()
operator|.
name|toString
argument_list|()
decl_stmt|;
if|if
condition|(
name|printerName
operator|==
name|QStringLiteral
argument_list|(
literal|"PdfFormat"
argument_list|)
condition|)
name|printer
operator|->
name|setOutputFileName
argument_list|(
name|m_panel
operator|.
name|m_fileName
operator|->
name|text
argument_list|()
argument_list|)
expr_stmt|;
else|else
name|printer
operator|->
name|setPrinterName
argument_list|(
name|printerName
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setPrintRange
argument_list|(
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|PrintRange
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_printRangeCombo
argument_list|)
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setFromTo
argument_list|(
name|m_panel
operator|.
name|m_fromPage
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_toPage
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setPageOrder
argument_list|(
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|PageOrder
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_pageOrderCombo
argument_list|)
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setCopyCount
argument_list|(
name|m_panel
operator|.
name|m_copyCount
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setCollateCopies
argument_list|(
name|m_panel
operator|.
name|m_collateCopies
operator|->
name|isChecked
argument_list|()
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setDuplex
argument_list|(
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|DuplexMode
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_duplexModeCombo
argument_list|)
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setPaperSource
argument_list|(
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|PaperSource
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_paperSourceCombo
argument_list|)
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setColorMode
argument_list|(
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|ColorMode
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_colorModeCombo
argument_list|)
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setResolution
argument_list|(
name|m_panel
operator|.
name|m_resolution
operator|->
name|value
argument_list|()
argument_list|)
expr_stmt|;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|printer
operator|->
name|setPageLayout
argument_list|(
name|m_pageLayout
argument_list|)
expr_stmt|;
else|#
directive|else
if|if
condition|(
name|m_printerLayout
operator|.
name|pageSize
argument_list|()
operator|==
name|QPrinter
operator|::
name|Custom
condition|)
name|printer
operator|->
name|setPaperSize
argument_list|(
name|customPageSize
argument_list|()
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
else|else
name|printer
operator|->
name|setPageSize
argument_list|(
name|m_printerLayout
operator|.
name|pageSize
argument_list|()
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setOrientation
argument_list|(
name|m_printerLayout
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setFullPage
argument_list|(
name|m_printerLayout
operator|.
name|fullPage
argument_list|()
argument_list|)
expr_stmt|;
name|double
name|left
decl_stmt|,
name|top
decl_stmt|,
name|right
decl_stmt|,
name|bottom
decl_stmt|;
name|m_printerLayout
operator|.
name|getPageMargins
argument_list|(
operator|&
name|left
argument_list|,
operator|&
name|top
argument_list|,
operator|&
name|right
argument_list|,
operator|&
name|bottom
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
name|printer
operator|->
name|setPageMargins
argument_list|(
name|left
argument_list|,
name|top
argument_list|,
name|right
argument_list|,
name|bottom
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_comment
comment|// Retrieve the settings from the QPrinter
end_comment
begin_function
DECL|function|retrieveSettings
name|void
name|PrintDialogPanel
operator|::
name|retrieveSettings
parameter_list|(
specifier|const
name|QPrinter
modifier|*
name|printer
parameter_list|)
block|{
if|if
condition|(
name|printer
operator|->
name|outputFormat
argument_list|()
operator|==
name|QPrinter
operator|::
name|NativeFormat
condition|)
block|{
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|setCurrentIndex
argument_list|(
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|findData
argument_list|(
name|QVariant
argument_list|(
name|printer
operator|->
name|printerName
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_fileName
operator|->
name|setEnabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|setCurrentIndex
argument_list|(
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|findData
argument_list|(
name|QVariant
argument_list|(
name|QStringLiteral
argument_list|(
literal|"PdfFormat"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_fileName
operator|->
name|setEnabled
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
name|m_panel
operator|.
name|m_fileName
operator|->
name|setText
argument_list|(
name|printer
operator|->
name|outputFileName
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_printRangeCombo
argument_list|,
name|printer
operator|->
name|printRange
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_fromPage
operator|->
name|setValue
argument_list|(
name|printer
operator|->
name|fromPage
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_toPage
operator|->
name|setValue
argument_list|(
name|printer
operator|->
name|toPage
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_pageOrderCombo
argument_list|,
name|printer
operator|->
name|pageOrder
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_copyCount
operator|->
name|setValue
argument_list|(
name|printer
operator|->
name|copyCount
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_collateCopies
operator|->
name|setChecked
argument_list|(
name|printer
operator|->
name|collateCopies
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_duplexModeCombo
argument_list|,
name|printer
operator|->
name|duplex
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_paperSourceCombo
argument_list|,
name|printer
operator|->
name|paperSource
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_colorModeCombo
argument_list|,
name|printer
operator|->
name|colorMode
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_resolution
operator|->
name|setValue
argument_list|(
name|printer
operator|->
name|resolution
argument_list|()
argument_list|)
expr_stmt|;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|m_pageLayout
operator|=
name|printer
operator|->
name|pageLayout
argument_list|()
expr_stmt|;
else|#
directive|else
if|if
condition|(
name|printer
operator|->
name|pageSize
argument_list|()
operator|==
name|QPrinter
operator|::
name|Custom
condition|)
name|m_printerLayout
operator|.
name|setPaperSize
argument_list|(
name|customPageSize
argument_list|()
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
else|else
name|m_printerLayout
operator|.
name|setPageSize
argument_list|(
name|printer
operator|->
name|pageSize
argument_list|()
argument_list|)
expr_stmt|;
name|m_printerLayout
operator|.
name|setOrientation
argument_list|(
name|printer
operator|->
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|m_printerLayout
operator|.
name|setFullPage
argument_list|(
name|printer
operator|->
name|fullPage
argument_list|()
argument_list|)
expr_stmt|;
name|double
name|left
decl_stmt|,
name|top
decl_stmt|,
name|right
decl_stmt|,
name|bottom
decl_stmt|;
name|printer
operator|->
name|getPageMargins
argument_list|(
operator|&
name|left
argument_list|,
operator|&
name|top
argument_list|,
operator|&
name|right
argument_list|,
operator|&
name|bottom
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
name|m_printerLayout
operator|.
name|setPageMargins
argument_list|(
name|left
argument_list|,
name|top
argument_list|,
name|right
argument_list|,
name|bottom
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|updatePageLayoutWidgets
name|void
name|PrintDialogPanel
operator|::
name|updatePageLayoutWidgets
parameter_list|()
block|{
name|m_blockSignals
operator|=
literal|true
expr_stmt|;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|,
name|m_pageLayout
operator|.
name|units
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_pageSizeCombo
argument_list|,
name|m_pageLayout
operator|.
name|pageSize
argument_list|()
operator|.
name|id
argument_list|()
argument_list|)
expr_stmt|;
name|QSizeF
name|sizef
init|=
name|m_pageLayout
operator|.
name|pageSize
argument_list|()
operator|.
name|size
argument_list|(
name|QPageSize
operator|::
name|Unit
argument_list|(
name|m_pageLayout
operator|.
name|units
argument_list|()
argument_list|)
argument_list|)
decl_stmt|;
name|bool
name|custom
init|=
operator|(
name|m_pageLayout
operator|.
name|pageSize
argument_list|()
operator|.
name|id
argument_list|()
operator|==
name|QPageSize
operator|::
name|Custom
operator|)
decl_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_orientationCombo
argument_list|,
name|m_pageLayout
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_leftMargin
operator|->
name|setValue
argument_list|(
name|m_pageLayout
operator|.
name|margins
argument_list|()
operator|.
name|left
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_topMargin
operator|->
name|setValue
argument_list|(
name|m_pageLayout
operator|.
name|margins
argument_list|()
operator|.
name|top
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rightMargin
operator|->
name|setValue
argument_list|(
name|m_pageLayout
operator|.
name|margins
argument_list|()
operator|.
name|right
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_bottomMargin
operator|->
name|setValue
argument_list|(
name|m_pageLayout
operator|.
name|margins
argument_list|()
operator|.
name|bottom
argument_list|()
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|,
name|m_pageLayout
operator|.
name|mode
argument_list|()
argument_list|)
expr_stmt|;
name|QRectF
name|rectf
init|=
name|m_pageLayout
operator|.
name|paintRect
argument_list|()
decl_stmt|;
else|#
directive|else
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_pageSizeCombo
argument_list|,
name|m_printerLayout
operator|.
name|pageSize
argument_list|()
argument_list|)
expr_stmt|;
name|QSizeF
name|sizef
init|=
name|m_printerLayout
operator|.
name|paperSize
argument_list|(
name|m_units
argument_list|)
decl_stmt|;
name|bool
name|custom
init|=
operator|(
name|m_printerLayout
operator|.
name|pageSize
argument_list|()
operator|==
name|QPrinter
operator|::
name|Custom
operator|)
decl_stmt|;
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_orientationCombo
argument_list|,
name|m_printerLayout
operator|.
name|orientation
argument_list|()
argument_list|)
expr_stmt|;
name|double
name|left
decl_stmt|,
name|top
decl_stmt|,
name|right
decl_stmt|,
name|bottom
decl_stmt|;
name|m_printerLayout
operator|.
name|getPageMargins
argument_list|(
operator|&
name|left
argument_list|,
operator|&
name|top
argument_list|,
operator|&
name|right
argument_list|,
operator|&
name|bottom
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_leftMargin
operator|->
name|setValue
argument_list|(
name|left
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_topMargin
operator|->
name|setValue
argument_list|(
name|top
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rightMargin
operator|->
name|setValue
argument_list|(
name|right
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_bottomMargin
operator|->
name|setValue
argument_list|(
name|bottom
argument_list|)
expr_stmt|;
if|if
condition|(
name|m_printerLayout
operator|.
name|fullPage
argument_list|()
condition|)
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|,
name|QPageLayout
operator|::
name|FullPageMode
argument_list|)
expr_stmt|;
else|else
name|setComboBoxValue
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|,
name|QPageLayout
operator|::
name|StandardMode
argument_list|)
expr_stmt|;
name|QRectF
name|rectf
init|=
name|m_printerLayout
operator|.
name|pageRect
argument_list|(
name|m_units
argument_list|)
decl_stmt|;
endif|#
directive|endif
name|m_panel
operator|.
name|m_pageWidth
operator|->
name|setValue
argument_list|(
name|sizef
operator|.
name|width
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_pageHeight
operator|->
name|setValue
argument_list|(
name|sizef
operator|.
name|height
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_pageWidth
operator|->
name|setEnabled
argument_list|(
name|custom
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_pageHeight
operator|->
name|setEnabled
argument_list|(
name|custom
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectX
operator|->
name|setValue
argument_list|(
name|rectf
operator|.
name|x
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectY
operator|->
name|setValue
argument_list|(
name|rectf
operator|.
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectWidth
operator|->
name|setValue
argument_list|(
name|rectf
operator|.
name|width
argument_list|()
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectHeight
operator|->
name|setValue
argument_list|(
name|rectf
operator|.
name|height
argument_list|()
argument_list|)
expr_stmt|;
name|QString
name|suffix
decl_stmt|;
switch|switch
condition|(
name|comboBoxValue
argument_list|<
name|QPageLayout
operator|::
name|Unit
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|)
condition|)
block|{
case|case
name|QPageLayout
operator|::
name|Millimeter
case|:
name|suffix
operator|=
name|tr
argument_list|(
literal|" mm"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QPageLayout
operator|::
name|Point
case|:
name|suffix
operator|=
name|tr
argument_list|(
literal|" pt"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QPageLayout
operator|::
name|Inch
case|:
name|suffix
operator|=
name|tr
argument_list|(
literal|" in"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QPageLayout
operator|::
name|Pica
case|:
name|suffix
operator|=
name|tr
argument_list|(
literal|" pc"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QPageLayout
operator|::
name|Didot
case|:
name|suffix
operator|=
name|tr
argument_list|(
literal|" DD"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QPageLayout
operator|::
name|Cicero
case|:
name|suffix
operator|=
name|tr
argument_list|(
literal|" CC"
argument_list|)
expr_stmt|;
break|break;
block|}
name|m_panel
operator|.
name|m_pageWidth
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_pageHeight
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_leftMargin
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_topMargin
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rightMargin
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_bottomMargin
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectX
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectY
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectWidth
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_panel
operator|.
name|m_rectHeight
operator|->
name|setSuffix
argument_list|(
name|suffix
argument_list|)
expr_stmt|;
name|m_blockSignals
operator|=
literal|false
expr_stmt|;
block|}
end_function
begin_function
DECL|function|unitsChanged
name|void
name|PrintDialogPanel
operator|::
name|unitsChanged
parameter_list|()
block|{
if|if
condition|(
name|m_blockSignals
condition|)
return|return;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|m_pageLayout
operator|.
name|setUnits
argument_list|(
name|comboBoxValue
argument_list|<
name|QPageLayout
operator|::
name|Unit
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
name|m_units
operator|=
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|Unit
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_unitsCombo
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|pageSizeChanged
name|void
name|PrintDialogPanel
operator|::
name|pageSizeChanged
parameter_list|()
block|{
if|if
condition|(
name|m_blockSignals
condition|)
return|return;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
specifier|const
name|QPageSize
operator|::
name|PageSizeId
name|pageSizeId
init|=
name|comboBoxValue
argument_list|<
name|QPageSize
operator|::
name|PageSizeId
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_pageSizeCombo
argument_list|)
decl_stmt|;
name|QPageSize
name|pageSize
decl_stmt|;
if|if
condition|(
name|pageSizeId
operator|==
name|QPageSize
operator|::
name|Custom
condition|)
name|pageSize
operator|=
name|QPageSize
argument_list|(
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
argument_list|,
name|QPageSize
operator|::
name|Unit
argument_list|(
name|m_pageLayout
operator|.
name|units
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|pageSize
operator|=
name|QPageSize
argument_list|(
name|pageSizeId
argument_list|)
expr_stmt|;
name|m_pageLayout
operator|.
name|setPageSize
argument_list|(
name|pageSize
argument_list|)
expr_stmt|;
else|#
directive|else
specifier|const
name|QPrinter
operator|::
name|PageSize
name|pageSize
init|=
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|PageSize
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_pageSizeCombo
argument_list|)
decl_stmt|;
if|if
condition|(
name|pageSize
operator|==
name|QPrinter
operator|::
name|Custom
condition|)
name|m_printerLayout
operator|.
name|setPaperSize
argument_list|(
name|QSizeF
argument_list|(
literal|200
argument_list|,
literal|200
argument_list|)
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
else|else
name|m_printerLayout
operator|.
name|setPageSize
argument_list|(
name|pageSize
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|pageDimensionsChanged
name|void
name|PrintDialogPanel
operator|::
name|pageDimensionsChanged
parameter_list|()
block|{
if|if
condition|(
name|m_blockSignals
condition|)
return|return;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|m_pageLayout
operator|.
name|setPageSize
argument_list|(
name|QPageSize
argument_list|(
name|customPageSize
argument_list|()
argument_list|,
name|QPageSize
operator|::
name|Unit
argument_list|(
name|m_pageLayout
operator|.
name|units
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
name|m_printerLayout
operator|.
name|setPaperSize
argument_list|(
name|customPageSize
argument_list|()
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|orientationChanged
name|void
name|PrintDialogPanel
operator|::
name|orientationChanged
parameter_list|()
block|{
if|if
condition|(
name|m_blockSignals
condition|)
return|return;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|m_pageLayout
operator|.
name|setOrientation
argument_list|(
name|comboBoxValue
argument_list|<
name|QPageLayout
operator|::
name|Orientation
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_orientationCombo
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
name|m_printerLayout
operator|.
name|setOrientation
argument_list|(
name|comboBoxValue
argument_list|<
name|QPrinter
operator|::
name|Orientation
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_orientationCombo
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|marginsChanged
name|void
name|PrintDialogPanel
operator|::
name|marginsChanged
parameter_list|()
block|{
if|if
condition|(
name|m_blockSignals
condition|)
return|return;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|m_pageLayout
operator|.
name|setMargins
argument_list|(
name|QMarginsF
argument_list|(
name|m_panel
operator|.
name|m_leftMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_topMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_rightMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_bottomMargin
operator|->
name|value
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
name|m_printerLayout
operator|.
name|setPageMargins
argument_list|(
name|m_panel
operator|.
name|m_leftMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_topMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_rightMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_panel
operator|.
name|m_bottomMargin
operator|->
name|value
argument_list|()
argument_list|,
name|m_units
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|layoutModeChanged
name|void
name|PrintDialogPanel
operator|::
name|layoutModeChanged
parameter_list|()
block|{
if|if
condition|(
name|m_blockSignals
condition|)
return|return;
if|#
directive|if
name|QT_VERSION
operator|>=
literal|0x050300
name|m_pageLayout
operator|.
name|setMode
argument_list|(
name|comboBoxValue
argument_list|<
name|QPageLayout
operator|::
name|Mode
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
name|bool
name|fullPage
init|=
operator|(
name|comboBoxValue
argument_list|<
name|QPageLayout
operator|::
name|Mode
argument_list|>
argument_list|(
name|m_panel
operator|.
name|m_layoutModeCombo
argument_list|)
operator|==
name|QPageLayout
operator|::
name|FullPageMode
operator|)
decl_stmt|;
name|m_printerLayout
operator|.
name|setFullPage
argument_list|(
name|fullPage
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|updatePageLayoutWidgets
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|printerChanged
name|void
name|PrintDialogPanel
operator|::
name|printerChanged
parameter_list|()
block|{
name|bool
name|isPdf
init|=
operator|(
name|m_panel
operator|.
name|m_printerCombo
operator|->
name|currentData
argument_list|()
operator|.
name|toString
argument_list|()
operator|==
name|QStringLiteral
argument_list|(
literal|"PdfFormat"
argument_list|)
operator|)
decl_stmt|;
name|m_panel
operator|.
name|m_fileName
operator|->
name|setEnabled
argument_list|(
name|isPdf
argument_list|)
expr_stmt|;
if|if
condition|(
name|isPdf
operator|&&
name|m_panel
operator|.
name|m_fileName
operator|->
name|text
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
name|m_panel
operator|.
name|m_fileName
operator|->
name|setText
argument_list|(
name|QDir
operator|::
name|homePath
argument_list|()
operator|+
name|QDir
operator|::
name|separator
argument_list|()
operator|+
name|QStringLiteral
argument_list|(
literal|"print.pdf"
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|showPrintDialog
name|void
name|PrintDialogPanel
operator|::
name|showPrintDialog
parameter_list|()
block|{
name|applySettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|QPrintDialog
name|dialog
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|,
name|this
argument_list|)
decl_stmt|;
name|dialog
operator|.
name|setOptions
argument_list|(
name|m_panel
operator|.
name|m_dialogOptionsGroupBox
operator|->
name|value
argument_list|<
name|QPrintDialog
operator|::
name|PrintDialogOptions
argument_list|>
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|dialog
operator|.
name|exec
argument_list|()
operator|==
name|QDialog
operator|::
name|Accepted
condition|)
block|{
name|retrieveSettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|print
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|showPreviewDialog
name|void
name|PrintDialogPanel
operator|::
name|showPreviewDialog
parameter_list|()
block|{
name|applySettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|PrintPreviewDialog
name|dialog
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|,
name|this
argument_list|)
decl_stmt|;
name|dialog
operator|.
name|resize
argument_list|(
name|QApplication
operator|::
name|desktop
argument_list|()
operator|->
name|availableGeometry
argument_list|()
operator|.
name|size
argument_list|()
operator|*
literal|4
operator|/
literal|5
argument_list|)
expr_stmt|;
if|if
condition|(
name|dialog
operator|.
name|exec
argument_list|()
operator|==
name|QDialog
operator|::
name|Accepted
condition|)
name|retrieveSettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|showPageSetupDialog
name|void
name|PrintDialogPanel
operator|::
name|showPageSetupDialog
parameter_list|()
block|{
name|applySettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
name|QPageSetupDialog
name|dialog
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|,
name|this
argument_list|)
decl_stmt|;
if|if
condition|(
name|dialog
operator|.
name|exec
argument_list|()
operator|==
name|QDialog
operator|::
name|Accepted
condition|)
name|retrieveSettings
argument_list|(
name|m_printer
operator|.
name|data
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_include
include|#
directive|include
file|"moc_printdialogpanel.cpp"
end_include
begin_include
include|#
directive|include
file|"printdialogpanel.moc"
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// !QT_NO_PRINTER
end_comment
end_unit
