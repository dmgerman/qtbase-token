begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2015 The Qt Company Ltd. ** Contact: http://www.qt.io/licensing/ ** ** This file is part of the QtGui module of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL21$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and The Qt Company. For licensing terms ** and conditions see http://www.qt.io/terms-conditions. For further ** information use the contact form at http://www.qt.io/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 or version 3 as published by the Free ** Software Foundation and appearing in the file LICENSE.LGPLv21 and ** LICENSE.LGPLv3 included in the packaging of this file. Please review the ** following information to ensure the GNU Lesser General Public License ** requirements will be met: https://www.gnu.org/licenses/lgpl.html and ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** As a special exception, The Qt Company gives you certain additional ** rights. These rights are described in The Qt Company LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|"qcursor.h"
end_include
begin_include
include|#
directive|include
file|<qcoreapplication.h>
end_include
begin_include
include|#
directive|include
file|<qbitmap.h>
end_include
begin_include
include|#
directive|include
file|<qimage.h>
end_include
begin_include
include|#
directive|include
file|<qdatastream.h>
end_include
begin_include
include|#
directive|include
file|<qvariant.h>
end_include
begin_include
include|#
directive|include
file|<private/qcursor_p.h>
end_include
begin_include
include|#
directive|include
file|<qdebug.h>
end_include
begin_include
include|#
directive|include
file|<qpa/qplatformcursor.h>
end_include
begin_include
include|#
directive|include
file|<private/qguiapplication_p.h>
end_include
begin_include
include|#
directive|include
file|<private/qhighdpiscaling_p.h>
end_include
begin_function
name|QT_BEGIN_NAMESPACE
comment|/*!     \class QCursor      \brief The QCursor class provides a mouse cursor with an arbitrary     shape.      \inmodule QtGui     \ingroup appearance     \ingroup shared       This class is mainly used to create mouse cursors that are     associated with particular widgets and to get and set the position     of the mouse cursor.      Qt has a number of standard cursor shapes, but you can also make     custom cursor shapes based on a QBitmap, a mask and a hotspot.      To associate a cursor with a widget, use QWidget::setCursor(). To     associate a cursor with all widgets (normally for a short period     of time), use QGuiApplication::setOverrideCursor().      To set a cursor shape use QCursor::setShape() or use the QCursor     constructor which takes the shape as argument, or you can use one     of the predefined cursors defined in the \l Qt::CursorShape enum.      If you want to create a cursor with your own bitmap, either use     the QCursor constructor which takes a bitmap and a mask or the     constructor which takes a pixmap as arguments.      To set or get the position of the mouse cursor use the static     methods QCursor::pos() and QCursor::setPos().      \b{Note:} It is possible to create a QCursor before     QGuiApplication, but it is not useful except as a place-holder for a     real QCursor created after QGuiApplication. Attempting to use a     QCursor that was created before QGuiApplication will result in a     crash.      \section1 A Note for X11 Users      On X11, Qt supports the \l{Xcursor}{Xcursor}     library, which allows for full color icon themes. The table below     shows the cursor name used for each Qt::CursorShape value. If a     cursor cannot be found using the name shown below, a standard X11     cursor will be used instead. Note: X11 does not provide     appropriate cursors for all possible Qt::CursorShape values. It     is possible that some cursors will be taken from the Xcursor     theme, while others will use an internal bitmap cursor.      \table     \header \li Shape \li Qt::CursorShape Value \li Cursor Name             \li Shape \li Qt::CursorShape Value \li Cursor Name     \row \li \inlineimage cursor-arrow.png          \li Qt::ArrowCursor   \li \c left_ptr          \li \inlineimage      cursor-sizev.png          \li Qt::SizeVerCursor \li \c size_ver     \row \li \inlineimage      cursor-uparrow.png          \li Qt::UpArrowCursor \li \c up_arrow          \li \inlineimage      cursor-sizeh.png          \li Qt::SizeHorCursor \li \c size_hor     \row \li \inlineimage      cursor-cross.png          \li Qt::CrossCursor   \li \c cross          \li \inlineimage      cursor-sizeb.png          \li Qt::SizeBDiagCursor \li \c size_bdiag     \row \li \inlineimage      cursor-ibeam.png          \li Qt::IBeamCursor   \li \c ibeam          \li \inlineimage      cursor-sizef.png          \li Qt::SizeFDiagCursor \li \c size_fdiag     \row \li \inlineimage      cursor-wait.png          \li Qt::WaitCursor    \li \c wait          \li \inlineimage      cursor-sizeall.png          \li Qt::SizeAllCursor \li \c size_all     \row \li \inlineimage      cursor-busy.png          \li Qt::BusyCursor    \li \c left_ptr_watch          \li \inlineimage      cursor-vsplit.png          \li Qt::SplitVCursor  \li \c split_v     \row \li \inlineimage      cursor-forbidden.png          \li Qt::ForbiddenCursor \li \c forbidden          \li \inlineimage      cursor-hsplit.png          \li Qt::SplitHCursor  \li \c split_h     \row \li \inlineimage      cursor-hand.png          \li Qt::PointingHandCursor \li \c pointing_hand          \li \inlineimage      cursor-openhand.png          \li Qt::OpenHandCursor  \li \c openhand     \row \li \inlineimage      cursor-whatsthis.png          \li Qt::WhatsThisCursor \li \c whats_this          \li \inlineimage      cursor-closedhand.png          \li Qt::ClosedHandCursor \li \c closedhand     \row \li          \li Qt::DragMoveCursor      \li \c dnd-move or \c move          \li          \li Qt::DragCopyCursor      \li \c dnd-copy or \c copy     \row \li          \li Qt::DragLinkCursor      \li \c dnd-link or \c link     \endtable      \sa QWidget, {fowler}{GUI Design Handbook: Cursors} */
comment|/*!     \fn QCursor::QCursor(QCursor&&other)     \since 5.5      Move-constructs a cursor from \a other. After being moved from,     the only valid operations on \a other are destruction and     (move and copy) assignment. The effects of calling any other     member function on a moved-from instance are undefined. */
comment|/*!     \fn QCursor&QCursor::operator=(QCursor&&other)      Move-assigns \a other to this QCursor instance.      \since 5.2 */
comment|/*!     \fn QPoint QCursor::pos(const QScreen *screen)      Returns the position of the cursor (hot spot) of the \a screen     in global screen coordinates.      You can call QWidget::mapFromGlobal() to translate it to widget     coordinates.      \sa setPos(), QWidget::mapFromGlobal(), QWidget::mapToGlobal() */
DECL|function|pos
name|QPoint
name|QCursor
operator|::
name|pos
parameter_list|(
specifier|const
name|QScreen
modifier|*
name|screen
parameter_list|)
block|{
if|if
condition|(
name|screen
condition|)
block|{
if|if
condition|(
specifier|const
name|QPlatformCursor
modifier|*
name|cursor
init|=
name|screen
operator|->
name|handle
argument_list|()
operator|->
name|cursor
argument_list|()
condition|)
block|{
specifier|const
name|QPlatformScreen
modifier|*
name|ps
init|=
name|screen
operator|->
name|handle
argument_list|()
decl_stmt|;
name|QPoint
name|nativePos
init|=
name|cursor
operator|->
name|pos
argument_list|()
decl_stmt|;
name|ps
operator|=
name|ps
operator|->
name|screenForPosition
argument_list|(
name|nativePos
argument_list|)
expr_stmt|;
return|return
name|QHighDpi
operator|::
name|fromNativePixels
argument_list|(
name|nativePos
argument_list|,
name|ps
operator|->
name|screen
argument_list|()
argument_list|)
return|;
block|}
block|}
return|return
name|QGuiApplicationPrivate
operator|::
name|lastCursorPosition
operator|.
name|toPoint
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \fn QPoint QCursor::pos()      Returns the position of the cursor (hot spot) of     the primary screen in global screen coordinates.      You can call QWidget::mapFromGlobal() to translate it to widget     coordinates.      \note The position is queried from the windowing system. If mouse events are generated     via other means (e.g., via QWindowSystemInterface in a unit test), those fake mouse     moves will not be reflected in the returned value.      \note On platforms where there is no windowing system or cursors are not available, the returned     position is based on the mouse move events generated via QWindowSystemInterface.      \sa setPos(), QWidget::mapFromGlobal(), QWidget::mapToGlobal(), QGuiApplication::primaryScreen() */
end_comment
begin_function
DECL|function|pos
name|QPoint
name|QCursor
operator|::
name|pos
parameter_list|()
block|{
return|return
name|QCursor
operator|::
name|pos
argument_list|(
name|QGuiApplication
operator|::
name|primaryScreen
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \fn void QCursor::setPos(QScreen *screen, int x, int y)      Moves the cursor (hot spot) of the \a screen to the global     screen position (\a x, \a y).      You can call QWidget::mapToGlobal() to translate widget     coordinates to global screen coordinates.      \note Calling this function results in changing the cursor position through the windowing     system. The windowing system will typically respond by sending mouse events to the application's     window. This means that the usage of this function should be avoided in unit tests and     everywhere where fake mouse events are being injected via QWindowSystemInterface because the     windowing system's mouse state (with regards to buttons for example) may not match the state in     the application-generated events.      \note On platforms where there is no windowing system or cursors are not available, this     function may do nothing.      \sa pos(), QWidget::mapFromGlobal(), QWidget::mapToGlobal() */
end_comment
begin_function
DECL|function|setPos
name|void
name|QCursor
operator|::
name|setPos
parameter_list|(
name|QScreen
modifier|*
name|screen
parameter_list|,
name|int
name|x
parameter_list|,
name|int
name|y
parameter_list|)
block|{
if|if
condition|(
name|screen
condition|)
block|{
if|if
condition|(
name|QPlatformCursor
modifier|*
name|cursor
init|=
name|screen
operator|->
name|handle
argument_list|()
operator|->
name|cursor
argument_list|()
condition|)
block|{
specifier|const
name|QPoint
name|devicePos
init|=
name|QHighDpi
operator|::
name|toNativePixels
argument_list|(
name|QPoint
argument_list|(
name|x
argument_list|,
name|y
argument_list|)
argument_list|,
name|screen
argument_list|)
decl_stmt|;
comment|// Need to check, since some X servers generate null mouse move
comment|// events, causing looping in applications which call setPos() on
comment|// every mouse move event.
if|if
condition|(
name|devicePos
operator|!=
name|cursor
operator|->
name|pos
argument_list|()
condition|)
name|cursor
operator|->
name|setPos
argument_list|(
name|devicePos
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function
begin_comment
comment|/*!     \fn void QCursor::setPos(int x, int y)      Moves the cursor (hot spot) of the primary screen     to the global screen position (\a x, \a y).      You can call QWidget::mapToGlobal() to translate widget     coordinates to global screen coordinates.      \sa pos(), QWidget::mapFromGlobal(), QWidget::mapToGlobal(), QGuiApplication::primaryScreen() */
end_comment
begin_function
DECL|function|setPos
name|void
name|QCursor
operator|::
name|setPos
parameter_list|(
name|int
name|x
parameter_list|,
name|int
name|y
parameter_list|)
block|{
name|QCursor
operator|::
name|setPos
argument_list|(
name|QGuiApplication
operator|::
name|primaryScreen
argument_list|()
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
expr_stmt|;
block|}
end_function
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_CURSOR
end_ifndef
begin_comment
comment|/*!     \fn void QCursor::setPos (const QPoint&p)      \overload      Moves the cursor (hot spot) to the global screen position at point     \a p. */
end_comment
begin_comment
comment|/*!     \fn void QCursor::setPos (QScreen *screen,const QPoint&p)      \overload      Moves the cursor (hot spot) to the global screen position of the     \a screen at point \a p. */
end_comment
begin_comment
comment|/*****************************************************************************   QCursor stream functions  *****************************************************************************/
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATASTREAM
end_ifndef
begin_comment
comment|/*!     \fn QDataStream&operator<<(QDataStream&stream, const QCursor&cursor)     \relates QCursor      Writes the \a cursor to the \a stream.      \sa {Serializing Qt Data Types} */
end_comment
begin_function
DECL|function|operator <<
name|QDataStream
modifier|&
name|operator
name|<<
parameter_list|(
name|QDataStream
modifier|&
name|s
parameter_list|,
specifier|const
name|QCursor
modifier|&
name|c
parameter_list|)
block|{
name|s
operator|<<
operator|(
name|qint16
operator|)
name|c
operator|.
name|shape
argument_list|()
expr_stmt|;
comment|// write shape id to stream
if|if
condition|(
name|c
operator|.
name|shape
argument_list|()
operator|==
name|Qt
operator|::
name|BitmapCursor
condition|)
block|{
comment|// bitmap cursor
name|bool
name|isPixmap
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|s
operator|.
name|version
argument_list|()
operator|>=
literal|7
condition|)
block|{
name|isPixmap
operator|=
operator|!
name|c
operator|.
name|pixmap
argument_list|()
operator|.
name|isNull
argument_list|()
expr_stmt|;
name|s
operator|<<
name|isPixmap
expr_stmt|;
block|}
if|if
condition|(
name|isPixmap
condition|)
name|s
operator|<<
name|c
operator|.
name|pixmap
argument_list|()
expr_stmt|;
else|else
name|s
operator|<<
operator|*
name|c
operator|.
name|bitmap
argument_list|()
operator|<<
operator|*
name|c
operator|.
name|mask
argument_list|()
expr_stmt|;
name|s
operator|<<
name|c
operator|.
name|hotSpot
argument_list|()
expr_stmt|;
block|}
return|return
name|s
return|;
block|}
end_function
begin_comment
comment|/*!     \fn QDataStream&operator>>(QDataStream&stream, QCursor&cursor)     \relates QCursor      Reads the \a cursor from the \a stream.      \sa {Serializing Qt Data Types} */
end_comment
begin_function
DECL|function|operator >>
name|QDataStream
modifier|&
name|operator
name|>>
parameter_list|(
name|QDataStream
modifier|&
name|s
parameter_list|,
name|QCursor
modifier|&
name|c
parameter_list|)
block|{
name|qint16
name|shape
decl_stmt|;
name|s
operator|>>
name|shape
expr_stmt|;
comment|// read shape id from stream
if|if
condition|(
name|shape
operator|==
name|Qt
operator|::
name|BitmapCursor
condition|)
block|{
comment|// read bitmap cursor
name|bool
name|isPixmap
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|s
operator|.
name|version
argument_list|()
operator|>=
literal|7
condition|)
name|s
operator|>>
name|isPixmap
expr_stmt|;
if|if
condition|(
name|isPixmap
condition|)
block|{
name|QPixmap
name|pm
decl_stmt|;
name|QPoint
name|hot
decl_stmt|;
name|s
operator|>>
name|pm
operator|>>
name|hot
expr_stmt|;
name|c
operator|=
name|QCursor
argument_list|(
name|pm
argument_list|,
name|hot
operator|.
name|x
argument_list|()
argument_list|,
name|hot
operator|.
name|y
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QBitmap
name|bm
decl_stmt|,
name|bmm
decl_stmt|;
name|QPoint
name|hot
decl_stmt|;
name|s
operator|>>
name|bm
operator|>>
name|bmm
operator|>>
name|hot
expr_stmt|;
name|c
operator|=
name|QCursor
argument_list|(
name|bm
argument_list|,
name|bmm
argument_list|,
name|hot
operator|.
name|x
argument_list|()
argument_list|,
name|hot
operator|.
name|y
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|c
operator|.
name|setShape
argument_list|(
operator|(
name|Qt
operator|::
name|CursorShape
operator|)
name|shape
argument_list|)
expr_stmt|;
comment|// create cursor with shape
block|}
return|return
name|s
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// QT_NO_DATASTREAM
end_comment
begin_comment
comment|/*!     Constructs a custom pixmap cursor.      \a pixmap is the image. It is usual to give it a mask (set using     QPixmap::setMask()). \a hotX and \a hotY define the cursor's hot     spot.      If \a hotX is negative, it is set to the \c{pixmap().width()/2}.     If \a hotY is negative, it is set to the \c{pixmap().height()/2}.      Valid cursor sizes depend on the display hardware (or the     underlying window system). We recommend using 32 x 32 cursors,     because this size is supported on all platforms. Some platforms     also support 16 x 16, 48 x 48, and 64 x 64 cursors.      \note On Windows CE, the cursor size is fixed. If the pixmap     is bigger than the system size, it will be scaled.      \sa QPixmap::QPixmap(), QPixmap::setMask() */
end_comment
begin_constructor
DECL|function|QCursor
name|QCursor
operator|::
name|QCursor
parameter_list|(
specifier|const
name|QPixmap
modifier|&
name|pixmap
parameter_list|,
name|int
name|hotX
parameter_list|,
name|int
name|hotY
parameter_list|)
member_init_list|:
name|d
argument_list|(
literal|0
argument_list|)
block|{
name|QImage
name|img
init|=
name|pixmap
operator|.
name|toImage
argument_list|()
operator|.
name|convertToFormat
argument_list|(
name|QImage
operator|::
name|Format_Indexed8
argument_list|,
name|Qt
operator|::
name|ThresholdDither
operator||
name|Qt
operator|::
name|AvoidDither
argument_list|)
decl_stmt|;
name|QBitmap
name|bm
init|=
name|QBitmap
operator|::
name|fromImage
argument_list|(
name|img
argument_list|,
name|Qt
operator|::
name|ThresholdDither
operator||
name|Qt
operator|::
name|AvoidDither
argument_list|)
decl_stmt|;
name|QBitmap
name|bmm
init|=
name|pixmap
operator|.
name|mask
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|bmm
operator|.
name|isNull
argument_list|()
condition|)
block|{
name|QBitmap
name|nullBm
decl_stmt|;
name|bm
operator|.
name|setMask
argument_list|(
name|nullBm
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|pixmap
operator|.
name|mask
argument_list|()
operator|.
name|isNull
argument_list|()
condition|)
block|{
name|QImage
name|mimg
init|=
name|pixmap
operator|.
name|mask
argument_list|()
operator|.
name|toImage
argument_list|()
operator|.
name|convertToFormat
argument_list|(
name|QImage
operator|::
name|Format_Indexed8
argument_list|,
name|Qt
operator|::
name|ThresholdDither
operator||
name|Qt
operator|::
name|AvoidDither
argument_list|)
decl_stmt|;
name|bmm
operator|=
name|QBitmap
operator|::
name|fromImage
argument_list|(
name|mimg
argument_list|,
name|Qt
operator|::
name|ThresholdDither
operator||
name|Qt
operator|::
name|AvoidDither
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|bmm
operator|=
name|QBitmap
argument_list|(
name|bm
operator|.
name|size
argument_list|()
argument_list|)
expr_stmt|;
name|bmm
operator|.
name|fill
argument_list|(
name|Qt
operator|::
name|color1
argument_list|)
expr_stmt|;
block|}
name|d
operator|=
name|QCursorData
operator|::
name|setBitmap
argument_list|(
name|bm
argument_list|,
name|bmm
argument_list|,
name|hotX
argument_list|,
name|hotY
argument_list|)
expr_stmt|;
name|d
operator|->
name|pixmap
operator|=
name|pixmap
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     Constructs a custom bitmap cursor.      \a bitmap and     \a mask make up the bitmap.     \a hotX and     \a hotY define the cursor's hot spot.      If \a hotX is negative, it is set to the \c{bitmap().width()/2}.     If \a hotY is negative, it is set to the \c{bitmap().height()/2}.      The cursor \a bitmap (B) and \a mask (M) bits are combined like this:     \list     \li B=1 and M=1 gives black.     \li B=0 and M=1 gives white.     \li B=0 and M=0 gives transparent.     \li B=1 and M=0 gives an XOR'd result under Windows, undefined     results on all other platforms.     \endlist      Use the global Qt color Qt::color0 to draw 0-pixels and Qt::color1 to     draw 1-pixels in the bitmaps.      Valid cursor sizes depend on the display hardware (or the     underlying window system). We recommend using 32 x 32 cursors,     because this size is supported on all platforms. Some platforms     also support 16 x 16, 48 x 48, and 64 x 64 cursors.      \note On Windows CE, the cursor size is fixed. If the pixmap     is bigger than the system size, it will be scaled.      \sa QBitmap::QBitmap(), QBitmap::setMask() */
end_comment
begin_constructor
DECL|function|QCursor
name|QCursor
operator|::
name|QCursor
parameter_list|(
specifier|const
name|QBitmap
modifier|&
name|bitmap
parameter_list|,
specifier|const
name|QBitmap
modifier|&
name|mask
parameter_list|,
name|int
name|hotX
parameter_list|,
name|int
name|hotY
parameter_list|)
member_init_list|:
name|d
argument_list|(
literal|0
argument_list|)
block|{
name|d
operator|=
name|QCursorData
operator|::
name|setBitmap
argument_list|(
name|bitmap
argument_list|,
name|mask
argument_list|,
name|hotX
argument_list|,
name|hotY
argument_list|)
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     Constructs a cursor with the default arrow shape. */
end_comment
begin_constructor
DECL|function|QCursor
name|QCursor
operator|::
name|QCursor
parameter_list|()
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
block|{
if|if
condition|(
name|QCoreApplication
operator|::
name|startingUp
argument_list|()
condition|)
block|{
name|d
operator|=
literal|0
expr_stmt|;
return|return;
block|}
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
block|}
name|QCursorData
modifier|*
name|c
init|=
name|qt_cursorTable
index|[
literal|0
index|]
decl_stmt|;
name|c
operator|->
name|ref
operator|.
name|ref
parameter_list|()
constructor_decl|;
name|d
operator|=
name|c
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     Constructs a cursor with the specified \a shape.      See \l Qt::CursorShape for a list of shapes.      \sa setShape() */
end_comment
begin_constructor
DECL|function|QCursor
name|QCursor
operator|::
name|QCursor
parameter_list|(
name|Qt
operator|::
name|CursorShape
name|shape
parameter_list|)
member_init_list|:
name|d
argument_list|(
literal|0
argument_list|)
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
name|setShape
argument_list|(
name|shape
argument_list|)
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     Returns the cursor shape identifier. The return value is one of     the \l Qt::CursorShape enum values (cast to an int).      \sa setShape() */
end_comment
begin_function
DECL|function|shape
name|Qt
operator|::
name|CursorShape
name|QCursor
operator|::
name|shape
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
return|return
name|d
operator|->
name|cshape
return|;
block|}
end_function
begin_comment
comment|/*!     Sets the cursor to the shape identified by \a shape.      See \l Qt::CursorShape for the list of cursor shapes.      \sa shape() */
end_comment
begin_function
DECL|function|setShape
name|void
name|QCursor
operator|::
name|setShape
parameter_list|(
name|Qt
operator|::
name|CursorShape
name|shape
parameter_list|)
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
name|QCursorData
modifier|*
name|c
init|=
name|uint
argument_list|(
name|shape
argument_list|)
operator|<=
name|Qt
operator|::
name|LastCursor
condition|?
name|qt_cursorTable
index|[
name|shape
index|]
else|:
literal|0
decl_stmt|;
if|if
condition|(
operator|!
name|c
condition|)
name|c
operator|=
name|qt_cursorTable
index|[
literal|0
index|]
expr_stmt|;
name|c
operator|->
name|ref
operator|.
name|ref
parameter_list|()
constructor_decl|;
if|if
condition|(
operator|!
name|d
condition|)
block|{
name|d
operator|=
name|c
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|!
name|d
operator|->
name|ref
operator|.
name|deref
argument_list|()
condition|)
operator|delete
name|d
expr_stmt|;
name|d
operator|=
name|c
expr_stmt|;
block|}
block|}
end_function
begin_comment
comment|/*!     Returns the cursor bitmap, or 0 if it is one of the standard     cursors. */
end_comment
begin_function
DECL|function|bitmap
specifier|const
name|QBitmap
modifier|*
name|QCursor
operator|::
name|bitmap
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
return|return
name|d
operator|->
name|bm
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the cursor bitmap mask, or 0 if it is one of the standard     cursors. */
end_comment
begin_function
DECL|function|mask
specifier|const
name|QBitmap
modifier|*
name|QCursor
operator|::
name|mask
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
return|return
name|d
operator|->
name|bmm
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the cursor pixmap. This is only valid if the cursor is a     pixmap cursor. */
end_comment
begin_function
DECL|function|pixmap
name|QPixmap
name|QCursor
operator|::
name|pixmap
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
return|return
name|d
operator|->
name|pixmap
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the cursor hot spot, or (0, 0) if it is one of the     standard cursors. */
end_comment
begin_function
DECL|function|hotSpot
name|QPoint
name|QCursor
operator|::
name|hotSpot
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
return|return
name|QPoint
argument_list|(
name|d
operator|->
name|hx
argument_list|,
name|d
operator|->
name|hy
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Constructs a copy of the cursor \a c. */
end_comment
begin_constructor
DECL|function|QCursor
name|QCursor
operator|::
name|QCursor
parameter_list|(
specifier|const
name|QCursor
modifier|&
name|c
parameter_list|)
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
name|d
operator|=
name|c
operator|.
name|d
expr_stmt|;
name|d
operator|->
name|ref
operator|.
name|ref
parameter_list|()
constructor_decl|;
block|}
end_constructor
begin_comment
comment|/*!     Destroys the cursor. */
end_comment
begin_destructor
DECL|function|~QCursor
name|QCursor
operator|::
name|~
name|QCursor
parameter_list|()
block|{
if|if
condition|(
name|d
operator|&&
operator|!
name|d
operator|->
name|ref
operator|.
name|deref
argument_list|()
condition|)
operator|delete
name|d
expr_stmt|;
block|}
end_destructor
begin_comment
comment|/*!     Assigns \a c to this cursor and returns a reference to this     cursor. */
end_comment
begin_function
DECL|function|operator =
name|QCursor
modifier|&
name|QCursor
operator|::
name|operator
name|=
parameter_list|(
specifier|const
name|QCursor
modifier|&
name|c
parameter_list|)
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
if|if
condition|(
name|c
operator|.
name|d
condition|)
name|c
operator|.
name|d
operator|->
name|ref
operator|.
name|ref
parameter_list|()
constructor_decl|;
if|if
condition|(
name|d
operator|&&
operator|!
name|d
operator|->
name|ref
operator|.
name|deref
argument_list|()
condition|)
operator|delete
name|d
expr_stmt|;
name|d
operator|=
name|c
operator|.
name|d
expr_stmt|;
return|return
operator|*
name|this
return|;
block|}
end_function
begin_comment
comment|/*!    Returns the cursor as a QVariant. */
end_comment
begin_function
DECL|function|operator QVariant
name|QCursor
operator|::
name|operator
name|QVariant
parameter_list|()
specifier|const
block|{
return|return
name|QVariant
argument_list|(
name|QVariant
operator|::
name|Cursor
argument_list|,
name|this
argument_list|)
return|;
block|}
end_function
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DEBUG_STREAM
end_ifndef
begin_function
DECL|function|operator <<
name|QDebug
name|operator
name|<<
parameter_list|(
name|QDebug
name|dbg
parameter_list|,
specifier|const
name|QCursor
modifier|&
name|c
parameter_list|)
block|{
name|QDebugStateSaver
name|saver
argument_list|(
name|dbg
argument_list|)
decl_stmt|;
name|dbg
operator|.
name|nospace
argument_list|()
operator|<<
literal|"QCursor(Qt::CursorShape("
operator|<<
name|c
operator|.
name|shape
argument_list|()
operator|<<
literal|"))"
expr_stmt|;
return|return
name|dbg
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*****************************************************************************   Internal QCursorData class  *****************************************************************************/
end_comment
begin_decl_stmt
DECL|variable|qt_cursorTable
name|QCursorData
modifier|*
name|qt_cursorTable
index|[
name|Qt
operator|::
name|LastCursor
operator|+
literal|1
index|]
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|member|initialized
name|bool
name|QCursorData
operator|::
name|initialized
init|=
literal|false
decl_stmt|;
end_decl_stmt
begin_constructor
DECL|function|QCursorData
name|QCursorData
operator|::
name|QCursorData
parameter_list|(
name|Qt
operator|::
name|CursorShape
name|s
parameter_list|)
member_init_list|:
name|ref
argument_list|(
literal|1
argument_list|)
member_init_list|,
name|cshape
argument_list|(
name|s
argument_list|)
member_init_list|,
name|bm
argument_list|(
literal|0
argument_list|)
member_init_list|,
name|bmm
argument_list|(
literal|0
argument_list|)
member_init_list|,
name|hx
argument_list|(
literal|0
argument_list|)
member_init_list|,
name|hy
argument_list|(
literal|0
argument_list|)
block|{ }
end_constructor
begin_destructor
DECL|function|~QCursorData
name|QCursorData
operator|::
name|~
name|QCursorData
parameter_list|()
block|{
operator|delete
name|bm
expr_stmt|;
operator|delete
name|bmm
expr_stmt|;
block|}
end_destructor
begin_comment
comment|/*! \internal */
end_comment
begin_function
DECL|function|cleanup
name|void
name|QCursorData
operator|::
name|cleanup
parameter_list|()
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
return|return;
for|for
control|(
name|int
name|shape
init|=
literal|0
init|;
name|shape
operator|<=
name|Qt
operator|::
name|LastCursor
condition|;
operator|++
name|shape
control|)
block|{
comment|// In case someone has a static QCursor defined with this shape
if|if
condition|(
operator|!
name|qt_cursorTable
index|[
name|shape
index|]
operator|->
name|ref
operator|.
name|deref
argument_list|()
condition|)
operator|delete
name|qt_cursorTable
index|[
name|shape
index|]
expr_stmt|;
name|qt_cursorTable
index|[
name|shape
index|]
operator|=
literal|0
expr_stmt|;
block|}
name|QCursorData
operator|::
name|initialized
operator|=
literal|false
expr_stmt|;
block|}
end_function
begin_comment
comment|/*! \internal */
end_comment
begin_function
DECL|function|initialize
name|void
name|QCursorData
operator|::
name|initialize
parameter_list|()
block|{
if|if
condition|(
name|QCursorData
operator|::
name|initialized
condition|)
return|return;
for|for
control|(
name|int
name|shape
init|=
literal|0
init|;
name|shape
operator|<=
name|Qt
operator|::
name|LastCursor
condition|;
operator|++
name|shape
control|)
name|qt_cursorTable
index|[
name|shape
index|]
operator|=
operator|new
name|QCursorData
argument_list|(
operator|(
name|Qt
operator|::
name|CursorShape
operator|)
name|shape
argument_list|)
expr_stmt|;
name|QCursorData
operator|::
name|initialized
operator|=
literal|true
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setBitmap
name|QCursorData
modifier|*
name|QCursorData
operator|::
name|setBitmap
parameter_list|(
specifier|const
name|QBitmap
modifier|&
name|bitmap
parameter_list|,
specifier|const
name|QBitmap
modifier|&
name|mask
parameter_list|,
name|int
name|hotX
parameter_list|,
name|int
name|hotY
parameter_list|)
block|{
if|if
condition|(
operator|!
name|QCursorData
operator|::
name|initialized
condition|)
name|QCursorData
operator|::
name|initialize
argument_list|()
expr_stmt|;
if|if
condition|(
name|bitmap
operator|.
name|depth
argument_list|()
operator|!=
literal|1
operator|||
name|mask
operator|.
name|depth
argument_list|()
operator|!=
literal|1
operator|||
name|bitmap
operator|.
name|size
argument_list|()
operator|!=
name|mask
operator|.
name|size
argument_list|()
condition|)
block|{
name|qWarning
argument_list|(
literal|"QCursor: Cannot create bitmap cursor; invalid bitmap(s)"
argument_list|)
expr_stmt|;
name|QCursorData
modifier|*
name|c
init|=
name|qt_cursorTable
index|[
literal|0
index|]
decl_stmt|;
name|c
operator|->
name|ref
operator|.
name|ref
parameter_list|()
constructor_decl|;
return|return
name|c
return|;
block|}
name|QCursorData
modifier|*
name|d
init|=
operator|new
name|QCursorData
decl_stmt|;
name|d
operator|->
name|bm
operator|=
operator|new
name|QBitmap
argument_list|(
name|bitmap
argument_list|)
expr_stmt|;
name|d
operator|->
name|bmm
operator|=
operator|new
name|QBitmap
argument_list|(
name|mask
argument_list|)
expr_stmt|;
name|d
operator|->
name|cshape
operator|=
name|Qt
operator|::
name|BitmapCursor
expr_stmt|;
name|d
operator|->
name|hx
operator|=
name|hotX
operator|>=
literal|0
condition|?
name|hotX
else|:
name|bitmap
operator|.
name|width
argument_list|()
operator|/
literal|2
expr_stmt|;
name|d
operator|->
name|hy
operator|=
name|hotY
operator|>=
literal|0
condition|?
name|hotY
else|:
name|bitmap
operator|.
name|height
argument_list|()
operator|/
literal|2
expr_stmt|;
return|return
name|d
return|;
block|}
end_function
begin_function
DECL|function|update
name|void
name|QCursorData
operator|::
name|update
parameter_list|()
block|{ }
end_function
begin_macro
name|QT_END_NAMESPACE
end_macro
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// QT_NO_CURSOR
end_comment
end_unit
