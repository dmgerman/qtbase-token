begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2015 The Qt Company Ltd. ** Contact: http://www.qt.io/licensing/ ** ** This file is part of the QtCore module of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL21$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and The Qt Company. For licensing terms ** and conditions see http://www.qt.io/terms-conditions. For further ** information use the contact form at http://www.qt.io/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 or version 3 as published by the Free ** Software Foundation and appearing in the file LICENSE.LGPLv21 and ** LICENSE.LGPLv3 included in the packaging of this file. Please review the ** following information to ensure the GNU Lesser General Public License ** requirements will be met: https://www.gnu.org/licenses/lgpl.html and ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** As a special exception, The Qt Company gives you certain additional ** rights. These rights are described in The Qt Company LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QWS
argument_list|)
operator|&&
name|defined
argument_list|(
name|Q_OS_MAC
argument_list|)
end_if
begin_include
include|#
directive|include
file|"private/qcore_mac_p.h"
end_include
begin_include
include|#
directive|include
file|<CoreFoundation/CoreFoundation.h>
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"qglobal.h"
end_include
begin_include
include|#
directive|include
file|"qplatformdefs.h"
end_include
begin_include
include|#
directive|include
file|"qdatastream.h"
end_include
begin_include
include|#
directive|include
file|"qdebug.h"
end_include
begin_include
include|#
directive|include
file|"qhashfunctions.h"
end_include
begin_include
include|#
directive|include
file|"qstring.h"
end_include
begin_include
include|#
directive|include
file|"qlocale.h"
end_include
begin_include
include|#
directive|include
file|"qlocale_p.h"
end_include
begin_include
include|#
directive|include
file|"qlocale_tools_p.h"
end_include
begin_include
include|#
directive|include
file|"qdatetime_p.h"
end_include
begin_include
include|#
directive|include
file|"qdatetimeparser_p.h"
end_include
begin_include
include|#
directive|include
file|"qnamespace.h"
end_include
begin_include
include|#
directive|include
file|"qdatetime.h"
end_include
begin_include
include|#
directive|include
file|"qstringlist.h"
end_include
begin_include
include|#
directive|include
file|"qvariant.h"
end_include
begin_include
include|#
directive|include
file|"qstringbuilder.h"
end_include
begin_include
include|#
directive|include
file|"private/qnumeric_p.h"
end_include
begin_include
include|#
directive|include
file|"private/qsystemlibrary_p.h"
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|Q_OS_WIN
end_ifdef
begin_include
include|#
directive|include
file|<qt_windows.h>
end_include
begin_include
include|#
directive|include
file|<time.h>
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_decl_stmt
name|QT_BEGIN_NAMESPACE
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
DECL|variable|_systemLocale
specifier|static
name|QSystemLocale
modifier|*
name|_systemLocale
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_class
DECL|class|QSystemLocaleSingleton
class|class
name|QSystemLocaleSingleton
super|:
specifier|public
name|QSystemLocale
block|{
public|public:
DECL|function|QSystemLocaleSingleton
name|QSystemLocaleSingleton
parameter_list|()
member_init_list|:
name|QSystemLocale
argument_list|(
literal|true
argument_list|)
block|{}
block|}
class|;
end_class
begin_macro
name|Q_GLOBAL_STATIC
argument_list|(
argument|QSystemLocaleSingleton
argument_list|,
argument|QSystemLocale_globalSystemLocale
argument_list|)
end_macro
begin_decl_stmt
DECL|variable|system_data
specifier|static
name|QLocaleData
modifier|*
name|system_data
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_macro
name|Q_GLOBAL_STATIC
argument_list|(
argument|QLocaleData
argument_list|,
argument|globalLocaleData
argument_list|)
end_macro
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/****************************************************************************** ** Helpers for accessing Qt locale database */
end_comment
begin_function
name|QT_BEGIN_INCLUDE_NAMESPACE
include|#
directive|include
file|"qlocale_data_p.h"
name|QT_END_INCLUDE_NAMESPACE
DECL|function|codeToLanguage
name|QLocale
operator|::
name|Language
name|QLocalePrivate
operator|::
name|codeToLanguage
parameter_list|(
specifier|const
name|QString
modifier|&
name|code
parameter_list|)
block|{
name|int
name|len
init|=
name|code
operator|.
name|length
argument_list|()
decl_stmt|;
if|if
condition|(
name|len
operator|!=
literal|2
operator|&&
name|len
operator|!=
literal|3
condition|)
return|return
name|QLocale
operator|::
name|C
return|;
name|ushort
name|uc1
init|=
name|code
index|[
literal|0
index|]
operator|.
name|toLower
argument_list|()
operator|.
name|unicode
argument_list|()
decl_stmt|;
name|ushort
name|uc2
init|=
name|code
index|[
literal|1
index|]
operator|.
name|toLower
argument_list|()
operator|.
name|unicode
argument_list|()
decl_stmt|;
name|ushort
name|uc3
init|=
name|len
operator|>
literal|2
condition|?
name|code
index|[
literal|2
index|]
operator|.
name|toLower
argument_list|()
operator|.
name|unicode
argument_list|()
else|:
literal|0
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|c
init|=
name|language_code_list
decl_stmt|;
for|for
control|(
init|;
operator|*
name|c
operator|!=
literal|0
condition|;
name|c
operator|+=
literal|3
control|)
block|{
if|if
condition|(
name|uc1
operator|==
name|c
index|[
literal|0
index|]
operator|&&
name|uc2
operator|==
name|c
index|[
literal|1
index|]
operator|&&
name|uc3
operator|==
name|c
index|[
literal|2
index|]
condition|)
return|return
name|QLocale
operator|::
name|Language
argument_list|(
operator|(
name|c
operator|-
name|language_code_list
operator|)
operator|/
literal|3
argument_list|)
return|;
block|}
comment|// legacy codes
if|if
condition|(
name|uc1
operator|==
literal|'n'
operator|&&
name|uc2
operator|==
literal|'o'
operator|&&
name|uc3
operator|==
literal|0
condition|)
block|{
comment|// no -> nb
name|Q_STATIC_ASSERT
argument_list|(
name|QLocale
operator|::
name|Norwegian
operator|==
name|QLocale
operator|::
name|NorwegianBokmal
argument_list|)
expr_stmt|;
return|return
name|QLocale
operator|::
name|Norwegian
return|;
block|}
if|if
condition|(
name|uc1
operator|==
literal|'t'
operator|&&
name|uc2
operator|==
literal|'l'
operator|&&
name|uc3
operator|==
literal|0
condition|)
block|{
comment|// tl -> fil
name|Q_STATIC_ASSERT
argument_list|(
name|QLocale
operator|::
name|Tagalog
operator|==
name|QLocale
operator|::
name|Filipino
argument_list|)
expr_stmt|;
return|return
name|QLocale
operator|::
name|Tagalog
return|;
block|}
if|if
condition|(
name|uc1
operator|==
literal|'s'
operator|&&
name|uc2
operator|==
literal|'h'
operator|&&
name|uc3
operator|==
literal|0
condition|)
block|{
comment|// sh -> sr[_Latn]
name|Q_STATIC_ASSERT
argument_list|(
name|QLocale
operator|::
name|SerboCroatian
operator|==
name|QLocale
operator|::
name|Serbian
argument_list|)
expr_stmt|;
return|return
name|QLocale
operator|::
name|SerboCroatian
return|;
block|}
if|if
condition|(
name|uc1
operator|==
literal|'m'
operator|&&
name|uc2
operator|==
literal|'o'
operator|&&
name|uc3
operator|==
literal|0
condition|)
block|{
comment|// mo -> ro
name|Q_STATIC_ASSERT
argument_list|(
name|QLocale
operator|::
name|Moldavian
operator|==
name|QLocale
operator|::
name|Romanian
argument_list|)
expr_stmt|;
return|return
name|QLocale
operator|::
name|Moldavian
return|;
block|}
return|return
name|QLocale
operator|::
name|C
return|;
block|}
end_function
begin_function
DECL|function|codeToScript
name|QLocale
operator|::
name|Script
name|QLocalePrivate
operator|::
name|codeToScript
parameter_list|(
specifier|const
name|QString
modifier|&
name|code
parameter_list|)
block|{
name|int
name|len
init|=
name|code
operator|.
name|length
argument_list|()
decl_stmt|;
if|if
condition|(
name|len
operator|!=
literal|4
condition|)
return|return
name|QLocale
operator|::
name|AnyScript
return|;
comment|// script is titlecased in our data
name|unsigned
name|char
name|c0
init|=
name|code
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|toUpper
argument_list|()
operator|.
name|toLatin1
argument_list|()
decl_stmt|;
name|unsigned
name|char
name|c1
init|=
name|code
operator|.
name|at
argument_list|(
literal|1
argument_list|)
operator|.
name|toLower
argument_list|()
operator|.
name|toLatin1
argument_list|()
decl_stmt|;
name|unsigned
name|char
name|c2
init|=
name|code
operator|.
name|at
argument_list|(
literal|2
argument_list|)
operator|.
name|toLower
argument_list|()
operator|.
name|toLatin1
argument_list|()
decl_stmt|;
name|unsigned
name|char
name|c3
init|=
name|code
operator|.
name|at
argument_list|(
literal|3
argument_list|)
operator|.
name|toLower
argument_list|()
operator|.
name|toLatin1
argument_list|()
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|c
init|=
name|script_code_list
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|QLocale
operator|::
name|LastScript
condition|;
operator|++
name|i
operator|,
name|c
operator|+=
literal|4
control|)
block|{
if|if
condition|(
name|c0
operator|==
name|c
index|[
literal|0
index|]
operator|&&
name|c1
operator|==
name|c
index|[
literal|1
index|]
operator|&&
name|c2
operator|==
name|c
index|[
literal|2
index|]
operator|&&
name|c3
operator|==
name|c
index|[
literal|3
index|]
condition|)
return|return
name|QLocale
operator|::
name|Script
argument_list|(
name|i
argument_list|)
return|;
block|}
return|return
name|QLocale
operator|::
name|AnyScript
return|;
block|}
end_function
begin_function
DECL|function|codeToCountry
name|QLocale
operator|::
name|Country
name|QLocalePrivate
operator|::
name|codeToCountry
parameter_list|(
specifier|const
name|QString
modifier|&
name|code
parameter_list|)
block|{
name|int
name|len
init|=
name|code
operator|.
name|length
argument_list|()
decl_stmt|;
if|if
condition|(
name|len
operator|!=
literal|2
operator|&&
name|len
operator|!=
literal|3
condition|)
return|return
name|QLocale
operator|::
name|AnyCountry
return|;
name|ushort
name|uc1
init|=
name|code
index|[
literal|0
index|]
operator|.
name|toUpper
argument_list|()
operator|.
name|unicode
argument_list|()
decl_stmt|;
name|ushort
name|uc2
init|=
name|code
index|[
literal|1
index|]
operator|.
name|toUpper
argument_list|()
operator|.
name|unicode
argument_list|()
decl_stmt|;
name|ushort
name|uc3
init|=
name|len
operator|>
literal|2
condition|?
name|code
index|[
literal|2
index|]
operator|.
name|toUpper
argument_list|()
operator|.
name|unicode
argument_list|()
else|:
literal|0
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|c
init|=
name|country_code_list
decl_stmt|;
for|for
control|(
init|;
operator|*
name|c
operator|!=
literal|0
condition|;
name|c
operator|+=
literal|3
control|)
block|{
if|if
condition|(
name|uc1
operator|==
name|c
index|[
literal|0
index|]
operator|&&
name|uc2
operator|==
name|c
index|[
literal|1
index|]
operator|&&
name|uc3
operator|==
name|c
index|[
literal|2
index|]
condition|)
return|return
name|QLocale
operator|::
name|Country
argument_list|(
operator|(
name|c
operator|-
name|country_code_list
operator|)
operator|/
literal|3
argument_list|)
return|;
block|}
return|return
name|QLocale
operator|::
name|AnyCountry
return|;
block|}
end_function
begin_function
DECL|function|languageToCode
name|QString
name|QLocalePrivate
operator|::
name|languageToCode
parameter_list|(
name|QLocale
operator|::
name|Language
name|language
parameter_list|)
block|{
if|if
condition|(
name|language
operator|==
name|QLocale
operator|::
name|AnyLanguage
condition|)
return|return
name|QString
argument_list|()
return|;
if|if
condition|(
name|language
operator|==
name|QLocale
operator|::
name|C
condition|)
return|return
name|QLatin1String
argument_list|(
literal|"C"
argument_list|)
return|;
specifier|const
name|unsigned
name|char
modifier|*
name|c
init|=
name|language_code_list
operator|+
literal|3
operator|*
operator|(
name|uint
argument_list|(
name|language
argument_list|)
operator|)
decl_stmt|;
name|QString
name|code
argument_list|(
name|c
index|[
literal|2
index|]
operator|==
literal|0
condition|?
literal|2
else|:
literal|3
argument_list|,
name|Qt
operator|::
name|Uninitialized
argument_list|)
decl_stmt|;
name|code
index|[
literal|0
index|]
operator|=
name|ushort
argument_list|(
name|c
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|code
index|[
literal|1
index|]
operator|=
name|ushort
argument_list|(
name|c
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|c
index|[
literal|2
index|]
operator|!=
literal|0
condition|)
name|code
index|[
literal|2
index|]
operator|=
name|ushort
argument_list|(
name|c
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
return|return
name|code
return|;
block|}
end_function
begin_function
DECL|function|scriptToCode
name|QString
name|QLocalePrivate
operator|::
name|scriptToCode
parameter_list|(
name|QLocale
operator|::
name|Script
name|script
parameter_list|)
block|{
if|if
condition|(
name|script
operator|==
name|QLocale
operator|::
name|AnyScript
operator|||
name|script
operator|>
name|QLocale
operator|::
name|LastScript
condition|)
return|return
name|QString
argument_list|()
return|;
specifier|const
name|unsigned
name|char
modifier|*
name|c
init|=
name|script_code_list
operator|+
literal|4
operator|*
operator|(
name|uint
argument_list|(
name|script
argument_list|)
operator|)
decl_stmt|;
return|return
name|QString
operator|::
name|fromLatin1
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|)
name|c
argument_list|,
literal|4
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|countryToCode
name|QString
name|QLocalePrivate
operator|::
name|countryToCode
parameter_list|(
name|QLocale
operator|::
name|Country
name|country
parameter_list|)
block|{
if|if
condition|(
name|country
operator|==
name|QLocale
operator|::
name|AnyCountry
condition|)
return|return
name|QString
argument_list|()
return|;
specifier|const
name|unsigned
name|char
modifier|*
name|c
init|=
name|country_code_list
operator|+
literal|3
operator|*
operator|(
name|uint
argument_list|(
name|country
argument_list|)
operator|)
decl_stmt|;
name|QString
name|code
argument_list|(
name|c
index|[
literal|2
index|]
operator|==
literal|0
condition|?
literal|2
else|:
literal|3
argument_list|,
name|Qt
operator|::
name|Uninitialized
argument_list|)
decl_stmt|;
name|code
index|[
literal|0
index|]
operator|=
name|ushort
argument_list|(
name|c
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|code
index|[
literal|1
index|]
operator|=
name|ushort
argument_list|(
name|c
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|c
index|[
literal|2
index|]
operator|!=
literal|0
condition|)
name|code
index|[
literal|2
index|]
operator|=
name|ushort
argument_list|(
name|c
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
return|return
name|code
return|;
block|}
end_function
begin_comment
comment|// http://www.unicode.org/reports/tr35/#Likely_Subtags
end_comment
begin_function
DECL|function|addLikelySubtags
specifier|static
name|bool
name|addLikelySubtags
parameter_list|(
name|QLocaleId
modifier|&
name|localeId
parameter_list|)
block|{
comment|// ### optimize with bsearch
specifier|const
name|int
name|likely_subtags_count
init|=
sizeof|sizeof
argument_list|(
name|likely_subtags
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|likely_subtags
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
specifier|const
name|QLocaleId
modifier|*
name|p
init|=
name|likely_subtags
decl_stmt|;
specifier|const
name|QLocaleId
modifier|*
specifier|const
name|e
init|=
name|p
operator|+
name|likely_subtags_count
decl_stmt|;
for|for
control|(
init|;
name|p
operator|<
name|e
condition|;
name|p
operator|+=
literal|2
control|)
block|{
if|if
condition|(
name|localeId
operator|==
name|p
index|[
literal|0
index|]
condition|)
block|{
name|localeId
operator|=
name|p
index|[
literal|1
index|]
expr_stmt|;
return|return
literal|true
return|;
block|}
block|}
return|return
literal|false
return|;
block|}
end_function
begin_function
DECL|function|withLikelySubtagsAdded
name|QLocaleId
name|QLocaleId
operator|::
name|withLikelySubtagsAdded
parameter_list|()
specifier|const
block|{
comment|// language_script_region
if|if
condition|(
name|language_id
operator|||
name|script_id
operator|||
name|country_id
condition|)
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
name|script_id
argument_list|,
name|country_id
argument_list|)
decl_stmt|;
if|if
condition|(
name|addLikelySubtags
argument_list|(
name|id
argument_list|)
condition|)
return|return
name|id
return|;
block|}
comment|// language_script
if|if
condition|(
name|country_id
condition|)
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
name|script_id
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|addLikelySubtags
argument_list|(
name|id
argument_list|)
condition|)
block|{
name|id
operator|.
name|country_id
operator|=
name|country_id
expr_stmt|;
return|return
name|id
return|;
block|}
block|}
comment|// language_region
if|if
condition|(
name|script_id
condition|)
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
literal|0
argument_list|,
name|country_id
argument_list|)
decl_stmt|;
if|if
condition|(
name|addLikelySubtags
argument_list|(
name|id
argument_list|)
condition|)
block|{
name|id
operator|.
name|script_id
operator|=
name|script_id
expr_stmt|;
return|return
name|id
return|;
block|}
block|}
comment|// language
if|if
condition|(
name|script_id
operator|&&
name|country_id
condition|)
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|addLikelySubtags
argument_list|(
name|id
argument_list|)
condition|)
block|{
name|id
operator|.
name|script_id
operator|=
name|script_id
expr_stmt|;
name|id
operator|.
name|country_id
operator|=
name|country_id
expr_stmt|;
return|return
name|id
return|;
block|}
block|}
return|return
operator|*
name|this
return|;
block|}
end_function
begin_function
DECL|function|withLikelySubtagsRemoved
name|QLocaleId
name|QLocaleId
operator|::
name|withLikelySubtagsRemoved
parameter_list|()
specifier|const
block|{
name|QLocaleId
name|max
init|=
name|withLikelySubtagsAdded
argument_list|()
decl_stmt|;
comment|// language
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|.
name|withLikelySubtagsAdded
argument_list|()
operator|==
name|max
condition|)
return|return
name|id
return|;
block|}
comment|// language_region
if|if
condition|(
name|country_id
condition|)
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
literal|0
argument_list|,
name|country_id
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|.
name|withLikelySubtagsAdded
argument_list|()
operator|==
name|max
condition|)
return|return
name|id
return|;
block|}
comment|// language_script
if|if
condition|(
name|script_id
condition|)
block|{
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language_id
argument_list|,
name|script_id
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|.
name|withLikelySubtagsAdded
argument_list|()
operator|==
name|max
condition|)
return|return
name|id
return|;
block|}
return|return
name|max
return|;
block|}
end_function
begin_function
DECL|function|name
name|QByteArray
name|QLocaleId
operator|::
name|name
parameter_list|(
name|char
name|separator
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|language_id
operator|==
name|QLocale
operator|::
name|AnyLanguage
condition|)
return|return
name|QByteArray
argument_list|()
return|;
if|if
condition|(
name|language_id
operator|==
name|QLocale
operator|::
name|C
condition|)
return|return
name|QByteArrayLiteral
argument_list|(
literal|"C"
argument_list|)
return|;
specifier|const
name|unsigned
name|char
modifier|*
name|lang
init|=
name|language_code_list
operator|+
literal|3
operator|*
name|language_id
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|script
init|=
operator|(
name|script_id
operator|!=
name|QLocale
operator|::
name|AnyScript
condition|?
name|script_code_list
operator|+
literal|4
operator|*
name|script_id
else|:
literal|0
operator|)
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|country
init|=
operator|(
name|country_id
operator|!=
name|QLocale
operator|::
name|AnyCountry
condition|?
name|country_code_list
operator|+
literal|3
operator|*
name|country_id
else|:
literal|0
operator|)
decl_stmt|;
name|char
name|len
init|=
operator|(
name|lang
index|[
literal|2
index|]
operator|!=
literal|0
condition|?
literal|3
else|:
literal|2
operator|)
operator|+
operator|(
name|script
condition|?
literal|4
operator|+
literal|1
else|:
literal|0
operator|)
operator|+
operator|(
name|country
condition|?
operator|(
name|country
index|[
literal|2
index|]
operator|!=
literal|0
condition|?
literal|3
else|:
literal|2
operator|)
operator|+
literal|1
else|:
literal|0
operator|)
decl_stmt|;
name|QByteArray
name|name
argument_list|(
name|len
argument_list|,
name|Qt
operator|::
name|Uninitialized
argument_list|)
decl_stmt|;
name|char
modifier|*
name|uc
init|=
name|name
operator|.
name|data
argument_list|()
decl_stmt|;
operator|*
name|uc
operator|++
operator|=
name|lang
index|[
literal|0
index|]
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|lang
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|lang
index|[
literal|2
index|]
operator|!=
literal|0
condition|)
operator|*
name|uc
operator|++
operator|=
name|lang
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|script
condition|)
block|{
operator|*
name|uc
operator|++
operator|=
name|separator
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|script
index|[
literal|0
index|]
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|script
index|[
literal|1
index|]
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|script
index|[
literal|2
index|]
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|script
index|[
literal|3
index|]
expr_stmt|;
block|}
if|if
condition|(
name|country
condition|)
block|{
operator|*
name|uc
operator|++
operator|=
name|separator
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|country
index|[
literal|0
index|]
expr_stmt|;
operator|*
name|uc
operator|++
operator|=
name|country
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|country
index|[
literal|2
index|]
operator|!=
literal|0
condition|)
operator|*
name|uc
operator|++
operator|=
name|country
index|[
literal|2
index|]
expr_stmt|;
block|}
return|return
name|name
return|;
block|}
end_function
begin_function
DECL|function|bcp47Name
name|QByteArray
name|QLocalePrivate
operator|::
name|bcp47Name
parameter_list|(
name|char
name|separator
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|m_data
operator|->
name|m_language_id
operator|==
name|QLocale
operator|::
name|AnyLanguage
condition|)
return|return
name|QByteArray
argument_list|()
return|;
if|if
condition|(
name|m_data
operator|->
name|m_language_id
operator|==
name|QLocale
operator|::
name|C
condition|)
return|return
name|QByteArrayLiteral
argument_list|(
literal|"C"
argument_list|)
return|;
name|QLocaleId
name|localeId
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|m_data
operator|->
name|m_language_id
argument_list|,
name|m_data
operator|->
name|m_script_id
argument_list|,
name|m_data
operator|->
name|m_country_id
argument_list|)
decl_stmt|;
return|return
name|localeId
operator|.
name|withLikelySubtagsRemoved
argument_list|()
operator|.
name|name
argument_list|(
name|separator
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|findLocaleData
specifier|const
name|QLocaleData
modifier|*
name|QLocaleData
operator|::
name|findLocaleData
parameter_list|(
name|QLocale
operator|::
name|Language
name|language
parameter_list|,
name|QLocale
operator|::
name|Script
name|script
parameter_list|,
name|QLocale
operator|::
name|Country
name|country
parameter_list|)
block|{
name|QLocaleId
name|localeId
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|language
argument_list|,
name|script
argument_list|,
name|country
argument_list|)
decl_stmt|;
name|localeId
operator|=
name|localeId
operator|.
name|withLikelySubtagsAdded
argument_list|()
expr_stmt|;
name|uint
name|idx
init|=
name|locale_index
index|[
name|localeId
operator|.
name|language_id
index|]
decl_stmt|;
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|locale_data
operator|+
name|idx
decl_stmt|;
if|if
condition|(
name|idx
operator|==
literal|0
condition|)
comment|// default language has no associated country
return|return
name|data
return|;
name|Q_ASSERT
argument_list|(
name|data
operator|->
name|m_language_id
operator|==
name|localeId
operator|.
name|language_id
argument_list|)
expr_stmt|;
if|if
condition|(
name|localeId
operator|.
name|script_id
operator|!=
name|QLocale
operator|::
name|AnyScript
operator|&&
name|localeId
operator|.
name|country_id
operator|!=
name|QLocale
operator|::
name|AnyCountry
condition|)
block|{
comment|// both script and country are explicitly specified
do|do
block|{
if|if
condition|(
name|data
operator|->
name|m_script_id
operator|==
name|localeId
operator|.
name|script_id
operator|&&
name|data
operator|->
name|m_country_id
operator|==
name|localeId
operator|.
name|country_id
condition|)
return|return
name|data
return|;
operator|++
name|data
expr_stmt|;
block|}
do|while
condition|(
name|data
operator|->
name|m_language_id
operator|==
name|localeId
operator|.
name|language_id
condition|)
do|;
comment|// no match; try again with default script
name|localeId
operator|.
name|script_id
operator|=
name|QLocale
operator|::
name|AnyScript
expr_stmt|;
name|data
operator|=
name|locale_data
operator|+
name|idx
expr_stmt|;
block|}
if|if
condition|(
name|localeId
operator|.
name|script_id
operator|==
name|QLocale
operator|::
name|AnyScript
operator|&&
name|localeId
operator|.
name|country_id
operator|==
name|QLocale
operator|::
name|AnyCountry
condition|)
return|return
name|data
return|;
if|if
condition|(
name|localeId
operator|.
name|script_id
operator|==
name|QLocale
operator|::
name|AnyScript
condition|)
block|{
do|do
block|{
if|if
condition|(
name|data
operator|->
name|m_country_id
operator|==
name|localeId
operator|.
name|country_id
condition|)
return|return
name|data
return|;
operator|++
name|data
expr_stmt|;
block|}
do|while
condition|(
name|data
operator|->
name|m_language_id
operator|==
name|localeId
operator|.
name|language_id
condition|)
do|;
block|}
elseif|else
if|if
condition|(
name|localeId
operator|.
name|country_id
operator|==
name|QLocale
operator|::
name|AnyCountry
condition|)
block|{
do|do
block|{
if|if
condition|(
name|data
operator|->
name|m_script_id
operator|==
name|localeId
operator|.
name|script_id
condition|)
return|return
name|data
return|;
operator|++
name|data
expr_stmt|;
block|}
do|while
condition|(
name|data
operator|->
name|m_language_id
operator|==
name|localeId
operator|.
name|language_id
condition|)
do|;
block|}
return|return
name|locale_data
operator|+
name|idx
return|;
block|}
end_function
begin_function
DECL|function|parse_locale_tag
specifier|static
name|bool
name|parse_locale_tag
parameter_list|(
specifier|const
name|QString
modifier|&
name|input
parameter_list|,
name|int
modifier|&
name|i
parameter_list|,
name|QString
modifier|*
name|result
parameter_list|,
specifier|const
name|QString
modifier|&
name|separators
parameter_list|)
block|{
operator|*
name|result
operator|=
name|QString
argument_list|(
literal|8
argument_list|,
name|Qt
operator|::
name|Uninitialized
argument_list|)
expr_stmt|;
comment|// worst case according to BCP47
name|QChar
modifier|*
name|pch
init|=
name|result
operator|->
name|data
argument_list|()
decl_stmt|;
specifier|const
name|QChar
modifier|*
name|uc
init|=
name|input
operator|.
name|data
argument_list|()
operator|+
name|i
decl_stmt|;
specifier|const
name|int
name|l
init|=
name|input
operator|.
name|length
argument_list|()
decl_stmt|;
name|int
name|size
init|=
literal|0
decl_stmt|;
for|for
control|(
init|;
name|i
operator|<
name|l
operator|&&
name|size
operator|<
literal|8
condition|;
operator|++
name|i
operator|,
operator|++
name|size
control|)
block|{
if|if
condition|(
name|separators
operator|.
name|contains
argument_list|(
operator|*
name|uc
argument_list|)
condition|)
break|break;
if|if
condition|(
operator|!
operator|(
operator|(
name|uc
operator|->
name|unicode
argument_list|()
operator|>=
literal|'a'
operator|&&
name|uc
operator|->
name|unicode
argument_list|()
operator|<=
literal|'z'
operator|)
operator|||
operator|(
name|uc
operator|->
name|unicode
argument_list|()
operator|>=
literal|'A'
operator|&&
name|uc
operator|->
name|unicode
argument_list|()
operator|<=
literal|'Z'
operator|)
operator|||
operator|(
name|uc
operator|->
name|unicode
argument_list|()
operator|>=
literal|'0'
operator|&&
name|uc
operator|->
name|unicode
argument_list|()
operator|<=
literal|'9'
operator|)
operator|)
condition|)
comment|// latin only
return|return
literal|false
return|;
operator|*
name|pch
operator|++
operator|=
operator|*
name|uc
operator|++
expr_stmt|;
block|}
name|result
operator|->
name|truncate
argument_list|(
name|size
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|qt_splitLocaleName
name|bool
name|qt_splitLocaleName
parameter_list|(
specifier|const
name|QString
modifier|&
name|name
parameter_list|,
name|QString
modifier|&
name|lang
parameter_list|,
name|QString
modifier|&
name|script
parameter_list|,
name|QString
modifier|&
name|cntry
parameter_list|)
block|{
specifier|const
name|int
name|length
init|=
name|name
operator|.
name|length
argument_list|()
decl_stmt|;
name|lang
operator|=
name|script
operator|=
name|cntry
operator|=
name|QString
argument_list|()
expr_stmt|;
specifier|const
name|QString
name|separators
init|=
name|QStringLiteral
argument_list|(
literal|"_-.@"
argument_list|)
decl_stmt|;
enum|enum
name|ParserState
block|{
name|NoState
block|,
name|LangState
block|,
name|ScriptState
block|,
name|CountryState
block|}
enum|;
name|ParserState
name|state
init|=
name|LangState
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|length
operator|&&
name|state
operator|!=
name|NoState
condition|;
control|)
block|{
name|QString
name|value
decl_stmt|;
if|if
condition|(
operator|!
name|parse_locale_tag
argument_list|(
name|name
argument_list|,
name|i
argument_list|,
operator|&
name|value
argument_list|,
name|separators
argument_list|)
operator|||
name|value
operator|.
name|isEmpty
argument_list|()
condition|)
break|break;
name|QChar
name|sep
init|=
name|i
operator|<
name|length
condition|?
name|name
operator|.
name|at
argument_list|(
name|i
argument_list|)
else|:
name|QChar
argument_list|()
decl_stmt|;
switch|switch
condition|(
name|state
condition|)
block|{
case|case
name|LangState
case|:
if|if
condition|(
operator|!
name|sep
operator|.
name|isNull
argument_list|()
operator|&&
operator|!
name|separators
operator|.
name|contains
argument_list|(
name|sep
argument_list|)
condition|)
block|{
name|state
operator|=
name|NoState
expr_stmt|;
break|break;
block|}
name|lang
operator|=
name|value
expr_stmt|;
if|if
condition|(
name|i
operator|==
name|length
condition|)
block|{
comment|// just language was specified
name|state
operator|=
name|NoState
expr_stmt|;
break|break;
block|}
name|state
operator|=
name|ScriptState
expr_stmt|;
break|break;
case|case
name|ScriptState
case|:
block|{
name|QString
name|scripts
init|=
name|QString
operator|::
name|fromLatin1
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|)
name|script_code_list
argument_list|,
sizeof|sizeof
argument_list|(
name|script_code_list
argument_list|)
operator|-
literal|1
argument_list|)
decl_stmt|;
if|if
condition|(
name|value
operator|.
name|length
argument_list|()
operator|==
literal|4
operator|&&
name|scripts
operator|.
name|indexOf
argument_list|(
name|value
argument_list|)
operator|%
literal|4
operator|==
literal|0
condition|)
block|{
comment|// script name is always 4 characters
name|script
operator|=
name|value
expr_stmt|;
name|state
operator|=
name|CountryState
expr_stmt|;
block|}
else|else
block|{
comment|// it wasn't a script, maybe it is a country then?
name|cntry
operator|=
name|value
expr_stmt|;
name|state
operator|=
name|NoState
expr_stmt|;
block|}
break|break;
block|}
case|case
name|CountryState
case|:
name|cntry
operator|=
name|value
expr_stmt|;
name|state
operator|=
name|NoState
expr_stmt|;
break|break;
case|case
name|NoState
case|:
comment|// shouldn't happen
name|qWarning
argument_list|(
literal|"QLocale: This should never happen"
argument_list|)
expr_stmt|;
break|break;
block|}
operator|++
name|i
expr_stmt|;
block|}
return|return
name|lang
operator|.
name|length
argument_list|()
operator|==
literal|2
operator|||
name|lang
operator|.
name|length
argument_list|()
operator|==
literal|3
return|;
block|}
end_function
begin_function
DECL|function|getLangAndCountry
name|void
name|QLocalePrivate
operator|::
name|getLangAndCountry
parameter_list|(
specifier|const
name|QString
modifier|&
name|name
parameter_list|,
name|QLocale
operator|::
name|Language
modifier|&
name|lang
parameter_list|,
name|QLocale
operator|::
name|Script
modifier|&
name|script
parameter_list|,
name|QLocale
operator|::
name|Country
modifier|&
name|cntry
parameter_list|)
block|{
name|lang
operator|=
name|QLocale
operator|::
name|C
expr_stmt|;
name|script
operator|=
name|QLocale
operator|::
name|AnyScript
expr_stmt|;
name|cntry
operator|=
name|QLocale
operator|::
name|AnyCountry
expr_stmt|;
name|QString
name|lang_code
decl_stmt|;
name|QString
name|script_code
decl_stmt|;
name|QString
name|cntry_code
decl_stmt|;
if|if
condition|(
operator|!
name|qt_splitLocaleName
argument_list|(
name|name
argument_list|,
name|lang_code
argument_list|,
name|script_code
argument_list|,
name|cntry_code
argument_list|)
condition|)
return|return;
name|lang
operator|=
name|QLocalePrivate
operator|::
name|codeToLanguage
argument_list|(
name|lang_code
argument_list|)
expr_stmt|;
if|if
condition|(
name|lang
operator|==
name|QLocale
operator|::
name|C
condition|)
return|return;
name|script
operator|=
name|QLocalePrivate
operator|::
name|codeToScript
argument_list|(
name|script_code
argument_list|)
expr_stmt|;
name|cntry
operator|=
name|QLocalePrivate
operator|::
name|codeToCountry
argument_list|(
name|cntry_code
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|findLocaleData
specifier|static
specifier|const
name|QLocaleData
modifier|*
name|findLocaleData
parameter_list|(
specifier|const
name|QString
modifier|&
name|name
parameter_list|)
block|{
name|QLocale
operator|::
name|Language
name|lang
decl_stmt|;
name|QLocale
operator|::
name|Script
name|script
decl_stmt|;
name|QLocale
operator|::
name|Country
name|cntry
decl_stmt|;
name|QLocalePrivate
operator|::
name|getLangAndCountry
argument_list|(
name|name
argument_list|,
name|lang
argument_list|,
name|script
argument_list|,
name|cntry
argument_list|)
expr_stmt|;
return|return
name|QLocaleData
operator|::
name|findLocaleData
argument_list|(
name|lang
argument_list|,
name|script
argument_list|,
name|cntry
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|qt_readEscapedFormatString
name|QString
name|qt_readEscapedFormatString
parameter_list|(
specifier|const
name|QString
modifier|&
name|format
parameter_list|,
name|int
modifier|*
name|idx
parameter_list|)
block|{
name|int
modifier|&
name|i
init|=
operator|*
name|idx
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|==
name|QLatin1Char
argument_list|(
literal|'\''
argument_list|)
argument_list|)
expr_stmt|;
operator|++
name|i
expr_stmt|;
if|if
condition|(
name|i
operator|==
name|format
operator|.
name|size
argument_list|()
condition|)
return|return
name|QString
argument_list|()
return|;
if|if
condition|(
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'\''
condition|)
block|{
comment|// "''" outside of a quoted stirng
operator|++
name|i
expr_stmt|;
return|return
name|QLatin1String
argument_list|(
literal|"'"
argument_list|)
return|;
block|}
name|QString
name|result
decl_stmt|;
while|while
condition|(
name|i
operator|<
name|format
operator|.
name|size
argument_list|()
condition|)
block|{
if|if
condition|(
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'\''
condition|)
block|{
if|if
condition|(
name|i
operator|+
literal|1
operator|<
name|format
operator|.
name|size
argument_list|()
operator|&&
name|format
operator|.
name|at
argument_list|(
name|i
operator|+
literal|1
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'\''
condition|)
block|{
comment|// "''" inside of a quoted string
name|result
operator|.
name|append
argument_list|(
name|QLatin1Char
argument_list|(
literal|'\''
argument_list|)
argument_list|)
expr_stmt|;
name|i
operator|+=
literal|2
expr_stmt|;
block|}
else|else
block|{
break|break;
block|}
block|}
else|else
block|{
name|result
operator|.
name|append
argument_list|(
name|format
operator|.
name|at
argument_list|(
name|i
operator|++
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|i
operator|<
name|format
operator|.
name|size
argument_list|()
condition|)
operator|++
name|i
expr_stmt|;
return|return
name|result
return|;
block|}
end_function
begin_function
DECL|function|qt_repeatCount
name|int
name|qt_repeatCount
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|int
name|i
parameter_list|)
block|{
name|QChar
name|c
init|=
name|s
operator|.
name|at
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|int
name|j
init|=
name|i
operator|+
literal|1
decl_stmt|;
while|while
condition|(
name|j
operator|<
name|s
operator|.
name|size
argument_list|()
operator|&&
name|s
operator|.
name|at
argument_list|(
name|j
argument_list|)
operator|==
name|c
condition|)
operator|++
name|j
expr_stmt|;
return|return
name|j
operator|-
name|i
return|;
block|}
end_function
begin_decl_stmt
DECL|variable|default_data
specifier|static
specifier|const
name|QLocaleData
modifier|*
name|default_data
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|default_number_options
specifier|static
name|uint
name|default_number_options
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|c_data
specifier|static
specifier|const
name|QLocaleData
modifier|*
specifier|const
name|c_data
init|=
name|locale_data
decl_stmt|;
end_decl_stmt
begin_function
DECL|function|c_private
specifier|static
name|QLocalePrivate
modifier|*
name|c_private
parameter_list|()
block|{
specifier|static
name|QLocalePrivate
name|c_locale
init|=
block|{
name|c_data
block|,
name|Q_BASIC_ATOMIC_INITIALIZER
argument_list|(
literal|1
argument_list|)
block|,
name|QLocale
operator|::
name|OmitGroupSeparator
block|}
decl_stmt|;
return|return
operator|&
name|c_locale
return|;
block|}
end_function
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
end_ifndef
begin_comment
comment|/****************************************************************************** ** Default system locale behavior */
end_comment
begin_comment
comment|/*!   Constructs a QSystemLocale object. The constructor will automatically   install this object as the system locale and remove any earlier installed   system locales. */
end_comment
begin_constructor
DECL|function|QSystemLocale
name|QSystemLocale
operator|::
name|QSystemLocale
parameter_list|()
block|{
operator|delete
name|_systemLocale
expr_stmt|;
name|_systemLocale
operator|=
name|this
expr_stmt|;
if|if
condition|(
name|system_data
condition|)
name|system_data
operator|->
name|m_language_id
operator|=
literal|0
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     \internal */
end_comment
begin_constructor
DECL|function|QSystemLocale
name|QSystemLocale
operator|::
name|QSystemLocale
parameter_list|(
name|bool
parameter_list|)
block|{ }
end_constructor
begin_comment
comment|/*!   Deletes the object. */
end_comment
begin_destructor
DECL|function|~QSystemLocale
name|QSystemLocale
operator|::
name|~
name|QSystemLocale
parameter_list|()
block|{
if|if
condition|(
name|_systemLocale
operator|==
name|this
condition|)
block|{
name|_systemLocale
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|system_data
condition|)
name|system_data
operator|->
name|m_language_id
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_destructor
begin_function
DECL|function|systemLocale
specifier|static
specifier|const
name|QSystemLocale
modifier|*
name|systemLocale
parameter_list|()
block|{
if|if
condition|(
name|_systemLocale
condition|)
return|return
name|_systemLocale
return|;
return|return
name|QSystemLocale_globalSystemLocale
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|updateSystemPrivate
name|void
name|QLocalePrivate
operator|::
name|updateSystemPrivate
parameter_list|()
block|{
specifier|const
name|QSystemLocale
modifier|*
name|sys_locale
init|=
name|systemLocale
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|system_data
condition|)
name|system_data
operator|=
name|globalLocaleData
argument_list|()
expr_stmt|;
comment|// tell the object that the system locale has changed.
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|LocaleChanged
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
operator|*
name|system_data
operator|=
operator|*
name|sys_locale
operator|->
name|fallbackUiLocale
argument_list|()
operator|.
name|d
operator|->
name|m_data
expr_stmt|;
name|QVariant
name|res
init|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|LanguageId
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
block|{
name|system_data
operator|->
name|m_language_id
operator|=
name|res
operator|.
name|toInt
argument_list|()
expr_stmt|;
name|system_data
operator|->
name|m_script_id
operator|=
name|QLocale
operator|::
name|AnyScript
expr_stmt|;
comment|// default for compatibility
block|}
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|CountryId
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
block|{
name|system_data
operator|->
name|m_country_id
operator|=
name|res
operator|.
name|toInt
argument_list|()
expr_stmt|;
name|system_data
operator|->
name|m_script_id
operator|=
name|QLocale
operator|::
name|AnyScript
expr_stmt|;
comment|// default for compatibility
block|}
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|ScriptId
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
name|system_data
operator|->
name|m_script_id
operator|=
name|res
operator|.
name|toInt
argument_list|()
expr_stmt|;
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|DecimalPoint
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
name|system_data
operator|->
name|m_decimal
operator|=
name|res
operator|.
name|toString
argument_list|()
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|unicode
argument_list|()
expr_stmt|;
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|GroupSeparator
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
name|system_data
operator|->
name|m_group
operator|=
name|res
operator|.
name|toString
argument_list|()
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|unicode
argument_list|()
expr_stmt|;
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|ZeroDigit
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
name|system_data
operator|->
name|m_zero
operator|=
name|res
operator|.
name|toString
argument_list|()
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|unicode
argument_list|()
expr_stmt|;
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|NegativeSign
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
name|system_data
operator|->
name|m_minus
operator|=
name|res
operator|.
name|toString
argument_list|()
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|unicode
argument_list|()
expr_stmt|;
name|res
operator|=
name|sys_locale
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|PositiveSign
argument_list|,
name|QVariant
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
name|system_data
operator|->
name|m_plus
operator|=
name|res
operator|.
name|toString
argument_list|()
operator|.
name|at
argument_list|(
literal|0
argument_list|)
operator|.
name|unicode
argument_list|()
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|systemData
specifier|static
specifier|const
name|QLocaleData
modifier|*
name|systemData
parameter_list|()
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
comment|// copy over the information from the fallback locale and modify
if|if
condition|(
operator|!
name|system_data
operator|||
name|system_data
operator|->
name|m_language_id
operator|==
literal|0
condition|)
name|QLocalePrivate
operator|::
name|updateSystemPrivate
argument_list|()
expr_stmt|;
return|return
name|system_data
return|;
else|#
directive|else
return|return
name|locale_data
return|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|defaultData
specifier|static
specifier|const
name|QLocaleData
modifier|*
name|defaultData
parameter_list|()
block|{
if|if
condition|(
operator|!
name|default_data
condition|)
name|default_data
operator|=
name|systemData
argument_list|()
expr_stmt|;
return|return
name|default_data
return|;
block|}
end_function
begin_function
DECL|function|c
specifier|const
name|QLocaleData
modifier|*
name|QLocaleData
operator|::
name|c
parameter_list|()
block|{
name|Q_ASSERT
argument_list|(
name|locale_index
index|[
name|QLocale
operator|::
name|C
index|]
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
name|c_data
return|;
block|}
end_function
begin_function
DECL|function|getLocaleData
specifier|static
specifier|inline
name|QString
name|getLocaleData
parameter_list|(
specifier|const
name|ushort
modifier|*
name|data
parameter_list|,
name|int
name|size
parameter_list|)
block|{
return|return
name|size
operator|>
literal|0
condition|?
name|QString
operator|::
name|fromRawData
argument_list|(
cast|reinterpret_cast
argument_list|<
specifier|const
name|QChar
operator|*
argument_list|>
argument_list|(
name|data
argument_list|)
argument_list|,
name|size
argument_list|)
else|:
name|QString
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|getLocaleListData
specifier|static
name|QString
name|getLocaleListData
parameter_list|(
specifier|const
name|ushort
modifier|*
name|data
parameter_list|,
name|int
name|size
parameter_list|,
name|int
name|index
parameter_list|)
block|{
specifier|static
specifier|const
name|ushort
name|separator
init|=
literal|';'
decl_stmt|;
while|while
condition|(
name|index
operator|&&
name|size
operator|>
literal|0
condition|)
block|{
while|while
condition|(
operator|*
name|data
operator|!=
name|separator
condition|)
operator|++
name|data
operator|,
operator|--
name|size
expr_stmt|;
operator|--
name|index
expr_stmt|;
operator|++
name|data
expr_stmt|;
operator|--
name|size
expr_stmt|;
block|}
specifier|const
name|ushort
modifier|*
name|end
init|=
name|data
decl_stmt|;
while|while
condition|(
name|size
operator|>
literal|0
operator|&&
operator|*
name|end
operator|!=
name|separator
condition|)
operator|++
name|end
operator|,
operator|--
name|size
expr_stmt|;
return|return
name|getLocaleData
argument_list|(
name|data
argument_list|,
name|end
operator|-
name|data
argument_list|)
return|;
block|}
end_function
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATASTREAM
end_ifndef
begin_function
DECL|function|operator <<
name|QDataStream
modifier|&
name|operator
name|<<
parameter_list|(
name|QDataStream
modifier|&
name|ds
parameter_list|,
specifier|const
name|QLocale
modifier|&
name|l
parameter_list|)
block|{
name|ds
operator|<<
name|l
operator|.
name|name
argument_list|()
expr_stmt|;
return|return
name|ds
return|;
block|}
end_function
begin_function
DECL|function|operator >>
name|QDataStream
modifier|&
name|operator
name|>>
parameter_list|(
name|QDataStream
modifier|&
name|ds
parameter_list|,
name|QLocale
modifier|&
name|l
parameter_list|)
block|{
name|QString
name|s
decl_stmt|;
name|ds
operator|>>
name|s
expr_stmt|;
name|l
operator|=
name|QLocale
argument_list|(
name|s
argument_list|)
expr_stmt|;
return|return
name|ds
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// QT_NO_DATASTREAM
end_comment
begin_decl_stmt
DECL|variable|locale_data_size
specifier|static
specifier|const
name|int
name|locale_data_size
init|=
sizeof|sizeof
argument_list|(
name|locale_data
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|QLocaleData
argument_list|)
operator|-
literal|1
decl_stmt|;
end_decl_stmt
begin_macro
name|Q_GLOBAL_STATIC_WITH_ARGS
argument_list|(
argument|QSharedDataPointer<QLocalePrivate>
argument_list|,
argument|defaultLocalePrivate
argument_list|,
argument|(QLocalePrivate::create(defaultData(), default_number_options))
argument_list|)
end_macro
begin_function
DECL|function|localePrivateByName
specifier|static
name|QLocalePrivate
modifier|*
name|localePrivateByName
parameter_list|(
specifier|const
name|QString
modifier|&
name|name
parameter_list|)
block|{
if|if
condition|(
name|name
operator|==
name|QLatin1String
argument_list|(
literal|"C"
argument_list|)
condition|)
return|return
name|c_private
argument_list|()
return|;
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|findLocaleData
argument_list|(
name|name
argument_list|)
decl_stmt|;
return|return
name|QLocalePrivate
operator|::
name|create
argument_list|(
name|data
argument_list|,
name|data
operator|->
name|m_language_id
operator|==
name|QLocale
operator|::
name|C
condition|?
name|QLocale
operator|::
name|OmitGroupSeparator
else|:
literal|0
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|findLocalePrivate
specifier|static
name|QLocalePrivate
modifier|*
name|findLocalePrivate
parameter_list|(
name|QLocale
operator|::
name|Language
name|language
parameter_list|,
name|QLocale
operator|::
name|Script
name|script
parameter_list|,
name|QLocale
operator|::
name|Country
name|country
parameter_list|)
block|{
if|if
condition|(
name|language
operator|==
name|QLocale
operator|::
name|C
condition|)
return|return
name|c_private
argument_list|()
return|;
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|QLocaleData
operator|::
name|findLocaleData
argument_list|(
name|language
argument_list|,
name|script
argument_list|,
name|country
argument_list|)
decl_stmt|;
name|int
name|numberOptions
init|=
literal|0
decl_stmt|;
comment|// If not found, should default to system
if|if
condition|(
name|data
operator|->
name|m_language_id
operator|==
name|QLocale
operator|::
name|C
operator|&&
name|language
operator|!=
name|QLocale
operator|::
name|C
condition|)
block|{
name|numberOptions
operator|=
name|default_number_options
expr_stmt|;
name|data
operator|=
name|defaultData
argument_list|()
expr_stmt|;
block|}
return|return
name|QLocalePrivate
operator|::
name|create
argument_list|(
name|data
argument_list|,
name|numberOptions
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!  \internal */
end_comment
begin_constructor
DECL|function|QLocale
name|QLocale
operator|::
name|QLocale
parameter_list|(
name|QLocalePrivate
modifier|&
name|dd
parameter_list|)
member_init_list|:
name|d
argument_list|(
operator|&
name|dd
argument_list|)
block|{}
end_constructor
begin_comment
comment|/*!     Constructs a QLocale object with the specified \a name,     which has the format     "language[_script][_country][.codeset][@modifier]" or "C", where:      \list     \li language is a lowercase, two-letter, ISO 639 language code (also some three-letter codes),     \li script is a titlecase, four-letter, ISO 15924 script code,     \li country is an uppercase, two-letter, ISO 3166 country code (also "419" as defined by United Nations),     \li and codeset and modifier are ignored.     \endlist      The separator can be either underscore or a minus sign.      If the string violates the locale format, or language is not     a valid ISO 639 code, the "C" locale is used instead. If country     is not present, or is not a valid ISO 3166 code, the most     appropriate country is chosen for the specified language.      The language, script and country codes are converted to their respective     \c Language, \c Script and \c Country enums. After this conversion is     performed, the constructor behaves exactly like QLocale(Country, Script,     Language).      This constructor is much slower than QLocale(Country, Script, Language).      \sa bcp47Name() */
end_comment
begin_constructor
DECL|function|QLocale
name|QLocale
operator|::
name|QLocale
parameter_list|(
specifier|const
name|QString
modifier|&
name|name
parameter_list|)
member_init_list|:
name|d
argument_list|(
name|localePrivateByName
argument_list|(
name|name
argument_list|)
argument_list|)
block|{ }
end_constructor
begin_comment
comment|/*!     Constructs a QLocale object initialized with the default locale. If     no default locale was set using setDefault(), this locale will     be the same as the one returned by system().      \sa setDefault() */
end_comment
begin_constructor
DECL|function|QLocale
name|QLocale
operator|::
name|QLocale
parameter_list|()
member_init_list|:
name|d
argument_list|(
operator|*
name|defaultLocalePrivate
argument_list|)
block|{ }
end_constructor
begin_comment
comment|/*!     Constructs a QLocale object with the specified \a language and \a     country.      \list     \li If the language/country pair is found in the database, it is used.     \li If the language is found but the country is not, or if the country        is \c AnyCountry, the language is used with the most        appropriate available country (for example, Germany for German),     \li If neither the language nor the country are found, QLocale        defaults to the default locale (see setDefault()).     \endlist      The language and country that are actually used can be queried     using language() and country().      \sa setDefault(), language(), country() */
end_comment
begin_constructor
DECL|function|QLocale
name|QLocale
operator|::
name|QLocale
parameter_list|(
name|Language
name|language
parameter_list|,
name|Country
name|country
parameter_list|)
member_init_list|:
name|d
argument_list|(
name|findLocalePrivate
argument_list|(
name|language
argument_list|,
name|QLocale
operator|::
name|AnyScript
argument_list|,
name|country
argument_list|)
argument_list|)
block|{ }
end_constructor
begin_comment
comment|/*!     \since 4.8      Constructs a QLocale object with the specified \a language, \a script and     \a country.      \list     \li If the language/script/country is found in the database, it is used.     \li If both \a script is AnyScript and \a country is AnyCountry, the        language is used with the most appropriate available script and country        (for example, Germany for German),     \li If either \a script is AnyScript or \a country is AnyCountry, the        language is used with the first locale that matches the given \a script        and \a country.     \li If neither the language nor the country are found, QLocale        defaults to the default locale (see setDefault()).     \endlist      The language, script and country that are actually used can be queried     using language(), script() and country().      \sa setDefault(), language(), script(), country() */
end_comment
begin_constructor
DECL|function|QLocale
name|QLocale
operator|::
name|QLocale
parameter_list|(
name|Language
name|language
parameter_list|,
name|Script
name|script
parameter_list|,
name|Country
name|country
parameter_list|)
member_init_list|:
name|d
argument_list|(
name|findLocalePrivate
argument_list|(
name|language
argument_list|,
name|script
argument_list|,
name|country
argument_list|)
argument_list|)
block|{ }
end_constructor
begin_comment
comment|/*!     Constructs a QLocale object as a copy of \a other. */
end_comment
begin_constructor
DECL|function|QLocale
name|QLocale
operator|::
name|QLocale
parameter_list|(
specifier|const
name|QLocale
modifier|&
name|other
parameter_list|)
block|{
name|d
operator|=
name|other
operator|.
name|d
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     Destructor */
end_comment
begin_destructor
DECL|function|~QLocale
name|QLocale
operator|::
name|~
name|QLocale
parameter_list|()
block|{ }
end_destructor
begin_comment
comment|/*!     Assigns \a other to this QLocale object and returns a reference     to this QLocale object. */
end_comment
begin_function
DECL|function|operator =
name|QLocale
modifier|&
name|QLocale
operator|::
name|operator
name|=
parameter_list|(
specifier|const
name|QLocale
modifier|&
name|other
parameter_list|)
block|{
name|d
operator|=
name|other
operator|.
name|d
expr_stmt|;
return|return
operator|*
name|this
return|;
block|}
end_function
begin_function
DECL|function|operator ==
name|bool
name|QLocale
operator|::
name|operator
name|==
parameter_list|(
specifier|const
name|QLocale
modifier|&
name|other
parameter_list|)
specifier|const
block|{
return|return
name|d
operator|->
name|m_data
operator|==
name|other
operator|.
name|d
operator|->
name|m_data
operator|&&
name|d
operator|->
name|m_numberOptions
operator|==
name|other
operator|.
name|d
operator|->
name|m_numberOptions
return|;
block|}
end_function
begin_function
DECL|function|operator !=
name|bool
name|QLocale
operator|::
name|operator
name|!=
parameter_list|(
specifier|const
name|QLocale
modifier|&
name|other
parameter_list|)
specifier|const
block|{
return|return
name|d
operator|->
name|m_data
operator|!=
name|other
operator|.
name|d
operator|->
name|m_data
operator|||
name|d
operator|->
name|m_numberOptions
operator|!=
name|other
operator|.
name|d
operator|->
name|m_numberOptions
return|;
block|}
end_function
begin_comment
comment|/*!     \since 5.6     \relates QLocale      Returns the hash value for \a key, using     \a seed to seed the calculation. */
end_comment
begin_function
name|uint
name|qHash
parameter_list|(
specifier|const
name|QLocale
modifier|&
name|key
parameter_list|,
name|uint
name|seed
parameter_list|)
name|Q_DECL_NOTHROW
block|{
name|QtPrivate
operator|::
name|QHashCombine
name|hash
decl_stmt|;
name|seed
operator|=
name|hash
argument_list|(
name|seed
argument_list|,
name|key
operator|.
name|d
operator|->
name|m_data
argument_list|)
expr_stmt|;
name|seed
operator|=
name|hash
argument_list|(
name|seed
argument_list|,
name|key
operator|.
name|d
operator|->
name|m_numberOptions
argument_list|)
expr_stmt|;
return|return
name|seed
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.2      Sets the \a options related to number conversions for this     QLocale instance. */
end_comment
begin_function
DECL|function|setNumberOptions
name|void
name|QLocale
operator|::
name|setNumberOptions
parameter_list|(
name|NumberOptions
name|options
parameter_list|)
block|{
name|d
operator|->
name|m_numberOptions
operator|=
name|options
expr_stmt|;
block|}
end_function
begin_comment
comment|/*!     \since 4.2      Returns the options related to number conversions for this     QLocale instance.      By default, no options are set for the standard locales. */
end_comment
begin_function
DECL|function|numberOptions
name|QLocale
operator|::
name|NumberOptions
name|QLocale
operator|::
name|numberOptions
parameter_list|()
specifier|const
block|{
return|return
cast|static_cast
argument_list|<
name|NumberOption
argument_list|>
argument_list|(
name|d
operator|->
name|m_numberOptions
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns \a str quoted according to the current locale using the given     quotation \a style. */
end_comment
begin_function
DECL|function|quoteString
name|QString
name|QLocale
operator|::
name|quoteString
parameter_list|(
specifier|const
name|QString
modifier|&
name|str
parameter_list|,
name|QuotationStyle
name|style
parameter_list|)
specifier|const
block|{
return|return
name|quoteString
argument_list|(
operator|&
name|str
argument_list|,
name|style
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      \overload */
end_comment
begin_function
DECL|function|quoteString
name|QString
name|QLocale
operator|::
name|quoteString
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|str
parameter_list|,
name|QuotationStyle
name|style
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
decl_stmt|;
if|if
condition|(
name|style
operator|==
name|QLocale
operator|::
name|AlternateQuotation
condition|)
name|res
operator|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|StringToAlternateQuotation
argument_list|,
name|QVariant
operator|::
name|fromValue
argument_list|(
name|str
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|res
operator|.
name|isNull
argument_list|()
operator|||
name|style
operator|==
name|QLocale
operator|::
name|StandardQuotation
condition|)
name|res
operator|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|StringToStandardQuotation
argument_list|,
name|QVariant
operator|::
name|fromValue
argument_list|(
name|str
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
if|if
condition|(
name|style
operator|==
name|QLocale
operator|::
name|StandardQuotation
condition|)
return|return
name|QChar
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_quotation_start
argument_list|)
operator|%
name|str
operator|%
name|QChar
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_quotation_end
argument_list|)
return|;
else|else
return|return
name|QChar
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_alternate_quotation_start
argument_list|)
operator|%
name|str
operator|%
name|QChar
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_alternate_quotation_end
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a string that represents a join of a given \a list of strings with     a separator defined by the locale. */
end_comment
begin_function
DECL|function|createSeparatedList
name|QString
name|QLocale
operator|::
name|createSeparatedList
parameter_list|(
specifier|const
name|QStringList
modifier|&
name|list
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
decl_stmt|;
name|res
operator|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|ListToSeparatedString
argument_list|,
name|QVariant
operator|::
name|fromValue
argument_list|(
name|list
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
specifier|const
name|int
name|size
init|=
name|list
operator|.
name|size
argument_list|()
decl_stmt|;
if|if
condition|(
name|size
operator|==
literal|1
condition|)
block|{
return|return
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
return|;
block|}
elseif|else
if|if
condition|(
name|size
operator|==
literal|2
condition|)
block|{
name|QString
name|format
init|=
name|getLocaleData
argument_list|(
name|list_pattern_part_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_two_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_two_size
argument_list|)
decl_stmt|;
return|return
name|format
operator|.
name|arg
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|)
return|;
block|}
elseif|else
if|if
condition|(
name|size
operator|>
literal|2
condition|)
block|{
name|QString
name|formatStart
init|=
name|getLocaleData
argument_list|(
name|list_pattern_part_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_start_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_start_size
argument_list|)
decl_stmt|;
name|QString
name|formatMid
init|=
name|getLocaleData
argument_list|(
name|list_pattern_part_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_mid_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_mid_size
argument_list|)
decl_stmt|;
name|QString
name|formatEnd
init|=
name|getLocaleData
argument_list|(
name|list_pattern_part_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_end_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_list_pattern_part_end_size
argument_list|)
decl_stmt|;
name|QString
name|result
init|=
name|formatStart
operator|.
name|arg
argument_list|(
name|list
operator|.
name|at
argument_list|(
literal|0
argument_list|)
argument_list|,
name|list
operator|.
name|at
argument_list|(
literal|1
argument_list|)
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|2
init|;
name|i
operator|<
name|size
operator|-
literal|1
condition|;
operator|++
name|i
control|)
name|result
operator|=
name|formatMid
operator|.
name|arg
argument_list|(
name|result
argument_list|,
name|list
operator|.
name|at
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
name|result
operator|=
name|formatEnd
operator|.
name|arg
argument_list|(
name|result
argument_list|,
name|list
operator|.
name|at
argument_list|(
name|size
operator|-
literal|1
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|result
return|;
block|}
return|return
name|QString
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \nonreentrant      Sets the global default locale to \a locale. These     values are used when a QLocale object is constructed with     no arguments. If this function is not called, the system's     locale is used.      \warning In a multithreaded application, the default locale     should be set at application startup, before any non-GUI threads     are created.      \sa system(), c() */
end_comment
begin_function
DECL|function|setDefault
name|void
name|QLocale
operator|::
name|setDefault
parameter_list|(
specifier|const
name|QLocale
modifier|&
name|locale
parameter_list|)
block|{
name|default_data
operator|=
name|locale
operator|.
name|d
operator|->
name|m_data
expr_stmt|;
name|default_number_options
operator|=
name|locale
operator|.
name|numberOptions
argument_list|()
expr_stmt|;
if|if
condition|(
name|defaultLocalePrivate
operator|.
name|exists
argument_list|()
condition|)
block|{
comment|// update the cached private
operator|*
name|defaultLocalePrivate
operator|=
name|locale
operator|.
name|d
expr_stmt|;
block|}
block|}
end_function
begin_comment
comment|/*!     Returns the language of this locale.      \sa script(), country(), languageToString(), bcp47Name() */
end_comment
begin_function
DECL|function|language
name|QLocale
operator|::
name|Language
name|QLocale
operator|::
name|language
parameter_list|()
specifier|const
block|{
return|return
name|Language
argument_list|(
name|d
operator|->
name|languageId
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns the script of this locale.      \sa language(), country(), languageToString(), scriptToString(), bcp47Name() */
end_comment
begin_function
DECL|function|script
name|QLocale
operator|::
name|Script
name|QLocale
operator|::
name|script
parameter_list|()
specifier|const
block|{
return|return
name|Script
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_script_id
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the country of this locale.      \sa language(), script(), countryToString(), bcp47Name() */
end_comment
begin_function
DECL|function|country
name|QLocale
operator|::
name|Country
name|QLocale
operator|::
name|country
parameter_list|()
specifier|const
block|{
return|return
name|Country
argument_list|(
name|d
operator|->
name|countryId
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the language and country of this locale as a     string of the form "language_country", where     language is a lowercase, two-letter ISO 639 language code,     and country is an uppercase, two- or three-letter ISO 3166 country code.      Note that even if QLocale object was constructed with an explicit script,     name() will not contain it for compatibility reasons. Use bcp47Name() instead     if you need a full locale name.      \sa QLocale(), language(), script(), country(), bcp47Name() */
end_comment
begin_function
DECL|function|name
name|QString
name|QLocale
operator|::
name|name
parameter_list|()
specifier|const
block|{
name|Language
name|l
init|=
name|language
argument_list|()
decl_stmt|;
name|QString
name|result
init|=
name|d
operator|->
name|languageCode
argument_list|()
decl_stmt|;
if|if
condition|(
name|l
operator|==
name|C
condition|)
return|return
name|result
return|;
name|Country
name|c
init|=
name|country
argument_list|()
decl_stmt|;
if|if
condition|(
name|c
operator|==
name|AnyCountry
condition|)
return|return
name|result
return|;
name|result
operator|.
name|append
argument_list|(
name|QLatin1Char
argument_list|(
literal|'_'
argument_list|)
argument_list|)
expr_stmt|;
name|result
operator|.
name|append
argument_list|(
name|d
operator|->
name|countryCode
argument_list|()
argument_list|)
expr_stmt|;
return|return
name|result
return|;
block|}
end_function
begin_function
DECL|function|toIntegral_helper
specifier|static
name|qlonglong
name|toIntegral_helper
parameter_list|(
specifier|const
name|QLocaleData
modifier|*
name|d
parameter_list|,
specifier|const
name|QChar
modifier|*
name|data
parameter_list|,
name|int
name|len
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|QLocaleData
operator|::
name|GroupSeparatorMode
name|mode
parameter_list|,
name|qlonglong
parameter_list|)
block|{
return|return
name|d
operator|->
name|stringToLongLong
argument_list|(
name|data
argument_list|,
name|len
argument_list|,
literal|10
argument_list|,
name|ok
argument_list|,
name|mode
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|toIntegral_helper
specifier|static
name|qulonglong
name|toIntegral_helper
parameter_list|(
specifier|const
name|QLocaleData
modifier|*
name|d
parameter_list|,
specifier|const
name|QChar
modifier|*
name|data
parameter_list|,
name|int
name|len
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|QLocaleData
operator|::
name|GroupSeparatorMode
name|mode
parameter_list|,
name|qulonglong
parameter_list|)
block|{
return|return
name|d
operator|->
name|stringToUnsLongLong
argument_list|(
name|data
argument_list|,
name|len
argument_list|,
literal|10
argument_list|,
name|ok
argument_list|,
name|mode
argument_list|)
return|;
block|}
end_function
begin_function
template|template
parameter_list|<
name|typename
name|T
parameter_list|>
specifier|static
specifier|inline
DECL|function|toIntegral_helper
name|T
name|toIntegral_helper
parameter_list|(
specifier|const
name|QLocalePrivate
modifier|*
name|d
parameter_list|,
specifier|const
name|QChar
modifier|*
name|data
parameter_list|,
name|int
name|len
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
block|{
comment|// ### Qt6: use std::conditional<std::is_unsigned<T>::value, qulonglong, qlonglong>::type
specifier|const
name|bool
name|isUnsigned
init|=
name|T
argument_list|(
literal|0
argument_list|)
operator|<
name|T
argument_list|(
operator|-
literal|1
argument_list|)
decl_stmt|;
typedef|typedef
typename|typename
name|QtPrivate
operator|::
name|QConditional
argument_list|<
name|isUnsigned
argument_list|,
name|qulonglong
argument_list|,
name|qlonglong
argument_list|>
operator|::
name|Type
name|Int64
typedef|;
name|QLocaleData
operator|::
name|GroupSeparatorMode
name|mode
init|=
name|d
operator|->
name|m_numberOptions
operator|&
name|QLocale
operator|::
name|RejectGroupSeparator
condition|?
name|QLocaleData
operator|::
name|FailOnGroupSeparators
else|:
name|QLocaleData
operator|::
name|ParseGroupSeparators
decl_stmt|;
comment|// we select the right overload by the last, unused parameter
name|Int64
name|val
init|=
name|toIntegral_helper
argument_list|(
name|d
operator|->
name|m_data
argument_list|,
name|data
argument_list|,
name|len
argument_list|,
name|ok
argument_list|,
name|mode
argument_list|,
name|Int64
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|T
argument_list|(
name|val
argument_list|)
operator|!=
name|val
condition|)
block|{
if|if
condition|(
name|ok
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
name|val
operator|=
literal|0
expr_stmt|;
block|}
return|return
name|T
argument_list|(
name|val
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns the dash-separated language, script and country (and possibly other BCP47 fields)     of this locale as a string.      Unlike the uiLanguages() the returned value of the bcp47Name() represents     the locale name of the QLocale data but not the language the user-interface     should be in.      This function tries to conform the locale name to BCP47.      \sa language(), country(), script(), uiLanguages() */
end_comment
begin_function
DECL|function|bcp47Name
name|QString
name|QLocale
operator|::
name|bcp47Name
parameter_list|()
specifier|const
block|{
return|return
name|QString
operator|::
name|fromLatin1
argument_list|(
name|d
operator|->
name|bcp47Name
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a QString containing the name of \a language.      \sa countryToString(), scriptToString(), bcp47Name() */
end_comment
begin_function
DECL|function|languageToString
name|QString
name|QLocale
operator|::
name|languageToString
parameter_list|(
name|Language
name|language
parameter_list|)
block|{
if|if
condition|(
name|uint
argument_list|(
name|language
argument_list|)
operator|>
name|uint
argument_list|(
name|QLocale
operator|::
name|LastLanguage
argument_list|)
condition|)
return|return
name|QLatin1String
argument_list|(
literal|"Unknown"
argument_list|)
return|;
return|return
name|QLatin1String
argument_list|(
name|language_name_list
operator|+
name|language_name_index
index|[
name|language
index|]
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a QString containing the name of \a country.      \sa languageToString(), scriptToString(), country(), bcp47Name() */
end_comment
begin_function
DECL|function|countryToString
name|QString
name|QLocale
operator|::
name|countryToString
parameter_list|(
name|Country
name|country
parameter_list|)
block|{
if|if
condition|(
name|uint
argument_list|(
name|country
argument_list|)
operator|>
name|uint
argument_list|(
name|QLocale
operator|::
name|LastCountry
argument_list|)
condition|)
return|return
name|QLatin1String
argument_list|(
literal|"Unknown"
argument_list|)
return|;
return|return
name|QLatin1String
argument_list|(
name|country_name_list
operator|+
name|country_name_index
index|[
name|country
index|]
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a QString containing the name of \a script.      \sa languageToString(), countryToString(), script(), bcp47Name() */
end_comment
begin_function
DECL|function|scriptToString
name|QString
name|QLocale
operator|::
name|scriptToString
parameter_list|(
name|QLocale
operator|::
name|Script
name|script
parameter_list|)
block|{
if|if
condition|(
name|uint
argument_list|(
name|script
argument_list|)
operator|>
name|uint
argument_list|(
name|QLocale
operator|::
name|LastScript
argument_list|)
condition|)
return|return
name|QLatin1String
argument_list|(
literal|"Unknown"
argument_list|)
return|;
return|return
name|QLatin1String
argument_list|(
name|script_name_list
operator|+
name|script_name_index
index|[
name|script
index|]
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the short int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not 0, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toUShort(), toString() */
end_comment
begin_function
DECL|function|toShort
name|short
name|QLocale
operator|::
name|toShort
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|short
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the unsigned short int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not 0, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toShort(), toString() */
end_comment
begin_function
DECL|function|toUShort
name|ushort
name|QLocale
operator|::
name|toUShort
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|ushort
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not 0, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toUInt(), toString() */
end_comment
begin_function
DECL|function|toInt
name|int
name|QLocale
operator|::
name|toInt
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|int
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the unsigned int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not 0, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toInt(), toString() */
end_comment
begin_function
DECL|function|toUInt
name|uint
name|QLocale
operator|::
name|toUInt
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|uint
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the long long int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not 0, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toInt(), toULongLong(), toDouble(), toString() */
end_comment
begin_function
DECL|function|toLongLong
name|qlonglong
name|QLocale
operator|::
name|toLongLong
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|qlonglong
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the unsigned long long int represented by the localized     string \a s.      If the conversion fails the function returns 0.      If \a ok is not 0, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toLongLong(), toInt(), toDouble(), toString() */
end_comment
begin_function
DECL|function|toULongLong
name|qulonglong
name|QLocale
operator|::
name|toULongLong
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|qulonglong
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the float represented by the localized string \a s, or 0.0     if the conversion failed.      If \a ok is not 0, reports failure by setting     *ok to false and success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toDouble(), toInt(), toString() */
end_comment
begin_function
DECL|function|toFloat
name|float
name|QLocale
operator|::
name|toFloat
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|QLocaleData
operator|::
name|convertDoubleToFloat
argument_list|(
name|toDouble
argument_list|(
name|s
argument_list|,
name|ok
argument_list|)
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the double represented by the localized string \a s, or     0.0 if the conversion failed.      If \a ok is not 0, reports failure by setting     *ok to false and success by setting *ok to true.      Unlike QString::toDouble(), this function does not fall back to     the "C" locale if the string cannot be interpreted in this     locale.      \snippet code/src_corelib_tools_qlocale.cpp 3      Notice that the last conversion returns 1234.0, because '.' is the     thousands group separator in the German locale.      This function ignores leading and trailing whitespace.      \sa toFloat(), toInt(), toString() */
end_comment
begin_function
DECL|function|toDouble
name|double
name|QLocale
operator|::
name|toDouble
parameter_list|(
specifier|const
name|QString
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
name|QLocaleData
operator|::
name|GroupSeparatorMode
name|mode
init|=
name|d
operator|->
name|m_numberOptions
operator|&
name|RejectGroupSeparator
condition|?
name|QLocaleData
operator|::
name|FailOnGroupSeparators
else|:
name|QLocaleData
operator|::
name|ParseGroupSeparators
decl_stmt|;
return|return
name|d
operator|->
name|m_data
operator|->
name|stringToDouble
argument_list|(
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|,
name|mode
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the short int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not null, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toUShort(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toShort
name|short
name|QLocale
operator|::
name|toShort
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|short
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the unsigned short int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not null, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toShort(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toUShort
name|ushort
name|QLocale
operator|::
name|toUShort
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|ushort
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not null, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toUInt(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toInt
name|int
name|QLocale
operator|::
name|toInt
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|int
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the unsigned int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not null, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toInt(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toUInt
name|uint
name|QLocale
operator|::
name|toUInt
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|uint
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the long long int represented by the localized string \a s.      If the conversion fails the function returns 0.      If \a ok is not null, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toInt(), toULongLong(), toDouble(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toLongLong
name|qlonglong
name|QLocale
operator|::
name|toLongLong
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|qlonglong
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the unsigned long long int represented by the localized     string \a s.      If the conversion fails the function returns 0.      If \a ok is not null, failure is reported by setting *ok to false, and     success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toLongLong(), toInt(), toDouble(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toULongLong
name|qulonglong
name|QLocale
operator|::
name|toULongLong
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|toIntegral_helper
argument_list|<
name|qulonglong
argument_list|>
argument_list|(
name|d
argument_list|,
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the float represented by the localized string \a s, or 0.0     if the conversion failed.      If \a ok is not null, reports failure by setting     *ok to false and success by setting *ok to true.      This function ignores leading and trailing whitespace.      \sa toDouble(), toInt(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toFloat
name|float
name|QLocale
operator|::
name|toFloat
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
return|return
name|QLocaleData
operator|::
name|convertDoubleToFloat
argument_list|(
name|toDouble
argument_list|(
name|s
argument_list|,
name|ok
argument_list|)
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the double represented by the localized string \a s, or     0.0 if the conversion failed.      If \a ok is not null, reports failure by setting     *ok to false and success by setting *ok to true.      Unlike QString::toDouble(), this function does not fall back to     the "C" locale if the string cannot be interpreted in this     locale.      \snippet code/src_corelib_tools_qlocale.cpp 3      Notice that the last conversion returns 1234.0, because '.' is the     thousands group separator in the German locale.      This function ignores leading and trailing whitespace.      \sa toFloat(), toInt(), toString()      \since 5.1 */
end_comment
begin_function
DECL|function|toDouble
name|double
name|QLocale
operator|::
name|toDouble
parameter_list|(
specifier|const
name|QStringRef
modifier|&
name|s
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
specifier|const
block|{
name|QLocaleData
operator|::
name|GroupSeparatorMode
name|mode
init|=
name|d
operator|->
name|m_numberOptions
operator|&
name|RejectGroupSeparator
condition|?
name|QLocaleData
operator|::
name|FailOnGroupSeparators
else|:
name|QLocaleData
operator|::
name|ParseGroupSeparators
decl_stmt|;
return|return
name|d
operator|->
name|m_data
operator|->
name|stringToDouble
argument_list|(
name|s
operator|.
name|constData
argument_list|()
argument_list|,
name|s
operator|.
name|size
argument_list|()
argument_list|,
name|ok
argument_list|,
name|mode
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a localized string representation of \a i.      \sa toLongLong() */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
name|qlonglong
name|i
parameter_list|)
specifier|const
block|{
name|int
name|flags
init|=
name|d
operator|->
name|m_numberOptions
operator|&
name|OmitGroupSeparator
condition|?
literal|0
else|:
name|QLocaleData
operator|::
name|ThousandsGroup
decl_stmt|;
return|return
name|d
operator|->
name|m_data
operator|->
name|longLongToString
argument_list|(
name|i
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
operator|-
literal|1
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \overload      \sa toULongLong() */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
name|qulonglong
name|i
parameter_list|)
specifier|const
block|{
name|int
name|flags
init|=
name|d
operator|->
name|m_numberOptions
operator|&
name|OmitGroupSeparator
condition|?
literal|0
else|:
name|QLocaleData
operator|::
name|ThousandsGroup
decl_stmt|;
return|return
name|d
operator|->
name|m_data
operator|->
name|unsLongLongToString
argument_list|(
name|i
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
operator|-
literal|1
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a localized string representation of the given \a date in the     specified \a format.     If \a format is an empty string, an empty string is returned. */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
specifier|const
name|QDate
modifier|&
name|date
parameter_list|,
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
specifier|const
block|{
return|return
name|d
operator|->
name|dateTimeToString
argument_list|(
name|format
argument_list|,
name|QDateTime
argument_list|()
argument_list|,
name|date
argument_list|,
name|QTime
argument_list|()
argument_list|,
name|this
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a localized string representation of the given \a date according     to the specified \a format. */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
specifier|const
name|QDate
modifier|&
name|date
parameter_list|,
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|date
operator|.
name|isValid
argument_list|()
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|format
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|DateToStringLong
else|:
name|QSystemLocale
operator|::
name|DateToStringShort
argument_list|,
name|date
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|QString
name|format_str
init|=
name|dateFormat
argument_list|(
name|format
argument_list|)
decl_stmt|;
return|return
name|toString
argument_list|(
name|date
argument_list|,
name|format_str
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|timeFormatContainsAP
specifier|static
name|bool
name|timeFormatContainsAP
parameter_list|(
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
block|{
name|int
name|i
init|=
literal|0
decl_stmt|;
while|while
condition|(
name|i
operator|<
name|format
operator|.
name|size
argument_list|()
condition|)
block|{
if|if
condition|(
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'\''
condition|)
block|{
name|qt_readEscapedFormatString
argument_list|(
name|format
argument_list|,
operator|&
name|i
argument_list|)
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|toLower
argument_list|()
operator|.
name|unicode
argument_list|()
operator|==
literal|'a'
condition|)
return|return
literal|true
return|;
operator|++
name|i
expr_stmt|;
block|}
return|return
literal|false
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a localized string representation of the given \a time according     to the specified \a format.     If \a format is an empty string, an empty string is returned. */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
specifier|const
name|QTime
modifier|&
name|time
parameter_list|,
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
specifier|const
block|{
return|return
name|d
operator|->
name|dateTimeToString
argument_list|(
name|format
argument_list|,
name|QDateTime
argument_list|()
argument_list|,
name|QDate
argument_list|()
argument_list|,
name|time
argument_list|,
name|this
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.4      Returns a localized string representation of the given \a dateTime according     to the specified \a format.     If \a format is an empty string, an empty string is returned. */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
specifier|const
name|QDateTime
modifier|&
name|dateTime
parameter_list|,
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
specifier|const
block|{
return|return
name|d
operator|->
name|dateTimeToString
argument_list|(
name|format
argument_list|,
name|dateTime
argument_list|,
name|QDate
argument_list|()
argument_list|,
name|QTime
argument_list|()
argument_list|,
name|this
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.4      Returns a localized string representation of the given \a dateTime according     to the specified \a format. */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
specifier|const
name|QDateTime
modifier|&
name|dateTime
parameter_list|,
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|dateTime
operator|.
name|isValid
argument_list|()
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|format
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|DateTimeToStringLong
else|:
name|QSystemLocale
operator|::
name|DateTimeToStringShort
argument_list|,
name|dateTime
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
specifier|const
name|QString
name|format_str
init|=
name|dateTimeFormat
argument_list|(
name|format
argument_list|)
decl_stmt|;
return|return
name|toString
argument_list|(
name|dateTime
argument_list|,
name|format_str
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Returns a localized string representation of the given \a time in the     specified \a format. */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
specifier|const
name|QTime
modifier|&
name|time
parameter_list|,
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|time
operator|.
name|isValid
argument_list|()
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|format
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|TimeToStringLong
else|:
name|QSystemLocale
operator|::
name|TimeToStringShort
argument_list|,
name|time
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|QString
name|format_str
init|=
name|timeFormat
argument_list|(
name|format
argument_list|)
decl_stmt|;
return|return
name|toString
argument_list|(
name|time
argument_list|,
name|format_str
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the date format used for the current locale.      If \a format is LongFormat the format will be a long version.     Otherwise it uses a shorter version.      \sa QDate::toString(), QDate::fromString() */
end_comment
begin_function
DECL|function|dateFormat
name|QString
name|QLocale
operator|::
name|dateFormat
parameter_list|(
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|format
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|DateFormatLong
else|:
name|QSystemLocale
operator|::
name|DateFormatShort
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|format
condition|)
block|{
case|case
name|LongFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_date_format_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_date_format_size
expr_stmt|;
break|break;
default|default:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_date_format_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_date_format_size
expr_stmt|;
break|break;
block|}
return|return
name|getLocaleData
argument_list|(
name|date_format_data
operator|+
name|idx
argument_list|,
name|size
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the time format used for the current locale.      If \a format is LongFormat the format will be a long version.     Otherwise it uses a shorter version.      \sa QTime::toString(), QTime::fromString() */
end_comment
begin_function
DECL|function|timeFormat
name|QString
name|QLocale
operator|::
name|timeFormat
parameter_list|(
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|format
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|TimeFormatLong
else|:
name|QSystemLocale
operator|::
name|TimeFormatShort
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|format
condition|)
block|{
case|case
name|LongFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_time_format_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_time_format_size
expr_stmt|;
break|break;
default|default:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_time_format_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_time_format_size
expr_stmt|;
break|break;
block|}
return|return
name|getLocaleData
argument_list|(
name|time_format_data
operator|+
name|idx
argument_list|,
name|size
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.4      Returns the date time format used for the current locale.      If \a format is ShortFormat the format will be a short version.     Otherwise it uses a longer version.      \sa QDateTime::toString(), QDateTime::fromString() */
end_comment
begin_function
DECL|function|dateTimeFormat
name|QString
name|QLocale
operator|::
name|dateTimeFormat
parameter_list|(
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|format
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|DateTimeFormatLong
else|:
name|QSystemLocale
operator|::
name|DateTimeFormatShort
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
block|{
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
block|}
endif|#
directive|endif
return|return
name|dateFormat
argument_list|(
name|format
argument_list|)
operator|+
name|QLatin1Char
argument_list|(
literal|' '
argument_list|)
operator|+
name|timeFormat
argument_list|(
name|format
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.4      Parses the time string given in \a string and returns the     time. The format of the time string is chosen according to the     \a format parameter (see timeFormat()).      If the time could not be parsed, returns an invalid time.      \sa timeFormat(), toDate(), toDateTime(), QTime::fromString() */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATESTRING
end_ifndef
begin_function
DECL|function|toTime
name|QTime
name|QLocale
operator|::
name|toTime
parameter_list|(
specifier|const
name|QString
modifier|&
name|string
parameter_list|,
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
return|return
name|toTime
argument_list|(
name|string
argument_list|,
name|timeFormat
argument_list|(
name|format
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*!     \since 4.4      Parses the date string given in \a string and returns the     date. The format of the date string is chosen according to the     \a format parameter (see dateFormat()).      If the date could not be parsed, returns an invalid date.      \sa dateFormat(), toTime(), toDateTime(), QDate::fromString() */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATESTRING
end_ifndef
begin_function
DECL|function|toDate
name|QDate
name|QLocale
operator|::
name|toDate
parameter_list|(
specifier|const
name|QString
modifier|&
name|string
parameter_list|,
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
return|return
name|toDate
argument_list|(
name|string
argument_list|,
name|dateFormat
argument_list|(
name|format
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*!     \since 4.4      Parses the date/time string given in \a string and returns the     time. The format of the date/time string is chosen according to the     \a format parameter (see dateTimeFormat()).      If the string could not be parsed, returns an invalid QDateTime.      \sa dateTimeFormat(), toTime(), toDate(), QDateTime::fromString() */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATESTRING
end_ifndef
begin_function
DECL|function|toDateTime
name|QDateTime
name|QLocale
operator|::
name|toDateTime
parameter_list|(
specifier|const
name|QString
modifier|&
name|string
parameter_list|,
name|FormatType
name|format
parameter_list|)
specifier|const
block|{
return|return
name|toDateTime
argument_list|(
name|string
argument_list|,
name|dateTimeFormat
argument_list|(
name|format
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*!     \since 4.4      Parses the time string given in \a string and returns the     time. See QTime::fromString() for information on what is a valid     format string.      If the time could not be parsed, returns an invalid time.      \sa timeFormat(), toDate(), toDateTime(), QTime::fromString() */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATESTRING
end_ifndef
begin_function
DECL|function|toTime
name|QTime
name|QLocale
operator|::
name|toTime
parameter_list|(
specifier|const
name|QString
modifier|&
name|string
parameter_list|,
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
specifier|const
block|{
name|QTime
name|time
decl_stmt|;
ifndef|#
directive|ifndef
name|QT_BOOTSTRAPPED
name|QDateTimeParser
name|dt
argument_list|(
name|QVariant
operator|::
name|Time
argument_list|,
name|QDateTimeParser
operator|::
name|FromString
argument_list|)
decl_stmt|;
name|dt
operator|.
name|defaultLocale
operator|=
operator|*
name|this
expr_stmt|;
if|if
condition|(
name|dt
operator|.
name|parseFormat
argument_list|(
name|format
argument_list|)
condition|)
name|dt
operator|.
name|fromString
argument_list|(
name|string
argument_list|,
literal|0
argument_list|,
operator|&
name|time
argument_list|)
expr_stmt|;
else|#
directive|else
name|Q_UNUSED
argument_list|(
name|string
argument_list|)
expr_stmt|;
name|Q_UNUSED
argument_list|(
name|format
argument_list|)
expr_stmt|;
endif|#
directive|endif
return|return
name|time
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*!     \since 4.4      Parses the date string given in \a string and returns the     date. See QDate::fromString() for information on the expressions     that can be used with this function.      This function searches month names and the names of the days of     the week in the current locale.      If the date could not be parsed, returns an invalid date.      \sa dateFormat(), toTime(), toDateTime(), QDate::fromString() */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATESTRING
end_ifndef
begin_function
DECL|function|toDate
name|QDate
name|QLocale
operator|::
name|toDate
parameter_list|(
specifier|const
name|QString
modifier|&
name|string
parameter_list|,
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
specifier|const
block|{
name|QDate
name|date
decl_stmt|;
ifndef|#
directive|ifndef
name|QT_BOOTSTRAPPED
name|QDateTimeParser
name|dt
argument_list|(
name|QVariant
operator|::
name|Date
argument_list|,
name|QDateTimeParser
operator|::
name|FromString
argument_list|)
decl_stmt|;
name|dt
operator|.
name|defaultLocale
operator|=
operator|*
name|this
expr_stmt|;
if|if
condition|(
name|dt
operator|.
name|parseFormat
argument_list|(
name|format
argument_list|)
condition|)
name|dt
operator|.
name|fromString
argument_list|(
name|string
argument_list|,
operator|&
name|date
argument_list|,
literal|0
argument_list|)
expr_stmt|;
else|#
directive|else
name|Q_UNUSED
argument_list|(
name|string
argument_list|)
expr_stmt|;
name|Q_UNUSED
argument_list|(
name|format
argument_list|)
expr_stmt|;
endif|#
directive|endif
return|return
name|date
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*!     \since 4.4      Parses the date/time string given in \a string and returns the     time.  See QDateTime::fromString() for information on the expressions     that can be used with this function.      \note The month and day names used must be given in the user's local     language.      If the string could not be parsed, returns an invalid QDateTime.      \sa dateTimeFormat(), toTime(), toDate(), QDateTime::fromString() */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DATESTRING
end_ifndef
begin_function
DECL|function|toDateTime
name|QDateTime
name|QLocale
operator|::
name|toDateTime
parameter_list|(
specifier|const
name|QString
modifier|&
name|string
parameter_list|,
specifier|const
name|QString
modifier|&
name|format
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_BOOTSTRAPPED
name|QTime
name|time
decl_stmt|;
name|QDate
name|date
decl_stmt|;
name|QDateTimeParser
name|dt
argument_list|(
name|QVariant
operator|::
name|DateTime
argument_list|,
name|QDateTimeParser
operator|::
name|FromString
argument_list|)
decl_stmt|;
name|dt
operator|.
name|defaultLocale
operator|=
operator|*
name|this
expr_stmt|;
if|if
condition|(
name|dt
operator|.
name|parseFormat
argument_list|(
name|format
argument_list|)
operator|&&
name|dt
operator|.
name|fromString
argument_list|(
name|string
argument_list|,
operator|&
name|date
argument_list|,
operator|&
name|time
argument_list|)
condition|)
return|return
name|QDateTime
argument_list|(
name|date
argument_list|,
name|time
argument_list|)
return|;
else|#
directive|else
name|Q_UNUSED
argument_list|(
name|string
argument_list|)
expr_stmt|;
name|Q_UNUSED
argument_list|(
name|format
argument_list|)
expr_stmt|;
endif|#
directive|endif
return|return
name|QDateTime
argument_list|(
name|QDate
argument_list|()
argument_list|,
name|QTime
argument_list|(
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*!     \since 4.1      Returns the decimal point character of this locale. */
end_comment
begin_function
DECL|function|decimalPoint
name|QChar
name|QLocale
operator|::
name|decimalPoint
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|decimal
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the group separator character of this locale. */
end_comment
begin_function
DECL|function|groupSeparator
name|QChar
name|QLocale
operator|::
name|groupSeparator
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|group
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the percent character of this locale. */
end_comment
begin_function
DECL|function|percent
name|QChar
name|QLocale
operator|::
name|percent
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|percent
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the zero digit character of this locale. */
end_comment
begin_function
DECL|function|zeroDigit
name|QChar
name|QLocale
operator|::
name|zeroDigit
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|zero
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the negative sign character of this locale. */
end_comment
begin_function
DECL|function|negativeSign
name|QChar
name|QLocale
operator|::
name|negativeSign
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|minus
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns the positive sign character of this locale. */
end_comment
begin_function
DECL|function|positiveSign
name|QChar
name|QLocale
operator|::
name|positiveSign
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|plus
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.1      Returns the exponential character of this locale. */
end_comment
begin_function
DECL|function|exponential
name|QChar
name|QLocale
operator|::
name|exponential
parameter_list|()
specifier|const
block|{
return|return
name|d
operator|->
name|exponential
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|qIsUpper
specifier|static
name|bool
name|qIsUpper
parameter_list|(
name|char
name|c
parameter_list|)
block|{
return|return
name|c
operator|>=
literal|'A'
operator|&&
name|c
operator|<=
literal|'Z'
return|;
block|}
end_function
begin_function
DECL|function|qToLower
specifier|static
name|char
name|qToLower
parameter_list|(
name|char
name|c
parameter_list|)
block|{
if|if
condition|(
name|c
operator|>=
literal|'A'
operator|&&
name|c
operator|<=
literal|'Z'
condition|)
return|return
name|c
operator|-
literal|'A'
operator|+
literal|'a'
return|;
else|else
return|return
name|c
return|;
block|}
end_function
begin_comment
comment|/*!     \overload      \a f and \a prec have the same meaning as in QString::number(double, char, int).      \sa toDouble() */
end_comment
begin_function
DECL|function|toString
name|QString
name|QLocale
operator|::
name|toString
parameter_list|(
name|double
name|i
parameter_list|,
name|char
name|f
parameter_list|,
name|int
name|prec
parameter_list|)
specifier|const
block|{
name|QLocaleData
operator|::
name|DoubleForm
name|form
init|=
name|QLocaleData
operator|::
name|DFDecimal
decl_stmt|;
name|uint
name|flags
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|qIsUpper
argument_list|(
name|f
argument_list|)
condition|)
name|flags
operator|=
name|QLocaleData
operator|::
name|CapitalEorX
expr_stmt|;
name|f
operator|=
name|qToLower
argument_list|(
name|f
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|f
condition|)
block|{
case|case
literal|'f'
case|:
name|form
operator|=
name|QLocaleData
operator|::
name|DFDecimal
expr_stmt|;
break|break;
case|case
literal|'e'
case|:
name|form
operator|=
name|QLocaleData
operator|::
name|DFExponent
expr_stmt|;
break|break;
case|case
literal|'g'
case|:
name|form
operator|=
name|QLocaleData
operator|::
name|DFSignificantDigits
expr_stmt|;
break|break;
default|default:
break|break;
block|}
if|if
condition|(
operator|!
operator|(
name|d
operator|->
name|m_numberOptions
operator|&
name|OmitGroupSeparator
operator|)
condition|)
name|flags
operator||=
name|QLocaleData
operator|::
name|ThousandsGroup
expr_stmt|;
return|return
name|d
operator|->
name|m_data
operator|->
name|doubleToString
argument_list|(
name|i
argument_list|,
name|prec
argument_list|,
name|form
argument_list|,
operator|-
literal|1
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \fn QLocale QLocale::c()      Returns a QLocale object initialized to the "C" locale.      \sa system() */
end_comment
begin_comment
comment|/*!     Returns a QLocale object initialized to the system locale.      On Windows and Mac, this locale will use the decimal/grouping characters and date/time     formats specified in the system configuration panel.      \sa c() */
end_comment
begin_function
DECL|function|system
name|QLocale
name|QLocale
operator|::
name|system
parameter_list|()
block|{
return|return
name|QLocale
argument_list|(
operator|*
name|QLocalePrivate
operator|::
name|create
argument_list|(
name|systemData
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a list of valid locale objects that match the given \a language, \a     script and \a country.      Getting a list of all locales:     QList<QLocale> allLocales = QLocale::matchingLocales(QLocale::AnyLanguage, QLocale::AnyScript, QLocale::AnyCountry);      Getting a list of locales suitable for Russia:     QList<QLocale> locales = QLocale::matchingLocales(QLocale::AnyLanguage, QLocale::AnyScript, QLocale::Russia); */
end_comment
begin_function
DECL|function|matchingLocales
name|QList
argument_list|<
name|QLocale
argument_list|>
name|QLocale
operator|::
name|matchingLocales
parameter_list|(
name|QLocale
operator|::
name|Language
name|language
parameter_list|,
name|QLocale
operator|::
name|Script
name|script
parameter_list|,
name|QLocale
operator|::
name|Country
name|country
parameter_list|)
block|{
if|if
condition|(
name|uint
argument_list|(
name|language
argument_list|)
operator|>
name|QLocale
operator|::
name|LastLanguage
operator|||
name|uint
argument_list|(
name|script
argument_list|)
operator|>
name|QLocale
operator|::
name|LastScript
operator|||
name|uint
argument_list|(
name|country
argument_list|)
operator|>
name|QLocale
operator|::
name|LastCountry
condition|)
return|return
name|QList
argument_list|<
name|QLocale
argument_list|>
argument_list|()
return|;
if|if
condition|(
name|language
operator|==
name|QLocale
operator|::
name|C
condition|)
return|return
name|QList
argument_list|<
name|QLocale
argument_list|>
argument_list|()
operator|<<
name|QLocale
argument_list|(
name|QLocale
operator|::
name|C
argument_list|)
return|;
name|QList
argument_list|<
name|QLocale
argument_list|>
name|result
decl_stmt|;
if|if
condition|(
name|language
operator|==
name|QLocale
operator|::
name|AnyLanguage
operator|&&
name|script
operator|==
name|QLocale
operator|::
name|AnyScript
operator|&&
name|country
operator|==
name|QLocale
operator|::
name|AnyCountry
condition|)
name|result
operator|.
name|reserve
argument_list|(
name|locale_data_size
argument_list|)
expr_stmt|;
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|locale_data
operator|+
name|locale_index
index|[
name|language
index|]
decl_stmt|;
while|while
condition|(
operator|(
name|data
operator|!=
name|locale_data
operator|+
name|locale_data_size
operator|)
operator|&&
operator|(
name|language
operator|==
name|QLocale
operator|::
name|AnyLanguage
operator|||
name|data
operator|->
name|m_language_id
operator|==
name|uint
argument_list|(
name|language
argument_list|)
operator|)
condition|)
block|{
if|if
condition|(
operator|(
name|script
operator|==
name|QLocale
operator|::
name|AnyScript
operator|||
name|data
operator|->
name|m_script_id
operator|==
name|uint
argument_list|(
name|script
argument_list|)
operator|)
operator|&&
operator|(
name|country
operator|==
name|QLocale
operator|::
name|AnyCountry
operator|||
name|data
operator|->
name|m_country_id
operator|==
name|uint
argument_list|(
name|country
argument_list|)
operator|)
condition|)
block|{
name|QLocale
name|locale
argument_list|(
operator|*
name|QLocalePrivate
operator|::
name|create
argument_list|(
name|data
argument_list|)
argument_list|)
decl_stmt|;
name|result
operator|.
name|append
argument_list|(
name|locale
argument_list|)
expr_stmt|;
block|}
operator|++
name|data
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
end_function
begin_comment
comment|/*!     \obsolete     \since 4.3      Returns the list of countries that have entries for \a language in Qt's locale     database. If the result is an empty list, then \a language is not represented in     Qt's locale database.      \sa matchingLocales() */
end_comment
begin_function
DECL|function|countriesForLanguage
name|QList
argument_list|<
name|QLocale
operator|::
name|Country
argument_list|>
name|QLocale
operator|::
name|countriesForLanguage
parameter_list|(
name|Language
name|language
parameter_list|)
block|{
name|QList
argument_list|<
name|Country
argument_list|>
name|result
decl_stmt|;
if|if
condition|(
name|language
operator|==
name|C
condition|)
block|{
name|result
operator|<<
name|AnyCountry
expr_stmt|;
return|return
name|result
return|;
block|}
name|unsigned
name|language_id
init|=
name|language
decl_stmt|;
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|locale_data
operator|+
name|locale_index
index|[
name|language_id
index|]
decl_stmt|;
while|while
condition|(
name|data
operator|->
name|m_language_id
operator|==
name|language_id
condition|)
block|{
specifier|const
name|QLocale
operator|::
name|Country
name|country
init|=
cast|static_cast
argument_list|<
name|Country
argument_list|>
argument_list|(
name|data
operator|->
name|m_country_id
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|result
operator|.
name|contains
argument_list|(
name|country
argument_list|)
condition|)
name|result
operator|.
name|append
argument_list|(
name|country
argument_list|)
expr_stmt|;
operator|++
name|data
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.2      Returns the localized name of \a month, in the format specified     by \a type.      \sa dayName(), standaloneMonthName() */
end_comment
begin_function
DECL|function|monthName
name|QString
name|QLocale
operator|::
name|monthName
parameter_list|(
name|int
name|month
parameter_list|,
name|FormatType
name|type
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|month
argument_list|<
literal|1
operator|||
name|month
argument_list|>
literal|12
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|type
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|MonthNameLong
else|:
name|QSystemLocale
operator|::
name|MonthNameShort
argument_list|,
name|month
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|QLocale
operator|::
name|LongFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_month_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_month_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|ShortFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_month_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_month_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|NarrowFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_narrow_month_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_narrow_month_names_size
expr_stmt|;
break|break;
default|default:
return|return
name|QString
argument_list|()
return|;
block|}
return|return
name|getLocaleListData
argument_list|(
name|months_data
operator|+
name|idx
argument_list|,
name|size
argument_list|,
name|month
operator|-
literal|1
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns the localized name of \a month that is used as a     standalone text, in the format specified by \a type.      If the locale information doesn't specify the standalone month     name then return value is the same as in monthName().      \sa monthName(), standaloneDayName() */
end_comment
begin_function
DECL|function|standaloneMonthName
name|QString
name|QLocale
operator|::
name|standaloneMonthName
parameter_list|(
name|int
name|month
parameter_list|,
name|FormatType
name|type
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|month
argument_list|<
literal|1
operator|||
name|month
argument_list|>
literal|12
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|type
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|StandaloneMonthNameLong
else|:
name|QSystemLocale
operator|::
name|StandaloneMonthNameShort
argument_list|,
name|month
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|QLocale
operator|::
name|LongFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_long_month_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_long_month_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|ShortFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_short_month_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_short_month_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|NarrowFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_narrow_month_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_narrow_month_names_size
expr_stmt|;
break|break;
default|default:
return|return
name|QString
argument_list|()
return|;
block|}
name|QString
name|name
init|=
name|getLocaleListData
argument_list|(
name|months_data
operator|+
name|idx
argument_list|,
name|size
argument_list|,
name|month
operator|-
literal|1
argument_list|)
decl_stmt|;
if|if
condition|(
name|name
operator|.
name|isEmpty
argument_list|()
condition|)
return|return
name|monthName
argument_list|(
name|month
argument_list|,
name|type
argument_list|)
return|;
return|return
name|name
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.2      Returns the localized name of the \a day (where 1 represents     Monday, 2 represents Tuesday and so on), in the format specified     by \a type.      \sa monthName(), standaloneDayName() */
end_comment
begin_function
DECL|function|dayName
name|QString
name|QLocale
operator|::
name|dayName
parameter_list|(
name|int
name|day
parameter_list|,
name|FormatType
name|type
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|day
argument_list|<
literal|1
operator|||
name|day
argument_list|>
literal|7
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|type
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|DayNameLong
else|:
name|QSystemLocale
operator|::
name|DayNameShort
argument_list|,
name|day
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
if|if
condition|(
name|day
operator|==
literal|7
condition|)
name|day
operator|=
literal|0
expr_stmt|;
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|QLocale
operator|::
name|LongFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_day_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_long_day_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|ShortFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_day_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_short_day_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|NarrowFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_narrow_day_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_narrow_day_names_size
expr_stmt|;
break|break;
default|default:
return|return
name|QString
argument_list|()
return|;
block|}
return|return
name|getLocaleListData
argument_list|(
name|days_data
operator|+
name|idx
argument_list|,
name|size
argument_list|,
name|day
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns the localized name of the \a day (where 1 represents     Monday, 2 represents Tuesday and so on) that is used as a     standalone text, in the format specified by \a type.      If the locale information does not specify the standalone day     name then return value is the same as in dayName().      \sa dayName(), standaloneMonthName() */
end_comment
begin_function
DECL|function|standaloneDayName
name|QString
name|QLocale
operator|::
name|standaloneDayName
parameter_list|(
name|int
name|day
parameter_list|,
name|FormatType
name|type
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|day
argument_list|<
literal|1
operator|||
name|day
argument_list|>
literal|7
condition|)
return|return
name|QString
argument_list|()
return|;
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|type
operator|==
name|LongFormat
condition|?
name|QSystemLocale
operator|::
name|DayNameLong
else|:
name|QSystemLocale
operator|::
name|DayNameShort
argument_list|,
name|day
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
if|if
condition|(
name|day
operator|==
literal|7
condition|)
name|day
operator|=
literal|0
expr_stmt|;
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|QLocale
operator|::
name|LongFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_long_day_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_long_day_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|ShortFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_short_day_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_short_day_names_size
expr_stmt|;
break|break;
case|case
name|QLocale
operator|::
name|NarrowFormat
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_narrow_day_names_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_standalone_narrow_day_names_size
expr_stmt|;
break|break;
default|default:
return|return
name|QString
argument_list|()
return|;
block|}
name|QString
name|name
init|=
name|getLocaleListData
argument_list|(
name|days_data
operator|+
name|idx
argument_list|,
name|size
argument_list|,
name|day
argument_list|)
decl_stmt|;
if|if
condition|(
name|name
operator|.
name|isEmpty
argument_list|()
condition|)
return|return
name|dayName
argument_list|(
name|day
operator|==
literal|0
condition|?
literal|7
else|:
name|day
argument_list|,
name|type
argument_list|)
return|;
return|return
name|name
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns the first day of the week according to the current locale. */
end_comment
begin_function
DECL|function|firstDayOfWeek
name|Qt
operator|::
name|DayOfWeek
name|QLocale
operator|::
name|firstDayOfWeek
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|FirstDayOfWeek
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
cast|static_cast
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
argument_list|(
name|res
operator|.
name|toUInt
argument_list|()
argument_list|)
return|;
block|}
endif|#
directive|endif
return|return
cast|static_cast
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_first_day_of_week
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|measurementSystem
name|QLocale
operator|::
name|MeasurementSystem
name|QLocalePrivate
operator|::
name|measurementSystem
parameter_list|()
specifier|const
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|ImperialMeasurementSystemsCount
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|ImperialMeasurementSystems
index|[
name|i
index|]
operator|.
name|languageId
operator|==
name|m_data
operator|->
name|m_language_id
operator|&&
name|ImperialMeasurementSystems
index|[
name|i
index|]
operator|.
name|countryId
operator|==
name|m_data
operator|->
name|m_country_id
condition|)
block|{
return|return
name|ImperialMeasurementSystems
index|[
name|i
index|]
operator|.
name|system
return|;
block|}
block|}
return|return
name|QLocale
operator|::
name|MetricSystem
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a list of days that are considered weekdays according to the current locale. */
end_comment
begin_function
DECL|function|weekdays
name|QList
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
name|QLocale
operator|::
name|weekdays
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|Weekdays
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
cast|static_cast
argument_list|<
name|QList
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
argument_list|>
argument_list|(
name|res
operator|.
name|value
argument_list|<
name|QList
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
argument_list|>
argument_list|()
argument_list|)
return|;
block|}
endif|#
directive|endif
name|QList
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
name|weekdays
decl_stmt|;
name|quint16
name|weekendStart
init|=
name|d
operator|->
name|m_data
operator|->
name|m_weekend_start
decl_stmt|;
name|quint16
name|weekendEnd
init|=
name|d
operator|->
name|m_data
operator|->
name|m_weekend_end
decl_stmt|;
for|for
control|(
name|int
name|day
init|=
name|Qt
operator|::
name|Monday
init|;
name|day
operator|<=
name|Qt
operator|::
name|Sunday
condition|;
name|day
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|weekendEnd
operator|>=
name|weekendStart
operator|&&
operator|(
name|day
argument_list|<
name|weekendStart
operator|||
name|day
argument_list|>
name|weekendEnd
operator|)
operator|)
operator|||
operator|(
name|weekendEnd
operator|<
name|weekendStart
operator|&&
operator|(
name|day
operator|>
name|weekendEnd
operator|&&
name|day
operator|<
name|weekendStart
operator|)
operator|)
condition|)
name|weekdays
operator|<<
cast|static_cast
argument_list|<
name|Qt
operator|::
name|DayOfWeek
argument_list|>
argument_list|(
name|day
argument_list|)
expr_stmt|;
block|}
return|return
name|weekdays
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.4      Returns the measurement system for the locale. */
end_comment
begin_function
DECL|function|measurementSystem
name|QLocale
operator|::
name|MeasurementSystem
name|QLocale
operator|::
name|measurementSystem
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|MeasurementSystem
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|MeasurementSystem
argument_list|(
name|res
operator|.
name|toInt
argument_list|()
argument_list|)
return|;
block|}
endif|#
directive|endif
return|return
name|d
operator|->
name|measurementSystem
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!   \since 4.7    Returns the text direction of the language. */
end_comment
begin_function
DECL|function|textDirection
name|Qt
operator|::
name|LayoutDirection
name|QLocale
operator|::
name|textDirection
parameter_list|()
specifier|const
block|{
switch|switch
condition|(
name|script
argument_list|()
condition|)
block|{
case|case
name|QLocale
operator|::
name|ArabicScript
case|:
case|case
name|QLocale
operator|::
name|AvestanScript
case|:
case|case
name|QLocale
operator|::
name|CypriotScript
case|:
case|case
name|QLocale
operator|::
name|HebrewScript
case|:
case|case
name|QLocale
operator|::
name|ImperialAramaicScript
case|:
case|case
name|QLocale
operator|::
name|InscriptionalPahlaviScript
case|:
case|case
name|QLocale
operator|::
name|InscriptionalParthianScript
case|:
case|case
name|QLocale
operator|::
name|KharoshthiScript
case|:
case|case
name|QLocale
operator|::
name|LydianScript
case|:
case|case
name|QLocale
operator|::
name|MandaeanScript
case|:
case|case
name|QLocale
operator|::
name|ManichaeanScript
case|:
case|case
name|QLocale
operator|::
name|MendeKikakuiScript
case|:
case|case
name|QLocale
operator|::
name|MeroiticCursiveScript
case|:
case|case
name|QLocale
operator|::
name|MeroiticScript
case|:
case|case
name|QLocale
operator|::
name|NabataeanScript
case|:
case|case
name|QLocale
operator|::
name|NkoScript
case|:
case|case
name|QLocale
operator|::
name|OldNorthArabianScript
case|:
case|case
name|QLocale
operator|::
name|OldSouthArabianScript
case|:
case|case
name|QLocale
operator|::
name|OrkhonScript
case|:
case|case
name|QLocale
operator|::
name|PalmyreneScript
case|:
case|case
name|QLocale
operator|::
name|PhoenicianScript
case|:
case|case
name|QLocale
operator|::
name|PsalterPahlaviScript
case|:
case|case
name|QLocale
operator|::
name|SamaritanScript
case|:
case|case
name|QLocale
operator|::
name|SyriacScript
case|:
case|case
name|QLocale
operator|::
name|ThaanaScript
case|:
return|return
name|Qt
operator|::
name|RightToLeft
return|;
default|default:
break|break;
block|}
return|return
name|Qt
operator|::
name|LeftToRight
return|;
block|}
end_function
begin_comment
comment|/*!   \since 4.8    Returns an uppercase copy of \a str.    If Qt Core is using the ICU libraries, they will be used to perform   the transformation according to the rules of the current locale.   Otherwise the conversion may be done in a platform-dependent manner,   with QString::toUpper() as a generic fallback.    \sa QString::toUpper() */
end_comment
begin_function
DECL|function|toUpper
name|QString
name|QLocale
operator|::
name|toUpper
parameter_list|(
specifier|const
name|QString
modifier|&
name|str
parameter_list|)
specifier|const
block|{
ifdef|#
directive|ifdef
name|QT_USE_ICU
name|bool
name|ok
init|=
literal|true
decl_stmt|;
name|QString
name|result
init|=
name|QIcu
operator|::
name|toUpper
argument_list|(
name|d
operator|->
name|bcp47Name
argument_list|(
literal|'_'
argument_list|)
argument_list|,
name|str
argument_list|,
operator|&
name|ok
argument_list|)
decl_stmt|;
if|if
condition|(
name|ok
condition|)
return|return
name|result
return|;
comment|// else fall through and use Qt's toUpper
endif|#
directive|endif
return|return
name|str
operator|.
name|toUpper
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!   \since 4.8    Returns a lowercase copy of \a str.    If Qt Core is using the ICU libraries, they will be used to perform   the transformation according to the rules of the current locale.   Otherwise the conversion may be done in a platform-dependent manner,   with QString::toLower() as a generic fallback.    \sa QString::toLower() */
end_comment
begin_function
DECL|function|toLower
name|QString
name|QLocale
operator|::
name|toLower
parameter_list|(
specifier|const
name|QString
modifier|&
name|str
parameter_list|)
specifier|const
block|{
ifdef|#
directive|ifdef
name|QT_USE_ICU
name|bool
name|ok
init|=
literal|true
decl_stmt|;
specifier|const
name|QString
name|result
init|=
name|QIcu
operator|::
name|toLower
argument_list|(
name|d
operator|->
name|bcp47Name
argument_list|(
literal|'_'
argument_list|)
argument_list|,
name|str
argument_list|,
operator|&
name|ok
argument_list|)
decl_stmt|;
if|if
condition|(
name|ok
condition|)
return|return
name|result
return|;
comment|// else fall through and use Qt's toUpper
endif|#
directive|endif
return|return
name|str
operator|.
name|toLower
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns the localized name of the "AM" suffix for times specified using     the conventions of the 12-hour clock.      \sa pmText() */
end_comment
begin_function
DECL|function|amText
name|QString
name|QLocale
operator|::
name|amText
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|AMText
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
return|return
name|getLocaleData
argument_list|(
name|am_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_am_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_am_size
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns the localized name of the "PM" suffix for times specified using     the conventions of the 12-hour clock.      \sa amText() */
end_comment
begin_function
DECL|function|pmText
name|QString
name|QLocale
operator|::
name|pmText
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|PMText
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
return|return
name|getLocaleData
argument_list|(
name|pm_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_pm_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_pm_size
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|dateTimeToString
name|QString
name|QLocalePrivate
operator|::
name|dateTimeToString
parameter_list|(
specifier|const
name|QString
modifier|&
name|format
parameter_list|,
specifier|const
name|QDateTime
modifier|&
name|datetime
parameter_list|,
specifier|const
name|QDate
modifier|&
name|dateOnly
parameter_list|,
specifier|const
name|QTime
modifier|&
name|timeOnly
parameter_list|,
specifier|const
name|QLocale
modifier|*
name|q
parameter_list|)
specifier|const
block|{
name|QDate
name|date
decl_stmt|;
name|QTime
name|time
decl_stmt|;
name|bool
name|formatDate
init|=
literal|false
decl_stmt|;
name|bool
name|formatTime
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|datetime
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|date
operator|=
name|datetime
operator|.
name|date
argument_list|()
expr_stmt|;
name|time
operator|=
name|datetime
operator|.
name|time
argument_list|()
expr_stmt|;
name|formatDate
operator|=
literal|true
expr_stmt|;
name|formatTime
operator|=
literal|true
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|dateOnly
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|date
operator|=
name|dateOnly
expr_stmt|;
name|formatDate
operator|=
literal|true
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|timeOnly
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|time
operator|=
name|timeOnly
expr_stmt|;
name|formatTime
operator|=
literal|true
expr_stmt|;
block|}
else|else
block|{
return|return
name|QString
argument_list|()
return|;
block|}
name|QString
name|result
decl_stmt|;
name|int
name|i
init|=
literal|0
decl_stmt|;
while|while
condition|(
name|i
operator|<
name|format
operator|.
name|size
argument_list|()
condition|)
block|{
if|if
condition|(
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'\''
condition|)
block|{
name|result
operator|.
name|append
argument_list|(
name|qt_readEscapedFormatString
argument_list|(
name|format
argument_list|,
operator|&
name|i
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
specifier|const
name|QChar
name|c
init|=
name|format
operator|.
name|at
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|int
name|repeat
init|=
name|qt_repeatCount
argument_list|(
name|format
argument_list|,
name|i
argument_list|)
decl_stmt|;
name|bool
name|used
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|formatDate
condition|)
block|{
switch|switch
condition|(
name|c
operator|.
name|unicode
argument_list|()
condition|)
block|{
case|case
literal|'y'
case|:
name|used
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|repeat
operator|>=
literal|4
condition|)
name|repeat
operator|=
literal|4
expr_stmt|;
elseif|else
if|if
condition|(
name|repeat
operator|>=
literal|2
condition|)
name|repeat
operator|=
literal|2
expr_stmt|;
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|4
case|:
block|{
specifier|const
name|int
name|yr
init|=
name|date
operator|.
name|year
argument_list|()
decl_stmt|;
specifier|const
name|int
name|len
init|=
operator|(
name|yr
operator|<
literal|0
operator|)
condition|?
literal|5
else|:
literal|4
decl_stmt|;
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|yr
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
name|len
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|date
operator|.
name|year
argument_list|()
operator|%
literal|100
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|repeat
operator|=
literal|1
expr_stmt|;
name|result
operator|.
name|append
argument_list|(
name|c
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
literal|'M'
case|:
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
name|qMin
argument_list|(
name|repeat
argument_list|,
literal|4
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|date
operator|.
name|month
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|date
operator|.
name|month
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|result
operator|.
name|append
argument_list|(
name|q
operator|->
name|monthName
argument_list|(
name|date
operator|.
name|month
argument_list|()
argument_list|,
name|QLocale
operator|::
name|ShortFormat
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|result
operator|.
name|append
argument_list|(
name|q
operator|->
name|monthName
argument_list|(
name|date
operator|.
name|month
argument_list|()
argument_list|,
name|QLocale
operator|::
name|LongFormat
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
literal|'d'
case|:
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
name|qMin
argument_list|(
name|repeat
argument_list|,
literal|4
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|date
operator|.
name|day
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|date
operator|.
name|day
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|result
operator|.
name|append
argument_list|(
name|q
operator|->
name|dayName
argument_list|(
name|date
operator|.
name|dayOfWeek
argument_list|()
argument_list|,
name|QLocale
operator|::
name|ShortFormat
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|result
operator|.
name|append
argument_list|(
name|q
operator|->
name|dayName
argument_list|(
name|date
operator|.
name|dayOfWeek
argument_list|()
argument_list|,
name|QLocale
operator|::
name|LongFormat
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
default|default:
break|break;
block|}
block|}
if|if
condition|(
operator|!
name|used
operator|&&
name|formatTime
condition|)
block|{
switch|switch
condition|(
name|c
operator|.
name|unicode
argument_list|()
condition|)
block|{
case|case
literal|'h'
case|:
block|{
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
name|qMin
argument_list|(
name|repeat
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|int
name|hour
init|=
name|time
operator|.
name|hour
argument_list|()
decl_stmt|;
if|if
condition|(
name|timeFormatContainsAP
argument_list|(
name|format
argument_list|)
condition|)
block|{
if|if
condition|(
name|hour
operator|>
literal|12
condition|)
name|hour
operator|-=
literal|12
expr_stmt|;
elseif|else
if|if
condition|(
name|hour
operator|==
literal|0
condition|)
name|hour
operator|=
literal|12
expr_stmt|;
block|}
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|hour
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|hour
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
block|}
case|case
literal|'H'
case|:
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
name|qMin
argument_list|(
name|repeat
argument_list|,
literal|2
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|hour
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|hour
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
literal|'m'
case|:
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
name|qMin
argument_list|(
name|repeat
argument_list|,
literal|2
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|minute
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|minute
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
literal|'s'
case|:
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
name|qMin
argument_list|(
name|repeat
argument_list|,
literal|2
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|second
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|second
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|2
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
literal|'a'
case|:
name|used
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|i
operator|+
literal|1
operator|<
name|format
operator|.
name|length
argument_list|()
operator|&&
name|format
operator|.
name|at
argument_list|(
name|i
operator|+
literal|1
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'p'
condition|)
block|{
name|repeat
operator|=
literal|2
expr_stmt|;
block|}
else|else
block|{
name|repeat
operator|=
literal|1
expr_stmt|;
block|}
name|result
operator|.
name|append
argument_list|(
name|time
operator|.
name|hour
argument_list|()
operator|<
literal|12
condition|?
name|q
operator|->
name|amText
argument_list|()
operator|.
name|toLower
argument_list|()
else|:
name|q
operator|->
name|pmText
argument_list|()
operator|.
name|toLower
argument_list|()
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'A'
case|:
name|used
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|i
operator|+
literal|1
operator|<
name|format
operator|.
name|length
argument_list|()
operator|&&
name|format
operator|.
name|at
argument_list|(
name|i
operator|+
literal|1
argument_list|)
operator|.
name|unicode
argument_list|()
operator|==
literal|'P'
condition|)
block|{
name|repeat
operator|=
literal|2
expr_stmt|;
block|}
else|else
block|{
name|repeat
operator|=
literal|1
expr_stmt|;
block|}
name|result
operator|.
name|append
argument_list|(
name|time
operator|.
name|hour
argument_list|()
operator|<
literal|12
condition|?
name|q
operator|->
name|amText
argument_list|()
operator|.
name|toUpper
argument_list|()
else|:
name|q
operator|->
name|pmText
argument_list|()
operator|.
name|toUpper
argument_list|()
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'z'
case|:
name|used
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|repeat
operator|>=
literal|3
condition|)
block|{
name|repeat
operator|=
literal|3
expr_stmt|;
block|}
else|else
block|{
name|repeat
operator|=
literal|1
expr_stmt|;
block|}
switch|switch
condition|(
name|repeat
condition|)
block|{
case|case
literal|1
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|msec
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|result
operator|.
name|append
argument_list|(
name|m_data
operator|->
name|longLongToString
argument_list|(
name|time
operator|.
name|msec
argument_list|()
argument_list|,
operator|-
literal|1
argument_list|,
literal|10
argument_list|,
literal|3
argument_list|,
name|QLocaleData
operator|::
name|ZeroPadded
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
literal|'t'
case|:
name|used
operator|=
literal|true
expr_stmt|;
name|repeat
operator|=
literal|1
expr_stmt|;
comment|// If we have a QDateTime use the time spec otherwise use the current system tzname
if|if
condition|(
name|formatDate
condition|)
block|{
name|result
operator|.
name|append
argument_list|(
name|datetime
operator|.
name|timeZoneAbbreviation
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|result
operator|.
name|append
argument_list|(
name|QDateTime
operator|::
name|currentDateTime
argument_list|()
operator|.
name|timeZoneAbbreviation
argument_list|()
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
break|break;
block|}
block|}
if|if
condition|(
operator|!
name|used
condition|)
block|{
name|result
operator|.
name|append
argument_list|(
name|QString
argument_list|(
name|repeat
argument_list|,
name|c
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|i
operator|+=
name|repeat
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
end_function
begin_function
DECL|function|doubleToString
name|QString
name|QLocaleData
operator|::
name|doubleToString
parameter_list|(
name|double
name|d
parameter_list|,
name|int
name|precision
parameter_list|,
name|DoubleForm
name|form
parameter_list|,
name|int
name|width
parameter_list|,
name|unsigned
name|flags
parameter_list|)
specifier|const
block|{
return|return
name|doubleToString
argument_list|(
name|m_zero
argument_list|,
name|m_plus
argument_list|,
name|m_minus
argument_list|,
name|m_exponential
argument_list|,
name|m_group
argument_list|,
name|m_decimal
argument_list|,
name|d
argument_list|,
name|precision
argument_list|,
name|form
argument_list|,
name|width
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|doubleToString
name|QString
name|QLocaleData
operator|::
name|doubleToString
parameter_list|(
specifier|const
name|QChar
name|_zero
parameter_list|,
specifier|const
name|QChar
name|plus
parameter_list|,
specifier|const
name|QChar
name|minus
parameter_list|,
specifier|const
name|QChar
name|exponential
parameter_list|,
specifier|const
name|QChar
name|group
parameter_list|,
specifier|const
name|QChar
name|decimal
parameter_list|,
name|double
name|d
parameter_list|,
name|int
name|precision
parameter_list|,
name|DoubleForm
name|form
parameter_list|,
name|int
name|width
parameter_list|,
name|unsigned
name|flags
parameter_list|)
block|{
if|if
condition|(
name|precision
operator|<
literal|0
condition|)
name|precision
operator|=
literal|6
expr_stmt|;
if|if
condition|(
name|width
operator|<
literal|0
condition|)
name|width
operator|=
literal|0
expr_stmt|;
name|bool
name|negative
init|=
literal|false
decl_stmt|;
name|QString
name|num_str
decl_stmt|;
name|int
name|decpt
decl_stmt|;
name|int
name|bufSize
init|=
literal|1
decl_stmt|;
if|if
condition|(
name|form
operator|==
name|DFDecimal
condition|)
comment|// optimize for numbers smaller than 512k
name|bufSize
operator|+=
operator|(
operator|(
name|d
operator|>
operator|(
literal|1
operator|<<
literal|19
operator|)
operator|||
name|d
operator|<
operator|-
operator|(
literal|1
operator|<<
literal|19
operator|)
operator|)
condition|?
name|DoubleMaxDigitsBeforeDecimal
else|:
literal|6
operator|)
operator|+
name|precision
expr_stmt|;
else|else
comment|// Add extra digit due to different interpretations of precision. Also, "nan" has to fit.
name|bufSize
operator|+=
name|qMax
argument_list|(
literal|2
argument_list|,
name|precision
argument_list|)
operator|+
literal|1
expr_stmt|;
name|QVarLengthArray
argument_list|<
name|char
argument_list|>
name|buf
argument_list|(
name|bufSize
argument_list|)
decl_stmt|;
name|int
name|length
decl_stmt|;
name|doubleToAscii
argument_list|(
name|d
argument_list|,
name|form
argument_list|,
name|precision
argument_list|,
name|buf
operator|.
name|data
argument_list|()
argument_list|,
name|bufSize
argument_list|,
name|negative
argument_list|,
name|length
argument_list|,
name|decpt
argument_list|)
expr_stmt|;
if|if
condition|(
name|qstrncmp
argument_list|(
name|buf
operator|.
name|data
argument_list|()
argument_list|,
literal|"inf"
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
operator|||
name|qstrncmp
argument_list|(
name|buf
operator|.
name|data
argument_list|()
argument_list|,
literal|"nan"
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
condition|)
block|{
name|num_str
operator|=
name|QString
operator|::
name|fromLatin1
argument_list|(
name|buf
operator|.
name|data
argument_list|()
argument_list|,
name|length
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// Handle normal numbers
comment|// Chop trailing zeros
name|int
name|last_nonzero_idx
init|=
name|length
operator|-
literal|1
decl_stmt|;
while|while
condition|(
name|last_nonzero_idx
operator|>
literal|0
operator|&&
name|buf
index|[
name|last_nonzero_idx
index|]
operator|==
literal|'0'
condition|)
operator|--
name|last_nonzero_idx
expr_stmt|;
name|QString
name|digits
init|=
name|QString
operator|::
name|fromLatin1
argument_list|(
name|buf
operator|.
name|data
argument_list|()
argument_list|,
name|last_nonzero_idx
operator|+
literal|1
argument_list|)
decl_stmt|;
if|if
condition|(
name|_zero
operator|.
name|unicode
argument_list|()
operator|!=
literal|'0'
condition|)
block|{
name|ushort
name|z
init|=
name|_zero
operator|.
name|unicode
argument_list|()
operator|-
literal|'0'
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|digits
operator|.
name|length
argument_list|()
condition|;
operator|++
name|i
control|)
cast|reinterpret_cast
argument_list|<
name|ushort
operator|*
argument_list|>
argument_list|(
name|digits
operator|.
name|data
argument_list|()
argument_list|)
index|[
name|i
index|]
operator|+=
name|z
expr_stmt|;
block|}
name|bool
name|always_show_decpt
init|=
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ForcePoint
operator|)
decl_stmt|;
switch|switch
condition|(
name|form
condition|)
block|{
case|case
name|DFExponent
case|:
block|{
name|num_str
operator|=
name|exponentForm
argument_list|(
name|_zero
argument_list|,
name|decimal
argument_list|,
name|exponential
argument_list|,
name|group
argument_list|,
name|plus
argument_list|,
name|minus
argument_list|,
name|digits
argument_list|,
name|decpt
argument_list|,
name|precision
argument_list|,
name|PMDecimalDigits
argument_list|,
name|always_show_decpt
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|DFDecimal
case|:
block|{
name|num_str
operator|=
name|decimalForm
argument_list|(
name|_zero
argument_list|,
name|decimal
argument_list|,
name|group
argument_list|,
name|digits
argument_list|,
name|decpt
argument_list|,
name|precision
argument_list|,
name|PMDecimalDigits
argument_list|,
name|always_show_decpt
argument_list|,
name|flags
operator|&
name|ThousandsGroup
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|DFSignificantDigits
case|:
block|{
name|PrecisionMode
name|mode
init|=
operator|(
name|flags
operator|&
name|Alternate
operator|)
condition|?
name|PMSignificantDigits
else|:
name|PMChopTrailingZeros
decl_stmt|;
if|if
condition|(
name|decpt
operator|!=
name|digits
operator|.
name|length
argument_list|()
operator|&&
operator|(
name|decpt
operator|<=
operator|-
literal|4
operator|||
name|decpt
operator|>
name|precision
operator|)
condition|)
name|num_str
operator|=
name|exponentForm
argument_list|(
name|_zero
argument_list|,
name|decimal
argument_list|,
name|exponential
argument_list|,
name|group
argument_list|,
name|plus
argument_list|,
name|minus
argument_list|,
name|digits
argument_list|,
name|decpt
argument_list|,
name|precision
argument_list|,
name|mode
argument_list|,
name|always_show_decpt
argument_list|)
expr_stmt|;
else|else
name|num_str
operator|=
name|decimalForm
argument_list|(
name|_zero
argument_list|,
name|decimal
argument_list|,
name|group
argument_list|,
name|digits
argument_list|,
name|decpt
argument_list|,
name|precision
argument_list|,
name|mode
argument_list|,
name|always_show_decpt
argument_list|,
name|flags
operator|&
name|ThousandsGroup
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|isZero
argument_list|(
name|d
argument_list|)
condition|)
name|negative
operator|=
literal|false
expr_stmt|;
comment|// pad with zeros. LeftAdjusted overrides this flag). Also, we don't
comment|// pad special numbers
if|if
condition|(
name|flags
operator|&
name|QLocaleData
operator|::
name|ZeroPadded
operator|&&
operator|!
operator|(
name|flags
operator|&
name|QLocaleData
operator|::
name|LeftAdjusted
operator|)
condition|)
block|{
name|int
name|num_pad_chars
init|=
name|width
operator|-
name|num_str
operator|.
name|length
argument_list|()
decl_stmt|;
comment|// leave space for the sign
if|if
condition|(
name|negative
operator|||
name|flags
operator|&
name|QLocaleData
operator|::
name|AlwaysShowSign
operator|||
name|flags
operator|&
name|QLocaleData
operator|::
name|BlankBeforePositive
condition|)
operator|--
name|num_pad_chars
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|num_pad_chars
condition|;
operator|++
name|i
control|)
name|num_str
operator|.
name|prepend
argument_list|(
name|_zero
argument_list|)
expr_stmt|;
block|}
block|}
comment|// add sign
if|if
condition|(
name|negative
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|minus
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|flags
operator|&
name|QLocaleData
operator|::
name|AlwaysShowSign
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|plus
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|flags
operator|&
name|QLocaleData
operator|::
name|BlankBeforePositive
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1Char
argument_list|(
literal|' '
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|QLocaleData
operator|::
name|CapitalEorX
condition|)
name|num_str
operator|=
name|num_str
operator|.
name|toUpper
argument_list|()
expr_stmt|;
return|return
name|num_str
return|;
block|}
end_function
begin_function
DECL|function|longLongToString
name|QString
name|QLocaleData
operator|::
name|longLongToString
parameter_list|(
name|qlonglong
name|l
parameter_list|,
name|int
name|precision
parameter_list|,
name|int
name|base
parameter_list|,
name|int
name|width
parameter_list|,
name|unsigned
name|flags
parameter_list|)
specifier|const
block|{
return|return
name|longLongToString
argument_list|(
name|m_zero
argument_list|,
name|m_group
argument_list|,
name|m_plus
argument_list|,
name|m_minus
argument_list|,
name|l
argument_list|,
name|precision
argument_list|,
name|base
argument_list|,
name|width
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|longLongToString
name|QString
name|QLocaleData
operator|::
name|longLongToString
parameter_list|(
specifier|const
name|QChar
name|zero
parameter_list|,
specifier|const
name|QChar
name|group
parameter_list|,
specifier|const
name|QChar
name|plus
parameter_list|,
specifier|const
name|QChar
name|minus
parameter_list|,
name|qlonglong
name|l
parameter_list|,
name|int
name|precision
parameter_list|,
name|int
name|base
parameter_list|,
name|int
name|width
parameter_list|,
name|unsigned
name|flags
parameter_list|)
block|{
name|bool
name|precision_not_specified
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|precision
operator|==
operator|-
literal|1
condition|)
block|{
name|precision_not_specified
operator|=
literal|true
expr_stmt|;
name|precision
operator|=
literal|1
expr_stmt|;
block|}
name|bool
name|negative
init|=
name|l
operator|<
literal|0
decl_stmt|;
if|if
condition|(
name|base
operator|!=
literal|10
condition|)
block|{
comment|// these are not supported by sprintf for octal and hex
name|flags
operator|&=
operator|~
name|AlwaysShowSign
expr_stmt|;
name|flags
operator|&=
operator|~
name|BlankBeforePositive
expr_stmt|;
name|negative
operator|=
literal|false
expr_stmt|;
comment|// neither are negative numbers
block|}
name|QString
name|num_str
decl_stmt|;
if|if
condition|(
name|base
operator|==
literal|10
condition|)
name|num_str
operator|=
name|qlltoa
argument_list|(
name|l
argument_list|,
name|base
argument_list|,
name|zero
argument_list|)
expr_stmt|;
else|else
name|num_str
operator|=
name|qulltoa
argument_list|(
name|l
argument_list|,
name|base
argument_list|,
name|zero
argument_list|)
expr_stmt|;
name|uint
name|cnt_thousand_sep
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|flags
operator|&
name|ThousandsGroup
operator|&&
name|base
operator|==
literal|10
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
name|num_str
operator|.
name|length
argument_list|()
operator|-
literal|3
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|-=
literal|3
control|)
block|{
name|num_str
operator|.
name|insert
argument_list|(
name|i
argument_list|,
name|group
argument_list|)
expr_stmt|;
operator|++
name|cnt_thousand_sep
expr_stmt|;
block|}
block|}
for|for
control|(
name|int
name|i
init|=
name|num_str
operator|.
name|length
argument_list|()
comment|/* - cnt_thousand_sep*/
init|;
name|i
operator|<
name|precision
condition|;
operator|++
name|i
control|)
name|num_str
operator|.
name|prepend
argument_list|(
name|base
operator|==
literal|10
condition|?
name|zero
else|:
name|QChar
operator|::
name|fromLatin1
argument_list|(
literal|'0'
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
operator|&&
name|base
operator|==
literal|8
operator|&&
operator|(
name|num_str
operator|.
name|isEmpty
argument_list|()
operator|||
name|num_str
index|[
literal|0
index|]
operator|.
name|unicode
argument_list|()
operator|!=
name|QLatin1Char
argument_list|(
literal|'0'
argument_list|)
operator|)
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1Char
argument_list|(
literal|'0'
argument_list|)
argument_list|)
expr_stmt|;
comment|// LeftAdjusted overrides this flag ZeroPadded. sprintf only padds
comment|// when precision is not specified in the format string
name|bool
name|zero_padded
init|=
name|flags
operator|&
name|ZeroPadded
operator|&&
operator|!
operator|(
name|flags
operator|&
name|LeftAdjusted
operator|)
operator|&&
name|precision_not_specified
decl_stmt|;
if|if
condition|(
name|zero_padded
condition|)
block|{
name|int
name|num_pad_chars
init|=
name|width
operator|-
name|num_str
operator|.
name|length
argument_list|()
decl_stmt|;
comment|// leave space for the sign
if|if
condition|(
name|negative
operator|||
name|flags
operator|&
name|AlwaysShowSign
operator|||
name|flags
operator|&
name|BlankBeforePositive
condition|)
operator|--
name|num_pad_chars
expr_stmt|;
comment|// leave space for optional '0x' in hex form
if|if
condition|(
name|base
operator|==
literal|16
operator|&&
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
condition|)
name|num_pad_chars
operator|-=
literal|2
expr_stmt|;
comment|// leave space for optional '0b' in binary form
elseif|else
if|if
condition|(
name|base
operator|==
literal|2
operator|&&
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
condition|)
name|num_pad_chars
operator|-=
literal|2
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|num_pad_chars
condition|;
operator|++
name|i
control|)
name|num_str
operator|.
name|prepend
argument_list|(
name|base
operator|==
literal|10
condition|?
name|zero
else|:
name|QChar
operator|::
name|fromLatin1
argument_list|(
literal|'0'
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|flags
operator|&
name|CapitalEorX
condition|)
name|num_str
operator|=
name|num_str
operator|.
name|toUpper
argument_list|()
expr_stmt|;
if|if
condition|(
name|base
operator|==
literal|16
operator|&&
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1String
argument_list|(
name|flags
operator|&
name|UppercaseBase
condition|?
literal|"0X"
else|:
literal|"0x"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|base
operator|==
literal|2
operator|&&
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1String
argument_list|(
name|flags
operator|&
name|UppercaseBase
condition|?
literal|"0B"
else|:
literal|"0b"
argument_list|)
argument_list|)
expr_stmt|;
comment|// add sign
if|if
condition|(
name|negative
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|minus
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|flags
operator|&
name|AlwaysShowSign
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|plus
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|flags
operator|&
name|BlankBeforePositive
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1Char
argument_list|(
literal|' '
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|num_str
return|;
block|}
end_function
begin_function
DECL|function|unsLongLongToString
name|QString
name|QLocaleData
operator|::
name|unsLongLongToString
parameter_list|(
name|qulonglong
name|l
parameter_list|,
name|int
name|precision
parameter_list|,
name|int
name|base
parameter_list|,
name|int
name|width
parameter_list|,
name|unsigned
name|flags
parameter_list|)
specifier|const
block|{
return|return
name|unsLongLongToString
argument_list|(
name|m_zero
argument_list|,
name|m_group
argument_list|,
name|m_plus
argument_list|,
name|l
argument_list|,
name|precision
argument_list|,
name|base
argument_list|,
name|width
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|unsLongLongToString
name|QString
name|QLocaleData
operator|::
name|unsLongLongToString
parameter_list|(
specifier|const
name|QChar
name|zero
parameter_list|,
specifier|const
name|QChar
name|group
parameter_list|,
specifier|const
name|QChar
name|plus
parameter_list|,
name|qulonglong
name|l
parameter_list|,
name|int
name|precision
parameter_list|,
name|int
name|base
parameter_list|,
name|int
name|width
parameter_list|,
name|unsigned
name|flags
parameter_list|)
block|{
name|bool
name|precision_not_specified
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|precision
operator|==
operator|-
literal|1
condition|)
block|{
name|precision_not_specified
operator|=
literal|true
expr_stmt|;
name|precision
operator|=
literal|1
expr_stmt|;
block|}
name|QString
name|num_str
init|=
name|qulltoa
argument_list|(
name|l
argument_list|,
name|base
argument_list|,
name|zero
argument_list|)
decl_stmt|;
name|uint
name|cnt_thousand_sep
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|flags
operator|&
name|ThousandsGroup
operator|&&
name|base
operator|==
literal|10
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
name|num_str
operator|.
name|length
argument_list|()
operator|-
literal|3
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|-=
literal|3
control|)
block|{
name|num_str
operator|.
name|insert
argument_list|(
name|i
argument_list|,
name|group
argument_list|)
expr_stmt|;
operator|++
name|cnt_thousand_sep
expr_stmt|;
block|}
block|}
for|for
control|(
name|int
name|i
init|=
name|num_str
operator|.
name|length
argument_list|()
comment|/* - cnt_thousand_sep*/
init|;
name|i
operator|<
name|precision
condition|;
operator|++
name|i
control|)
name|num_str
operator|.
name|prepend
argument_list|(
name|base
operator|==
literal|10
condition|?
name|zero
else|:
name|QChar
operator|::
name|fromLatin1
argument_list|(
literal|'0'
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
operator|&&
name|base
operator|==
literal|8
operator|&&
operator|(
name|num_str
operator|.
name|isEmpty
argument_list|()
operator|||
name|num_str
index|[
literal|0
index|]
operator|.
name|unicode
argument_list|()
operator|!=
name|QLatin1Char
argument_list|(
literal|'0'
argument_list|)
operator|)
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1Char
argument_list|(
literal|'0'
argument_list|)
argument_list|)
expr_stmt|;
comment|// LeftAdjusted overrides this flag ZeroPadded. sprintf only padds
comment|// when precision is not specified in the format string
name|bool
name|zero_padded
init|=
name|flags
operator|&
name|ZeroPadded
operator|&&
operator|!
operator|(
name|flags
operator|&
name|LeftAdjusted
operator|)
operator|&&
name|precision_not_specified
decl_stmt|;
if|if
condition|(
name|zero_padded
condition|)
block|{
name|int
name|num_pad_chars
init|=
name|width
operator|-
name|num_str
operator|.
name|length
argument_list|()
decl_stmt|;
comment|// leave space for optional '0x' in hex form
if|if
condition|(
name|base
operator|==
literal|16
operator|&&
name|flags
operator|&
name|Alternate
condition|)
name|num_pad_chars
operator|-=
literal|2
expr_stmt|;
comment|// leave space for optional '0b' in binary form
elseif|else
if|if
condition|(
name|base
operator|==
literal|2
operator|&&
name|flags
operator|&
name|Alternate
condition|)
name|num_pad_chars
operator|-=
literal|2
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|num_pad_chars
condition|;
operator|++
name|i
control|)
name|num_str
operator|.
name|prepend
argument_list|(
name|base
operator|==
literal|10
condition|?
name|zero
else|:
name|QChar
operator|::
name|fromLatin1
argument_list|(
literal|'0'
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|flags
operator|&
name|CapitalEorX
condition|)
name|num_str
operator|=
name|num_str
operator|.
name|toUpper
argument_list|()
expr_stmt|;
if|if
condition|(
name|base
operator|==
literal|16
operator|&&
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1String
argument_list|(
name|flags
operator|&
name|UppercaseBase
condition|?
literal|"0X"
else|:
literal|"0x"
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|base
operator|==
literal|2
operator|&&
operator|(
name|flags
operator|&
name|Alternate
operator|||
name|flags
operator|&
name|ShowBase
operator|)
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1String
argument_list|(
name|flags
operator|&
name|UppercaseBase
condition|?
literal|"0B"
else|:
literal|"0b"
argument_list|)
argument_list|)
expr_stmt|;
comment|// add sign
if|if
condition|(
name|flags
operator|&
name|AlwaysShowSign
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|plus
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|flags
operator|&
name|BlankBeforePositive
condition|)
name|num_str
operator|.
name|prepend
argument_list|(
name|QLatin1Char
argument_list|(
literal|' '
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|num_str
return|;
block|}
end_function
begin_comment
comment|/*     Converts a number in locale to its representation in the C locale.     Only has to guarantee that a string that is a correct representation of     a number will be converted. If junk is passed in, junk will be passed     out and the error will be detected during the actual conversion to a     number. We can't detect junk here, since we don't even know the base     of the number. */
end_comment
begin_function
DECL|function|numberToCLocale
name|bool
name|QLocaleData
operator|::
name|numberToCLocale
parameter_list|(
specifier|const
name|QChar
modifier|*
name|str
parameter_list|,
name|int
name|len
parameter_list|,
name|GroupSeparatorMode
name|group_sep_mode
parameter_list|,
name|CharBuff
modifier|*
name|result
parameter_list|)
specifier|const
block|{
specifier|const
name|QChar
modifier|*
name|uc
init|=
name|str
decl_stmt|;
name|int
name|l
init|=
name|len
decl_stmt|;
name|int
name|idx
init|=
literal|0
decl_stmt|;
comment|// Skip whitespace
while|while
condition|(
name|idx
operator|<
name|l
operator|&&
name|uc
index|[
name|idx
index|]
operator|.
name|isSpace
argument_list|()
condition|)
operator|++
name|idx
expr_stmt|;
if|if
condition|(
name|idx
operator|==
name|l
condition|)
return|return
literal|false
return|;
comment|// Check trailing whitespace
for|for
control|(
init|;
name|idx
operator|<
name|l
condition|;
operator|--
name|l
control|)
block|{
if|if
condition|(
operator|!
name|uc
index|[
name|l
operator|-
literal|1
index|]
operator|.
name|isSpace
argument_list|()
condition|)
break|break;
block|}
name|int
name|group_cnt
init|=
literal|0
decl_stmt|;
comment|// counts number of group chars
name|int
name|decpt_idx
init|=
operator|-
literal|1
decl_stmt|;
name|int
name|last_separator_idx
init|=
operator|-
literal|1
decl_stmt|;
name|int
name|start_of_digits_idx
init|=
operator|-
literal|1
decl_stmt|;
while|while
condition|(
name|idx
operator|<
name|l
condition|)
block|{
specifier|const
name|QChar
name|in
init|=
name|uc
index|[
name|idx
index|]
decl_stmt|;
name|char
name|out
init|=
name|digitToCLocale
argument_list|(
name|in
argument_list|)
decl_stmt|;
if|if
condition|(
name|out
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|in
operator|==
name|m_list
condition|)
name|out
operator|=
literal|';'
expr_stmt|;
elseif|else
if|if
condition|(
name|in
operator|==
name|m_percent
condition|)
name|out
operator|=
literal|'%'
expr_stmt|;
comment|// for handling base-x numbers
elseif|else
if|if
condition|(
name|in
operator|.
name|unicode
argument_list|()
operator|>=
literal|'A'
operator|&&
name|in
operator|.
name|unicode
argument_list|()
operator|<=
literal|'Z'
condition|)
name|out
operator|=
name|in
operator|.
name|toLower
argument_list|()
operator|.
name|toLatin1
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|in
operator|.
name|unicode
argument_list|()
operator|>=
literal|'a'
operator|&&
name|in
operator|.
name|unicode
argument_list|()
operator|<=
literal|'z'
condition|)
name|out
operator|=
name|in
operator|.
name|toLatin1
argument_list|()
expr_stmt|;
else|else
break|break;
block|}
if|if
condition|(
name|group_sep_mode
operator|==
name|ParseGroupSeparators
condition|)
block|{
if|if
condition|(
name|start_of_digits_idx
operator|==
operator|-
literal|1
operator|&&
name|out
operator|>=
literal|'0'
operator|&&
name|out
operator|<=
literal|'9'
condition|)
block|{
name|start_of_digits_idx
operator|=
name|idx
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|out
operator|==
literal|','
condition|)
block|{
comment|// Don't allow group chars after the decimal point
if|if
condition|(
name|decpt_idx
operator|!=
operator|-
literal|1
condition|)
return|return
literal|false
return|;
comment|// check distance from the last separator or from the beginning of the digits
comment|// ### FIXME: Some locales allow other groupings! See https://en.wikipedia.org/wiki/Thousands_separator
if|if
condition|(
name|last_separator_idx
operator|!=
operator|-
literal|1
operator|&&
name|idx
operator|-
name|last_separator_idx
operator|!=
literal|4
condition|)
return|return
literal|false
return|;
if|if
condition|(
name|last_separator_idx
operator|==
operator|-
literal|1
operator|&&
operator|(
name|start_of_digits_idx
operator|==
operator|-
literal|1
operator|||
name|idx
operator|-
name|start_of_digits_idx
operator|>
literal|3
operator|)
condition|)
return|return
literal|false
return|;
name|last_separator_idx
operator|=
name|idx
expr_stmt|;
operator|++
name|group_cnt
expr_stmt|;
comment|// don't add the group separator
operator|++
name|idx
expr_stmt|;
continue|continue;
block|}
elseif|else
if|if
condition|(
name|out
operator|==
literal|'.'
operator|||
name|out
operator|==
literal|'e'
operator|||
name|out
operator|==
literal|'E'
condition|)
block|{
comment|// Fail if more than one decimal point
if|if
condition|(
name|out
operator|==
literal|'.'
operator|&&
name|decpt_idx
operator|!=
operator|-
literal|1
condition|)
return|return
literal|false
return|;
if|if
condition|(
name|decpt_idx
operator|==
operator|-
literal|1
condition|)
name|decpt_idx
operator|=
name|idx
expr_stmt|;
comment|// check distance from the last separator
comment|// ### FIXME: Some locales allow other groupings! See https://en.wikipedia.org/wiki/Thousands_separator
if|if
condition|(
name|last_separator_idx
operator|!=
operator|-
literal|1
operator|&&
name|idx
operator|-
name|last_separator_idx
operator|!=
literal|4
condition|)
return|return
literal|false
return|;
comment|// stop processing separators
name|last_separator_idx
operator|=
operator|-
literal|1
expr_stmt|;
block|}
block|}
name|result
operator|->
name|append
argument_list|(
name|out
argument_list|)
expr_stmt|;
operator|++
name|idx
expr_stmt|;
block|}
if|if
condition|(
name|group_sep_mode
operator|==
name|ParseGroupSeparators
condition|)
block|{
comment|// group separator post-processing
comment|// did we end in a separator?
if|if
condition|(
name|last_separator_idx
operator|+
literal|1
operator|==
name|idx
condition|)
return|return
literal|false
return|;
comment|// were there enough digits since the last separator?
if|if
condition|(
name|last_separator_idx
operator|!=
operator|-
literal|1
operator|&&
name|idx
operator|-
name|last_separator_idx
operator|!=
literal|4
condition|)
return|return
literal|false
return|;
block|}
name|result
operator|->
name|append
argument_list|(
literal|'\0'
argument_list|)
expr_stmt|;
return|return
name|idx
operator|==
name|l
return|;
block|}
end_function
begin_function
DECL|function|validateChars
name|bool
name|QLocaleData
operator|::
name|validateChars
parameter_list|(
specifier|const
name|QString
modifier|&
name|str
parameter_list|,
name|NumberMode
name|numMode
parameter_list|,
name|QByteArray
modifier|*
name|buff
parameter_list|,
name|int
name|decDigits
parameter_list|,
name|bool
name|rejectGroupSeparators
parameter_list|)
specifier|const
block|{
name|buff
operator|->
name|clear
argument_list|()
expr_stmt|;
name|buff
operator|->
name|reserve
argument_list|(
name|str
operator|.
name|length
argument_list|()
argument_list|)
expr_stmt|;
specifier|const
name|bool
name|scientific
init|=
name|numMode
operator|==
name|DoubleScientificMode
decl_stmt|;
name|bool
name|lastWasE
init|=
literal|false
decl_stmt|;
name|bool
name|lastWasDigit
init|=
literal|false
decl_stmt|;
name|int
name|eCnt
init|=
literal|0
decl_stmt|;
name|int
name|decPointCnt
init|=
literal|0
decl_stmt|;
name|bool
name|dec
init|=
literal|false
decl_stmt|;
name|int
name|decDigitCnt
init|=
literal|0
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|str
operator|.
name|length
argument_list|()
condition|;
operator|++
name|i
control|)
block|{
name|char
name|c
init|=
name|digitToCLocale
argument_list|(
name|str
operator|.
name|at
argument_list|(
name|i
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
name|c
operator|>=
literal|'0'
operator|&&
name|c
operator|<=
literal|'9'
condition|)
block|{
if|if
condition|(
name|numMode
operator|!=
name|IntegerMode
condition|)
block|{
comment|// If a double has too many digits after decpt, it shall be Invalid.
if|if
condition|(
name|dec
operator|&&
name|decDigits
operator|!=
operator|-
literal|1
operator|&&
name|decDigits
operator|<
operator|++
name|decDigitCnt
condition|)
return|return
literal|false
return|;
block|}
name|lastWasDigit
operator|=
literal|true
expr_stmt|;
block|}
else|else
block|{
switch|switch
condition|(
name|c
condition|)
block|{
case|case
literal|'.'
case|:
if|if
condition|(
name|numMode
operator|==
name|IntegerMode
condition|)
block|{
comment|// If an integer has a decimal point, it shall be Invalid.
return|return
literal|false
return|;
block|}
else|else
block|{
comment|// If a double has more than one decimal point, it shall be Invalid.
if|if
condition|(
operator|++
name|decPointCnt
operator|>
literal|1
condition|)
return|return
literal|false
return|;
if|#
directive|if
literal|0
comment|// If a double with no decimal digits has a decimal point, it shall be
comment|// Invalid.
block|if (decDigits == 0)                             return false;
endif|#
directive|endif
comment|// On second thoughts, it shall be Valid.
name|dec
operator|=
literal|true
expr_stmt|;
block|}
break|break;
case|case
literal|'+'
case|:
case|case
literal|'-'
case|:
if|if
condition|(
name|scientific
condition|)
block|{
comment|// If a scientific has a sign that's not at the beginning or after
comment|// an 'e', it shall be Invalid.
if|if
condition|(
name|i
operator|!=
literal|0
operator|&&
operator|!
name|lastWasE
condition|)
return|return
literal|false
return|;
block|}
else|else
block|{
comment|// If a non-scientific has a sign that's not at the beginning,
comment|// it shall be Invalid.
if|if
condition|(
name|i
operator|!=
literal|0
condition|)
return|return
literal|false
return|;
block|}
break|break;
case|case
literal|','
case|:
comment|//it can only be placed after a digit which is before the decimal point
if|if
condition|(
name|rejectGroupSeparators
operator|||
operator|!
name|lastWasDigit
operator|||
name|decPointCnt
operator|>
literal|0
condition|)
return|return
literal|false
return|;
break|break;
case|case
literal|'e'
case|:
if|if
condition|(
name|scientific
condition|)
block|{
comment|// If a scientific has more than one 'e', it shall be Invalid.
if|if
condition|(
operator|++
name|eCnt
operator|>
literal|1
condition|)
return|return
literal|false
return|;
name|dec
operator|=
literal|false
expr_stmt|;
block|}
else|else
block|{
comment|// If a non-scientific has an 'e', it shall be Invalid.
return|return
literal|false
return|;
block|}
break|break;
default|default:
comment|// If it's not a valid digit, it shall be Invalid.
return|return
literal|false
return|;
block|}
name|lastWasDigit
operator|=
literal|false
expr_stmt|;
block|}
name|lastWasE
operator|=
name|c
operator|==
literal|'e'
expr_stmt|;
if|if
condition|(
name|c
operator|!=
literal|','
condition|)
name|buff
operator|->
name|append
argument_list|(
name|c
argument_list|)
expr_stmt|;
block|}
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|stringToDouble
name|double
name|QLocaleData
operator|::
name|stringToDouble
parameter_list|(
specifier|const
name|QChar
modifier|*
name|begin
parameter_list|,
name|int
name|len
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|GroupSeparatorMode
name|group_sep_mode
parameter_list|)
specifier|const
block|{
name|CharBuff
name|buff
decl_stmt|;
if|if
condition|(
operator|!
name|numberToCLocale
argument_list|(
name|begin
argument_list|,
name|len
argument_list|,
name|group_sep_mode
argument_list|,
operator|&
name|buff
argument_list|)
condition|)
block|{
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
return|return
literal|0.0
return|;
block|}
name|int
name|processed
init|=
literal|0
decl_stmt|;
name|bool
name|nonNullOk
init|=
literal|false
decl_stmt|;
name|double
name|d
init|=
name|asciiToDouble
argument_list|(
name|buff
operator|.
name|constData
argument_list|()
argument_list|,
name|buff
operator|.
name|length
argument_list|()
operator|-
literal|1
argument_list|,
name|nonNullOk
argument_list|,
name|processed
argument_list|)
decl_stmt|;
if|if
condition|(
name|ok
condition|)
operator|*
name|ok
operator|=
name|nonNullOk
expr_stmt|;
return|return
name|d
return|;
block|}
end_function
begin_function
DECL|function|stringToLongLong
name|qlonglong
name|QLocaleData
operator|::
name|stringToLongLong
parameter_list|(
specifier|const
name|QChar
modifier|*
name|begin
parameter_list|,
name|int
name|len
parameter_list|,
name|int
name|base
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|GroupSeparatorMode
name|group_sep_mode
parameter_list|)
specifier|const
block|{
name|CharBuff
name|buff
decl_stmt|;
if|if
condition|(
operator|!
name|numberToCLocale
argument_list|(
name|begin
argument_list|,
name|len
argument_list|,
name|group_sep_mode
argument_list|,
operator|&
name|buff
argument_list|)
condition|)
block|{
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|bytearrayToLongLong
argument_list|(
name|buff
operator|.
name|constData
argument_list|()
argument_list|,
name|base
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|stringToUnsLongLong
name|qulonglong
name|QLocaleData
operator|::
name|stringToUnsLongLong
parameter_list|(
specifier|const
name|QChar
modifier|*
name|begin
parameter_list|,
name|int
name|len
parameter_list|,
name|int
name|base
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|GroupSeparatorMode
name|group_sep_mode
parameter_list|)
specifier|const
block|{
name|CharBuff
name|buff
decl_stmt|;
if|if
condition|(
operator|!
name|numberToCLocale
argument_list|(
name|begin
argument_list|,
name|len
argument_list|,
name|group_sep_mode
argument_list|,
operator|&
name|buff
argument_list|)
condition|)
block|{
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|bytearrayToUnsLongLong
argument_list|(
name|buff
operator|.
name|constData
argument_list|()
argument_list|,
name|base
argument_list|,
name|ok
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|bytearrayToDouble
name|double
name|QLocaleData
operator|::
name|bytearrayToDouble
parameter_list|(
specifier|const
name|char
modifier|*
name|num
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|bool
modifier|*
name|overflow
parameter_list|)
block|{
name|bool
name|nonNullOk
init|=
literal|false
decl_stmt|;
name|int
name|len
init|=
cast|static_cast
argument_list|<
name|int
argument_list|>
argument_list|(
name|strlen
argument_list|(
name|num
argument_list|)
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|len
operator|>=
literal|0
argument_list|)
expr_stmt|;
name|int
name|processed
init|=
literal|0
decl_stmt|;
name|double
name|d
init|=
name|asciiToDouble
argument_list|(
name|num
argument_list|,
name|len
argument_list|,
name|nonNullOk
argument_list|,
name|processed
argument_list|)
decl_stmt|;
if|if
condition|(
name|ok
condition|)
operator|*
name|ok
operator|=
name|nonNullOk
expr_stmt|;
if|if
condition|(
name|overflow
condition|)
operator|*
name|overflow
operator|=
name|processed
operator|<
name|len
expr_stmt|;
return|return
name|d
return|;
block|}
end_function
begin_function
DECL|function|bytearrayToLongLong
name|qlonglong
name|QLocaleData
operator|::
name|bytearrayToLongLong
parameter_list|(
specifier|const
name|char
modifier|*
name|num
parameter_list|,
name|int
name|base
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|bool
modifier|*
name|overflow
parameter_list|)
block|{
name|bool
name|_ok
decl_stmt|;
specifier|const
name|char
modifier|*
name|endptr
decl_stmt|;
if|if
condition|(
operator|*
name|num
operator|==
literal|'\0'
condition|)
block|{
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
if|if
condition|(
name|overflow
operator|!=
literal|0
condition|)
operator|*
name|overflow
operator|=
literal|false
expr_stmt|;
return|return
literal|0
return|;
block|}
name|qlonglong
name|l
init|=
name|qstrtoll
argument_list|(
name|num
argument_list|,
operator|&
name|endptr
argument_list|,
name|base
argument_list|,
operator|&
name|_ok
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|_ok
condition|)
block|{
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
if|if
condition|(
name|overflow
operator|!=
literal|0
condition|)
block|{
comment|// the only way qstrtoll can fail with *endptr != '\0' on a non-empty
comment|// input string is overflow
operator|*
name|overflow
operator|=
operator|*
name|endptr
operator|!=
literal|'\0'
expr_stmt|;
block|}
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|*
name|endptr
operator|!=
literal|'\0'
condition|)
block|{
comment|// we stopped at a non-digit character after converting some digits
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
if|if
condition|(
name|overflow
operator|!=
literal|0
condition|)
operator|*
name|overflow
operator|=
literal|false
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|overflow
operator|!=
literal|0
condition|)
operator|*
name|overflow
operator|=
literal|false
expr_stmt|;
return|return
name|l
return|;
block|}
end_function
begin_function
DECL|function|bytearrayToUnsLongLong
name|qulonglong
name|QLocaleData
operator|::
name|bytearrayToUnsLongLong
parameter_list|(
specifier|const
name|char
modifier|*
name|num
parameter_list|,
name|int
name|base
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|)
block|{
name|bool
name|_ok
decl_stmt|;
specifier|const
name|char
modifier|*
name|endptr
decl_stmt|;
name|qulonglong
name|l
init|=
name|qstrtoull
argument_list|(
name|num
argument_list|,
operator|&
name|endptr
argument_list|,
name|base
argument_list|,
operator|&
name|_ok
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|_ok
operator|||
operator|*
name|endptr
operator|!=
literal|'\0'
condition|)
block|{
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|false
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|ok
operator|!=
literal|0
condition|)
operator|*
name|ok
operator|=
literal|true
expr_stmt|;
return|return
name|l
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      \enum QLocale::CurrencySymbolFormat      Specifies the format of the currency symbol.      \value CurrencyIsoCode a ISO-4217 code of the currency.     \value CurrencySymbol a currency symbol.     \value CurrencyDisplayName a user readable name of the currency. */
end_comment
begin_comment
comment|/*!     \since 4.8     Returns a currency symbol according to the \a format. */
end_comment
begin_function
DECL|function|currencySymbol
name|QString
name|QLocale
operator|::
name|currencySymbol
parameter_list|(
name|QLocale
operator|::
name|CurrencySymbolFormat
name|format
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|CurrencySymbol
argument_list|,
name|format
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
name|quint32
name|idx
decl_stmt|,
name|size
decl_stmt|;
switch|switch
condition|(
name|format
condition|)
block|{
case|case
name|CurrencySymbol
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_symbol_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_symbol_size
expr_stmt|;
return|return
name|getLocaleData
argument_list|(
name|currency_symbol_data
operator|+
name|idx
argument_list|,
name|size
argument_list|)
return|;
case|case
name|CurrencyDisplayName
case|:
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_display_name_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_display_name_size
expr_stmt|;
return|return
name|getLocaleListData
argument_list|(
name|currency_display_name_data
operator|+
name|idx
argument_list|,
name|size
argument_list|,
literal|0
argument_list|)
return|;
case|case
name|CurrencyIsoCode
case|:
block|{
name|int
name|len
init|=
literal|0
decl_stmt|;
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|this
operator|->
name|d
operator|->
name|m_data
decl_stmt|;
for|for
control|(
init|;
name|len
operator|<
literal|3
condition|;
operator|++
name|len
control|)
if|if
condition|(
operator|!
name|data
operator|->
name|m_currency_iso_code
index|[
name|len
index|]
condition|)
break|break;
return|return
name|len
condition|?
name|QString
operator|::
name|fromLatin1
argument_list|(
name|data
operator|->
name|m_currency_iso_code
argument_list|,
name|len
argument_list|)
else|:
name|QString
argument_list|()
return|;
block|}
block|}
return|return
name|QString
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a localized string representation of \a value as a currency.     If the \a symbol is provided it is used instead of the default currency symbol.      \sa currencySymbol() */
end_comment
begin_function
DECL|function|toCurrencyString
name|QString
name|QLocale
operator|::
name|toCurrencyString
parameter_list|(
name|qlonglong
name|value
parameter_list|,
specifier|const
name|QString
modifier|&
name|symbol
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QSystemLocale
operator|::
name|CurrencyToStringArgument
name|arg
argument_list|(
name|value
argument_list|,
name|symbol
argument_list|)
decl_stmt|;
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|CurrencyToString
argument_list|,
name|QVariant
operator|::
name|fromValue
argument_list|(
name|arg
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
specifier|const
name|QLocalePrivate
modifier|*
name|d
init|=
name|this
operator|->
name|d
decl_stmt|;
name|quint8
name|idx
init|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_format_idx
decl_stmt|;
name|quint8
name|size
init|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_format_size
decl_stmt|;
if|if
condition|(
name|d
operator|->
name|m_data
operator|->
name|m_currency_negative_format_size
operator|&&
name|value
operator|<
literal|0
condition|)
block|{
name|idx
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_negative_format_idx
expr_stmt|;
name|size
operator|=
name|d
operator|->
name|m_data
operator|->
name|m_currency_negative_format_size
expr_stmt|;
name|value
operator|=
operator|-
name|value
expr_stmt|;
block|}
name|QString
name|str
init|=
name|toString
argument_list|(
name|value
argument_list|)
decl_stmt|;
name|QString
name|sym
init|=
name|symbol
operator|.
name|isNull
argument_list|()
condition|?
name|currencySymbol
argument_list|()
else|:
name|symbol
decl_stmt|;
if|if
condition|(
name|sym
operator|.
name|isEmpty
argument_list|()
condition|)
name|sym
operator|=
name|currencySymbol
argument_list|(
name|QLocale
operator|::
name|CurrencyIsoCode
argument_list|)
expr_stmt|;
name|QString
name|format
init|=
name|getLocaleData
argument_list|(
name|currency_format_data
operator|+
name|idx
argument_list|,
name|size
argument_list|)
decl_stmt|;
return|return
name|format
operator|.
name|arg
argument_list|(
name|str
argument_list|,
name|sym
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8     \overload */
end_comment
begin_function
DECL|function|toCurrencyString
name|QString
name|QLocale
operator|::
name|toCurrencyString
parameter_list|(
name|qulonglong
name|value
parameter_list|,
specifier|const
name|QString
modifier|&
name|symbol
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QSystemLocale
operator|::
name|CurrencyToStringArgument
name|arg
argument_list|(
name|value
argument_list|,
name|symbol
argument_list|)
decl_stmt|;
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|CurrencyToString
argument_list|,
name|QVariant
operator|::
name|fromValue
argument_list|(
name|arg
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|this
operator|->
name|d
operator|->
name|m_data
decl_stmt|;
name|quint8
name|idx
init|=
name|data
operator|->
name|m_currency_format_idx
decl_stmt|;
name|quint8
name|size
init|=
name|data
operator|->
name|m_currency_format_size
decl_stmt|;
name|QString
name|str
init|=
name|toString
argument_list|(
name|value
argument_list|)
decl_stmt|;
name|QString
name|sym
init|=
name|symbol
operator|.
name|isNull
argument_list|()
condition|?
name|currencySymbol
argument_list|()
else|:
name|symbol
decl_stmt|;
if|if
condition|(
name|sym
operator|.
name|isEmpty
argument_list|()
condition|)
name|sym
operator|=
name|currencySymbol
argument_list|(
name|QLocale
operator|::
name|CurrencyIsoCode
argument_list|)
expr_stmt|;
name|QString
name|format
init|=
name|getLocaleData
argument_list|(
name|currency_format_data
operator|+
name|idx
argument_list|,
name|size
argument_list|)
decl_stmt|;
return|return
name|format
operator|.
name|arg
argument_list|(
name|str
argument_list|,
name|sym
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8     \overload */
end_comment
begin_function
DECL|function|toCurrencyString
name|QString
name|QLocale
operator|::
name|toCurrencyString
parameter_list|(
name|double
name|value
parameter_list|,
specifier|const
name|QString
modifier|&
name|symbol
parameter_list|)
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QSystemLocale
operator|::
name|CurrencyToStringArgument
name|arg
argument_list|(
name|value
argument_list|,
name|symbol
argument_list|)
decl_stmt|;
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|CurrencyToString
argument_list|,
name|QVariant
operator|::
name|fromValue
argument_list|(
name|arg
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
specifier|const
name|QLocaleData
modifier|*
name|data
init|=
name|this
operator|->
name|d
operator|->
name|m_data
decl_stmt|;
name|quint8
name|idx
init|=
name|data
operator|->
name|m_currency_format_idx
decl_stmt|;
name|quint8
name|size
init|=
name|data
operator|->
name|m_currency_format_size
decl_stmt|;
if|if
condition|(
name|data
operator|->
name|m_currency_negative_format_size
operator|&&
name|value
operator|<
literal|0
condition|)
block|{
name|idx
operator|=
name|data
operator|->
name|m_currency_negative_format_idx
expr_stmt|;
name|size
operator|=
name|data
operator|->
name|m_currency_negative_format_size
expr_stmt|;
name|value
operator|=
operator|-
name|value
expr_stmt|;
block|}
name|QString
name|str
init|=
name|toString
argument_list|(
name|value
argument_list|,
literal|'f'
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_currency_digits
argument_list|)
decl_stmt|;
name|QString
name|sym
init|=
name|symbol
operator|.
name|isNull
argument_list|()
condition|?
name|currencySymbol
argument_list|()
else|:
name|symbol
decl_stmt|;
if|if
condition|(
name|sym
operator|.
name|isEmpty
argument_list|()
condition|)
name|sym
operator|=
name|currencySymbol
argument_list|(
name|QLocale
operator|::
name|CurrencyIsoCode
argument_list|)
expr_stmt|;
name|QString
name|format
init|=
name|getLocaleData
argument_list|(
name|currency_format_data
operator|+
name|idx
argument_list|,
name|size
argument_list|)
decl_stmt|;
return|return
name|format
operator|.
name|arg
argument_list|(
name|str
argument_list|,
name|sym
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns an ordered list of locale names for translation purposes in     preference order (like "en-Latn-US", "en-US", "en").      The return value represents locale names that the user expects to see the     UI translation in.      Most like you do not need to use this function directly, but just pass the     QLocale object to the QTranslator::load() function.      The first item in the list is the most preferred one.      \sa QTranslator, bcp47Name() */
end_comment
begin_function
DECL|function|uiLanguages
name|QStringList
name|QLocale
operator|::
name|uiLanguages
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|UILanguages
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
block|{
name|QStringList
name|result
init|=
name|res
operator|.
name|toStringList
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|result
operator|.
name|isEmpty
argument_list|()
condition|)
return|return
name|result
return|;
block|}
block|}
endif|#
directive|endif
name|QLocaleId
name|id
init|=
name|QLocaleId
operator|::
name|fromIds
argument_list|(
name|d
operator|->
name|m_data
operator|->
name|m_language_id
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_script_id
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_country_id
argument_list|)
decl_stmt|;
specifier|const
name|QLocaleId
name|max
init|=
name|id
operator|.
name|withLikelySubtagsAdded
argument_list|()
decl_stmt|;
specifier|const
name|QLocaleId
name|min
init|=
name|max
operator|.
name|withLikelySubtagsRemoved
argument_list|()
decl_stmt|;
name|QStringList
name|uiLanguages
decl_stmt|;
name|uiLanguages
operator|.
name|append
argument_list|(
name|QString
operator|::
name|fromLatin1
argument_list|(
name|min
operator|.
name|name
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|.
name|script_id
condition|)
block|{
name|id
operator|.
name|script_id
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|id
operator|!=
name|min
operator|&&
name|id
operator|.
name|withLikelySubtagsAdded
argument_list|()
operator|==
name|max
condition|)
name|uiLanguages
operator|.
name|append
argument_list|(
name|QString
operator|::
name|fromLatin1
argument_list|(
name|id
operator|.
name|name
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|max
operator|!=
name|min
operator|&&
name|max
operator|!=
name|id
condition|)
name|uiLanguages
operator|.
name|append
argument_list|(
name|QString
operator|::
name|fromLatin1
argument_list|(
name|max
operator|.
name|name
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|uiLanguages
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a native name of the language for the locale. For example     "SchwiizertÃ¼Ã¼tsch" for Swiss-German locale.      \sa nativeCountryName(), languageToString() */
end_comment
begin_function
DECL|function|nativeLanguageName
name|QString
name|QLocale
operator|::
name|nativeLanguageName
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|NativeLanguageName
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
return|return
name|getLocaleData
argument_list|(
name|endonyms_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_language_endonym_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_language_endonym_size
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.8      Returns a native name of the country for the locale. For example     "EspaÃ±a" for Spanish/Spain locale.      \sa nativeLanguageName(), countryToString() */
end_comment
begin_function
DECL|function|nativeCountryName
name|QString
name|QLocale
operator|::
name|nativeCountryName
parameter_list|()
specifier|const
block|{
ifndef|#
directive|ifndef
name|QT_NO_SYSTEMLOCALE
if|if
condition|(
name|d
operator|->
name|m_data
operator|==
name|systemData
argument_list|()
condition|)
block|{
name|QVariant
name|res
init|=
name|systemLocale
argument_list|()
operator|->
name|query
argument_list|(
name|QSystemLocale
operator|::
name|NativeCountryName
argument_list|,
name|QVariant
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|res
operator|.
name|isNull
argument_list|()
condition|)
return|return
name|res
operator|.
name|toString
argument_list|()
return|;
block|}
endif|#
directive|endif
return|return
name|getLocaleData
argument_list|(
name|endonyms_data
operator|+
name|d
operator|->
name|m_data
operator|->
name|m_country_endonym_idx
argument_list|,
name|d
operator|->
name|m_data
operator|->
name|m_country_endonym_size
argument_list|)
return|;
block|}
end_function
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_DEBUG_STREAM
end_ifndef
begin_function
DECL|function|operator <<
name|QDebug
name|operator
name|<<
parameter_list|(
name|QDebug
name|dbg
parameter_list|,
specifier|const
name|QLocale
modifier|&
name|l
parameter_list|)
block|{
name|QDebugStateSaver
name|saver
argument_list|(
name|dbg
argument_list|)
decl_stmt|;
name|dbg
operator|.
name|nospace
argument_list|()
operator|.
name|noquote
argument_list|()
operator|<<
literal|"QLocale("
operator|<<
name|QLocale
operator|::
name|languageToString
argument_list|(
name|l
operator|.
name|language
argument_list|()
argument_list|)
operator|<<
literal|", "
operator|<<
name|QLocale
operator|::
name|scriptToString
argument_list|(
name|l
operator|.
name|script
argument_list|()
argument_list|)
operator|<<
literal|", "
operator|<<
name|QLocale
operator|::
name|countryToString
argument_list|(
name|l
operator|.
name|country
argument_list|()
argument_list|)
operator|<<
literal|')'
expr_stmt|;
return|return
name|dbg
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_macro
name|QT_END_NAMESPACE
end_macro
end_unit
