begin_unit
begin_comment
comment|/* $Id: tif_codec.c,v 1.10.2.1 2008-12-18 19:50:41 fwarmerdam Exp $ */
end_comment
begin_comment
comment|/*  * Copyright (c) 1988-1997 Sam Leffler  * Copyright (c) 1991-1997 Silicon Graphics, Inc.  *  * Permission to use, copy, modify, distribute, and sell this software and   * its documentation for any purpose is hereby granted without fee, provided  * that (i) the above copyright notices and this permission notice appear in  * all copies of the software and related documentation, and (ii) the names of  * Sam Leffler and Silicon Graphics may not be used in any advertising or  * publicity relating to the software without the specific, prior written  * permission of Sam Leffler and Silicon Graphics.  *   * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,   * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY   * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.    *   * IN NO EVENT SHALL SAM LEFFLER OR SILICON GRAPHICS BE LIABLE FOR  * ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,  * OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,  * WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF   * LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE   * OF THIS SOFTWARE.  */
end_comment
begin_comment
comment|/*  * TIFF Library  *  * Builtin Compression Scheme Configuration Support.  */
end_comment
begin_include
include|#
directive|include
file|"tiffiop.h"
end_include
begin_function_decl
specifier|static
name|int
name|NotConfigured
parameter_list|(
name|TIFF
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl
begin_ifndef
ifndef|#
directive|ifndef
name|LZW_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitLZW
define|#
directive|define
name|TIFFInitLZW
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|PACKBITS_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitPackBits
define|#
directive|define
name|TIFFInitPackBits
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|THUNDER_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitThunderScan
define|#
directive|define
name|TIFFInitThunderScan
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|NEXT_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitNeXT
define|#
directive|define
name|TIFFInitNeXT
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|JPEG_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitJPEG
define|#
directive|define
name|TIFFInitJPEG
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|OJPEG_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitOJPEG
define|#
directive|define
name|TIFFInitOJPEG
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|CCITT_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitCCITTRLE
define|#
directive|define
name|TIFFInitCCITTRLE
value|NotConfigured
end_define
begin_define
DECL|macro|TIFFInitCCITTRLEW
define|#
directive|define
name|TIFFInitCCITTRLEW
value|NotConfigured
end_define
begin_define
DECL|macro|TIFFInitCCITTFax3
define|#
directive|define
name|TIFFInitCCITTFax3
value|NotConfigured
end_define
begin_define
DECL|macro|TIFFInitCCITTFax4
define|#
directive|define
name|TIFFInitCCITTFax4
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|JBIG_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitJBIG
define|#
directive|define
name|TIFFInitJBIG
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|ZIP_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitZIP
define|#
directive|define
name|TIFFInitZIP
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|PIXARLOG_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitPixarLog
define|#
directive|define
name|TIFFInitPixarLog
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|LOGLUV_SUPPORT
end_ifndef
begin_define
DECL|macro|TIFFInitSGILog
define|#
directive|define
name|TIFFInitSGILog
value|NotConfigured
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*  * Compression schemes statically built into the library.  */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|VMS
end_ifdef
begin_decl_stmt
DECL|variable|_TIFFBuiltinCODECS
specifier|const
name|TIFFCodec
name|_TIFFBuiltinCODECS
index|[]
init|=
block|{
else|#
directive|else
name|TIFFCodec
name|_TIFFBuiltinCODECS
index|[]
operator|=
block|{
endif|#
directive|endif
block|{
literal|"None"
block|,
name|COMPRESSION_NONE
block|,
name|TIFFInitDumpMode
block|}
block|,
block|{
literal|"LZW"
block|,
name|COMPRESSION_LZW
block|,
name|TIFFInitLZW
block|}
block|,
block|{
literal|"PackBits"
block|,
name|COMPRESSION_PACKBITS
block|,
name|TIFFInitPackBits
block|}
block|,
block|{
literal|"ThunderScan"
block|,
name|COMPRESSION_THUNDERSCAN
block|,
name|TIFFInitThunderScan
block|}
block|,
block|{
literal|"NeXT"
block|,
name|COMPRESSION_NEXT
block|,
name|TIFFInitNeXT
block|}
block|,
block|{
literal|"JPEG"
block|,
name|COMPRESSION_JPEG
block|,
name|TIFFInitJPEG
block|}
block|,
block|{
literal|"Old-style JPEG"
block|,
name|COMPRESSION_OJPEG
block|,
name|TIFFInitOJPEG
block|}
block|,
block|{
literal|"CCITT RLE"
block|,
name|COMPRESSION_CCITTRLE
block|,
name|TIFFInitCCITTRLE
block|}
block|,
block|{
literal|"CCITT RLE/W"
block|,
name|COMPRESSION_CCITTRLEW
block|,
name|TIFFInitCCITTRLEW
block|}
block|,
block|{
literal|"CCITT Group 3"
block|,
name|COMPRESSION_CCITTFAX3
block|,
name|TIFFInitCCITTFax3
block|}
block|,
block|{
literal|"CCITT Group 4"
block|,
name|COMPRESSION_CCITTFAX4
block|,
name|TIFFInitCCITTFax4
block|}
block|,
block|{
literal|"ISO JBIG"
block|,
name|COMPRESSION_JBIG
block|,
name|TIFFInitJBIG
block|}
block|,
block|{
literal|"Deflate"
block|,
name|COMPRESSION_DEFLATE
block|,
name|TIFFInitZIP
block|}
block|,
block|{
literal|"AdobeDeflate"
block|,
name|COMPRESSION_ADOBE_DEFLATE
block|,
name|TIFFInitZIP
block|}
block|,
block|{
literal|"PixarLog"
block|,
name|COMPRESSION_PIXARLOG
block|,
name|TIFFInitPixarLog
block|}
block|,
block|{
literal|"SGILog"
block|,
name|COMPRESSION_SGILOG
block|,
name|TIFFInitSGILog
block|}
block|,
block|{
literal|"SGILog24"
block|,
name|COMPRESSION_SGILOG24
block|,
name|TIFFInitSGILog
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|}
block|}
block|;
specifier|static
name|int
DECL|function|_notConfigured
name|_notConfigured
argument_list|(
argument|TIFF* tif
argument_list|)
block|{
specifier|const
name|TIFFCodec
operator|*
name|c
operator|=
name|TIFFFindCODEC
argument_list|(
name|tif
operator|->
name|tif_dir
operator|.
name|td_compression
argument_list|)
block|;
name|char
name|compression_code
index|[
literal|20
index|]
block|;
name|sprintf
argument_list|(
name|compression_code
argument_list|,
literal|"%d"
argument_list|,
name|tif
operator|->
name|tif_dir
operator|.
name|td_compression
argument_list|)
block|;
name|TIFFErrorExt
argument_list|(
name|tif
operator|->
name|tif_clientdata
argument_list|,
name|tif
operator|->
name|tif_name
argument_list|,
literal|"%s compression support is not configured"
argument_list|,
name|c
condition|?
name|c
operator|->
name|name
else|:
name|compression_code
argument_list|)
block|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
specifier|static
name|int
DECL|function|NotConfigured
name|NotConfigured
argument_list|(
argument|TIFF* tif
argument_list|,
argument|int scheme
argument_list|)
block|{
operator|(
name|void
operator|)
name|scheme
block|;
name|tif
operator|->
name|tif_decodestatus
operator|=
name|FALSE
block|;
name|tif
operator|->
name|tif_setupdecode
operator|=
name|_notConfigured
block|;
name|tif
operator|->
name|tif_encodestatus
operator|=
name|FALSE
block|;
name|tif
operator|->
name|tif_setupencode
operator|=
name|_notConfigured
block|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
comment|/************************************************************************/
comment|/*                       TIFFIsCODECConfigured()                        */
comment|/************************************************************************/
comment|/**  * Check whether we have working codec for the specific coding scheme.  *   * @return returns 1 if the codec is configured and working. Otherwise  * 0 will be returned.  */
name|int
DECL|function|TIFFIsCODECConfigured
name|TIFFIsCODECConfigured
argument_list|(
argument|uint16 scheme
argument_list|)
block|{
specifier|const
name|TIFFCodec
operator|*
name|codec
operator|=
name|TIFFFindCODEC
argument_list|(
name|scheme
argument_list|)
block|;
if|if
condition|(
name|codec
operator|==
name|NULL
condition|)
block|{
return|return
literal|0
return|;
block|}
if|if
condition|(
name|codec
operator|->
name|init
operator|==
name|NULL
condition|)
block|{
return|return
literal|0
return|;
block|}
if|if
condition|(
name|codec
operator|->
name|init
operator|!=
name|NotConfigured
condition|)
block|{
return|return
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_decl_stmt
end_unit
