begin_unit
begin_comment
comment|/***************************************************************************/
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*  ftlcdfil.c                                                             */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*    FreeType API for color filtering of subpixel bitmap glyphs (body).   */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*  Copyright 2006, 2008-2010, 2013, 2014 by                               */
end_comment
begin_comment
comment|/*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*  This file is part of the FreeType project, and may only be used,       */
end_comment
begin_comment
comment|/*  modified, and distributed under the terms of the FreeType project      */
end_comment
begin_comment
comment|/*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */
end_comment
begin_comment
comment|/*  this file you indicate that you have read the license and              */
end_comment
begin_comment
comment|/*  understand and accept it fully.                                        */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/***************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<ft2build.h>
end_include
begin_include
include|#
directive|include
include|FT_INTERNAL_DEBUG_H
end_include
begin_include
include|#
directive|include
include|FT_LCD_FILTER_H
end_include
begin_include
include|#
directive|include
include|FT_IMAGE_H
end_include
begin_include
include|#
directive|include
include|FT_INTERNAL_OBJECTS_H
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|FT_CONFIG_OPTION_SUBPIXEL_RENDERING
end_ifdef
begin_comment
comment|/* define USE_LEGACY to implement the legacy filter */
end_comment
begin_define
DECL|macro|USE_LEGACY
define|#
directive|define
name|USE_LEGACY
end_define
begin_comment
comment|/* FIR filter used by the default and light filters */
end_comment
begin_function
specifier|static
name|void
DECL|function|_ft_lcd_filter_fir
name|_ft_lcd_filter_fir
parameter_list|(
name|FT_Bitmap
modifier|*
name|bitmap
parameter_list|,
name|FT_Render_Mode
name|mode
parameter_list|,
name|FT_Library
name|library
parameter_list|)
block|{
name|FT_Byte
modifier|*
name|weights
init|=
name|library
operator|->
name|lcd_weights
decl_stmt|;
name|FT_UInt
name|width
init|=
operator|(
name|FT_UInt
operator|)
name|bitmap
operator|->
name|width
decl_stmt|;
name|FT_UInt
name|height
init|=
operator|(
name|FT_UInt
operator|)
name|bitmap
operator|->
name|rows
decl_stmt|;
comment|/* horizontal in-place FIR filter */
if|if
condition|(
name|mode
operator|==
name|FT_RENDER_MODE_LCD
operator|&&
name|width
operator|>=
literal|4
condition|)
block|{
name|FT_Byte
modifier|*
name|line
init|=
name|bitmap
operator|->
name|buffer
decl_stmt|;
comment|/* take care of bitmap flow */
if|if
condition|(
name|bitmap
operator|->
name|pitch
operator|<
literal|0
condition|)
name|line
operator|-=
name|bitmap
operator|->
name|pitch
operator|*
operator|(
name|bitmap
operator|->
name|rows
operator|-
literal|1
operator|)
expr_stmt|;
comment|/* `fir' and `pix' must be at least 32 bit wide, since the sum of */
comment|/* the values in `weights' can exceed 0xFF                        */
for|for
control|(
init|;
name|height
operator|>
literal|0
condition|;
name|height
operator|--
operator|,
name|line
operator|+=
name|bitmap
operator|->
name|pitch
control|)
block|{
name|FT_UInt
name|fir
index|[
literal|4
index|]
decl_stmt|;
comment|/* below, `pix' is used as the 5th element */
name|FT_UInt
name|val1
decl_stmt|,
name|xx
decl_stmt|;
name|val1
operator|=
name|line
index|[
literal|0
index|]
expr_stmt|;
name|fir
index|[
literal|0
index|]
operator|=
name|weights
index|[
literal|2
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|1
index|]
operator|=
name|weights
index|[
literal|3
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|2
index|]
operator|=
name|weights
index|[
literal|4
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|3
index|]
operator|=
literal|0
expr_stmt|;
name|val1
operator|=
name|line
index|[
literal|1
index|]
expr_stmt|;
name|fir
index|[
literal|0
index|]
operator|+=
name|weights
index|[
literal|1
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|1
index|]
operator|+=
name|weights
index|[
literal|2
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|2
index|]
operator|+=
name|weights
index|[
literal|3
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|3
index|]
operator|+=
name|weights
index|[
literal|4
index|]
operator|*
name|val1
expr_stmt|;
for|for
control|(
name|xx
operator|=
literal|2
init|;
name|xx
operator|<
name|width
condition|;
name|xx
operator|++
control|)
block|{
name|FT_UInt
name|val
decl_stmt|,
name|pix
decl_stmt|;
name|val
operator|=
name|line
index|[
name|xx
index|]
expr_stmt|;
name|pix
operator|=
name|fir
index|[
literal|0
index|]
operator|+
name|weights
index|[
literal|0
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|0
index|]
operator|=
name|fir
index|[
literal|1
index|]
operator|+
name|weights
index|[
literal|1
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|1
index|]
operator|=
name|fir
index|[
literal|2
index|]
operator|+
name|weights
index|[
literal|2
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|2
index|]
operator|=
name|fir
index|[
literal|3
index|]
operator|+
name|weights
index|[
literal|3
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|3
index|]
operator|=
name|weights
index|[
literal|4
index|]
operator|*
name|val
expr_stmt|;
name|pix
operator|>>=
literal|8
expr_stmt|;
name|pix
operator||=
operator|(
name|FT_UInt
operator|)
operator|-
call|(
name|FT_Int
call|)
argument_list|(
name|pix
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|line
index|[
name|xx
operator|-
literal|2
index|]
operator|=
operator|(
name|FT_Byte
operator|)
name|pix
expr_stmt|;
block|}
block|{
name|FT_UInt
name|pix
decl_stmt|;
name|pix
operator|=
name|fir
index|[
literal|0
index|]
operator|>>
literal|8
expr_stmt|;
name|pix
operator||=
operator|(
name|FT_UInt
operator|)
operator|-
call|(
name|FT_Int
call|)
argument_list|(
name|pix
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|line
index|[
name|xx
operator|-
literal|2
index|]
operator|=
operator|(
name|FT_Byte
operator|)
name|pix
expr_stmt|;
name|pix
operator|=
name|fir
index|[
literal|1
index|]
operator|>>
literal|8
expr_stmt|;
name|pix
operator||=
operator|(
name|FT_UInt
operator|)
operator|-
call|(
name|FT_Int
call|)
argument_list|(
name|pix
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|line
index|[
name|xx
operator|-
literal|1
index|]
operator|=
operator|(
name|FT_Byte
operator|)
name|pix
expr_stmt|;
block|}
block|}
block|}
comment|/* vertical in-place FIR filter */
elseif|else
if|if
condition|(
name|mode
operator|==
name|FT_RENDER_MODE_LCD_V
operator|&&
name|height
operator|>=
literal|4
condition|)
block|{
name|FT_Byte
modifier|*
name|column
init|=
name|bitmap
operator|->
name|buffer
decl_stmt|;
name|FT_Int
name|pitch
init|=
name|bitmap
operator|->
name|pitch
decl_stmt|;
comment|/* take care of bitmap flow */
if|if
condition|(
name|bitmap
operator|->
name|pitch
operator|<
literal|0
condition|)
name|column
operator|-=
name|bitmap
operator|->
name|pitch
operator|*
operator|(
name|bitmap
operator|->
name|rows
operator|-
literal|1
operator|)
expr_stmt|;
for|for
control|(
init|;
name|width
operator|>
literal|0
condition|;
name|width
operator|--
operator|,
name|column
operator|++
control|)
block|{
name|FT_Byte
modifier|*
name|col
init|=
name|column
decl_stmt|;
name|FT_UInt
name|fir
index|[
literal|4
index|]
decl_stmt|;
comment|/* below, `pix' is used as the 5th element */
name|FT_UInt
name|val1
decl_stmt|,
name|yy
decl_stmt|;
name|val1
operator|=
name|col
index|[
literal|0
index|]
expr_stmt|;
name|fir
index|[
literal|0
index|]
operator|=
name|weights
index|[
literal|2
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|1
index|]
operator|=
name|weights
index|[
literal|3
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|2
index|]
operator|=
name|weights
index|[
literal|4
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|3
index|]
operator|=
literal|0
expr_stmt|;
name|col
operator|+=
name|pitch
expr_stmt|;
name|val1
operator|=
name|col
index|[
literal|0
index|]
expr_stmt|;
name|fir
index|[
literal|0
index|]
operator|+=
name|weights
index|[
literal|1
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|1
index|]
operator|+=
name|weights
index|[
literal|2
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|2
index|]
operator|+=
name|weights
index|[
literal|3
index|]
operator|*
name|val1
expr_stmt|;
name|fir
index|[
literal|3
index|]
operator|+=
name|weights
index|[
literal|4
index|]
operator|*
name|val1
expr_stmt|;
name|col
operator|+=
name|pitch
expr_stmt|;
for|for
control|(
name|yy
operator|=
literal|2
init|;
name|yy
operator|<
name|height
condition|;
name|yy
operator|++
control|)
block|{
name|FT_UInt
name|val
decl_stmt|,
name|pix
decl_stmt|;
name|val
operator|=
name|col
index|[
literal|0
index|]
expr_stmt|;
name|pix
operator|=
name|fir
index|[
literal|0
index|]
operator|+
name|weights
index|[
literal|0
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|0
index|]
operator|=
name|fir
index|[
literal|1
index|]
operator|+
name|weights
index|[
literal|1
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|1
index|]
operator|=
name|fir
index|[
literal|2
index|]
operator|+
name|weights
index|[
literal|2
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|2
index|]
operator|=
name|fir
index|[
literal|3
index|]
operator|+
name|weights
index|[
literal|3
index|]
operator|*
name|val
expr_stmt|;
name|fir
index|[
literal|3
index|]
operator|=
name|weights
index|[
literal|4
index|]
operator|*
name|val
expr_stmt|;
name|pix
operator|>>=
literal|8
expr_stmt|;
name|pix
operator||=
operator|(
name|FT_UInt
operator|)
operator|-
call|(
name|FT_Int
call|)
argument_list|(
name|pix
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|col
index|[
operator|-
literal|2
operator|*
name|pitch
index|]
operator|=
operator|(
name|FT_Byte
operator|)
name|pix
expr_stmt|;
name|col
operator|+=
name|pitch
expr_stmt|;
block|}
block|{
name|FT_UInt
name|pix
decl_stmt|;
name|pix
operator|=
name|fir
index|[
literal|0
index|]
operator|>>
literal|8
expr_stmt|;
name|pix
operator||=
operator|(
name|FT_UInt
operator|)
operator|-
call|(
name|FT_Int
call|)
argument_list|(
name|pix
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|col
index|[
operator|-
literal|2
operator|*
name|pitch
index|]
operator|=
operator|(
name|FT_Byte
operator|)
name|pix
expr_stmt|;
name|pix
operator|=
name|fir
index|[
literal|1
index|]
operator|>>
literal|8
expr_stmt|;
name|pix
operator||=
operator|(
name|FT_UInt
operator|)
operator|-
call|(
name|FT_Int
call|)
argument_list|(
name|pix
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|col
index|[
operator|-
name|pitch
index|]
operator|=
operator|(
name|FT_Byte
operator|)
name|pix
expr_stmt|;
block|}
block|}
block|}
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|USE_LEGACY
end_ifdef
begin_comment
comment|/* intra-pixel filter used by the legacy filter */
end_comment
begin_function
specifier|static
name|void
DECL|function|_ft_lcd_filter_legacy
name|_ft_lcd_filter_legacy
parameter_list|(
name|FT_Bitmap
modifier|*
name|bitmap
parameter_list|,
name|FT_Render_Mode
name|mode
parameter_list|,
name|FT_Library
name|library
parameter_list|)
block|{
name|FT_UInt
name|width
init|=
operator|(
name|FT_UInt
operator|)
name|bitmap
operator|->
name|width
decl_stmt|;
name|FT_UInt
name|height
init|=
operator|(
name|FT_UInt
operator|)
name|bitmap
operator|->
name|rows
decl_stmt|;
name|FT_Int
name|pitch
init|=
name|bitmap
operator|->
name|pitch
decl_stmt|;
specifier|static
specifier|const
name|int
name|filters
index|[
literal|3
index|]
index|[
literal|3
index|]
init|=
block|{
block|{
literal|65538
operator|*
literal|9
operator|/
literal|13
block|,
literal|65538
operator|*
literal|1
operator|/
literal|6
block|,
literal|65538
operator|*
literal|1
operator|/
literal|13
block|}
block|,
block|{
literal|65538
operator|*
literal|3
operator|/
literal|13
block|,
literal|65538
operator|*
literal|4
operator|/
literal|6
block|,
literal|65538
operator|*
literal|3
operator|/
literal|13
block|}
block|,
block|{
literal|65538
operator|*
literal|1
operator|/
literal|13
block|,
literal|65538
operator|*
literal|1
operator|/
literal|6
block|,
literal|65538
operator|*
literal|9
operator|/
literal|13
block|}
block|}
decl_stmt|;
name|FT_UNUSED
argument_list|(
name|library
argument_list|)
expr_stmt|;
comment|/* horizontal in-place intra-pixel filter */
if|if
condition|(
name|mode
operator|==
name|FT_RENDER_MODE_LCD
operator|&&
name|width
operator|>=
literal|3
condition|)
block|{
name|FT_Byte
modifier|*
name|line
init|=
name|bitmap
operator|->
name|buffer
decl_stmt|;
comment|/* take care of bitmap flow */
if|if
condition|(
name|bitmap
operator|->
name|pitch
operator|<
literal|0
condition|)
name|line
operator|-=
name|bitmap
operator|->
name|pitch
operator|*
operator|(
name|bitmap
operator|->
name|rows
operator|-
literal|1
operator|)
expr_stmt|;
for|for
control|(
init|;
name|height
operator|>
literal|0
condition|;
name|height
operator|--
operator|,
name|line
operator|+=
name|pitch
control|)
block|{
name|FT_UInt
name|xx
decl_stmt|;
for|for
control|(
name|xx
operator|=
literal|0
init|;
name|xx
operator|<
name|width
condition|;
name|xx
operator|+=
literal|3
control|)
block|{
name|FT_UInt
name|r
init|=
literal|0
decl_stmt|;
name|FT_UInt
name|g
init|=
literal|0
decl_stmt|;
name|FT_UInt
name|b
init|=
literal|0
decl_stmt|;
name|FT_UInt
name|p
decl_stmt|;
name|p
operator|=
name|line
index|[
name|xx
index|]
expr_stmt|;
name|r
operator|+=
name|filters
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|*
name|p
expr_stmt|;
name|g
operator|+=
name|filters
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|*
name|p
expr_stmt|;
name|b
operator|+=
name|filters
index|[
literal|0
index|]
index|[
literal|2
index|]
operator|*
name|p
expr_stmt|;
name|p
operator|=
name|line
index|[
name|xx
operator|+
literal|1
index|]
expr_stmt|;
name|r
operator|+=
name|filters
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|*
name|p
expr_stmt|;
name|g
operator|+=
name|filters
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|*
name|p
expr_stmt|;
name|b
operator|+=
name|filters
index|[
literal|1
index|]
index|[
literal|2
index|]
operator|*
name|p
expr_stmt|;
name|p
operator|=
name|line
index|[
name|xx
operator|+
literal|2
index|]
expr_stmt|;
name|r
operator|+=
name|filters
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|*
name|p
expr_stmt|;
name|g
operator|+=
name|filters
index|[
literal|2
index|]
index|[
literal|1
index|]
operator|*
name|p
expr_stmt|;
name|b
operator|+=
name|filters
index|[
literal|2
index|]
index|[
literal|2
index|]
operator|*
name|p
expr_stmt|;
name|line
index|[
name|xx
index|]
operator|=
call|(
name|FT_Byte
call|)
argument_list|(
name|r
operator|/
literal|65536
argument_list|)
expr_stmt|;
name|line
index|[
name|xx
operator|+
literal|1
index|]
operator|=
call|(
name|FT_Byte
call|)
argument_list|(
name|g
operator|/
literal|65536
argument_list|)
expr_stmt|;
name|line
index|[
name|xx
operator|+
literal|2
index|]
operator|=
call|(
name|FT_Byte
call|)
argument_list|(
name|b
operator|/
literal|65536
argument_list|)
expr_stmt|;
block|}
block|}
block|}
elseif|else
if|if
condition|(
name|mode
operator|==
name|FT_RENDER_MODE_LCD_V
operator|&&
name|height
operator|>=
literal|3
condition|)
block|{
name|FT_Byte
modifier|*
name|column
init|=
name|bitmap
operator|->
name|buffer
decl_stmt|;
comment|/* take care of bitmap flow */
if|if
condition|(
name|bitmap
operator|->
name|pitch
operator|<
literal|0
condition|)
name|column
operator|-=
name|bitmap
operator|->
name|pitch
operator|*
operator|(
name|bitmap
operator|->
name|rows
operator|-
literal|1
operator|)
expr_stmt|;
for|for
control|(
init|;
name|width
operator|>
literal|0
condition|;
name|width
operator|--
operator|,
name|column
operator|++
control|)
block|{
name|FT_Byte
modifier|*
name|col
init|=
name|column
decl_stmt|;
name|FT_Byte
modifier|*
name|col_end
init|=
name|col
operator|+
name|height
operator|*
name|pitch
decl_stmt|;
for|for
control|(
init|;
name|col
operator|<
name|col_end
condition|;
name|col
operator|+=
literal|3
operator|*
name|pitch
control|)
block|{
name|FT_UInt
name|r
init|=
literal|0
decl_stmt|;
name|FT_UInt
name|g
init|=
literal|0
decl_stmt|;
name|FT_UInt
name|b
init|=
literal|0
decl_stmt|;
name|FT_UInt
name|p
decl_stmt|;
name|p
operator|=
name|col
index|[
literal|0
index|]
expr_stmt|;
name|r
operator|+=
name|filters
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|*
name|p
expr_stmt|;
name|g
operator|+=
name|filters
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|*
name|p
expr_stmt|;
name|b
operator|+=
name|filters
index|[
literal|0
index|]
index|[
literal|2
index|]
operator|*
name|p
expr_stmt|;
name|p
operator|=
name|col
index|[
name|pitch
index|]
expr_stmt|;
name|r
operator|+=
name|filters
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|*
name|p
expr_stmt|;
name|g
operator|+=
name|filters
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|*
name|p
expr_stmt|;
name|b
operator|+=
name|filters
index|[
literal|1
index|]
index|[
literal|2
index|]
operator|*
name|p
expr_stmt|;
name|p
operator|=
name|col
index|[
name|pitch
operator|*
literal|2
index|]
expr_stmt|;
name|r
operator|+=
name|filters
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|*
name|p
expr_stmt|;
name|g
operator|+=
name|filters
index|[
literal|2
index|]
index|[
literal|1
index|]
operator|*
name|p
expr_stmt|;
name|b
operator|+=
name|filters
index|[
literal|2
index|]
index|[
literal|2
index|]
operator|*
name|p
expr_stmt|;
name|col
index|[
literal|0
index|]
operator|=
call|(
name|FT_Byte
call|)
argument_list|(
name|r
operator|/
literal|65536
argument_list|)
expr_stmt|;
name|col
index|[
name|pitch
index|]
operator|=
call|(
name|FT_Byte
call|)
argument_list|(
name|g
operator|/
literal|65536
argument_list|)
expr_stmt|;
name|col
index|[
literal|2
operator|*
name|pitch
index|]
operator|=
call|(
name|FT_Byte
call|)
argument_list|(
name|b
operator|/
literal|65536
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* USE_LEGACY */
end_comment
begin_macro
DECL|function|FT_EXPORT_DEF
name|FT_EXPORT_DEF
argument_list|(
argument|FT_Error
argument_list|)
end_macro
begin_macro
name|FT_Library_SetLcdFilterWeights
argument_list|(
argument|FT_Library      library
argument_list|,
argument|unsigned char  *weights
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|!
name|library
condition|)
return|return
name|FT_THROW
argument_list|(
name|Invalid_Library_Handle
argument_list|)
return|;
if|if
condition|(
operator|!
name|weights
condition|)
return|return
name|FT_THROW
argument_list|(
name|Invalid_Argument
argument_list|)
return|;
name|ft_memcpy
argument_list|(
name|library
operator|->
name|lcd_weights
argument_list|,
name|weights
argument_list|,
literal|5
argument_list|)
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_block
begin_macro
DECL|function|FT_EXPORT_DEF
name|FT_EXPORT_DEF
argument_list|(
argument|FT_Error
argument_list|)
end_macro
begin_macro
name|FT_Library_SetLcdFilter
argument_list|(
argument|FT_Library    library
argument_list|,
argument|FT_LcdFilter  filter
argument_list|)
end_macro
begin_block
block|{
specifier|static
specifier|const
name|FT_Byte
name|light_filter
index|[
literal|5
index|]
init|=
block|{
literal|0x00
block|,
literal|0x55
block|,
literal|0x56
block|,
literal|0x55
block|,
literal|0x00
block|}
decl_stmt|;
comment|/* the values here sum up to a value larger than 256, */
comment|/* providing a cheap gamma correction                 */
specifier|static
specifier|const
name|FT_Byte
name|default_filter
index|[
literal|5
index|]
init|=
block|{
literal|0x10
block|,
literal|0x40
block|,
literal|0x70
block|,
literal|0x40
block|,
literal|0x10
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|library
condition|)
return|return
name|FT_THROW
argument_list|(
name|Invalid_Library_Handle
argument_list|)
return|;
switch|switch
condition|(
name|filter
condition|)
block|{
case|case
name|FT_LCD_FILTER_NONE
case|:
name|library
operator|->
name|lcd_filter_func
operator|=
name|NULL
expr_stmt|;
name|library
operator|->
name|lcd_extra
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|FT_LCD_FILTER_DEFAULT
case|:
if|#
directive|if
name|defined
argument_list|(
name|FT_FORCE_LEGACY_LCD_FILTER
argument_list|)
name|library
operator|->
name|lcd_filter_func
operator|=
name|_ft_lcd_filter_legacy
expr_stmt|;
name|library
operator|->
name|lcd_extra
operator|=
literal|0
expr_stmt|;
elif|#
directive|elif
name|defined
argument_list|(
name|FT_FORCE_LIGHT_LCD_FILTER
argument_list|)
name|ft_memcpy
argument_list|(
name|library
operator|->
name|lcd_weights
argument_list|,
name|light_filter
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|library
operator|->
name|lcd_filter_func
operator|=
name|_ft_lcd_filter_fir
expr_stmt|;
name|library
operator|->
name|lcd_extra
operator|=
literal|2
expr_stmt|;
else|#
directive|else
name|ft_memcpy
argument_list|(
name|library
operator|->
name|lcd_weights
argument_list|,
name|default_filter
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|library
operator|->
name|lcd_filter_func
operator|=
name|_ft_lcd_filter_fir
expr_stmt|;
name|library
operator|->
name|lcd_extra
operator|=
literal|2
expr_stmt|;
endif|#
directive|endif
break|break;
case|case
name|FT_LCD_FILTER_LIGHT
case|:
name|ft_memcpy
argument_list|(
name|library
operator|->
name|lcd_weights
argument_list|,
name|light_filter
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|library
operator|->
name|lcd_filter_func
operator|=
name|_ft_lcd_filter_fir
expr_stmt|;
name|library
operator|->
name|lcd_extra
operator|=
literal|2
expr_stmt|;
break|break;
ifdef|#
directive|ifdef
name|USE_LEGACY
case|case
name|FT_LCD_FILTER_LEGACY
case|:
name|library
operator|->
name|lcd_filter_func
operator|=
name|_ft_lcd_filter_legacy
expr_stmt|;
name|library
operator|->
name|lcd_extra
operator|=
literal|0
expr_stmt|;
break|break;
endif|#
directive|endif
default|default:
return|return
name|FT_THROW
argument_list|(
name|Invalid_Argument
argument_list|)
return|;
block|}
name|library
operator|->
name|lcd_filter
operator|=
name|filter
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_block
begin_else
else|#
directive|else
end_else
begin_comment
comment|/* !FT_CONFIG_OPTION_SUBPIXEL_RENDERING */
end_comment
begin_macro
DECL|function|FT_EXPORT_DEF
name|FT_EXPORT_DEF
argument_list|(
argument|FT_Error
argument_list|)
end_macro
begin_macro
name|FT_Library_SetLcdFilterWeights
argument_list|(
argument|FT_Library      library
argument_list|,
argument|unsigned char  *weights
argument_list|)
end_macro
begin_block
block|{
name|FT_UNUSED
argument_list|(
name|library
argument_list|)
expr_stmt|;
name|FT_UNUSED
argument_list|(
name|weights
argument_list|)
expr_stmt|;
return|return
name|FT_THROW
argument_list|(
name|Unimplemented_Feature
argument_list|)
return|;
block|}
end_block
begin_macro
DECL|function|FT_EXPORT_DEF
name|FT_EXPORT_DEF
argument_list|(
argument|FT_Error
argument_list|)
end_macro
begin_macro
name|FT_Library_SetLcdFilter
argument_list|(
argument|FT_Library    library
argument_list|,
argument|FT_LcdFilter  filter
argument_list|)
end_macro
begin_block
block|{
name|FT_UNUSED
argument_list|(
name|library
argument_list|)
expr_stmt|;
name|FT_UNUSED
argument_list|(
name|filter
argument_list|)
expr_stmt|;
return|return
name|FT_THROW
argument_list|(
name|Unimplemented_Feature
argument_list|)
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* !FT_CONFIG_OPTION_SUBPIXEL_RENDERING */
end_comment
begin_comment
comment|/* END */
end_comment
end_unit
