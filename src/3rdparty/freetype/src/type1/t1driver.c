begin_unit
begin_comment
comment|/***************************************************************************/
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*  t1driver.c                                                             */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*    Type 1 driver interface (body).                                      */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*  Copyright 1996-2004, 2006, 2007, 2009, 2011, 2013, 2014 by             */
end_comment
begin_comment
comment|/*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/*  This file is part of the FreeType project, and may only be used,       */
end_comment
begin_comment
comment|/*  modified, and distributed under the terms of the FreeType project      */
end_comment
begin_comment
comment|/*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */
end_comment
begin_comment
comment|/*  this file you indicate that you have read the license and              */
end_comment
begin_comment
comment|/*  understand and accept it fully.                                        */
end_comment
begin_comment
comment|/*                                                                         */
end_comment
begin_comment
comment|/***************************************************************************/
end_comment
begin_include
include|#
directive|include
file|<ft2build.h>
end_include
begin_include
include|#
directive|include
file|"t1driver.h"
end_include
begin_include
include|#
directive|include
file|"t1gload.h"
end_include
begin_include
include|#
directive|include
file|"t1load.h"
end_include
begin_include
include|#
directive|include
file|"t1errors.h"
end_include
begin_ifndef
ifndef|#
directive|ifndef
name|T1_CONFIG_OPTION_NO_AFM
end_ifndef
begin_include
include|#
directive|include
file|"t1afm.h"
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
include|FT_INTERNAL_DEBUG_H
end_include
begin_include
include|#
directive|include
include|FT_INTERNAL_STREAM_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_MULTIPLE_MASTERS_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_GLYPH_DICT_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_XFREE86_NAME_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_POSTSCRIPT_NAME_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_POSTSCRIPT_CMAPS_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_POSTSCRIPT_INFO_H
end_include
begin_include
include|#
directive|include
include|FT_SERVICE_KERNING_H
end_include
begin_comment
comment|/*************************************************************************/
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/* The macro FT_COMPONENT is used in trace mode.  It is an implicit      */
end_comment
begin_comment
comment|/* parameter of the FT_TRACE() and FT_ERROR() macros, used to print/log  */
end_comment
begin_comment
comment|/* messages during execution.                                            */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_undef
DECL|macro|FT_COMPONENT
undef|#
directive|undef
name|FT_COMPONENT
end_undef
begin_define
DECL|macro|FT_COMPONENT
define|#
directive|define
name|FT_COMPONENT
value|trace_t1driver
end_define
begin_comment
comment|/*   *  GLYPH DICT SERVICE   *   */
end_comment
begin_function
specifier|static
name|FT_Error
DECL|function|t1_get_glyph_name
name|t1_get_glyph_name
parameter_list|(
name|T1_Face
name|face
parameter_list|,
name|FT_UInt
name|glyph_index
parameter_list|,
name|FT_Pointer
name|buffer
parameter_list|,
name|FT_UInt
name|buffer_max
parameter_list|)
block|{
name|FT_STRCPYN
argument_list|(
name|buffer
argument_list|,
name|face
operator|->
name|type1
operator|.
name|glyph_names
index|[
name|glyph_index
index|]
argument_list|,
name|buffer_max
argument_list|)
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_function
begin_function
specifier|static
name|FT_UInt
DECL|function|t1_get_name_index
name|t1_get_name_index
parameter_list|(
name|T1_Face
name|face
parameter_list|,
name|FT_String
modifier|*
name|glyph_name
parameter_list|)
block|{
name|FT_Int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|face
operator|->
name|type1
operator|.
name|num_glyphs
condition|;
name|i
operator|++
control|)
block|{
name|FT_String
modifier|*
name|gname
init|=
name|face
operator|->
name|type1
operator|.
name|glyph_names
index|[
name|i
index|]
decl_stmt|;
if|if
condition|(
operator|!
name|ft_strcmp
argument_list|(
name|glyph_name
argument_list|,
name|gname
argument_list|)
condition|)
return|return
operator|(
name|FT_UInt
operator|)
name|i
return|;
block|}
return|return
literal|0
return|;
block|}
end_function
begin_decl_stmt
DECL|variable|t1_service_glyph_dict
specifier|static
specifier|const
name|FT_Service_GlyphDictRec
name|t1_service_glyph_dict
init|=
block|{
operator|(
name|FT_GlyphDict_GetNameFunc
operator|)
name|t1_get_glyph_name
block|,
operator|(
name|FT_GlyphDict_NameIndexFunc
operator|)
name|t1_get_name_index
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/*    *  POSTSCRIPT NAME SERVICE    *    */
end_comment
begin_function
specifier|static
specifier|const
name|char
modifier|*
DECL|function|t1_get_ps_name
name|t1_get_ps_name
parameter_list|(
name|T1_Face
name|face
parameter_list|)
block|{
return|return
operator|(
specifier|const
name|char
operator|*
operator|)
name|face
operator|->
name|type1
operator|.
name|font_name
return|;
block|}
end_function
begin_decl_stmt
DECL|variable|t1_service_ps_name
specifier|static
specifier|const
name|FT_Service_PsFontNameRec
name|t1_service_ps_name
init|=
block|{
operator|(
name|FT_PsName_GetFunc
operator|)
name|t1_get_ps_name
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/*    *  MULTIPLE MASTERS SERVICE    *    */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|T1_CONFIG_OPTION_NO_MM_SUPPORT
end_ifndef
begin_decl_stmt
DECL|variable|t1_service_multi_masters
specifier|static
specifier|const
name|FT_Service_MultiMastersRec
name|t1_service_multi_masters
init|=
block|{
operator|(
name|FT_Get_MM_Func
operator|)
name|T1_Get_Multi_Master
block|,
operator|(
name|FT_Set_MM_Design_Func
operator|)
name|T1_Set_MM_Design
block|,
operator|(
name|FT_Set_MM_Blend_Func
operator|)
name|T1_Set_MM_Blend
block|,
operator|(
name|FT_Get_MM_Var_Func
operator|)
name|T1_Get_MM_Var
block|,
operator|(
name|FT_Set_Var_Design_Func
operator|)
name|T1_Set_Var_Design
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*    *  POSTSCRIPT INFO SERVICE    *    */
end_comment
begin_function
specifier|static
name|FT_Error
DECL|function|t1_ps_get_font_info
name|t1_ps_get_font_info
parameter_list|(
name|FT_Face
name|face
parameter_list|,
name|PS_FontInfoRec
modifier|*
name|afont_info
parameter_list|)
block|{
operator|*
name|afont_info
operator|=
operator|(
operator|(
name|T1_Face
operator|)
name|face
operator|)
operator|->
name|type1
operator|.
name|font_info
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_function
begin_function
specifier|static
name|FT_Error
DECL|function|t1_ps_get_font_extra
name|t1_ps_get_font_extra
parameter_list|(
name|FT_Face
name|face
parameter_list|,
name|PS_FontExtraRec
modifier|*
name|afont_extra
parameter_list|)
block|{
operator|*
name|afont_extra
operator|=
operator|(
operator|(
name|T1_Face
operator|)
name|face
operator|)
operator|->
name|type1
operator|.
name|font_extra
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_function
begin_function
specifier|static
name|FT_Int
DECL|function|t1_ps_has_glyph_names
name|t1_ps_has_glyph_names
parameter_list|(
name|FT_Face
name|face
parameter_list|)
block|{
name|FT_UNUSED
argument_list|(
name|face
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function
begin_function
specifier|static
name|FT_Error
DECL|function|t1_ps_get_font_private
name|t1_ps_get_font_private
parameter_list|(
name|FT_Face
name|face
parameter_list|,
name|PS_PrivateRec
modifier|*
name|afont_private
parameter_list|)
block|{
operator|*
name|afont_private
operator|=
operator|(
operator|(
name|T1_Face
operator|)
name|face
operator|)
operator|->
name|type1
operator|.
name|private_dict
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_function
begin_function
specifier|static
name|FT_Long
DECL|function|t1_ps_get_font_value
name|t1_ps_get_font_value
parameter_list|(
name|FT_Face
name|face
parameter_list|,
name|PS_Dict_Keys
name|key
parameter_list|,
name|FT_UInt
name|idx
parameter_list|,
name|void
modifier|*
name|value
parameter_list|,
name|FT_Long
name|value_len
parameter_list|)
block|{
name|FT_Long
name|retval
init|=
operator|-
literal|1
decl_stmt|;
name|T1_Face
name|t1face
init|=
operator|(
name|T1_Face
operator|)
name|face
decl_stmt|;
name|T1_Font
name|type1
init|=
operator|&
name|t1face
operator|->
name|type1
decl_stmt|;
switch|switch
condition|(
name|key
condition|)
block|{
case|case
name|PS_DICT_FONT_TYPE
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|font_type
expr_stmt|;
break|break;
case|case
name|PS_DICT_FONT_MATRIX
case|:
if|if
condition|(
name|idx
operator|<
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_matrix
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_matrix
operator|.
name|xx
argument_list|)
condition|)
block|{
name|FT_Fixed
name|val
init|=
literal|0
decl_stmt|;
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|val
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
block|{
switch|switch
condition|(
name|idx
condition|)
block|{
case|case
literal|0
case|:
name|val
operator|=
name|type1
operator|->
name|font_matrix
operator|.
name|xx
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|val
operator|=
name|type1
operator|->
name|font_matrix
operator|.
name|xy
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|val
operator|=
name|type1
operator|->
name|font_matrix
operator|.
name|yx
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|val
operator|=
name|type1
operator|->
name|font_matrix
operator|.
name|yy
expr_stmt|;
break|break;
block|}
operator|*
operator|(
operator|(
name|FT_Fixed
operator|*
operator|)
name|value
operator|)
operator|=
name|val
expr_stmt|;
block|}
block|}
break|break;
case|case
name|PS_DICT_FONT_BBOX
case|:
if|if
condition|(
name|idx
operator|<
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_bbox
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_bbox
operator|.
name|xMin
argument_list|)
condition|)
block|{
name|FT_Fixed
name|val
init|=
literal|0
decl_stmt|;
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|val
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
block|{
switch|switch
condition|(
name|idx
condition|)
block|{
case|case
literal|0
case|:
name|val
operator|=
name|type1
operator|->
name|font_bbox
operator|.
name|xMin
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|val
operator|=
name|type1
operator|->
name|font_bbox
operator|.
name|yMin
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|val
operator|=
name|type1
operator|->
name|font_bbox
operator|.
name|xMax
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|val
operator|=
name|type1
operator|->
name|font_bbox
operator|.
name|yMax
expr_stmt|;
break|break;
block|}
operator|*
operator|(
operator|(
name|FT_Fixed
operator|*
operator|)
name|value
operator|)
operator|=
name|val
expr_stmt|;
block|}
block|}
break|break;
case|case
name|PS_DICT_PAINT_TYPE
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|paint_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|paint_type
expr_stmt|;
break|break;
case|case
name|PS_DICT_FONT_NAME
case|:
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|font_name
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|font_name
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
break|break;
case|case
name|PS_DICT_UNIQUE_ID
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|unique_id
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Int
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|unique_id
expr_stmt|;
break|break;
case|case
name|PS_DICT_NUM_CHAR_STRINGS
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|num_glyphs
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Int
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|num_glyphs
expr_stmt|;
break|break;
case|case
name|PS_DICT_CHAR_STRING_KEY
case|:
if|if
condition|(
name|idx
operator|<
operator|(
name|FT_UInt
operator|)
name|type1
operator|->
name|num_glyphs
condition|)
block|{
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|glyph_names
index|[
name|idx
index|]
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
block|{
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|glyph_names
index|[
name|idx
index|]
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
operator|(
operator|(
name|FT_Char
operator|*
operator|)
name|value
operator|)
index|[
name|retval
operator|-
literal|1
index|]
operator|=
operator|(
name|FT_Char
operator|)
literal|'\0'
expr_stmt|;
block|}
block|}
break|break;
case|case
name|PS_DICT_CHAR_STRING
case|:
if|if
condition|(
name|idx
operator|<
operator|(
name|FT_UInt
operator|)
name|type1
operator|->
name|num_glyphs
condition|)
block|{
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|type1
operator|->
name|charstrings_len
index|[
name|idx
index|]
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
block|{
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|charstrings
index|[
name|idx
index|]
operator|)
argument_list|,
name|retval
operator|-
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|(
name|FT_Char
operator|*
operator|)
name|value
operator|)
index|[
name|retval
operator|-
literal|1
index|]
operator|=
operator|(
name|FT_Char
operator|)
literal|'\0'
expr_stmt|;
block|}
block|}
break|break;
case|case
name|PS_DICT_ENCODING_TYPE
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|encoding_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|T1_EncodingType
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|encoding_type
expr_stmt|;
break|break;
case|case
name|PS_DICT_ENCODING_ENTRY
case|:
if|if
condition|(
name|type1
operator|->
name|encoding_type
operator|==
name|T1_ENCODING_TYPE_ARRAY
operator|&&
name|idx
operator|<
operator|(
name|FT_UInt
operator|)
name|type1
operator|->
name|encoding
operator|.
name|num_chars
condition|)
block|{
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|encoding
operator|.
name|char_name
index|[
name|idx
index|]
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
block|{
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|encoding
operator|.
name|char_name
index|[
name|idx
index|]
operator|)
argument_list|,
name|retval
operator|-
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|(
name|FT_Char
operator|*
operator|)
name|value
operator|)
index|[
name|retval
operator|-
literal|1
index|]
operator|=
operator|(
name|FT_Char
operator|)
literal|'\0'
expr_stmt|;
block|}
block|}
break|break;
case|case
name|PS_DICT_NUM_SUBRS
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|num_subrs
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Int
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|num_subrs
expr_stmt|;
break|break;
case|case
name|PS_DICT_SUBR
case|:
if|if
condition|(
name|idx
operator|<
operator|(
name|FT_UInt
operator|)
name|type1
operator|->
name|num_subrs
condition|)
block|{
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|type1
operator|->
name|subrs_len
index|[
name|idx
index|]
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
block|{
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|subrs
index|[
name|idx
index|]
operator|)
argument_list|,
name|retval
operator|-
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|(
name|FT_Char
operator|*
operator|)
name|value
operator|)
index|[
name|retval
operator|-
literal|1
index|]
operator|=
operator|(
name|FT_Char
operator|)
literal|'\0'
expr_stmt|;
block|}
block|}
break|break;
case|case
name|PS_DICT_STD_HW
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|standard_width
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_UShort
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|standard_width
index|[
literal|0
index|]
expr_stmt|;
break|break;
case|case
name|PS_DICT_STD_VW
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|standard_height
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_UShort
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|standard_height
index|[
literal|0
index|]
expr_stmt|;
break|break;
case|case
name|PS_DICT_NUM_BLUE_VALUES
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|num_blue_values
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|num_blue_values
expr_stmt|;
break|break;
case|case
name|PS_DICT_BLUE_VALUE
case|:
if|if
condition|(
name|idx
operator|<
name|type1
operator|->
name|private_dict
operator|.
name|num_blue_values
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|blue_values
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|blue_values
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_BLUE_SCALE
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|blue_scale
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Fixed
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|blue_scale
expr_stmt|;
break|break;
case|case
name|PS_DICT_BLUE_FUZZ
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|blue_fuzz
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Int
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|blue_fuzz
expr_stmt|;
break|break;
case|case
name|PS_DICT_BLUE_SHIFT
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|blue_shift
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Int
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|blue_shift
expr_stmt|;
break|break;
case|case
name|PS_DICT_NUM_OTHER_BLUES
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|num_other_blues
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|num_other_blues
expr_stmt|;
break|break;
case|case
name|PS_DICT_OTHER_BLUE
case|:
if|if
condition|(
name|idx
operator|<
name|type1
operator|->
name|private_dict
operator|.
name|num_other_blues
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|other_blues
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|other_blues
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_NUM_FAMILY_BLUES
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|num_family_blues
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|num_family_blues
expr_stmt|;
break|break;
case|case
name|PS_DICT_FAMILY_BLUE
case|:
if|if
condition|(
name|idx
operator|<
name|type1
operator|->
name|private_dict
operator|.
name|num_family_blues
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|family_blues
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|family_blues
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_NUM_FAMILY_OTHER_BLUES
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|num_family_other_blues
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|num_family_other_blues
expr_stmt|;
break|break;
case|case
name|PS_DICT_FAMILY_OTHER_BLUE
case|:
if|if
condition|(
name|idx
operator|<
name|type1
operator|->
name|private_dict
operator|.
name|num_family_other_blues
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|family_other_blues
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|family_other_blues
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_NUM_STEM_SNAP_H
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|num_snap_widths
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|num_snap_widths
expr_stmt|;
break|break;
case|case
name|PS_DICT_STEM_SNAP_H
case|:
if|if
condition|(
name|idx
operator|<
name|type1
operator|->
name|private_dict
operator|.
name|num_snap_widths
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|snap_widths
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|snap_widths
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_NUM_STEM_SNAP_V
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|num_snap_heights
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Byte
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|num_snap_heights
expr_stmt|;
break|break;
case|case
name|PS_DICT_STEM_SNAP_V
case|:
if|if
condition|(
name|idx
operator|<
name|type1
operator|->
name|private_dict
operator|.
name|num_snap_heights
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|snap_heights
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|snap_heights
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_RND_STEM_UP
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|round_stem_up
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Bool
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|round_stem_up
expr_stmt|;
break|break;
case|case
name|PS_DICT_FORCE_BOLD
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|force_bold
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Bool
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|force_bold
expr_stmt|;
break|break;
case|case
name|PS_DICT_MIN_FEATURE
case|:
if|if
condition|(
name|idx
operator|<
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|min_feature
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|min_feature
index|[
literal|0
index|]
argument_list|)
condition|)
block|{
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|min_feature
index|[
name|idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|min_feature
index|[
name|idx
index|]
expr_stmt|;
block|}
break|break;
case|case
name|PS_DICT_LEN_IV
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|lenIV
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Int
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|lenIV
expr_stmt|;
break|break;
case|case
name|PS_DICT_PASSWORD
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|password
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Long
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|password
expr_stmt|;
break|break;
case|case
name|PS_DICT_LANGUAGE_GROUP
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|private_dict
operator|.
name|language_group
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Long
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|private_dict
operator|.
name|language_group
expr_stmt|;
break|break;
case|case
name|PS_DICT_IS_FIXED_PITCH
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|is_fixed_pitch
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Bool
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|font_info
operator|.
name|is_fixed_pitch
expr_stmt|;
break|break;
case|case
name|PS_DICT_UNDERLINE_POSITION
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|underline_position
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Short
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|font_info
operator|.
name|underline_position
expr_stmt|;
break|break;
case|case
name|PS_DICT_UNDERLINE_THICKNESS
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|underline_thickness
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_UShort
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|font_info
operator|.
name|underline_thickness
expr_stmt|;
break|break;
case|case
name|PS_DICT_FS_TYPE
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_extra
operator|.
name|fs_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_UShort
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|font_extra
operator|.
name|fs_type
expr_stmt|;
break|break;
case|case
name|PS_DICT_VERSION
case|:
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|version
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|font_info
operator|.
name|version
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
break|break;
case|case
name|PS_DICT_NOTICE
case|:
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|notice
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|font_info
operator|.
name|notice
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
break|break;
case|case
name|PS_DICT_FULL_NAME
case|:
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|full_name
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|font_info
operator|.
name|full_name
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
break|break;
case|case
name|PS_DICT_FAMILY_NAME
case|:
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|family_name
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|font_info
operator|.
name|family_name
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
break|break;
case|case
name|PS_DICT_WEIGHT
case|:
name|retval
operator|=
call|(
name|FT_Long
call|)
argument_list|(
name|ft_strlen
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|weight
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
name|ft_memcpy
argument_list|(
name|value
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|type1
operator|->
name|font_info
operator|.
name|weight
operator|)
argument_list|,
name|retval
argument_list|)
expr_stmt|;
break|break;
case|case
name|PS_DICT_ITALIC_ANGLE
case|:
name|retval
operator|=
sizeof|sizeof
argument_list|(
name|type1
operator|->
name|font_info
operator|.
name|italic_angle
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|&&
name|value_len
operator|>=
name|retval
condition|)
operator|*
operator|(
operator|(
name|FT_Long
operator|*
operator|)
name|value
operator|)
operator|=
name|type1
operator|->
name|font_info
operator|.
name|italic_angle
expr_stmt|;
break|break;
block|}
return|return
name|retval
return|;
block|}
end_function
begin_decl_stmt
DECL|variable|t1_service_ps_info
specifier|static
specifier|const
name|FT_Service_PsInfoRec
name|t1_service_ps_info
init|=
block|{
operator|(
name|PS_GetFontInfoFunc
operator|)
name|t1_ps_get_font_info
block|,
operator|(
name|PS_GetFontExtraFunc
operator|)
name|t1_ps_get_font_extra
block|,
operator|(
name|PS_HasGlyphNamesFunc
operator|)
name|t1_ps_has_glyph_names
block|,
operator|(
name|PS_GetFontPrivateFunc
operator|)
name|t1_ps_get_font_private
block|,
operator|(
name|PS_GetFontValueFunc
operator|)
name|t1_ps_get_font_value
block|,   }
decl_stmt|;
end_decl_stmt
begin_ifndef
ifndef|#
directive|ifndef
name|T1_CONFIG_OPTION_NO_AFM
end_ifndef
begin_decl_stmt
DECL|variable|t1_service_kerning
specifier|static
specifier|const
name|FT_Service_KerningRec
name|t1_service_kerning
init|=
block|{
name|T1_Get_Track_Kerning
block|,   }
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/*    *  SERVICE LIST    *    */
end_comment
begin_decl_stmt
DECL|variable|t1_services
specifier|static
specifier|const
name|FT_ServiceDescRec
name|t1_services
index|[]
init|=
block|{
block|{
name|FT_SERVICE_ID_POSTSCRIPT_FONT_NAME
block|,
operator|&
name|t1_service_ps_name
block|}
block|,
block|{
name|FT_SERVICE_ID_GLYPH_DICT
block|,
operator|&
name|t1_service_glyph_dict
block|}
block|,
block|{
name|FT_SERVICE_ID_XF86_NAME
block|,
name|FT_XF86_FORMAT_TYPE_1
block|}
block|,
block|{
name|FT_SERVICE_ID_POSTSCRIPT_INFO
block|,
operator|&
name|t1_service_ps_info
block|}
block|,
ifndef|#
directive|ifndef
name|T1_CONFIG_OPTION_NO_AFM
block|{
name|FT_SERVICE_ID_KERNING
block|,
operator|&
name|t1_service_kerning
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|T1_CONFIG_OPTION_NO_MM_SUPPORT
block|{
name|FT_SERVICE_ID_MULTI_MASTERS
block|,
operator|&
name|t1_service_multi_masters
block|}
block|,
endif|#
directive|endif
block|{
name|NULL
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_macro
DECL|function|FT_CALLBACK_DEF
name|FT_CALLBACK_DEF
argument_list|(
argument|FT_Module_Interface
argument_list|)
end_macro
begin_macro
name|Get_Interface
argument_list|(
argument|FT_Module         module
argument_list|,
argument|const FT_String*  t1_interface
argument_list|)
end_macro
begin_block
block|{
name|FT_UNUSED
argument_list|(
name|module
argument_list|)
expr_stmt|;
return|return
name|ft_service_list_lookup
argument_list|(
name|t1_services
argument_list|,
name|t1_interface
argument_list|)
return|;
block|}
end_block
begin_ifndef
ifndef|#
directive|ifndef
name|T1_CONFIG_OPTION_NO_AFM
end_ifndef
begin_comment
comment|/*************************************************************************/
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*<Function>                                                            */
end_comment
begin_comment
comment|/*    Get_Kerning                                                        */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*<Description>                                                         */
end_comment
begin_comment
comment|/*    A driver method used to return the kerning vector between two      */
end_comment
begin_comment
comment|/*    glyphs of the same face.                                           */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*<Input>                                                               */
end_comment
begin_comment
comment|/*    face        :: A handle to the source face object.                 */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*    left_glyph  :: The index of the left glyph in the kern pair.       */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*    right_glyph :: The index of the right glyph in the kern pair.      */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*<Output>                                                              */
end_comment
begin_comment
comment|/*    kerning     :: The kerning vector.  This is in font units for      */
end_comment
begin_comment
comment|/*                   scalable formats, and in pixels for fixed-sizes     */
end_comment
begin_comment
comment|/*                   formats.                                            */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*<Return>                                                              */
end_comment
begin_comment
comment|/*    FreeType error code.  0 means success.                             */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*<Note>                                                                */
end_comment
begin_comment
comment|/*    Only horizontal layouts (left-to-right& right-to-left) are        */
end_comment
begin_comment
comment|/*    supported by this function.  Other layouts, or more sophisticated  */
end_comment
begin_comment
comment|/*    kernings are out of scope of this method (the basic driver         */
end_comment
begin_comment
comment|/*    interface is meant to be simple).                                  */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_comment
comment|/*    They can be implemented by format-specific interfaces.             */
end_comment
begin_comment
comment|/*                                                                       */
end_comment
begin_function
specifier|static
name|FT_Error
DECL|function|Get_Kerning
name|Get_Kerning
parameter_list|(
name|FT_Face
name|t1face
parameter_list|,
comment|/* T1_Face */
name|FT_UInt
name|left_glyph
parameter_list|,
name|FT_UInt
name|right_glyph
parameter_list|,
name|FT_Vector
modifier|*
name|kerning
parameter_list|)
block|{
name|T1_Face
name|face
init|=
operator|(
name|T1_Face
operator|)
name|t1face
decl_stmt|;
name|kerning
operator|->
name|x
operator|=
literal|0
expr_stmt|;
name|kerning
operator|->
name|y
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|face
operator|->
name|afm_data
condition|)
name|T1_Get_Kerning
argument_list|(
operator|(
name|AFM_FontInfo
operator|)
name|face
operator|->
name|afm_data
argument_list|,
name|left_glyph
argument_list|,
name|right_glyph
argument_list|,
name|kerning
argument_list|)
expr_stmt|;
return|return
name|FT_Err_Ok
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* T1_CONFIG_OPTION_NO_AFM */
end_comment
begin_decl_stmt
name|FT_CALLBACK_TABLE_DEF
DECL|variable|t1_driver_class
specifier|const
name|FT_Driver_ClassRec
name|t1_driver_class
init|=
block|{
block|{
name|FT_MODULE_FONT_DRIVER
operator||
name|FT_MODULE_DRIVER_SCALABLE
operator||
name|FT_MODULE_DRIVER_HAS_HINTER
block|,
sizeof|sizeof
argument_list|(
name|FT_DriverRec
argument_list|)
block|,
literal|"type1"
block|,
literal|0x10000L
block|,
literal|0x20000L
block|,
literal|0
block|,
comment|/* format interface */
name|T1_Driver_Init
block|,
name|T1_Driver_Done
block|,
name|Get_Interface
block|,     }
block|,
sizeof|sizeof
argument_list|(
name|T1_FaceRec
argument_list|)
block|,
sizeof|sizeof
argument_list|(
name|T1_SizeRec
argument_list|)
block|,
sizeof|sizeof
argument_list|(
name|T1_GlyphSlotRec
argument_list|)
block|,
name|T1_Face_Init
block|,
name|T1_Face_Done
block|,
name|T1_Size_Init
block|,
name|T1_Size_Done
block|,
name|T1_GlyphSlot_Init
block|,
name|T1_GlyphSlot_Done
block|,
name|T1_Load_Glyph
block|,
ifdef|#
directive|ifdef
name|T1_CONFIG_OPTION_NO_AFM
literal|0
block|,
comment|/* FT_Face_GetKerningFunc */
literal|0
block|,
comment|/* FT_Face_AttachFunc     */
else|#
directive|else
name|Get_Kerning
block|,
name|T1_Read_Metrics
block|,
endif|#
directive|endif
name|T1_Get_Advances
block|,
name|T1_Size_Request
block|,
literal|0
comment|/* FT_Size_SelectFunc     */
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* END */
end_comment
end_unit
