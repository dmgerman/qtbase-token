begin_unit
begin_comment
comment|/* pngget.c - retrieval of values from info struct  *  * Last changed in libpng 1.6.17 [March 26, 2015]  * Copyright (c) 1998-2015 Glenn Randers-Pehrson  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)  * (Version 0.88 Copyright (c) 1995, 1996 Guy Eric Schalnat, Group 42, Inc.)  *  * This code is released under the libpng license.  * For conditions of distribution and use, see the disclaimer  * and license in png.h  *  */
end_comment
begin_include
include|#
directive|include
file|"pngpriv.h"
end_include
begin_if
if|#
directive|if
name|defined
argument_list|(
name|PNG_READ_SUPPORTED
argument_list|)
operator|||
name|defined
argument_list|(
name|PNG_WRITE_SUPPORTED
argument_list|)
end_if
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_valid
name|png_get_valid
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_uint_32
name|flag
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|flag
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_size_t
name|PNGAPI
DECL|function|png_get_rowbytes
name|png_get_rowbytes
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|rowbytes
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_INFO_IMAGE_SUPPORTED
end_ifdef
begin_function
name|png_bytepp
name|PNGAPI
DECL|function|png_get_rows
name|png_get_rows
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|row_pointers
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_EASY_ACCESS_SUPPORTED
end_ifdef
begin_comment
comment|/* Easy access to info, added in libpng-0.99 */
end_comment
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_image_width
name|png_get_image_width
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|width
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_image_height
name|png_get_image_height
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|height
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_bit_depth
name|png_get_bit_depth
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|bit_depth
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_color_type
name|png_get_color_type
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|color_type
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_filter_type
name|png_get_filter_type
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|filter_type
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_interlace_type
name|png_get_interlace_type
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|interlace_type
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_compression_type
name|png_get_compression_type
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|info_ptr
operator|->
name|compression_type
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_x_pixels_per_meter
name|png_get_x_pixels_per_meter
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_pHYs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_x_pixels_per_meter"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|phys_unit_type
operator|==
name|PNG_RESOLUTION_METER
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|x_pixels_per_unit
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_y_pixels_per_meter
name|png_get_y_pixels_per_meter
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_pHYs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_y_pixels_per_meter"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|phys_unit_type
operator|==
name|PNG_RESOLUTION_METER
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|y_pixels_per_unit
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_pixels_per_meter
name|png_get_pixels_per_meter
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_pHYs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_pixels_per_meter"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|phys_unit_type
operator|==
name|PNG_RESOLUTION_METER
operator|&&
name|info_ptr
operator|->
name|x_pixels_per_unit
operator|==
name|info_ptr
operator|->
name|y_pixels_per_unit
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|x_pixels_per_unit
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FLOATING_POINT_SUPPORTED
end_ifdef
begin_function
name|float
name|PNGAPI
DECL|function|png_get_pixel_aspect_ratio
name|png_get_pixel_aspect_ratio
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_READ_pHYs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_aspect_ratio"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|x_pixels_per_unit
operator|!=
literal|0
condition|)
return|return
operator|(
call|(
name|float
call|)
argument_list|(
operator|(
name|float
operator|)
name|info_ptr
operator|->
name|y_pixels_per_unit
operator|/
operator|(
name|float
operator|)
name|info_ptr
operator|->
name|x_pixels_per_unit
argument_list|)
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
operator|(
name|float
operator|)
literal|0.0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FIXED_POINT_SUPPORTED
end_ifdef
begin_function
name|png_fixed_point
name|PNGAPI
DECL|function|png_get_pixel_aspect_ratio_fixed
name|png_get_pixel_aspect_ratio_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_READ_pHYs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
operator|&&
name|info_ptr
operator|->
name|x_pixels_per_unit
operator|>
literal|0
operator|&&
name|info_ptr
operator|->
name|y_pixels_per_unit
operator|>
literal|0
operator|&&
name|info_ptr
operator|->
name|x_pixels_per_unit
operator|<=
name|PNG_UINT_31_MAX
operator|&&
name|info_ptr
operator|->
name|y_pixels_per_unit
operator|<=
name|PNG_UINT_31_MAX
condition|)
block|{
name|png_fixed_point
name|res
decl_stmt|;
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_aspect_ratio_fixed"
argument_list|)
expr_stmt|;
comment|/* The following casts work because a PNG 4 byte integer only has a valid        * range of 0..2^31-1; otherwise the cast might overflow.        */
if|if
condition|(
name|png_muldiv
argument_list|(
operator|&
name|res
argument_list|,
operator|(
name|png_int_32
operator|)
name|info_ptr
operator|->
name|y_pixels_per_unit
argument_list|,
name|PNG_FP_1
argument_list|,
operator|(
name|png_int_32
operator|)
name|info_ptr
operator|->
name|x_pixels_per_unit
argument_list|)
operator|!=
literal|0
condition|)
return|return
name|res
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
literal|0
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
name|png_int_32
name|PNGAPI
DECL|function|png_get_x_offset_microns
name|png_get_x_offset_microns
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_oFFs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_oFFs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_x_offset_microns"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|offset_unit_type
operator|==
name|PNG_OFFSET_MICROMETER
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|x_offset
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_int_32
name|PNGAPI
DECL|function|png_get_y_offset_microns
name|png_get_y_offset_microns
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_oFFs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_oFFs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_y_offset_microns"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|offset_unit_type
operator|==
name|PNG_OFFSET_MICROMETER
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|y_offset
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_int_32
name|PNGAPI
DECL|function|png_get_x_offset_pixels
name|png_get_x_offset_pixels
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_oFFs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_oFFs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_x_offset_pixels"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|offset_unit_type
operator|==
name|PNG_OFFSET_PIXEL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|x_offset
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_int_32
name|PNGAPI
DECL|function|png_get_y_offset_pixels
name|png_get_y_offset_pixels
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|PNG_oFFs_SUPPORTED
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_oFFs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"png_get_y_offset_pixels"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|offset_unit_type
operator|==
name|PNG_OFFSET_PIXEL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|y_offset
operator|)
return|;
block|}
else|#
directive|else
name|PNG_UNUSED
argument_list|(
argument|png_ptr
argument_list|)
name|PNG_UNUSED
argument_list|(
argument|info_ptr
argument_list|)
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_INCH_CONVERSIONS_SUPPORTED
end_ifdef
begin_function
specifier|static
name|png_uint_32
DECL|function|ppi_from_ppm
name|ppi_from_ppm
parameter_list|(
name|png_uint_32
name|ppm
parameter_list|)
block|{
if|#
directive|if
literal|0
comment|/* The conversion is *(2.54/100), in binary (32 digits):     * .00000110100000001001110101001001     */
block|png_uint_32 t1001, t1101;    ppm>>= 1;
comment|/* .1 */
block|t1001 = ppm + (ppm>> 3);
comment|/* .1001 */
block|t1101 = t1001 + (ppm>> 1);
comment|/* .1101 */
block|ppm>>= 20;
comment|/* .000000000000000000001 */
block|t1101 += t1101>> 15;
comment|/* .1101000000000001101 */
block|t1001>>= 11;
comment|/* .000000000001001 */
block|t1001 += t1001>> 12;
comment|/* .000000000001001000000001001 */
block|ppm += t1001;
comment|/* .000000000001001000001001001 */
block|ppm += t1101;
comment|/* .110100000001001110101001001 */
block|return (ppm + 16)>> 5;
comment|/* .00000110100000001001110101001001 */
else|#
directive|else
comment|/* The argument is a PNG unsigned integer, so it is not permitted     * to be bigger than 2^31.     */
name|png_fixed_point
name|result
decl_stmt|;
if|if
condition|(
name|ppm
operator|<=
name|PNG_UINT_31_MAX
operator|&&
name|png_muldiv
argument_list|(
operator|&
name|result
argument_list|,
operator|(
name|png_int_32
operator|)
name|ppm
argument_list|,
literal|127
argument_list|,
literal|5000
argument_list|)
operator|!=
literal|0
condition|)
return|return
name|result
return|;
comment|/* Overflow. */
return|return
literal|0
return|;
endif|#
directive|endif
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_pixels_per_inch
name|png_get_pixels_per_inch
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
return|return
name|ppi_from_ppm
argument_list|(
name|png_get_pixels_per_meter
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_x_pixels_per_inch
name|png_get_x_pixels_per_inch
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
return|return
name|ppi_from_ppm
argument_list|(
name|png_get_x_pixels_per_meter
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_y_pixels_per_inch
name|png_get_y_pixels_per_inch
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
return|return
name|ppi_from_ppm
argument_list|(
name|png_get_y_pixels_per_meter
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FIXED_POINT_SUPPORTED
end_ifdef
begin_function
specifier|static
name|png_fixed_point
DECL|function|png_fixed_inches_from_microns
name|png_fixed_inches_from_microns
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_int_32
name|microns
parameter_list|)
block|{
comment|/* Convert from metres * 1,000,000 to inches * 100,000, meters to     * inches is simply *(100/2.54), so we want *(10/2.54) == 500/127.     * Notice that this can overflow - a warning is output and 0 is     * returned.     */
return|return
name|png_muldiv_warn
argument_list|(
name|png_ptr
argument_list|,
name|microns
argument_list|,
literal|500
argument_list|,
literal|127
argument_list|)
return|;
block|}
end_function
begin_function
name|png_fixed_point
name|PNGAPI
DECL|function|png_get_x_offset_inches_fixed
name|png_get_x_offset_inches_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
return|return
name|png_fixed_inches_from_microns
argument_list|(
name|png_ptr
argument_list|,
name|png_get_x_offset_microns
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FIXED_POINT_SUPPORTED
end_ifdef
begin_function
name|png_fixed_point
name|PNGAPI
DECL|function|png_get_y_offset_inches_fixed
name|png_get_y_offset_inches_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
return|return
name|png_fixed_inches_from_microns
argument_list|(
name|png_ptr
argument_list|,
name|png_get_y_offset_microns
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FLOATING_POINT_SUPPORTED
end_ifdef
begin_function
name|float
name|PNGAPI
DECL|function|png_get_x_offset_inches
name|png_get_x_offset_inches
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
comment|/* To avoid the overflow do the conversion directly in floating     * point.     */
return|return
call|(
name|float
call|)
argument_list|(
name|png_get_x_offset_microns
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
operator|*
literal|.00003937
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FLOATING_POINT_SUPPORTED
end_ifdef
begin_function
name|float
name|PNGAPI
DECL|function|png_get_y_offset_inches
name|png_get_y_offset_inches
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
comment|/* To avoid the overflow do the conversion directly in floating     * point.     */
return|return
call|(
name|float
call|)
argument_list|(
name|png_get_y_offset_microns
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
argument_list|)
operator|*
literal|.00003937
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_pHYs_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_pHYs_dpi
name|png_get_pHYs_dpi
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_uint_32
modifier|*
name|res_x
parameter_list|,
name|png_uint_32
modifier|*
name|res_y
parameter_list|,
name|int
modifier|*
name|unit_type
parameter_list|)
block|{
name|png_uint_32
name|retval
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"pHYs"
argument_list|)
expr_stmt|;
if|if
condition|(
name|res_x
operator|!=
name|NULL
condition|)
block|{
operator|*
name|res_x
operator|=
name|info_ptr
operator|->
name|x_pixels_per_unit
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_pHYs
expr_stmt|;
block|}
if|if
condition|(
name|res_y
operator|!=
name|NULL
condition|)
block|{
operator|*
name|res_y
operator|=
name|info_ptr
operator|->
name|y_pixels_per_unit
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_pHYs
expr_stmt|;
block|}
if|if
condition|(
name|unit_type
operator|!=
name|NULL
condition|)
block|{
operator|*
name|unit_type
operator|=
operator|(
name|int
operator|)
name|info_ptr
operator|->
name|phys_unit_type
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_pHYs
expr_stmt|;
if|if
condition|(
operator|*
name|unit_type
operator|==
literal|1
condition|)
block|{
if|if
condition|(
name|res_x
operator|!=
name|NULL
condition|)
operator|*
name|res_x
operator|=
call|(
name|png_uint_32
call|)
argument_list|(
operator|*
name|res_x
operator|*
literal|.0254
operator|+
literal|.50
argument_list|)
expr_stmt|;
if|if
condition|(
name|res_y
operator|!=
name|NULL
condition|)
operator|*
name|res_y
operator|=
call|(
name|png_uint_32
call|)
argument_list|(
operator|*
name|res_y
operator|*
literal|.0254
operator|+
literal|.50
argument_list|)
expr_stmt|;
block|}
block|}
block|}
return|return
operator|(
name|retval
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* pHYs */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* INCH_CONVERSIONS */
end_comment
begin_comment
comment|/* png_get_channels really belongs in here, too, but it's been around longer */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* EASY_ACCESS */
end_comment
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_channels
name|png_get_channels
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|channels
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_READ_SUPPORTED
end_ifdef
begin_function
name|png_const_bytep
name|PNGAPI
DECL|function|png_get_signature
name|png_get_signature
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
operator|(
name|info_ptr
operator|->
name|signature
operator|)
return|;
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_bKGD_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_bKGD
name|png_get_bKGD
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_color_16p
modifier|*
name|background
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_bKGD
operator|)
operator|!=
literal|0
operator|&&
name|background
operator|!=
name|NULL
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"bKGD"
argument_list|)
expr_stmt|;
operator|*
name|background
operator|=
operator|&
operator|(
name|info_ptr
operator|->
name|background
operator|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_bKGD
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_cHRM_SUPPORTED
end_ifdef
begin_comment
comment|/* The XYZ APIs were added in 1.5.5 to take advantage of the code added at the  * same time to correct the rgb grayscale coefficient defaults obtained from the  * cHRM chunk in 1.5.4  */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FLOATING_POINT_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_cHRM
name|png_get_cHRM
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|double
modifier|*
name|white_x
parameter_list|,
name|double
modifier|*
name|white_y
parameter_list|,
name|double
modifier|*
name|red_x
parameter_list|,
name|double
modifier|*
name|red_y
parameter_list|,
name|double
modifier|*
name|green_x
parameter_list|,
name|double
modifier|*
name|green_y
parameter_list|,
name|double
modifier|*
name|blue_x
parameter_list|,
name|double
modifier|*
name|blue_y
parameter_list|)
block|{
comment|/* Quiet API change: this code used to only return the end points if a cHRM     * chunk was present, but the end points can also come from iCCP or sRGB     * chunks, so in 1.6.0 the png_get_ APIs return the end points regardless and     * the png_set_ APIs merely check that set end points are mutually     * consistent.     */
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|colorspace
operator|.
name|flags
operator|&
name|PNG_COLORSPACE_HAVE_ENDPOINTS
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"cHRM"
argument_list|)
expr_stmt|;
if|if
condition|(
name|white_x
operator|!=
name|NULL
condition|)
operator|*
name|white_x
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|whitex
argument_list|,
literal|"cHRM white X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|white_y
operator|!=
name|NULL
condition|)
operator|*
name|white_y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|whitey
argument_list|,
literal|"cHRM white Y"
argument_list|)
expr_stmt|;
if|if
condition|(
name|red_x
operator|!=
name|NULL
condition|)
operator|*
name|red_x
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|redx
argument_list|,
literal|"cHRM red X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|red_y
operator|!=
name|NULL
condition|)
operator|*
name|red_y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|redy
argument_list|,
literal|"cHRM red Y"
argument_list|)
expr_stmt|;
if|if
condition|(
name|green_x
operator|!=
name|NULL
condition|)
operator|*
name|green_x
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|greenx
argument_list|,
literal|"cHRM green X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|green_y
operator|!=
name|NULL
condition|)
operator|*
name|green_y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|greeny
argument_list|,
literal|"cHRM green Y"
argument_list|)
expr_stmt|;
if|if
condition|(
name|blue_x
operator|!=
name|NULL
condition|)
operator|*
name|blue_x
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|bluex
argument_list|,
literal|"cHRM blue X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|blue_y
operator|!=
name|NULL
condition|)
operator|*
name|blue_y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|bluey
argument_list|,
literal|"cHRM blue Y"
argument_list|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_cHRM
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_cHRM_XYZ
name|png_get_cHRM_XYZ
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|double
modifier|*
name|red_X
parameter_list|,
name|double
modifier|*
name|red_Y
parameter_list|,
name|double
modifier|*
name|red_Z
parameter_list|,
name|double
modifier|*
name|green_X
parameter_list|,
name|double
modifier|*
name|green_Y
parameter_list|,
name|double
modifier|*
name|green_Z
parameter_list|,
name|double
modifier|*
name|blue_X
parameter_list|,
name|double
modifier|*
name|blue_Y
parameter_list|,
name|double
modifier|*
name|blue_Z
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|colorspace
operator|.
name|flags
operator|&
name|PNG_COLORSPACE_HAVE_ENDPOINTS
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"cHRM_XYZ(float)"
argument_list|)
expr_stmt|;
if|if
condition|(
name|red_X
operator|!=
name|NULL
condition|)
operator|*
name|red_X
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|red_X
argument_list|,
literal|"cHRM red X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|red_Y
operator|!=
name|NULL
condition|)
operator|*
name|red_Y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|red_Y
argument_list|,
literal|"cHRM red Y"
argument_list|)
expr_stmt|;
if|if
condition|(
name|red_Z
operator|!=
name|NULL
condition|)
operator|*
name|red_Z
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|red_Z
argument_list|,
literal|"cHRM red Z"
argument_list|)
expr_stmt|;
if|if
condition|(
name|green_X
operator|!=
name|NULL
condition|)
operator|*
name|green_X
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|green_X
argument_list|,
literal|"cHRM green X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|green_Y
operator|!=
name|NULL
condition|)
operator|*
name|green_Y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|green_Y
argument_list|,
literal|"cHRM green Y"
argument_list|)
expr_stmt|;
if|if
condition|(
name|green_Z
operator|!=
name|NULL
condition|)
operator|*
name|green_Z
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|green_Z
argument_list|,
literal|"cHRM green Z"
argument_list|)
expr_stmt|;
if|if
condition|(
name|blue_X
operator|!=
name|NULL
condition|)
operator|*
name|blue_X
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|blue_X
argument_list|,
literal|"cHRM blue X"
argument_list|)
expr_stmt|;
if|if
condition|(
name|blue_Y
operator|!=
name|NULL
condition|)
operator|*
name|blue_Y
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|blue_Y
argument_list|,
literal|"cHRM blue Y"
argument_list|)
expr_stmt|;
if|if
condition|(
name|blue_Z
operator|!=
name|NULL
condition|)
operator|*
name|blue_Z
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|blue_Z
argument_list|,
literal|"cHRM blue Z"
argument_list|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_cHRM
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FIXED_POINT_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_cHRM_XYZ_fixed
name|png_get_cHRM_XYZ_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_fixed_point
modifier|*
name|int_red_X
parameter_list|,
name|png_fixed_point
modifier|*
name|int_red_Y
parameter_list|,
name|png_fixed_point
modifier|*
name|int_red_Z
parameter_list|,
name|png_fixed_point
modifier|*
name|int_green_X
parameter_list|,
name|png_fixed_point
modifier|*
name|int_green_Y
parameter_list|,
name|png_fixed_point
modifier|*
name|int_green_Z
parameter_list|,
name|png_fixed_point
modifier|*
name|int_blue_X
parameter_list|,
name|png_fixed_point
modifier|*
name|int_blue_Y
parameter_list|,
name|png_fixed_point
modifier|*
name|int_blue_Z
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|colorspace
operator|.
name|flags
operator|&
name|PNG_COLORSPACE_HAVE_ENDPOINTS
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"cHRM_XYZ"
argument_list|)
expr_stmt|;
if|if
condition|(
name|int_red_X
operator|!=
name|NULL
condition|)
operator|*
name|int_red_X
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|red_X
expr_stmt|;
if|if
condition|(
name|int_red_Y
operator|!=
name|NULL
condition|)
operator|*
name|int_red_Y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|red_Y
expr_stmt|;
if|if
condition|(
name|int_red_Z
operator|!=
name|NULL
condition|)
operator|*
name|int_red_Z
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|red_Z
expr_stmt|;
if|if
condition|(
name|int_green_X
operator|!=
name|NULL
condition|)
operator|*
name|int_green_X
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|green_X
expr_stmt|;
if|if
condition|(
name|int_green_Y
operator|!=
name|NULL
condition|)
operator|*
name|int_green_Y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|green_Y
expr_stmt|;
if|if
condition|(
name|int_green_Z
operator|!=
name|NULL
condition|)
operator|*
name|int_green_Z
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|green_Z
expr_stmt|;
if|if
condition|(
name|int_blue_X
operator|!=
name|NULL
condition|)
operator|*
name|int_blue_X
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|blue_X
expr_stmt|;
if|if
condition|(
name|int_blue_Y
operator|!=
name|NULL
condition|)
operator|*
name|int_blue_Y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|blue_Y
expr_stmt|;
if|if
condition|(
name|int_blue_Z
operator|!=
name|NULL
condition|)
operator|*
name|int_blue_Z
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_XYZ
operator|.
name|blue_Z
expr_stmt|;
return|return
operator|(
name|PNG_INFO_cHRM
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_cHRM_fixed
name|png_get_cHRM_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_fixed_point
modifier|*
name|white_x
parameter_list|,
name|png_fixed_point
modifier|*
name|white_y
parameter_list|,
name|png_fixed_point
modifier|*
name|red_x
parameter_list|,
name|png_fixed_point
modifier|*
name|red_y
parameter_list|,
name|png_fixed_point
modifier|*
name|green_x
parameter_list|,
name|png_fixed_point
modifier|*
name|green_y
parameter_list|,
name|png_fixed_point
modifier|*
name|blue_x
parameter_list|,
name|png_fixed_point
modifier|*
name|blue_y
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"cHRM"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|colorspace
operator|.
name|flags
operator|&
name|PNG_COLORSPACE_HAVE_ENDPOINTS
operator|)
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
name|white_x
operator|!=
name|NULL
condition|)
operator|*
name|white_x
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|whitex
expr_stmt|;
if|if
condition|(
name|white_y
operator|!=
name|NULL
condition|)
operator|*
name|white_y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|whitey
expr_stmt|;
if|if
condition|(
name|red_x
operator|!=
name|NULL
condition|)
operator|*
name|red_x
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|redx
expr_stmt|;
if|if
condition|(
name|red_y
operator|!=
name|NULL
condition|)
operator|*
name|red_y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|redy
expr_stmt|;
if|if
condition|(
name|green_x
operator|!=
name|NULL
condition|)
operator|*
name|green_x
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|greenx
expr_stmt|;
if|if
condition|(
name|green_y
operator|!=
name|NULL
condition|)
operator|*
name|green_y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|greeny
expr_stmt|;
if|if
condition|(
name|blue_x
operator|!=
name|NULL
condition|)
operator|*
name|blue_x
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|bluex
expr_stmt|;
if|if
condition|(
name|blue_y
operator|!=
name|NULL
condition|)
operator|*
name|blue_y
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|end_points_xy
operator|.
name|bluey
expr_stmt|;
return|return
operator|(
name|PNG_INFO_cHRM
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_gAMA_SUPPORTED
end_ifdef
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FIXED_POINT_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_gAMA_fixed
name|png_get_gAMA_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_fixed_point
modifier|*
name|file_gamma
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"gAMA"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|colorspace
operator|.
name|flags
operator|&
name|PNG_COLORSPACE_HAVE_GAMMA
operator|)
operator|!=
literal|0
operator|&&
name|file_gamma
operator|!=
name|NULL
condition|)
block|{
operator|*
name|file_gamma
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|gamma
expr_stmt|;
return|return
operator|(
name|PNG_INFO_gAMA
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FLOATING_POINT_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_gAMA
name|png_get_gAMA
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|double
modifier|*
name|file_gamma
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"gAMA(float)"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|colorspace
operator|.
name|flags
operator|&
name|PNG_COLORSPACE_HAVE_GAMMA
operator|)
operator|!=
literal|0
operator|&&
name|file_gamma
operator|!=
name|NULL
condition|)
block|{
operator|*
name|file_gamma
operator|=
name|png_float
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|colorspace
operator|.
name|gamma
argument_list|,
literal|"png_get_gAMA"
argument_list|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_gAMA
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_sRGB_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_sRGB
name|png_get_sRGB
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|int
modifier|*
name|file_srgb_intent
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"sRGB"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_sRGB
operator|)
operator|!=
literal|0
operator|&&
name|file_srgb_intent
operator|!=
name|NULL
condition|)
block|{
operator|*
name|file_srgb_intent
operator|=
name|info_ptr
operator|->
name|colorspace
operator|.
name|rendering_intent
expr_stmt|;
return|return
operator|(
name|PNG_INFO_sRGB
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_iCCP_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_iCCP
name|png_get_iCCP
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_charpp
name|name
parameter_list|,
name|int
modifier|*
name|compression_type
parameter_list|,
name|png_bytepp
name|profile
parameter_list|,
name|png_uint_32
modifier|*
name|proflen
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"iCCP"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_iCCP
operator|)
operator|!=
literal|0
operator|&&
name|name
operator|!=
name|NULL
operator|&&
name|compression_type
operator|!=
name|NULL
operator|&&
name|profile
operator|!=
name|NULL
operator|&&
name|proflen
operator|!=
name|NULL
condition|)
block|{
operator|*
name|name
operator|=
name|info_ptr
operator|->
name|iccp_name
expr_stmt|;
operator|*
name|profile
operator|=
name|info_ptr
operator|->
name|iccp_profile
expr_stmt|;
operator|*
name|proflen
operator|=
name|png_get_uint_32
argument_list|(
name|info_ptr
operator|->
name|iccp_profile
argument_list|)
expr_stmt|;
comment|/* This is somewhat irrelevant since the profile data returned has        * actually been uncompressed.        */
operator|*
name|compression_type
operator|=
name|PNG_COMPRESSION_TYPE_BASE
expr_stmt|;
return|return
operator|(
name|PNG_INFO_iCCP
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_sPLT_SUPPORTED
end_ifdef
begin_function
name|int
name|PNGAPI
DECL|function|png_get_sPLT
name|png_get_sPLT
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_sPLT_tpp
name|spalettes
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
name|spalettes
operator|!=
name|NULL
condition|)
block|{
operator|*
name|spalettes
operator|=
name|info_ptr
operator|->
name|splt_palettes
expr_stmt|;
return|return
name|info_ptr
operator|->
name|splt_palettes_num
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_hIST_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_hIST
name|png_get_hIST
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_uint_16p
modifier|*
name|hist
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"hIST"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_hIST
operator|)
operator|!=
literal|0
operator|&&
name|hist
operator|!=
name|NULL
condition|)
block|{
operator|*
name|hist
operator|=
name|info_ptr
operator|->
name|hist
expr_stmt|;
return|return
operator|(
name|PNG_INFO_hIST
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_IHDR
name|png_get_IHDR
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_uint_32
modifier|*
name|width
parameter_list|,
name|png_uint_32
modifier|*
name|height
parameter_list|,
name|int
modifier|*
name|bit_depth
parameter_list|,
name|int
modifier|*
name|color_type
parameter_list|,
name|int
modifier|*
name|interlace_type
parameter_list|,
name|int
modifier|*
name|compression_type
parameter_list|,
name|int
modifier|*
name|filter_type
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"IHDR"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|==
name|NULL
operator|||
name|info_ptr
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|width
operator|!=
name|NULL
condition|)
operator|*
name|width
operator|=
name|info_ptr
operator|->
name|width
expr_stmt|;
if|if
condition|(
name|height
operator|!=
name|NULL
condition|)
operator|*
name|height
operator|=
name|info_ptr
operator|->
name|height
expr_stmt|;
if|if
condition|(
name|bit_depth
operator|!=
name|NULL
condition|)
operator|*
name|bit_depth
operator|=
name|info_ptr
operator|->
name|bit_depth
expr_stmt|;
if|if
condition|(
name|color_type
operator|!=
name|NULL
condition|)
operator|*
name|color_type
operator|=
name|info_ptr
operator|->
name|color_type
expr_stmt|;
if|if
condition|(
name|compression_type
operator|!=
name|NULL
condition|)
operator|*
name|compression_type
operator|=
name|info_ptr
operator|->
name|compression_type
expr_stmt|;
if|if
condition|(
name|filter_type
operator|!=
name|NULL
condition|)
operator|*
name|filter_type
operator|=
name|info_ptr
operator|->
name|filter_type
expr_stmt|;
if|if
condition|(
name|interlace_type
operator|!=
name|NULL
condition|)
operator|*
name|interlace_type
operator|=
name|info_ptr
operator|->
name|interlace_type
expr_stmt|;
comment|/* This is redundant if we can be sure that the info_ptr values were all     * assigned in png_set_IHDR().  We do the check anyhow in case an     * application has ignored our advice not to mess with the members     * of info_ptr directly.     */
name|png_check_IHDR
argument_list|(
name|png_ptr
argument_list|,
name|info_ptr
operator|->
name|width
argument_list|,
name|info_ptr
operator|->
name|height
argument_list|,
name|info_ptr
operator|->
name|bit_depth
argument_list|,
name|info_ptr
operator|->
name|color_type
argument_list|,
name|info_ptr
operator|->
name|interlace_type
argument_list|,
name|info_ptr
operator|->
name|compression_type
argument_list|,
name|info_ptr
operator|->
name|filter_type
argument_list|)
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_oFFs_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_oFFs
name|png_get_oFFs
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_int_32
modifier|*
name|offset_x
parameter_list|,
name|png_int_32
modifier|*
name|offset_y
parameter_list|,
name|int
modifier|*
name|unit_type
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"oFFs"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_oFFs
operator|)
operator|!=
literal|0
operator|&&
name|offset_x
operator|!=
name|NULL
operator|&&
name|offset_y
operator|!=
name|NULL
operator|&&
name|unit_type
operator|!=
name|NULL
condition|)
block|{
operator|*
name|offset_x
operator|=
name|info_ptr
operator|->
name|x_offset
expr_stmt|;
operator|*
name|offset_y
operator|=
name|info_ptr
operator|->
name|y_offset
expr_stmt|;
operator|*
name|unit_type
operator|=
operator|(
name|int
operator|)
name|info_ptr
operator|->
name|offset_unit_type
expr_stmt|;
return|return
operator|(
name|PNG_INFO_oFFs
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_pCAL_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_pCAL
name|png_get_pCAL
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_charp
modifier|*
name|purpose
parameter_list|,
name|png_int_32
modifier|*
name|X0
parameter_list|,
name|png_int_32
modifier|*
name|X1
parameter_list|,
name|int
modifier|*
name|type
parameter_list|,
name|int
modifier|*
name|nparams
parameter_list|,
name|png_charp
modifier|*
name|units
parameter_list|,
name|png_charpp
modifier|*
name|params
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"pCAL"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pCAL
operator|)
operator|!=
literal|0
operator|&&
name|purpose
operator|!=
name|NULL
operator|&&
name|X0
operator|!=
name|NULL
operator|&&
name|X1
operator|!=
name|NULL
operator|&&
name|type
operator|!=
name|NULL
operator|&&
name|nparams
operator|!=
name|NULL
operator|&&
name|units
operator|!=
name|NULL
operator|&&
name|params
operator|!=
name|NULL
condition|)
block|{
operator|*
name|purpose
operator|=
name|info_ptr
operator|->
name|pcal_purpose
expr_stmt|;
operator|*
name|X0
operator|=
name|info_ptr
operator|->
name|pcal_X0
expr_stmt|;
operator|*
name|X1
operator|=
name|info_ptr
operator|->
name|pcal_X1
expr_stmt|;
operator|*
name|type
operator|=
operator|(
name|int
operator|)
name|info_ptr
operator|->
name|pcal_type
expr_stmt|;
operator|*
name|nparams
operator|=
operator|(
name|int
operator|)
name|info_ptr
operator|->
name|pcal_nparams
expr_stmt|;
operator|*
name|units
operator|=
name|info_ptr
operator|->
name|pcal_units
expr_stmt|;
operator|*
name|params
operator|=
name|info_ptr
operator|->
name|pcal_params
expr_stmt|;
return|return
operator|(
name|PNG_INFO_pCAL
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_sCAL_SUPPORTED
end_ifdef
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FIXED_POINT_SUPPORTED
end_ifdef
begin_if
if|#
directive|if
name|defined
argument_list|(
name|PNG_FLOATING_ARITHMETIC_SUPPORTED
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|PNG_FLOATING_POINT_SUPPORTED
argument_list|)
end_if
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_sCAL_fixed
name|png_get_sCAL_fixed
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|int
modifier|*
name|unit
parameter_list|,
name|png_fixed_point
modifier|*
name|width
parameter_list|,
name|png_fixed_point
modifier|*
name|height
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_sCAL
operator|)
operator|!=
literal|0
condition|)
block|{
operator|*
name|unit
operator|=
name|info_ptr
operator|->
name|scal_unit
expr_stmt|;
comment|/*TODO: make this work without FP support; the API is currently eliminated        * if neither floating point APIs nor internal floating point arithmetic        * are enabled.        */
operator|*
name|width
operator|=
name|png_fixed
argument_list|(
name|png_ptr
argument_list|,
name|atof
argument_list|(
name|info_ptr
operator|->
name|scal_s_width
argument_list|)
argument_list|,
literal|"sCAL width"
argument_list|)
expr_stmt|;
operator|*
name|height
operator|=
name|png_fixed
argument_list|(
name|png_ptr
argument_list|,
name|atof
argument_list|(
name|info_ptr
operator|->
name|scal_s_height
argument_list|)
argument_list|,
literal|"sCAL height"
argument_list|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_sCAL
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* FLOATING_ARITHMETIC */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* FIXED_POINT */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_FLOATING_POINT_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_sCAL
name|png_get_sCAL
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|int
modifier|*
name|unit
parameter_list|,
name|double
modifier|*
name|width
parameter_list|,
name|double
modifier|*
name|height
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_sCAL
operator|)
operator|!=
literal|0
condition|)
block|{
operator|*
name|unit
operator|=
name|info_ptr
operator|->
name|scal_unit
expr_stmt|;
operator|*
name|width
operator|=
name|atof
argument_list|(
name|info_ptr
operator|->
name|scal_s_width
argument_list|)
expr_stmt|;
operator|*
name|height
operator|=
name|atof
argument_list|(
name|info_ptr
operator|->
name|scal_s_height
argument_list|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_sCAL
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* FLOATING POINT */
end_comment
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_sCAL_s
name|png_get_sCAL_s
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|int
modifier|*
name|unit
parameter_list|,
name|png_charpp
name|width
parameter_list|,
name|png_charpp
name|height
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_sCAL
operator|)
operator|!=
literal|0
condition|)
block|{
operator|*
name|unit
operator|=
name|info_ptr
operator|->
name|scal_unit
expr_stmt|;
operator|*
name|width
operator|=
name|info_ptr
operator|->
name|scal_s_width
expr_stmt|;
operator|*
name|height
operator|=
name|info_ptr
operator|->
name|scal_s_height
expr_stmt|;
return|return
operator|(
name|PNG_INFO_sCAL
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* sCAL */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_pHYs_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_pHYs
name|png_get_pHYs
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_const_inforp
name|info_ptr
parameter_list|,
name|png_uint_32
modifier|*
name|res_x
parameter_list|,
name|png_uint_32
modifier|*
name|res_y
parameter_list|,
name|int
modifier|*
name|unit_type
parameter_list|)
block|{
name|png_uint_32
name|retval
init|=
literal|0
decl_stmt|;
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"pHYs"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_pHYs
operator|)
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
name|res_x
operator|!=
name|NULL
condition|)
block|{
operator|*
name|res_x
operator|=
name|info_ptr
operator|->
name|x_pixels_per_unit
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_pHYs
expr_stmt|;
block|}
if|if
condition|(
name|res_y
operator|!=
name|NULL
condition|)
block|{
operator|*
name|res_y
operator|=
name|info_ptr
operator|->
name|y_pixels_per_unit
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_pHYs
expr_stmt|;
block|}
if|if
condition|(
name|unit_type
operator|!=
name|NULL
condition|)
block|{
operator|*
name|unit_type
operator|=
operator|(
name|int
operator|)
name|info_ptr
operator|->
name|phys_unit_type
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_pHYs
expr_stmt|;
block|}
block|}
return|return
operator|(
name|retval
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* pHYs */
end_comment
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_PLTE
name|png_get_PLTE
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_colorp
modifier|*
name|palette
parameter_list|,
name|int
modifier|*
name|num_palette
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"PLTE"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_PLTE
operator|)
operator|!=
literal|0
operator|&&
name|palette
operator|!=
name|NULL
condition|)
block|{
operator|*
name|palette
operator|=
name|info_ptr
operator|->
name|palette
expr_stmt|;
operator|*
name|num_palette
operator|=
name|info_ptr
operator|->
name|num_palette
expr_stmt|;
name|png_debug1
argument_list|(
literal|3
argument_list|,
literal|"num_palette = %d"
argument_list|,
operator|*
name|num_palette
argument_list|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_PLTE
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_sBIT_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_sBIT
name|png_get_sBIT
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_color_8p
modifier|*
name|sig_bit
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"sBIT"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_sBIT
operator|)
operator|!=
literal|0
operator|&&
name|sig_bit
operator|!=
name|NULL
condition|)
block|{
operator|*
name|sig_bit
operator|=
operator|&
operator|(
name|info_ptr
operator|->
name|sig_bit
operator|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_sBIT
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_TEXT_SUPPORTED
end_ifdef
begin_function
name|int
name|PNGAPI
DECL|function|png_get_text
name|png_get_text
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_textp
modifier|*
name|text_ptr
parameter_list|,
name|int
modifier|*
name|num_text
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|->
name|num_text
operator|>
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in 0x%lx retrieval function"
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|png_ptr
operator|->
name|chunk_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|text_ptr
operator|!=
name|NULL
condition|)
operator|*
name|text_ptr
operator|=
name|info_ptr
operator|->
name|text
expr_stmt|;
if|if
condition|(
name|num_text
operator|!=
name|NULL
condition|)
operator|*
name|num_text
operator|=
name|info_ptr
operator|->
name|num_text
expr_stmt|;
return|return
name|info_ptr
operator|->
name|num_text
return|;
block|}
if|if
condition|(
name|num_text
operator|!=
name|NULL
condition|)
operator|*
name|num_text
operator|=
literal|0
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_tIME_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_tIME
name|png_get_tIME
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_timep
modifier|*
name|mod_time
parameter_list|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"tIME"
argument_list|)
expr_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_tIME
operator|)
operator|!=
literal|0
operator|&&
name|mod_time
operator|!=
name|NULL
condition|)
block|{
operator|*
name|mod_time
operator|=
operator|&
operator|(
name|info_ptr
operator|->
name|mod_time
operator|)
expr_stmt|;
return|return
operator|(
name|PNG_INFO_tIME
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_tRNS_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_tRNS
name|png_get_tRNS
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_bytep
modifier|*
name|trans_alpha
parameter_list|,
name|int
modifier|*
name|num_trans
parameter_list|,
name|png_color_16p
modifier|*
name|trans_color
parameter_list|)
block|{
name|png_uint_32
name|retval
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
operator|(
name|info_ptr
operator|->
name|valid
operator|&
name|PNG_INFO_tRNS
operator|)
operator|!=
literal|0
condition|)
block|{
name|png_debug1
argument_list|(
literal|1
argument_list|,
literal|"in %s retrieval function"
argument_list|,
literal|"tRNS"
argument_list|)
expr_stmt|;
if|if
condition|(
name|info_ptr
operator|->
name|color_type
operator|==
name|PNG_COLOR_TYPE_PALETTE
condition|)
block|{
if|if
condition|(
name|trans_alpha
operator|!=
name|NULL
condition|)
block|{
operator|*
name|trans_alpha
operator|=
name|info_ptr
operator|->
name|trans_alpha
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_tRNS
expr_stmt|;
block|}
if|if
condition|(
name|trans_color
operator|!=
name|NULL
condition|)
operator|*
name|trans_color
operator|=
operator|&
operator|(
name|info_ptr
operator|->
name|trans_color
operator|)
expr_stmt|;
block|}
else|else
comment|/* if (info_ptr->color_type != PNG_COLOR_TYPE_PALETTE) */
block|{
if|if
condition|(
name|trans_color
operator|!=
name|NULL
condition|)
block|{
operator|*
name|trans_color
operator|=
operator|&
operator|(
name|info_ptr
operator|->
name|trans_color
operator|)
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_tRNS
expr_stmt|;
block|}
if|if
condition|(
name|trans_alpha
operator|!=
name|NULL
condition|)
operator|*
name|trans_alpha
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
name|num_trans
operator|!=
name|NULL
condition|)
block|{
operator|*
name|num_trans
operator|=
name|info_ptr
operator|->
name|num_trans
expr_stmt|;
name|retval
operator||=
name|PNG_INFO_tRNS
expr_stmt|;
block|}
block|}
return|return
operator|(
name|retval
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_STORE_UNKNOWN_CHUNKS_SUPPORTED
end_ifdef
begin_function
name|int
name|PNGAPI
DECL|function|png_get_unknown_chunks
name|png_get_unknown_chunks
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|,
name|png_inforp
name|info_ptr
parameter_list|,
name|png_unknown_chunkpp
name|unknowns
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
operator|&&
name|unknowns
operator|!=
name|NULL
condition|)
block|{
operator|*
name|unknowns
operator|=
name|info_ptr
operator|->
name|unknown_chunks
expr_stmt|;
return|return
name|info_ptr
operator|->
name|unknown_chunks_num
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_READ_RGB_TO_GRAY_SUPPORTED
end_ifdef
begin_function
name|png_byte
name|PNGAPI
DECL|function|png_get_rgb_to_gray_status
name|png_get_rgb_to_gray_status
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
call|(
name|png_byte
call|)
argument_list|(
name|png_ptr
condition|?
name|png_ptr
operator|->
name|rgb_to_gray_status
else|:
literal|0
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_USER_CHUNKS_SUPPORTED
end_ifdef
begin_function
name|png_voidp
name|PNGAPI
DECL|function|png_get_user_chunk_ptr
name|png_get_user_chunk_ptr
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
operator|(
name|png_ptr
condition|?
name|png_ptr
operator|->
name|user_chunk_ptr
else|:
name|NULL
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
name|png_size_t
name|PNGAPI
DECL|function|png_get_compression_buffer_size
name|png_get_compression_buffer_size
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
ifdef|#
directive|ifdef
name|PNG_WRITE_SUPPORTED
if|if
condition|(
operator|(
name|png_ptr
operator|->
name|mode
operator|&
name|PNG_IS_READ_STRUCT
operator|)
operator|!=
literal|0
condition|)
endif|#
directive|endif
block|{
ifdef|#
directive|ifdef
name|PNG_SEQUENTIAL_READ_SUPPORTED
return|return
name|png_ptr
operator|->
name|IDAT_read_size
return|;
else|#
directive|else
return|return
name|PNG_IDAT_READ_SIZE
return|;
endif|#
directive|endif
block|}
ifdef|#
directive|ifdef
name|PNG_WRITE_SUPPORTED
else|else
return|return
name|png_ptr
operator|->
name|zbuffer_size
return|;
endif|#
directive|endif
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_SET_USER_LIMITS_SUPPORTED
end_ifdef
begin_comment
comment|/* These functions were added to libpng 1.2.6 and were enabled  * by default in libpng-1.4.0 */
end_comment
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_user_width_max
name|png_get_user_width_max
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
operator|(
name|png_ptr
condition|?
name|png_ptr
operator|->
name|user_width_max
else|:
literal|0
operator|)
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_user_height_max
name|png_get_user_height_max
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
operator|(
name|png_ptr
condition|?
name|png_ptr
operator|->
name|user_height_max
else|:
literal|0
operator|)
return|;
block|}
end_function
begin_comment
comment|/* This function was added to libpng 1.4.0 */
end_comment
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_chunk_cache_max
name|png_get_chunk_cache_max
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
operator|(
name|png_ptr
condition|?
name|png_ptr
operator|->
name|user_chunk_cache_max
else|:
literal|0
operator|)
return|;
block|}
end_function
begin_comment
comment|/* This function was added to libpng 1.4.1 */
end_comment
begin_function
name|png_alloc_size_t
name|PNGAPI
DECL|function|png_get_chunk_malloc_max
name|png_get_chunk_malloc_max
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
operator|(
name|png_ptr
condition|?
name|png_ptr
operator|->
name|user_chunk_malloc_max
else|:
literal|0
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* SET_USER_LIMITS */
end_comment
begin_comment
comment|/* These functions were added to libpng 1.4.0 */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_IO_STATE_SUPPORTED
end_ifdef
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_io_state
name|png_get_io_state
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
name|png_ptr
operator|->
name|io_state
return|;
block|}
end_function
begin_function
name|png_uint_32
name|PNGAPI
DECL|function|png_get_io_chunk_type
name|png_get_io_chunk_type
parameter_list|(
name|png_const_structrp
name|png_ptr
parameter_list|)
block|{
return|return
name|png_ptr
operator|->
name|chunk_name
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* IO_STATE */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_CHECK_FOR_INVALID_INDEX_SUPPORTED
end_ifdef
begin_ifdef
ifdef|#
directive|ifdef
name|PNG_GET_PALETTE_MAX_SUPPORTED
end_ifdef
begin_function
name|int
name|PNGAPI
DECL|function|png_get_palette_max
name|png_get_palette_max
parameter_list|(
name|png_const_structp
name|png_ptr
parameter_list|,
name|png_const_infop
name|info_ptr
parameter_list|)
block|{
if|if
condition|(
name|png_ptr
operator|!=
name|NULL
operator|&&
name|info_ptr
operator|!=
name|NULL
condition|)
return|return
name|png_ptr
operator|->
name|num_palette_max
return|;
return|return
operator|(
operator|-
literal|1
operator|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* READ || WRITE */
end_comment
end_unit
