begin_unit
begin_comment
comment|//
end_comment
begin_comment
comment|// Copyright(c) 2014 The ANGLE Project Authors. All rights reserved.
end_comment
begin_comment
comment|// Use of this source code is governed by a BSD-style license that can be
end_comment
begin_comment
comment|// found in the LICENSE file.
end_comment
begin_comment
comment|//
end_comment
begin_comment
comment|// entry_points_gles_2_0_ext.cpp : Implements the GLES 2.0 extension entry points.
end_comment
begin_include
include|#
directive|include
file|"libGLESv2/entry_points_gles_2_0_ext.h"
end_include
begin_include
include|#
directive|include
file|"libGLESv2/global_state.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Buffer.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Context.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Error.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Fence.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Framebuffer.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Shader.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/Query.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/validationES.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/validationES2.h"
end_include
begin_include
include|#
directive|include
file|"libANGLE/validationES3.h"
end_include
begin_include
include|#
directive|include
file|"common/debug.h"
end_include
begin_include
include|#
directive|include
file|"common/utilities.h"
end_include
begin_namespace
DECL|namespace|gl
namespace|namespace
name|gl
block|{
DECL|function|BeginQueryEXT
name|void
name|GL_APIENTRY
name|BeginQueryEXT
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLuint
name|id
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLuint %d)"
argument_list|,
name|target
argument_list|,
name|id
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateBeginQuery
argument_list|(
name|context
argument_list|,
name|target
argument_list|,
name|id
argument_list|)
condition|)
block|{
return|return;
block|}
name|Error
name|error
init|=
name|context
operator|->
name|beginQuery
argument_list|(
name|target
argument_list|,
name|id
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|DeleteFencesNV
name|void
name|GL_APIENTRY
name|DeleteFencesNV
parameter_list|(
name|GLsizei
name|n
parameter_list|,
specifier|const
name|GLuint
modifier|*
name|fences
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLsizei n = %d, const GLuint* fences = 0x%0.8p)"
argument_list|,
name|n
argument_list|,
name|fences
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|n
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
name|context
operator|->
name|deleteFenceNV
argument_list|(
name|fences
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|function|DeleteQueriesEXT
name|void
name|GL_APIENTRY
name|DeleteQueriesEXT
parameter_list|(
name|GLsizei
name|n
parameter_list|,
specifier|const
name|GLuint
modifier|*
name|ids
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLsizei n = %d, const GLuint *ids = 0x%0.8p)"
argument_list|,
name|n
argument_list|,
name|ids
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|n
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
name|context
operator|->
name|deleteQuery
argument_list|(
name|ids
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|function|DrawArraysInstancedANGLE
name|void
name|GL_APIENTRY
name|DrawArraysInstancedANGLE
parameter_list|(
name|GLenum
name|mode
parameter_list|,
name|GLint
name|first
parameter_list|,
name|GLsizei
name|count
parameter_list|,
name|GLsizei
name|primcount
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum mode = 0x%X, GLint first = %d, GLsizei count = %d, GLsizei primcount = %d)"
argument_list|,
name|mode
argument_list|,
name|first
argument_list|,
name|count
argument_list|,
name|primcount
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateDrawArraysInstancedANGLE
argument_list|(
name|context
argument_list|,
name|mode
argument_list|,
name|first
argument_list|,
name|count
argument_list|,
name|primcount
argument_list|)
condition|)
block|{
return|return;
block|}
name|Error
name|error
init|=
name|context
operator|->
name|drawArrays
argument_list|(
name|mode
argument_list|,
name|first
argument_list|,
name|count
argument_list|,
name|primcount
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|DrawElementsInstancedANGLE
name|void
name|GL_APIENTRY
name|DrawElementsInstancedANGLE
parameter_list|(
name|GLenum
name|mode
parameter_list|,
name|GLsizei
name|count
parameter_list|,
name|GLenum
name|type
parameter_list|,
specifier|const
name|GLvoid
modifier|*
name|indices
parameter_list|,
name|GLsizei
name|primcount
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum mode = 0x%X, GLsizei count = %d, GLenum type = 0x%X, const GLvoid* indices = 0x%0.8p, GLsizei primcount = %d)"
argument_list|,
name|mode
argument_list|,
name|count
argument_list|,
name|type
argument_list|,
name|indices
argument_list|,
name|primcount
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|rx
operator|::
name|RangeUI
name|indexRange
decl_stmt|;
if|if
condition|(
operator|!
name|ValidateDrawElementsInstancedANGLE
argument_list|(
name|context
argument_list|,
name|mode
argument_list|,
name|count
argument_list|,
name|type
argument_list|,
name|indices
argument_list|,
name|primcount
argument_list|,
operator|&
name|indexRange
argument_list|)
condition|)
block|{
return|return;
block|}
name|Error
name|error
init|=
name|context
operator|->
name|drawElements
argument_list|(
name|mode
argument_list|,
name|count
argument_list|,
name|type
argument_list|,
name|indices
argument_list|,
name|primcount
argument_list|,
name|indexRange
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|EndQueryEXT
name|void
name|GL_APIENTRY
name|EndQueryEXT
parameter_list|(
name|GLenum
name|target
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"GLenum target = 0x%X)"
argument_list|,
name|target
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateEndQuery
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
return|return;
block|}
name|Error
name|error
init|=
name|context
operator|->
name|endQuery
argument_list|(
name|target
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|FinishFenceNV
name|void
name|GL_APIENTRY
name|FinishFenceNV
parameter_list|(
name|GLuint
name|fence
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint fence = %d)"
argument_list|,
name|fence
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|FenceNV
modifier|*
name|fenceObject
init|=
name|context
operator|->
name|getFenceNV
argument_list|(
name|fence
argument_list|)
decl_stmt|;
if|if
condition|(
name|fenceObject
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|fenceObject
operator|->
name|isFence
argument_list|()
operator|!=
name|GL_TRUE
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|fenceObject
operator|->
name|finishFence
argument_list|()
expr_stmt|;
block|}
block|}
DECL|function|GenFencesNV
name|void
name|GL_APIENTRY
name|GenFencesNV
parameter_list|(
name|GLsizei
name|n
parameter_list|,
name|GLuint
modifier|*
name|fences
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLsizei n = %d, GLuint* fences = 0x%0.8p)"
argument_list|,
name|n
argument_list|,
name|fences
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|n
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
name|fences
index|[
name|i
index|]
operator|=
name|context
operator|->
name|createFenceNV
argument_list|()
expr_stmt|;
block|}
block|}
block|}
DECL|function|GenQueriesEXT
name|void
name|GL_APIENTRY
name|GenQueriesEXT
parameter_list|(
name|GLsizei
name|n
parameter_list|,
name|GLuint
modifier|*
name|ids
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLsizei n = %d, GLuint* ids = 0x%0.8p)"
argument_list|,
name|n
argument_list|,
name|ids
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|n
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|GLsizei
name|i
init|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
block|{
name|ids
index|[
name|i
index|]
operator|=
name|context
operator|->
name|createQuery
argument_list|()
expr_stmt|;
block|}
block|}
block|}
DECL|function|GetFenceivNV
name|void
name|GL_APIENTRY
name|GetFenceivNV
parameter_list|(
name|GLuint
name|fence
parameter_list|,
name|GLenum
name|pname
parameter_list|,
name|GLint
modifier|*
name|params
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint fence = %d, GLenum pname = 0x%X, GLint *params = 0x%0.8p)"
argument_list|,
name|fence
argument_list|,
name|pname
argument_list|,
name|params
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|FenceNV
modifier|*
name|fenceObject
init|=
name|context
operator|->
name|getFenceNV
argument_list|(
name|fence
argument_list|)
decl_stmt|;
if|if
condition|(
name|fenceObject
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|fenceObject
operator|->
name|isFence
argument_list|()
operator|!=
name|GL_TRUE
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
switch|switch
condition|(
name|pname
condition|)
block|{
case|case
name|GL_FENCE_STATUS_NV
case|:
block|{
comment|// GL_NV_fence spec:
comment|// Once the status of a fence has been finished (via FinishFenceNV) or tested and the returned status is TRUE (via either TestFenceNV
comment|// or GetFenceivNV querying the FENCE_STATUS_NV), the status remains TRUE until the next SetFenceNV of the fence.
name|GLboolean
name|status
init|=
name|GL_TRUE
decl_stmt|;
if|if
condition|(
name|fenceObject
operator|->
name|getStatus
argument_list|()
operator|!=
name|GL_TRUE
condition|)
block|{
name|Error
name|error
init|=
name|fenceObject
operator|->
name|testFence
argument_list|(
operator|&
name|status
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
operator|*
name|params
operator|=
name|status
expr_stmt|;
break|break;
block|}
case|case
name|GL_FENCE_CONDITION_NV
case|:
block|{
operator|*
name|params
operator|=
cast|static_cast
argument_list|<
name|GLint
argument_list|>
argument_list|(
name|fenceObject
operator|->
name|getCondition
argument_list|()
argument_list|)
expr_stmt|;
break|break;
block|}
default|default:
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
block|}
DECL|function|GetGraphicsResetStatusEXT
name|GLenum
name|GL_APIENTRY
name|GetGraphicsResetStatusEXT
parameter_list|(
name|void
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"()"
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
return|return
name|context
operator|->
name|getResetStatus
argument_list|()
return|;
block|}
return|return
name|GL_NO_ERROR
return|;
block|}
DECL|function|GetQueryivEXT
name|void
name|GL_APIENTRY
name|GetQueryivEXT
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLenum
name|pname
parameter_list|,
name|GLint
modifier|*
name|params
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"GLenum target = 0x%X, GLenum pname = 0x%X, GLint *params = 0x%0.8p)"
argument_list|,
name|target
argument_list|,
name|pname
argument_list|,
name|params
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidQueryType
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
switch|switch
condition|(
name|pname
condition|)
block|{
case|case
name|GL_CURRENT_QUERY_EXT
case|:
name|params
index|[
literal|0
index|]
operator|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getActiveQueryId
argument_list|(
name|target
argument_list|)
expr_stmt|;
break|break;
default|default:
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|GetQueryObjectuivEXT
name|void
name|GL_APIENTRY
name|GetQueryObjectuivEXT
parameter_list|(
name|GLuint
name|id
parameter_list|,
name|GLenum
name|pname
parameter_list|,
name|GLuint
modifier|*
name|params
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint id = %d, GLenum pname = 0x%X, GLuint *params = 0x%0.8p)"
argument_list|,
name|id
argument_list|,
name|pname
argument_list|,
name|params
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|Query
modifier|*
name|queryObject
init|=
name|context
operator|->
name|getQuery
argument_list|(
name|id
argument_list|,
literal|false
argument_list|,
name|GL_NONE
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|queryObject
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getActiveQueryId
argument_list|(
name|queryObject
operator|->
name|getType
argument_list|()
argument_list|)
operator|==
name|id
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
switch|switch
condition|(
name|pname
condition|)
block|{
case|case
name|GL_QUERY_RESULT_EXT
case|:
block|{
name|Error
name|error
init|=
name|queryObject
operator|->
name|getResult
argument_list|(
name|params
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
break|break;
case|case
name|GL_QUERY_RESULT_AVAILABLE_EXT
case|:
block|{
name|Error
name|error
init|=
name|queryObject
operator|->
name|isResultAvailable
argument_list|(
name|params
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
break|break;
default|default:
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|GetTranslatedShaderSourceANGLE
name|void
name|GL_APIENTRY
name|GetTranslatedShaderSourceANGLE
parameter_list|(
name|GLuint
name|shader
parameter_list|,
name|GLsizei
name|bufsize
parameter_list|,
name|GLsizei
modifier|*
name|length
parameter_list|,
name|GLchar
modifier|*
name|source
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint shader = %d, GLsizei bufsize = %d, GLsizei* length = 0x%0.8p, GLchar* source = 0x%0.8p)"
argument_list|,
name|shader
argument_list|,
name|bufsize
argument_list|,
name|length
argument_list|,
name|source
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|bufsize
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Shader
modifier|*
name|shaderObject
init|=
name|context
operator|->
name|getShader
argument_list|(
name|shader
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|shaderObject
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
comment|// Only returns extra info if ANGLE_GENERATE_SHADER_DEBUG_INFO is defined
name|shaderObject
operator|->
name|getTranslatedSourceWithDebugInfo
argument_list|(
name|bufsize
argument_list|,
name|length
argument_list|,
name|source
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|GetnUniformfvEXT
name|void
name|GL_APIENTRY
name|GetnUniformfvEXT
parameter_list|(
name|GLuint
name|program
parameter_list|,
name|GLint
name|location
parameter_list|,
name|GLsizei
name|bufSize
parameter_list|,
name|GLfloat
modifier|*
name|params
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint program = %d, GLint location = %d, GLsizei bufSize = %d, GLfloat* params = 0x%0.8p)"
argument_list|,
name|program
argument_list|,
name|location
argument_list|,
name|bufSize
argument_list|,
name|params
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateGetnUniformfvEXT
argument_list|(
name|context
argument_list|,
name|program
argument_list|,
name|location
argument_list|,
name|bufSize
argument_list|,
name|params
argument_list|)
condition|)
block|{
return|return;
block|}
name|Program
modifier|*
name|programObject
init|=
name|context
operator|->
name|getProgram
argument_list|(
name|program
argument_list|)
decl_stmt|;
name|ASSERT
argument_list|(
name|programObject
argument_list|)
expr_stmt|;
name|programObject
operator|->
name|getUniformfv
argument_list|(
name|location
argument_list|,
name|params
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|GetnUniformivEXT
name|void
name|GL_APIENTRY
name|GetnUniformivEXT
parameter_list|(
name|GLuint
name|program
parameter_list|,
name|GLint
name|location
parameter_list|,
name|GLsizei
name|bufSize
parameter_list|,
name|GLint
modifier|*
name|params
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint program = %d, GLint location = %d, GLsizei bufSize = %d, GLint* params = 0x%0.8p)"
argument_list|,
name|program
argument_list|,
name|location
argument_list|,
name|bufSize
argument_list|,
name|params
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateGetnUniformivEXT
argument_list|(
name|context
argument_list|,
name|program
argument_list|,
name|location
argument_list|,
name|bufSize
argument_list|,
name|params
argument_list|)
condition|)
block|{
return|return;
block|}
name|Program
modifier|*
name|programObject
init|=
name|context
operator|->
name|getProgram
argument_list|(
name|program
argument_list|)
decl_stmt|;
name|ASSERT
argument_list|(
name|programObject
argument_list|)
expr_stmt|;
name|programObject
operator|->
name|getUniformiv
argument_list|(
name|location
argument_list|,
name|params
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|IsFenceNV
name|GLboolean
name|GL_APIENTRY
name|IsFenceNV
parameter_list|(
name|GLuint
name|fence
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint fence = %d)"
argument_list|,
name|fence
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|FenceNV
modifier|*
name|fenceObject
init|=
name|context
operator|->
name|getFenceNV
argument_list|(
name|fence
argument_list|)
decl_stmt|;
if|if
condition|(
name|fenceObject
operator|==
name|NULL
condition|)
block|{
return|return
name|GL_FALSE
return|;
block|}
return|return
name|fenceObject
operator|->
name|isFence
argument_list|()
return|;
block|}
return|return
name|GL_FALSE
return|;
block|}
DECL|function|IsQueryEXT
name|GLboolean
name|GL_APIENTRY
name|IsQueryEXT
parameter_list|(
name|GLuint
name|id
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint id = %d)"
argument_list|,
name|id
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
return|return
operator|(
name|context
operator|->
name|getQuery
argument_list|(
name|id
argument_list|,
literal|false
argument_list|,
name|GL_NONE
argument_list|)
operator|!=
name|NULL
operator|)
condition|?
name|GL_TRUE
else|:
name|GL_FALSE
return|;
block|}
return|return
name|GL_FALSE
return|;
block|}
DECL|function|ReadnPixelsEXT
name|void
name|GL_APIENTRY
name|ReadnPixelsEXT
parameter_list|(
name|GLint
name|x
parameter_list|,
name|GLint
name|y
parameter_list|,
name|GLsizei
name|width
parameter_list|,
name|GLsizei
name|height
parameter_list|,
name|GLenum
name|format
parameter_list|,
name|GLenum
name|type
parameter_list|,
name|GLsizei
name|bufSize
parameter_list|,
name|GLvoid
modifier|*
name|data
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLint x = %d, GLint y = %d, GLsizei width = %d, GLsizei height = %d, "
literal|"GLenum format = 0x%X, GLenum type = 0x%X, GLsizei bufSize = 0x%d, GLvoid *data = 0x%0.8p)"
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|format
argument_list|,
name|type
argument_list|,
name|bufSize
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|width
operator|<
literal|0
operator|||
name|height
operator|<
literal|0
operator|||
name|bufSize
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
operator|!
name|ValidateReadPixelsParameters
argument_list|(
name|context
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|format
argument_list|,
name|type
argument_list|,
operator|&
name|bufSize
argument_list|,
name|data
argument_list|)
condition|)
block|{
return|return;
block|}
name|Framebuffer
modifier|*
name|framebufferObject
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getReadFramebuffer
argument_list|()
decl_stmt|;
name|ASSERT
argument_list|(
name|framebufferObject
argument_list|)
expr_stmt|;
name|Rectangle
name|area
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
decl_stmt|;
name|Error
name|error
init|=
name|framebufferObject
operator|->
name|readPixels
argument_list|(
name|context
operator|->
name|getState
argument_list|()
argument_list|,
name|area
argument_list|,
name|format
argument_list|,
name|type
argument_list|,
name|data
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|RenderbufferStorageMultisampleANGLE
name|void
name|GL_APIENTRY
name|RenderbufferStorageMultisampleANGLE
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLsizei
name|samples
parameter_list|,
name|GLenum
name|internalformat
parameter_list|,
name|GLsizei
name|width
parameter_list|,
name|GLsizei
name|height
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLsizei samples = %d, GLenum internalformat = 0x%X, GLsizei width = %d, GLsizei height = %d)"
argument_list|,
name|target
argument_list|,
name|samples
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateRenderbufferStorageParametersANGLE
argument_list|(
name|context
argument_list|,
name|target
argument_list|,
name|samples
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
condition|)
block|{
return|return;
block|}
name|Renderbuffer
modifier|*
name|renderbuffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getCurrentRenderbuffer
argument_list|()
decl_stmt|;
name|Error
name|error
init|=
name|renderbuffer
operator|->
name|setStorageMultisample
argument_list|(
name|samples
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|SetFenceNV
name|void
name|GL_APIENTRY
name|SetFenceNV
parameter_list|(
name|GLuint
name|fence
parameter_list|,
name|GLenum
name|condition
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint fence = %d, GLenum condition = 0x%X)"
argument_list|,
name|fence
argument_list|,
name|condition
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|condition
operator|!=
name|GL_ALL_COMPLETED_NV
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|FenceNV
modifier|*
name|fenceObject
init|=
name|context
operator|->
name|getFenceNV
argument_list|(
name|fence
argument_list|)
decl_stmt|;
if|if
condition|(
name|fenceObject
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Error
name|error
init|=
name|fenceObject
operator|->
name|setFence
argument_list|(
name|condition
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|TestFenceNV
name|GLboolean
name|GL_APIENTRY
name|TestFenceNV
parameter_list|(
name|GLuint
name|fence
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint fence = %d)"
argument_list|,
name|fence
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|FenceNV
modifier|*
name|fenceObject
init|=
name|context
operator|->
name|getFenceNV
argument_list|(
name|fence
argument_list|)
decl_stmt|;
if|if
condition|(
name|fenceObject
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|GL_TRUE
return|;
block|}
if|if
condition|(
name|fenceObject
operator|->
name|isFence
argument_list|()
operator|!=
name|GL_TRUE
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|GL_TRUE
return|;
block|}
name|GLboolean
name|result
decl_stmt|;
name|Error
name|error
init|=
name|fenceObject
operator|->
name|testFence
argument_list|(
operator|&
name|result
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return
name|GL_TRUE
return|;
block|}
return|return
name|result
return|;
block|}
return|return
name|GL_TRUE
return|;
block|}
DECL|function|TexStorage2DEXT
name|void
name|GL_APIENTRY
name|TexStorage2DEXT
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLsizei
name|levels
parameter_list|,
name|GLenum
name|internalformat
parameter_list|,
name|GLsizei
name|width
parameter_list|,
name|GLsizei
name|height
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLsizei levels = %d, GLenum internalformat = 0x%X, GLsizei width = %d, GLsizei height = %d)"
argument_list|,
name|target
argument_list|,
name|levels
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|context
operator|->
name|getExtensions
argument_list|()
operator|.
name|textureStorage
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|context
operator|->
name|getClientVersion
argument_list|()
operator|<
literal|3
operator|&&
operator|!
name|ValidateES2TexStorageParameters
argument_list|(
name|context
argument_list|,
name|target
argument_list|,
name|levels
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
condition|)
block|{
return|return;
block|}
if|if
condition|(
name|context
operator|->
name|getClientVersion
argument_list|()
operator|>=
literal|3
operator|&&
operator|!
name|ValidateES3TexStorageParameters
argument_list|(
name|context
argument_list|,
name|target
argument_list|,
name|levels
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
literal|1
argument_list|)
condition|)
block|{
return|return;
block|}
name|Extents
name|size
argument_list|(
name|width
argument_list|,
name|height
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|Texture
modifier|*
name|texture
init|=
name|context
operator|->
name|getTargetTexture
argument_list|(
name|target
argument_list|)
decl_stmt|;
name|Error
name|error
init|=
name|texture
operator|->
name|setStorage
argument_list|(
name|target
argument_list|,
name|levels
argument_list|,
name|internalformat
argument_list|,
name|size
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|VertexAttribDivisorANGLE
name|void
name|GL_APIENTRY
name|VertexAttribDivisorANGLE
parameter_list|(
name|GLuint
name|index
parameter_list|,
name|GLuint
name|divisor
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLuint index = %d, GLuint divisor = %d)"
argument_list|,
name|index
argument_list|,
name|divisor
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|index
operator|>=
name|MAX_VERTEX_ATTRIBS
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|context
operator|->
name|setVertexAttribDivisor
argument_list|(
name|index
argument_list|,
name|divisor
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|BlitFramebufferANGLE
name|void
name|GL_APIENTRY
name|BlitFramebufferANGLE
parameter_list|(
name|GLint
name|srcX0
parameter_list|,
name|GLint
name|srcY0
parameter_list|,
name|GLint
name|srcX1
parameter_list|,
name|GLint
name|srcY1
parameter_list|,
name|GLint
name|dstX0
parameter_list|,
name|GLint
name|dstY0
parameter_list|,
name|GLint
name|dstX1
parameter_list|,
name|GLint
name|dstY1
parameter_list|,
name|GLbitfield
name|mask
parameter_list|,
name|GLenum
name|filter
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLint srcX0 = %d, GLint srcY0 = %d, GLint srcX1 = %d, GLint srcY1 = %d, "
literal|"GLint dstX0 = %d, GLint dstY0 = %d, GLint dstX1 = %d, GLint dstY1 = %d, "
literal|"GLbitfield mask = 0x%X, GLenum filter = 0x%X)"
argument_list|,
name|srcX0
argument_list|,
name|srcY0
argument_list|,
name|srcX1
argument_list|,
name|srcX1
argument_list|,
name|dstX0
argument_list|,
name|dstY0
argument_list|,
name|dstX1
argument_list|,
name|dstY1
argument_list|,
name|mask
argument_list|,
name|filter
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidateBlitFramebufferParameters
argument_list|(
name|context
argument_list|,
name|srcX0
argument_list|,
name|srcY0
argument_list|,
name|srcX1
argument_list|,
name|srcY1
argument_list|,
name|dstX0
argument_list|,
name|dstY0
argument_list|,
name|dstX1
argument_list|,
name|dstY1
argument_list|,
name|mask
argument_list|,
name|filter
argument_list|,
literal|true
argument_list|)
condition|)
block|{
return|return;
block|}
name|Framebuffer
modifier|*
name|readFramebuffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getReadFramebuffer
argument_list|()
decl_stmt|;
name|ASSERT
argument_list|(
name|readFramebuffer
argument_list|)
expr_stmt|;
name|Framebuffer
modifier|*
name|drawFramebuffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getDrawFramebuffer
argument_list|()
decl_stmt|;
name|ASSERT
argument_list|(
name|drawFramebuffer
argument_list|)
expr_stmt|;
name|Rectangle
name|srcArea
argument_list|(
name|srcX0
argument_list|,
name|srcY0
argument_list|,
name|srcX1
operator|-
name|srcX0
argument_list|,
name|srcY1
operator|-
name|srcY0
argument_list|)
decl_stmt|;
name|Rectangle
name|dstArea
argument_list|(
name|dstX0
argument_list|,
name|dstY0
argument_list|,
name|dstX1
operator|-
name|dstX0
argument_list|,
name|dstY1
operator|-
name|dstY0
argument_list|)
decl_stmt|;
name|Error
name|error
init|=
name|drawFramebuffer
operator|->
name|blit
argument_list|(
name|context
operator|->
name|getState
argument_list|()
argument_list|,
name|srcArea
argument_list|,
name|dstArea
argument_list|,
name|mask
argument_list|,
name|filter
argument_list|,
name|readFramebuffer
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|TexImage3DOES
name|void
name|GL_APIENTRY
name|TexImage3DOES
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLint
name|level
parameter_list|,
name|GLenum
name|internalformat
parameter_list|,
name|GLsizei
name|width
parameter_list|,
name|GLsizei
name|height
parameter_list|,
name|GLsizei
name|depth
parameter_list|,
name|GLint
name|border
parameter_list|,
name|GLenum
name|format
parameter_list|,
name|GLenum
name|type
parameter_list|,
specifier|const
name|GLvoid
modifier|*
name|pixels
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLint level = %d, GLenum internalformat = 0x%X, "
literal|"GLsizei width = %d, GLsizei height = %d, GLsizei depth = %d, GLint border = %d, "
literal|"GLenum format = 0x%X, GLenum type = 0x%x, const GLvoid* pixels = 0x%0.8p)"
argument_list|,
name|target
argument_list|,
name|level
argument_list|,
name|internalformat
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|depth
argument_list|,
name|border
argument_list|,
name|format
argument_list|,
name|type
argument_list|,
name|pixels
argument_list|)
expr_stmt|;
name|UNIMPLEMENTED
argument_list|()
expr_stmt|;
comment|// FIXME
block|}
DECL|function|GetProgramBinaryOES
name|void
name|GL_APIENTRY
name|GetProgramBinaryOES
parameter_list|(
name|GLuint
name|program
parameter_list|,
name|GLsizei
name|bufSize
parameter_list|,
name|GLsizei
modifier|*
name|length
parameter_list|,
name|GLenum
modifier|*
name|binaryFormat
parameter_list|,
name|void
modifier|*
name|binary
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum program = 0x%X, bufSize = %d, length = 0x%0.8p, binaryFormat = 0x%0.8p, binary = 0x%0.8p)"
argument_list|,
name|program
argument_list|,
name|bufSize
argument_list|,
name|length
argument_list|,
name|binaryFormat
argument_list|,
name|binary
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
name|Program
modifier|*
name|programObject
init|=
name|context
operator|->
name|getProgram
argument_list|(
name|program
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|programObject
operator|||
operator|!
name|programObject
operator|->
name|isLinked
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Error
name|error
init|=
name|programObject
operator|->
name|saveBinary
argument_list|(
name|binaryFormat
argument_list|,
name|binary
argument_list|,
name|bufSize
argument_list|,
name|length
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|ProgramBinaryOES
name|void
name|GL_APIENTRY
name|ProgramBinaryOES
parameter_list|(
name|GLuint
name|program
parameter_list|,
name|GLenum
name|binaryFormat
parameter_list|,
specifier|const
name|void
modifier|*
name|binary
parameter_list|,
name|GLint
name|length
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum program = 0x%X, binaryFormat = 0x%x, binary = 0x%0.8p, length = %d)"
argument_list|,
name|program
argument_list|,
name|binaryFormat
argument_list|,
name|binary
argument_list|,
name|length
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
specifier|const
name|std
operator|::
name|vector
argument_list|<
name|GLenum
argument_list|>
modifier|&
name|programBinaryFormats
init|=
name|context
operator|->
name|getCaps
argument_list|()
operator|.
name|programBinaryFormats
decl_stmt|;
if|if
condition|(
name|std
operator|::
name|find
argument_list|(
name|programBinaryFormats
operator|.
name|begin
argument_list|()
argument_list|,
name|programBinaryFormats
operator|.
name|end
argument_list|()
argument_list|,
name|binaryFormat
argument_list|)
operator|==
name|programBinaryFormats
operator|.
name|end
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Program
modifier|*
name|programObject
init|=
name|context
operator|->
name|getProgram
argument_list|(
name|program
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|programObject
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Error
name|error
init|=
name|programObject
operator|->
name|loadBinary
argument_list|(
name|binaryFormat
argument_list|,
name|binary
argument_list|,
name|length
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
DECL|function|DrawBuffersEXT
name|void
name|GL_APIENTRY
name|DrawBuffersEXT
parameter_list|(
name|GLsizei
name|n
parameter_list|,
specifier|const
name|GLenum
modifier|*
name|bufs
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum n = %d, bufs = 0x%0.8p)"
argument_list|,
name|n
argument_list|,
name|bufs
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|n
operator|<
literal|0
operator|||
cast|static_cast
argument_list|<
name|GLuint
argument_list|>
argument_list|(
name|n
argument_list|)
operator|>
name|context
operator|->
name|getCaps
argument_list|()
operator|.
name|maxDrawBuffers
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|ASSERT
argument_list|(
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getDrawFramebuffer
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getDrawFramebuffer
argument_list|()
operator|->
name|id
argument_list|()
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|n
operator|!=
literal|1
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|bufs
index|[
literal|0
index|]
operator|!=
name|GL_NONE
operator|&&
name|bufs
index|[
literal|0
index|]
operator|!=
name|GL_BACK
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
else|else
block|{
for|for
control|(
name|int
name|colorAttachment
init|=
literal|0
init|;
name|colorAttachment
operator|<
name|n
condition|;
name|colorAttachment
operator|++
control|)
block|{
specifier|const
name|GLenum
name|attachment
init|=
name|GL_COLOR_ATTACHMENT0_EXT
operator|+
name|colorAttachment
decl_stmt|;
if|if
condition|(
name|bufs
index|[
name|colorAttachment
index|]
operator|!=
name|GL_NONE
operator|&&
name|bufs
index|[
name|colorAttachment
index|]
operator|!=
name|attachment
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
name|Framebuffer
modifier|*
name|framebuffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getDrawFramebuffer
argument_list|()
decl_stmt|;
name|ASSERT
argument_list|(
name|framebuffer
argument_list|)
expr_stmt|;
name|framebuffer
operator|->
name|setDrawBuffers
argument_list|(
name|n
argument_list|,
name|bufs
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|GetBufferPointervOES
name|void
name|GL_APIENTRY
name|GetBufferPointervOES
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLenum
name|pname
parameter_list|,
name|void
modifier|*
modifier|*
name|params
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLenum pname = 0x%X, GLvoid** params = 0x%0.8p)"
argument_list|,
name|target
argument_list|,
name|pname
argument_list|,
name|params
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidBufferTarget
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|pname
operator|!=
name|GL_BUFFER_MAP_POINTER
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Buffer
modifier|*
name|buffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getTargetBuffer
argument_list|(
name|target
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|buffer
operator|||
operator|!
name|buffer
operator|->
name|isMapped
argument_list|()
condition|)
block|{
operator|*
name|params
operator|=
name|NULL
expr_stmt|;
block|}
else|else
block|{
operator|*
name|params
operator|=
name|buffer
operator|->
name|getMapPointer
argument_list|()
expr_stmt|;
block|}
block|}
block|}
DECL|function|MapBufferOES
name|void
modifier|*
name|GL_APIENTRY
name|MapBufferOES
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLenum
name|access
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLbitfield access = 0x%X)"
argument_list|,
name|target
argument_list|,
name|access
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidBufferTarget
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Buffer
modifier|*
name|buffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getTargetBuffer
argument_list|(
name|target
argument_list|)
decl_stmt|;
if|if
condition|(
name|buffer
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|access
operator|!=
name|GL_WRITE_ONLY_OES
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|buffer
operator|->
name|isMapped
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Error
name|error
init|=
name|buffer
operator|->
name|mapRange
argument_list|(
literal|0
argument_list|,
name|buffer
operator|->
name|getSize
argument_list|()
argument_list|,
name|GL_MAP_WRITE_BIT
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|buffer
operator|->
name|getMapPointer
argument_list|()
return|;
block|}
return|return
name|NULL
return|;
block|}
DECL|function|UnmapBufferOES
name|GLboolean
name|GL_APIENTRY
name|UnmapBufferOES
parameter_list|(
name|GLenum
name|target
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X)"
argument_list|,
name|target
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidBufferTarget
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|GL_FALSE
return|;
block|}
name|Buffer
modifier|*
name|buffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getTargetBuffer
argument_list|(
name|target
argument_list|)
decl_stmt|;
if|if
condition|(
name|buffer
operator|==
name|NULL
operator|||
operator|!
name|buffer
operator|->
name|isMapped
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|GL_FALSE
return|;
block|}
comment|// TODO: detect if we had corruption. if so, throw an error and return false.
name|Error
name|error
init|=
name|buffer
operator|->
name|unmap
argument_list|()
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return
name|GL_FALSE
return|;
block|}
return|return
name|GL_TRUE
return|;
block|}
return|return
name|GL_FALSE
return|;
block|}
DECL|function|MapBufferRangeEXT
name|void
modifier|*
name|GL_APIENTRY
name|MapBufferRangeEXT
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLintptr
name|offset
parameter_list|,
name|GLsizeiptr
name|length
parameter_list|,
name|GLbitfield
name|access
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLintptr offset = %d, GLsizeiptr length = %d, GLbitfield access = 0x%X)"
argument_list|,
name|target
argument_list|,
name|offset
argument_list|,
name|length
argument_list|,
name|access
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
operator|!
name|ValidBufferTarget
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|offset
operator|<
literal|0
operator|||
name|length
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Buffer
modifier|*
name|buffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getTargetBuffer
argument_list|(
name|target
argument_list|)
decl_stmt|;
if|if
condition|(
name|buffer
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
comment|// Check for buffer overflow
name|size_t
name|offsetSize
init|=
cast|static_cast
argument_list|<
name|size_t
argument_list|>
argument_list|(
name|offset
argument_list|)
decl_stmt|;
name|size_t
name|lengthSize
init|=
cast|static_cast
argument_list|<
name|size_t
argument_list|>
argument_list|(
name|length
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|rx
operator|::
name|IsUnsignedAdditionSafe
argument_list|(
name|offsetSize
argument_list|,
name|lengthSize
argument_list|)
operator|||
name|offsetSize
operator|+
name|lengthSize
operator|>
cast|static_cast
argument_list|<
name|size_t
argument_list|>
argument_list|(
name|buffer
operator|->
name|getSize
argument_list|()
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
comment|// Check for invalid bits in the mask
name|GLbitfield
name|allAccessBits
init|=
name|GL_MAP_READ_BIT
operator||
name|GL_MAP_WRITE_BIT
operator||
name|GL_MAP_INVALIDATE_RANGE_BIT
operator||
name|GL_MAP_INVALIDATE_BUFFER_BIT
operator||
name|GL_MAP_FLUSH_EXPLICIT_BIT
operator||
name|GL_MAP_UNSYNCHRONIZED_BIT
decl_stmt|;
if|if
condition|(
name|access
operator|&
operator|~
operator|(
name|allAccessBits
operator|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|length
operator|==
literal|0
operator|||
name|buffer
operator|->
name|isMapped
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
comment|// Check for invalid bit combinations
if|if
condition|(
operator|(
name|access
operator|&
operator|(
name|GL_MAP_READ_BIT
operator||
name|GL_MAP_WRITE_BIT
operator|)
operator|)
operator|==
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|GLbitfield
name|writeOnlyBits
init|=
name|GL_MAP_INVALIDATE_RANGE_BIT
operator||
name|GL_MAP_INVALIDATE_BUFFER_BIT
operator||
name|GL_MAP_UNSYNCHRONIZED_BIT
decl_stmt|;
if|if
condition|(
operator|(
name|access
operator|&
name|GL_MAP_READ_BIT
operator|)
operator|!=
literal|0
operator|&&
operator|(
name|access
operator|&
name|writeOnlyBits
operator|)
operator|!=
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|(
name|access
operator|&
name|GL_MAP_WRITE_BIT
operator|)
operator|==
literal|0
operator|&&
operator|(
name|access
operator|&
name|GL_MAP_FLUSH_EXPLICIT_BIT
operator|)
operator|!=
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Error
name|error
init|=
name|buffer
operator|->
name|mapRange
argument_list|(
name|offset
argument_list|,
name|length
argument_list|,
name|access
argument_list|)
decl_stmt|;
if|if
condition|(
name|error
operator|.
name|isError
argument_list|()
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|error
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|buffer
operator|->
name|getMapPointer
argument_list|()
return|;
block|}
return|return
name|NULL
return|;
block|}
DECL|function|FlushMappedBufferRangeEXT
name|void
name|GL_APIENTRY
name|FlushMappedBufferRangeEXT
parameter_list|(
name|GLenum
name|target
parameter_list|,
name|GLintptr
name|offset
parameter_list|,
name|GLsizeiptr
name|length
parameter_list|)
block|{
name|EVENT
argument_list|(
literal|"(GLenum target = 0x%X, GLintptr offset = %d, GLsizeiptr length = %d)"
argument_list|,
name|target
argument_list|,
name|offset
argument_list|,
name|length
argument_list|)
expr_stmt|;
name|Context
modifier|*
name|context
init|=
name|GetValidGlobalContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|context
condition|)
block|{
if|if
condition|(
name|offset
operator|<
literal|0
operator|||
name|length
operator|<
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
operator|!
name|ValidBufferTarget
argument_list|(
name|context
argument_list|,
name|target
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_ENUM
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|Buffer
modifier|*
name|buffer
init|=
name|context
operator|->
name|getState
argument_list|()
operator|.
name|getTargetBuffer
argument_list|(
name|target
argument_list|)
decl_stmt|;
if|if
condition|(
name|buffer
operator|==
name|NULL
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
operator|!
name|buffer
operator|->
name|isMapped
argument_list|()
operator|||
operator|(
name|buffer
operator|->
name|getAccessFlags
argument_list|()
operator|&
name|GL_MAP_FLUSH_EXPLICIT_BIT
operator|)
operator|==
literal|0
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_OPERATION
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
comment|// Check for buffer overflow
name|size_t
name|offsetSize
init|=
cast|static_cast
argument_list|<
name|size_t
argument_list|>
argument_list|(
name|offset
argument_list|)
decl_stmt|;
name|size_t
name|lengthSize
init|=
cast|static_cast
argument_list|<
name|size_t
argument_list|>
argument_list|(
name|length
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|rx
operator|::
name|IsUnsignedAdditionSafe
argument_list|(
name|offsetSize
argument_list|,
name|lengthSize
argument_list|)
operator|||
name|offsetSize
operator|+
name|lengthSize
operator|>
cast|static_cast
argument_list|<
name|size_t
argument_list|>
argument_list|(
name|buffer
operator|->
name|getMapLength
argument_list|()
argument_list|)
condition|)
block|{
name|context
operator|->
name|recordError
argument_list|(
name|Error
argument_list|(
name|GL_INVALID_VALUE
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
comment|// We do not currently support a non-trivial implementation of FlushMappedBufferRange
block|}
block|}
block|}
end_namespace
end_unit
