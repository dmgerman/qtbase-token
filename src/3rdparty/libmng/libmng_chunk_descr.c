begin_unit
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* *             For conditions of distribution and use,                    * */
end_comment
begin_comment
comment|/* *                see copyright notice in libmng.h                        * */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* * project   : libmng                                                     * */
end_comment
begin_comment
comment|/* * file      : libmng_chunk_descr.c      copyright (c) 2005-2007 G.Juyn   * */
end_comment
begin_comment
comment|/* * version   : 1.0.10                                                     * */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* * purpose   : Chunk descriptor functions (implementation)                * */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* * author    : G.Juyn                                                     * */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* * comment   : implementation of the chunk- anf field-descriptor          * */
end_comment
begin_comment
comment|/* *             routines                                                   * */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* * changes   : 1.0.9 - 12/06/2004 - G.Juyn                                * */
end_comment
begin_comment
comment|/* *             - added conditional MNG_OPTIMIZE_CHUNKREADER               * */
end_comment
begin_comment
comment|/* *             1.0.9 - 12/11/2004 - G.Juyn                                * */
end_comment
begin_comment
comment|/* *             - made all constants 'static'                              * */
end_comment
begin_comment
comment|/* *             1.0.9 - 12/20/2004 - G.Juyn                                * */
end_comment
begin_comment
comment|/* *             - cleaned up macro-invocations (thanks to D. Airlie)       * */
end_comment
begin_comment
comment|/* *             1.0.9 - 01/17/2005 - G.Juyn                                * */
end_comment
begin_comment
comment|/* *             - fixed problem with global PLTE/tRNS                      * */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* *             1.0.10 - 01/17/2005 - G.R-P.                               * */
end_comment
begin_comment
comment|/* *             - added typecast to appease the compiler                   * */
end_comment
begin_comment
comment|/* *             1.0.10 - 04/08/2007 - G.Juyn                               * */
end_comment
begin_comment
comment|/* *             - added support for mPNG proposal                          * */
end_comment
begin_comment
comment|/* *             1.0.10 - 04/12/2007 - G.Juyn                               * */
end_comment
begin_comment
comment|/* *             - added support for ANG proposal                           * */
end_comment
begin_comment
comment|/* *                                                                        * */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_include
include|#
directive|include
file|<stddef.h>
end_include
begin_comment
comment|/* needed for offsetof() */
end_comment
begin_include
include|#
directive|include
file|"libmng.h"
end_include
begin_include
include|#
directive|include
file|"libmng_data.h"
end_include
begin_include
include|#
directive|include
file|"libmng_error.h"
end_include
begin_include
include|#
directive|include
file|"libmng_trace.h"
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|__BORLANDC__
end_ifdef
begin_pragma
pragma|#
directive|pragma
name|hdrstop
end_pragma
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"libmng_memory.h"
end_include
begin_include
include|#
directive|include
file|"libmng_objects.h"
end_include
begin_include
include|#
directive|include
file|"libmng_chunks.h"
end_include
begin_include
include|#
directive|include
file|"libmng_chunk_descr.h"
end_include
begin_include
include|#
directive|include
file|"libmng_object_prc.h"
end_include
begin_include
include|#
directive|include
file|"libmng_chunk_prc.h"
end_include
begin_include
include|#
directive|include
file|"libmng_chunk_io.h"
end_include
begin_include
include|#
directive|include
file|"libmng_display.h"
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
end_ifdef
begin_include
include|#
directive|include
file|"libmng_pixels.h"
end_include
begin_include
include|#
directive|include
file|"libmng_filter.h"
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_if
if|#
directive|if
name|defined
argument_list|(
name|__BORLANDC__
argument_list|)
operator|&&
name|defined
argument_list|(
name|MNG_STRICT_ANSI
argument_list|)
end_if
begin_pragma
pragma|#
directive|pragma
name|option
name|-
name|A
end_pragma
begin_comment
comment|/* force ANSI-C */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_OPTIMIZE_CHUNKREADER
end_ifdef
begin_if
if|#
directive|if
name|defined
argument_list|(
name|MNG_INCLUDE_READ_PROCS
argument_list|)
operator|||
name|defined
argument_list|(
name|MNG_INCLUDE_WRITE_PROCS
argument_list|)
end_if
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* PNG chunks */
end_comment
begin_decl_stmt
DECL|variable|mng_fields_ihdr
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_ihdr
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_NOHIGHBIT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iWidth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_NOHIGHBIT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iHeight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|16
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iBitdepth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|6
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iColortype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iCompression
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iFilter
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ihdr
argument_list|,
name|iInterlace
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_decl_stmt
DECL|variable|mng_fields_plte
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_plte
index|[]
init|=
block|{
block|{
name|mng_debunk_plte
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_decl_stmt
DECL|variable|mng_fields_idat
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_idat
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_idat
argument_list|,
name|pData
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_idat
argument_list|,
argument|iDatasize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_decl_stmt
DECL|variable|mng_fields_trns
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_trns
index|[]
init|=
block|{
block|{
name|mng_debunk_trns
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_gAMA
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_gama
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_gama
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_gama
argument_list|,
name|iGamma
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_cHRM
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_chrm
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_chrm
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iWhitepointx
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iWhitepointy
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iRedx
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iRedy
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iGreeny
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iGreeny
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iBluex
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|iBluey
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sRGB
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_srgb
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_srgb
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|4
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_srgb
argument_list|,
name|iRenderingintent
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iCCP
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_iccp
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_iccp
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_iccp
argument_list|,
name|zName
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_iccp
argument_list|,
argument|iNamesize
argument_list|)
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_iccp
argument_list|,
name|iCompression
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_DEFLATED
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_iccp
argument_list|,
name|pProfile
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_iccp
argument_list|,
argument|iProfilesize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tEXt
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_text
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_text
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_text
argument_list|,
name|zKeyword
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_text
argument_list|,
argument|iKeywordsize
argument_list|)
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_text
argument_list|,
name|zText
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_text
argument_list|,
argument|iTextsize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_zTXt
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_ztxt
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_ztxt
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_ztxt
argument_list|,
name|zKeyword
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_ztxt
argument_list|,
argument|iKeywordsize
argument_list|)
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ztxt
argument_list|,
name|iCompression
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_DEFLATED
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_ztxt
argument_list|,
name|zText
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_ztxt
argument_list|,
argument|iTextsize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iTXt
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_itxt
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_itxt
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_itxt
argument_list|,
name|zKeyword
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_itxt
argument_list|,
argument|iKeywordsize
argument_list|)
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_itxt
argument_list|,
name|iCompressionflag
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_itxt
argument_list|,
name|iCompressionmethod
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_itxt
argument_list|,
name|zLanguage
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_itxt
argument_list|,
argument|iLanguagesize
argument_list|)
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_itxt
argument_list|,
name|zTranslation
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_itxt
argument_list|,
argument|iTranslationsize
argument_list|)
block|}
block|,
block|{
name|mng_deflate_itxt
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_bKGD
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_bkgd
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_bkgd
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_PUTIMGTYPE
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|iType
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE3
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|iIndex
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE0
operator||
name|MNG_FIELD_IFIMGTYPE4
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|iGray
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE2
operator||
name|MNG_FIELD_IFIMGTYPE6
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|iRed
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE2
operator||
name|MNG_FIELD_IFIMGTYPE6
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|iGreen
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE2
operator||
name|MNG_FIELD_IFIMGTYPE6
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|iBlue
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYs
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_phys
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_phys
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_phys
argument_list|,
name|iSizex
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_phys
argument_list|,
name|iSizey
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_phys
argument_list|,
name|iUnit
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sBIT
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_sbit
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_sbit
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_PUTIMGTYPE
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_sbit
argument_list|,
name|iType
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPES
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_sbit
argument_list|,
name|aBits
index|[
literal|0
index|]
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE2
operator||
name|MNG_FIELD_IFIMGTYPE3
operator||
name|MNG_FIELD_IFIMGTYPE4
operator||
name|MNG_FIELD_IFIMGTYPE6
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_sbit
argument_list|,
name|aBits
index|[
literal|1
index|]
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE2
operator||
name|MNG_FIELD_IFIMGTYPE3
operator||
name|MNG_FIELD_IFIMGTYPE6
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_sbit
argument_list|,
name|aBits
index|[
literal|2
index|]
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_IFIMGTYPE6
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_sbit
argument_list|,
name|aBits
index|[
literal|3
index|]
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sPLT
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_splt
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_splt
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_splt
argument_list|,
name|zName
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_splt
argument_list|,
argument|iNamesize
argument_list|)
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|8
block|,
literal|16
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_splt
argument_list|,
name|iSampledepth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|mng_splt_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_hIST
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_hist
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_hist
index|[]
init|=
block|{
block|{
name|mng_hist_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tIME
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_time
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_time
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_time
argument_list|,
name|iYear
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|12
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_time
argument_list|,
name|iMonth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|31
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_time
argument_list|,
name|iDay
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|24
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_time
argument_list|,
name|iHour
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|60
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_time
argument_list|,
name|iMinute
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|60
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_time
argument_list|,
name|iSecond
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* JNG chunks */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_decl_stmt
DECL|variable|mng_fields_jhdr
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_jhdr
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_NOHIGHBIT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iWidth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_NOHIGHBIT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iHeight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|8
block|,
literal|16
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iColortype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|8
block|,
literal|20
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iImagesampledepth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|8
block|,
literal|8
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iImagecompression
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|8
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iImageinterlace
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|16
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iAlphasampledepth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|8
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iAlphacompression
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iAlphafilter
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_jhdr
argument_list|,
name|iAlphainterlace
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_define
DECL|macro|mng_fields_jdaa
define|#
directive|define
name|mng_fields_jdaa
value|mng_fields_idat
end_define
begin_define
DECL|macro|mng_fields_jdat
define|#
directive|define
name|mng_fields_jdat
value|mng_fields_idat
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* MNG chunks */
end_comment
begin_decl_stmt
DECL|variable|mng_fields_mhdr
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_mhdr
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iWidth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iHeight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iTicks
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iLayercount
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iFramecount
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iPlaytime
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mhdr
argument_list|,
name|iSimplicity
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_loop
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_loop
index|[]
init|=
block|{
block|{
name|mng_debunk_loop
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_endl
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_endl
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_endl
argument_list|,
name|iLevel
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DEFI
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_defi
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_defi
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iObjectid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iDonotshow
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|bHasdonotshow
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iConcrete
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|bHasconcrete
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iXlocation
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|bHasloca
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iYlocation
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP2
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iLeftcb
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|bHasclip
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP2
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iRightcb
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP2
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iTopcb
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP2
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_defi
argument_list|,
name|iBottomcb
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BASI
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_basi
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_basi
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iWidth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iHeight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|16
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iBitdepth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|6
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iColortype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iCompression
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iFilter
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iInterlace
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iRed
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iGreen
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iBlue
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iAlpha
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|bHasalpha
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_basi
argument_list|,
name|iViewable
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLON
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_clon
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_clon
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iSourceid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iCloneid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|2
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iClonetype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iDonotshow
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|bHasdonotshow
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iConcrete
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|2
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iLocationtype
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|bHasloca
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iLocationx
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_clon
argument_list|,
name|iLocationy
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_PAST
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_past
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_past
index|[]
init|=
block|{
block|{
name|mng_debunk_past
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DISC
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_disc
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_disc
index|[]
init|=
block|{
block|{
name|mng_disc_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BACK
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_back
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_back
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_back
argument_list|,
name|iRed
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_back
argument_list|,
name|iGreen
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_back
argument_list|,
name|iBlue
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|3
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_back
argument_list|,
name|iMandatory
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_back
argument_list|,
name|iImageid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_back
argument_list|,
name|iTile
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_FRAM
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_fram
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_fram
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|4
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_fram
argument_list|,
name|iMode
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_TERMINATOR
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_fram
argument_list|,
name|zName
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_fram
argument_list|,
argument|iNamesize
argument_list|)
block|}
block|,
block|{
name|mng_fram_remainder
block|,
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MOVE
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_move
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_move
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_move
argument_list|,
name|iFirstid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_move
argument_list|,
name|iLastid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_move
argument_list|,
name|iMovetype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_move
argument_list|,
name|iMovex
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_move
argument_list|,
name|iMovey
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLIP
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_clip
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_clip
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iFirstid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iLastid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iCliptype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iClipl
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iClipr
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iClipt
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_clip
argument_list|,
name|iClipb
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SHOW
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_show
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_show
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_show
argument_list|,
name|iFirstid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|1
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_show
argument_list|,
name|iLastid
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_show
argument_list|,
name|bHaslastid
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
block|,
literal|0
block|,
literal|7
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_show
argument_list|,
name|iMode
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_TERM
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_term
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_term
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|3
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_term
argument_list|,
name|iTermaction
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|2
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_term
argument_list|,
name|iIteraction
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_term
argument_list|,
name|iDelay
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_term
argument_list|,
name|iItermax
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SAVE
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_save
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_save
index|[]
init|=
block|{
block|{
name|mng_save_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SEEK
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_seek
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_seek
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_seek
argument_list|,
name|zName
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_seek
argument_list|,
argument|iNamesize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_eXPI
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_expi
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_expi
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_expi
argument_list|,
name|iSnapshotid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|79
block|,
name|offsetof
argument_list|(
name|mng_expi
argument_list|,
name|zName
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_expi
argument_list|,
argument|iNamesize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_fPRI
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_fpri
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_fpri
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_fpri
argument_list|,
name|iDeltatype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFF
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_fpri
argument_list|,
name|iPriority
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_nEED
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_need
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_need
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_need
argument_list|,
name|zKeywords
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_need
argument_list|,
argument|iKeywordssize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYg
end_ifndef
begin_define
DECL|macro|mng_fields_phyg
define|#
directive|define
name|mng_fields_phyg
value|mng_fields_phys
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_dhdr
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_dhdr
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iObjectid
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|2
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iImagetype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|7
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iDeltatype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iBlockwidth
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|bHasblocksize
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP1
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iBlockheight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP2
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iBlockx
argument_list|)
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|bHasblockloc
argument_list|)
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
operator||
name|MNG_FIELD_OPTIONAL
operator||
name|MNG_FIELD_GROUP2
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_dhdr
argument_list|,
name|iBlocky
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_prom
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_prom
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|14
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_prom
argument_list|,
name|iColortype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|16
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_prom
argument_list|,
name|iSampledepth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_prom
argument_list|,
name|iFilltype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_pplt
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_pplt
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|5
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_pplt
argument_list|,
name|iDeltatype
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|mng_pplt_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_drop
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_drop
index|[]
init|=
block|{
block|{
name|mng_drop_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DBYK
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_dbyk
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_dbyk
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_dbyk
argument_list|,
name|iChunkname
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_dbyk
argument_list|,
name|iPolarity
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_dbyk
argument_list|,
name|zKeywords
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_dbyk
argument_list|,
argument|iKeywordssize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_ORDR
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_ordr
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_ordr
index|[]
init|=
block|{
block|{
name|mng_drop_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MAGN
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_magn
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_magn
index|[]
init|=
block|{
block|{
name|mng_debunk_magn
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_MPNG_PROPOSAL
end_ifdef
begin_decl_stmt
DECL|variable|mng_fields_mpng
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_mpng
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mpng
argument_list|,
name|iFramewidth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_mpng
argument_list|,
name|iFrameheight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_mpng
argument_list|,
name|iNumplays
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0xFFFF
block|,
literal|2
block|,
literal|2
block|,
name|offsetof
argument_list|(
name|mng_mpng
argument_list|,
name|iTickspersec
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_mpng
argument_list|,
name|iCompressionmethod
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_DEFLATED
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_mpng
argument_list|,
name|pFrames
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_mpng
argument_list|,
argument|iFramessize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
end_ifdef
begin_decl_stmt
DECL|variable|mng_fields_ahdr
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_ahdr
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iNumframes
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iTickspersec
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iNumplays
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iTilewidth
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|1
block|,
literal|0
block|,
literal|4
block|,
literal|4
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iTileheight
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iInterlace
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|,
block|{
name|MNG_NULL
block|,
name|MNG_FIELD_INT
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
name|offsetof
argument_list|(
name|mng_ahdr
argument_list|,
name|iStillused
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_fields_adat
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_adat
index|[]
init|=
block|{
block|{
name|mng_adat_tiles
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_evNT
end_ifndef
begin_decl_stmt
DECL|variable|mng_fields_evnt
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_evnt
index|[]
init|=
block|{
block|{
name|mng_evnt_entries
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_decl_stmt
DECL|variable|mng_fields_unknown
name|MNG_LOCAL
name|mng_field_descriptor
name|mng_fields_unknown
index|[]
init|=
block|{
block|{
name|MNG_NULL
block|,
name|MNG_NULL
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_unknown_chunk
argument_list|,
name|pData
argument_list|)
block|,
name|MNG_NULL
block|,
name|offsetof
argument_list|(
argument|mng_unknown_chunk
argument_list|,
argument|iDatasize
argument_list|)
block|}
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* PNG chunks */
end_comment
begin_decl_stmt
DECL|variable|mng_chunk_descr_ihdr
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_ihdr
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_ihdr
block|,
name|mng_fields_ihdr
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_ihdr
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOJHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOPLTE
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_plte
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_plte
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_plte
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_plte
block|,
name|mng_fields_plte
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_plte
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_idat
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_idat
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_idat
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_idat
block|,
name|mng_fields_idat
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_idat
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOJSEP
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_iend
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_iend
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_iend
block|,
name|MNG_NULL
block|,
literal|0
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_trns
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_trns
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_trns
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_trns
block|,
name|mng_fields_trns
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_trns
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_gAMA
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_gama
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_gama
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_gama
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_gama
block|,
name|mng_fields_gama
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_gama
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOPLTE
operator||
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_cHRM
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_chrm
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_chrm
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_chrm
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_chrm
block|,
name|mng_fields_chrm
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_chrm
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOPLTE
operator||
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sRGB
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_srgb
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_srgb
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_srgb
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_srgb
block|,
name|mng_fields_srgb
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_srgb
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOPLTE
operator||
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iCCP
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_iccp
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_iccp
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_iccp
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_iccp
block|,
name|mng_fields_iccp
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_iccp
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOPLTE
operator||
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tEXt
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_text
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_text
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_text
block|,
name|mng_fields_text
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_text
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_zTXt
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_ztxt
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_ztxt
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_ztxt
block|,
name|mng_fields_ztxt
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_ztxt
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iTXt
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_itxt
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_itxt
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_itxt
block|,
name|mng_fields_itxt
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_itxt
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_bKGD
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_bkgd
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_bkgd
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_bkgd
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_bkgd
block|,
name|mng_fields_bkgd
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_bkgd
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYs
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_phys
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_phys
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_phys
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_phys
block|,
name|mng_fields_phys
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_phys
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sBIT
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_sbit
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_sbit
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_sbit
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_sbit
block|,
name|mng_fields_sbit
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_sbit
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sPLT
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_splt
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_splt
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_splt
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_splt
block|,
name|mng_fields_splt
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_splt
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
operator||
name|MNG_DESCR_EMPTYEMBED
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_hIST
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_hist
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_hist
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_hist
block|,
name|mng_fields_hist
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_hist
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_GenHDR
operator||
name|MNG_DESCR_PLTE
block|,
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
operator||
name|MNG_DESCR_NOJDAA
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tIME
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_time
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_time
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_time
block|,
name|mng_fields_time
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_time
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_GLOBAL
block|,
name|MNG_DESCR_GenHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* JNG chunks */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_jhdr
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_jhdr
init|=
block|{
name|mng_it_jng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_jhdr
block|,
name|mng_fields_jhdr
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_jhdr
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_jdaa
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_jdaa
init|=
block|{
name|mng_it_jng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_jdaa
block|,
name|mng_fields_jdaa
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_jdaa
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_JngHDR
block|,
name|MNG_DESCR_NOJSEP
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_jdat
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_jdat
init|=
block|{
name|mng_it_jng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_jdat
block|,
name|mng_fields_jdat
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_jdat
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_JngHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_jsep
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_jsep
init|=
block|{
name|mng_it_jng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_jsep
block|,
name|MNG_NULL
block|,
literal|0
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_JngHDR
block|,
name|MNG_DESCR_NOJSEP
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* MNG chunks */
end_comment
begin_decl_stmt
DECL|variable|mng_chunk_descr_mhdr
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_mhdr
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_mhdr
block|,
name|mng_fields_mhdr
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_mhdr
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_NOMHDR
operator||
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_mend
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_mend
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_mend
block|,
name|MNG_NULL
block|,
literal|0
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_loop
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_loop
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_loop
block|,
name|mng_fields_loop
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_loop
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_endl
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_endl
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_endl
block|,
name|mng_fields_endl
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_endl
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DEFI
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_defi
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_defi
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_defi
block|,
name|mng_fields_defi
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_defi
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BASI
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_basi
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_basi
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_basi
block|,
name|mng_fields_basi
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_basi
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLON
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_clon
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_clon
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_clon
block|,
name|mng_fields_clon
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_clon
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_PAST
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_past
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_past
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_past
block|,
name|mng_fields_past
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_past
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DISC
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_disc
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_disc
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_disc
block|,
name|mng_fields_disc
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_disc
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BACK
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_back
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_back
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_back
block|,
name|mng_fields_back
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_back
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_FRAM
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_fram
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_fram
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_fram
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_fram
block|,
name|mng_fields_fram
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_fram
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MOVE
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_move
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_move
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_move
block|,
name|mng_fields_move
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_move
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLIP
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_clip
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_clip
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_clip
block|,
name|mng_fields_clip
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_clip
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SHOW
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_show
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_show
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
name|offsetof
argument_list|(
name|mng_show
argument_list|,
name|bEmpty
argument_list|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_show
block|,
name|mng_fields_show
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_show
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_TERM
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_term
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_term
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_term
block|,
name|mng_fields_term
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_term
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
operator||
name|MNG_DESCR_NOTERM
operator||
name|MNG_DESCR_NOLOOP
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SAVE
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_save
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_save
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_save
block|,
name|mng_fields_save
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_save
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOSAVE
operator||
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SEEK
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_seek
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_seek
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_seek
block|,
name|mng_fields_seek
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_seek
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYGLOBAL
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_SAVE
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_eXPI
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_expi
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_expi
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_expi
block|,
name|mng_fields_expi
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_expi
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_fPRI
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_fpri
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_fpri
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_fpri
block|,
name|mng_fields_fpri
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_fpri
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_nEED
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_need
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_need
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_need
block|,
name|mng_fields_need
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_need
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYg
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_phyg
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_phyg
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_phyg
block|,
name|mng_fields_phyg
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_phyg
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_dhdr
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_dhdr
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_dhdr
block|,
name|mng_fields_dhdr
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_dhdr
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_prom
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_prom
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_prom
block|,
name|mng_fields_prom
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_prom
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_ipng
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_ipng
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_ipng
block|,
name|MNG_NULL
block|,
literal|0
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_pplt
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_pplt
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_pplt
block|,
name|mng_fields_pplt
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_pplt
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_ijng
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_ijng
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_ijng
block|,
name|MNG_NULL
block|,
literal|0
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_drop
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_drop
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_drop
block|,
name|mng_fields_drop
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_drop
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DBYK
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_dbyk
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_dbyk
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_dbyk
block|,
name|mng_fields_dbyk
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_dbyk
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_ORDR
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_ordr
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_ordr
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_ordr
block|,
name|mng_fields_ordr
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_ordr
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
operator||
name|MNG_DESCR_DHDR
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MAGN
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_magn
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_magn
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_magn
block|,
name|mng_fields_magn
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_magn
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOIHDR
operator||
name|MNG_DESCR_NOBASI
operator||
name|MNG_DESCR_NODHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_evNT
end_ifndef
begin_decl_stmt
DECL|variable|mng_chunk_descr_evnt
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_evnt
init|=
block|{
name|mng_it_mng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_evnt
block|,
name|mng_fields_evnt
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_evnt
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_MHDR
block|,
name|MNG_DESCR_NOSAVE
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_MPNG_PROPOSAL
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_mpng
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_mpng
init|=
block|{
name|mng_it_mpng
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_mpng
block|,
name|mng_fields_mpng
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_mpng
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_NOMHDR
operator||
name|MNG_DESCR_NOIDAT
operator||
name|MNG_DESCR_NOJDAT
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
end_ifdef
begin_decl_stmt
DECL|variable|mng_chunk_descr_ahdr
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_ahdr
init|=
block|{
name|mng_it_ang
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_ahdr
block|,
name|mng_fields_ahdr
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_ahdr
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_IHDR
block|,
name|MNG_DESCR_NOMHDR
operator||
name|MNG_DESCR_NOJHDR
operator||
name|MNG_DESCR_NOIDAT
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|mng_chunk_descr_adat
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_adat
init|=
block|{
name|mng_it_ang
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_adat
block|,
name|mng_fields_adat
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_adat
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_NULL
block|,
name|MNG_DESCR_IHDR
block|,
name|MNG_DESCR_NOMHDR
operator||
name|MNG_DESCR_NOJHDR
block|}
decl_stmt|;
end_decl_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* the good ol' unknown babe */
end_comment
begin_decl_stmt
DECL|variable|mng_chunk_descr_unknown
name|MNG_LOCAL
name|mng_chunk_descriptor
name|mng_chunk_descr_unknown
init|=
block|{
name|mng_it_png
block|,
name|mng_create_none
block|,
literal|0
block|,
literal|0
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|,
name|mng_special_unknown
block|,
name|mng_fields_unknown
block|,
operator|(
sizeof|sizeof
argument_list|(
name|mng_fields_unknown
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_field_descriptor
argument_list|)
operator|)
block|,
name|MNG_DESCR_EMPTY
operator||
name|MNG_DESCR_EMPTYEMBED
block|,
name|MNG_NULL
block|,
name|MNG_NULL
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_decl_stmt
DECL|variable|mng_chunk_unknown
name|MNG_LOCAL
name|mng_chunk_header
name|mng_chunk_unknown
init|=
block|{
name|MNG_UINT_HUH
block|,
name|mng_init_general
block|,
name|mng_free_unknown
block|,
name|mng_read_general
block|,
name|mng_write_unknown
block|,
name|mng_assign_unknown
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_unknown_chunk
argument_list|)
block|,
operator|&
name|mng_chunk_descr_unknown
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* the table-idea& binary search code was adapted from      libpng 1.1.0 (pngread.c) */
end_comment
begin_comment
comment|/* NOTE1: the table must remain sorted by chunkname, otherwise the binary      search will break !!! (ps. watch upper-/lower-case chunknames !!) */
end_comment
begin_comment
comment|/* NOTE2: the layout must remain equal to the header part of all the      chunk-structures (yes, that means even the pNext and pPrev fields;      it's wasting a bit of space, but hey, the code is a lot easier) */
end_comment
begin_decl_stmt
DECL|variable|mng_chunk_table
name|MNG_LOCAL
name|mng_chunk_header
name|mng_chunk_table
index|[]
init|=
block|{
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BACK
block|{
name|MNG_UINT_BACK
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_back
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_back
argument_list|)
block|,
operator|&
name|mng_chunk_descr_back
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BASI
block|{
name|MNG_UINT_BASI
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_basi
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_basi
argument_list|)
block|,
operator|&
name|mng_chunk_descr_basi
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLIP
block|{
name|MNG_UINT_CLIP
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_clip
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_clip
argument_list|)
block|,
operator|&
name|mng_chunk_descr_clip
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLON
block|{
name|MNG_UINT_CLON
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_clon
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_clon
argument_list|)
block|,
operator|&
name|mng_chunk_descr_clon
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DBYK
block|{
name|MNG_UINT_DBYK
block|,
name|mng_init_general
block|,
name|mng_free_dbyk
block|,
name|mng_read_general
block|,
name|mng_write_dbyk
block|,
name|mng_assign_dbyk
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_dbyk
argument_list|)
block|,
operator|&
name|mng_chunk_descr_dbyk
block|}
block|,
endif|#
directive|endif
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DEFI
block|{
name|MNG_UINT_DEFI
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_defi
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_defi
argument_list|)
block|,
operator|&
name|mng_chunk_descr_defi
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
block|{
name|MNG_UINT_DHDR
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_dhdr
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_dhdr
argument_list|)
block|,
operator|&
name|mng_chunk_descr_dhdr
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DISC
block|{
name|MNG_UINT_DISC
block|,
name|mng_init_general
block|,
name|mng_free_disc
block|,
name|mng_read_general
block|,
name|mng_write_disc
block|,
name|mng_assign_disc
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_disc
argument_list|)
block|,
operator|&
name|mng_chunk_descr_disc
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DROP
block|{
name|MNG_UINT_DROP
block|,
name|mng_init_general
block|,
name|mng_free_drop
block|,
name|mng_read_general
block|,
name|mng_write_drop
block|,
name|mng_assign_drop
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_drop
argument_list|)
block|,
operator|&
name|mng_chunk_descr_drop
block|}
block|,
endif|#
directive|endif
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
block|{
name|MNG_UINT_ENDL
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_endl
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_endl
argument_list|)
block|,
operator|&
name|mng_chunk_descr_endl
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_FRAM
block|{
name|MNG_UINT_FRAM
block|,
name|mng_init_general
block|,
name|mng_free_fram
block|,
name|mng_read_general
block|,
name|mng_write_fram
block|,
name|mng_assign_fram
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_fram
argument_list|)
block|,
operator|&
name|mng_chunk_descr_fram
block|}
block|,
endif|#
directive|endif
block|{
name|MNG_UINT_IDAT
block|,
name|mng_init_general
block|,
name|mng_free_idat
block|,
name|mng_read_general
block|,
name|mng_write_idat
block|,
name|mng_assign_idat
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_idat
argument_list|)
block|,
operator|&
name|mng_chunk_descr_idat
block|}
block|,
comment|/* 12-th element! */
block|{
name|MNG_UINT_IEND
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_iend
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_iend
argument_list|)
block|,
operator|&
name|mng_chunk_descr_iend
block|}
block|,
block|{
name|MNG_UINT_IHDR
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_ihdr
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_ihdr
argument_list|)
block|,
operator|&
name|mng_chunk_descr_ihdr
block|}
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
block|{
name|MNG_UINT_IJNG
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_ijng
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_ijng
argument_list|)
block|,
operator|&
name|mng_chunk_descr_ijng
block|}
block|,
endif|#
directive|endif
block|{
name|MNG_UINT_IPNG
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_ipng
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_ipng
argument_list|)
block|,
operator|&
name|mng_chunk_descr_ipng
block|}
block|,
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
block|{
name|MNG_UINT_JDAA
block|,
name|mng_init_general
block|,
name|mng_free_jdaa
block|,
name|mng_read_general
block|,
name|mng_write_jdaa
block|,
name|mng_assign_jdaa
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_jdaa
argument_list|)
block|,
operator|&
name|mng_chunk_descr_jdaa
block|}
block|,
block|{
name|MNG_UINT_JDAT
block|,
name|mng_init_general
block|,
name|mng_free_jdat
block|,
name|mng_read_general
block|,
name|mng_write_jdat
block|,
name|mng_assign_jdat
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_jdat
argument_list|)
block|,
operator|&
name|mng_chunk_descr_jdat
block|}
block|,
block|{
name|MNG_UINT_JHDR
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_jhdr
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_jhdr
argument_list|)
block|,
operator|&
name|mng_chunk_descr_jhdr
block|}
block|,
block|{
name|MNG_UINT_JSEP
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_jsep
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_jsep
argument_list|)
block|,
operator|&
name|mng_chunk_descr_jsep
block|}
block|,
block|{
name|MNG_UINT_JdAA
block|,
name|mng_init_general
block|,
name|mng_free_jdaa
block|,
name|mng_read_general
block|,
name|mng_write_jdaa
block|,
name|mng_assign_jdaa
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_jdaa
argument_list|)
block|,
operator|&
name|mng_chunk_descr_jdaa
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
block|{
name|MNG_UINT_LOOP
block|,
name|mng_init_general
block|,
name|mng_free_loop
block|,
name|mng_read_general
block|,
name|mng_write_loop
block|,
name|mng_assign_loop
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_loop
argument_list|)
block|,
operator|&
name|mng_chunk_descr_loop
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MAGN
block|{
name|MNG_UINT_MAGN
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_magn
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_magn
argument_list|)
block|,
operator|&
name|mng_chunk_descr_magn
block|}
block|,
endif|#
directive|endif
block|{
name|MNG_UINT_MEND
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_mend
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_mend
argument_list|)
block|,
operator|&
name|mng_chunk_descr_mend
block|}
block|,
block|{
name|MNG_UINT_MHDR
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_mhdr
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_mhdr
argument_list|)
block|,
operator|&
name|mng_chunk_descr_mhdr
block|}
block|,
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MOVE
block|{
name|MNG_UINT_MOVE
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_move
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_move
argument_list|)
block|,
operator|&
name|mng_chunk_descr_move
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_ORDR
block|{
name|MNG_UINT_ORDR
block|,
name|mng_init_general
block|,
name|mng_free_ordr
block|,
name|mng_read_general
block|,
name|mng_write_ordr
block|,
name|mng_assign_ordr
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_ordr
argument_list|)
block|,
operator|&
name|mng_chunk_descr_ordr
block|}
block|,
endif|#
directive|endif
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_PAST
block|{
name|MNG_UINT_PAST
block|,
name|mng_init_general
block|,
name|mng_free_past
block|,
name|mng_read_general
block|,
name|mng_write_past
block|,
name|mng_assign_past
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_past
argument_list|)
block|,
operator|&
name|mng_chunk_descr_past
block|}
block|,
endif|#
directive|endif
block|{
name|MNG_UINT_PLTE
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_plte
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_plte
argument_list|)
block|,
operator|&
name|mng_chunk_descr_plte
block|}
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
block|{
name|MNG_UINT_PPLT
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_pplt
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_pplt
argument_list|)
block|,
operator|&
name|mng_chunk_descr_pplt
block|}
block|,
block|{
name|MNG_UINT_PROM
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_prom
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_prom
argument_list|)
block|,
operator|&
name|mng_chunk_descr_prom
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SAVE
block|{
name|MNG_UINT_SAVE
block|,
name|mng_init_general
block|,
name|mng_free_save
block|,
name|mng_read_general
block|,
name|mng_write_save
block|,
name|mng_assign_save
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_save
argument_list|)
block|,
operator|&
name|mng_chunk_descr_save
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SEEK
block|{
name|MNG_UINT_SEEK
block|,
name|mng_init_general
block|,
name|mng_free_seek
block|,
name|mng_read_general
block|,
name|mng_write_seek
block|,
name|mng_assign_seek
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_seek
argument_list|)
block|,
operator|&
name|mng_chunk_descr_seek
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SHOW
block|{
name|MNG_UINT_SHOW
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_show
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_show
argument_list|)
block|,
operator|&
name|mng_chunk_descr_show
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_TERM
block|{
name|MNG_UINT_TERM
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_term
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_term
argument_list|)
block|,
operator|&
name|mng_chunk_descr_term
block|}
block|,
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
block|{
name|MNG_UINT_adAT
block|,
name|mng_init_general
block|,
name|mng_free_adat
block|,
name|mng_read_general
block|,
name|mng_write_adat
block|,
name|mng_assign_adat
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_adat
argument_list|)
block|,
operator|&
name|mng_chunk_descr_adat
block|}
block|,
block|{
name|MNG_UINT_ahDR
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_ahdr
block|,
name|mng_assign_ahdr
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_ahdr
argument_list|)
block|,
operator|&
name|mng_chunk_descr_ahdr
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_bKGD
block|{
name|MNG_UINT_bKGD
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_bkgd
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_bkgd
argument_list|)
block|,
operator|&
name|mng_chunk_descr_bkgd
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_cHRM
block|{
name|MNG_UINT_cHRM
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_chrm
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_chrm
argument_list|)
block|,
operator|&
name|mng_chunk_descr_chrm
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_eXPI
block|{
name|MNG_UINT_eXPI
block|,
name|mng_init_general
block|,
name|mng_free_expi
block|,
name|mng_read_general
block|,
name|mng_write_expi
block|,
name|mng_assign_expi
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_expi
argument_list|)
block|,
operator|&
name|mng_chunk_descr_expi
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_evNT
block|{
name|MNG_UINT_evNT
block|,
name|mng_init_general
block|,
name|mng_free_evnt
block|,
name|mng_read_general
block|,
name|mng_write_evnt
block|,
name|mng_assign_evnt
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_evnt
argument_list|)
block|,
operator|&
name|mng_chunk_descr_evnt
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_fPRI
block|{
name|MNG_UINT_fPRI
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_fpri
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_fpri
argument_list|)
block|,
operator|&
name|mng_chunk_descr_fpri
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_gAMA
block|{
name|MNG_UINT_gAMA
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_gama
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_gama
argument_list|)
block|,
operator|&
name|mng_chunk_descr_gama
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_hIST
block|{
name|MNG_UINT_hIST
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_hist
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_hist
argument_list|)
block|,
operator|&
name|mng_chunk_descr_hist
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iCCP
block|{
name|MNG_UINT_iCCP
block|,
name|mng_init_general
block|,
name|mng_free_iccp
block|,
name|mng_read_general
block|,
name|mng_write_iccp
block|,
name|mng_assign_iccp
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_iccp
argument_list|)
block|,
operator|&
name|mng_chunk_descr_iccp
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iTXt
block|{
name|MNG_UINT_iTXt
block|,
name|mng_init_general
block|,
name|mng_free_itxt
block|,
name|mng_read_general
block|,
name|mng_write_itxt
block|,
name|mng_assign_itxt
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_itxt
argument_list|)
block|,
operator|&
name|mng_chunk_descr_itxt
block|}
block|,
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_INCLUDE_MPNG_PROPOSAL
block|{
name|MNG_UINT_mpNG
block|,
name|mng_init_general
block|,
name|mng_free_mpng
block|,
name|mng_read_general
block|,
name|mng_write_mpng
block|,
name|mng_assign_mpng
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_mpng
argument_list|)
block|,
operator|&
name|mng_chunk_descr_mpng
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_nEED
block|{
name|MNG_UINT_nEED
block|,
name|mng_init_general
block|,
name|mng_free_need
block|,
name|mng_read_general
block|,
name|mng_write_need
block|,
name|mng_assign_need
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_need
argument_list|)
block|,
operator|&
name|mng_chunk_descr_need
block|}
block|,
endif|#
directive|endif
comment|/* TODO:     {MNG_UINT_oFFs, 0, 0, 0, 0, 0, 0},  */
comment|/* TODO:     {MNG_UINT_pCAL, 0, 0, 0, 0, 0, 0},  */
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYg
block|{
name|MNG_UINT_pHYg
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_phyg
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_phyg
argument_list|)
block|,
operator|&
name|mng_chunk_descr_phyg
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYs
block|{
name|MNG_UINT_pHYs
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_phys
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_phys
argument_list|)
block|,
operator|&
name|mng_chunk_descr_phys
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sBIT
block|{
name|MNG_UINT_sBIT
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_sbit
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_sbit
argument_list|)
block|,
operator|&
name|mng_chunk_descr_sbit
block|}
block|,
endif|#
directive|endif
comment|/* TODO:     {MNG_UINT_sCAL, 0, 0, 0, 0, 0, 0},  */
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sPLT
block|{
name|MNG_UINT_sPLT
block|,
name|mng_init_general
block|,
name|mng_free_splt
block|,
name|mng_read_general
block|,
name|mng_write_splt
block|,
name|mng_assign_splt
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_splt
argument_list|)
block|,
operator|&
name|mng_chunk_descr_splt
block|}
block|,
endif|#
directive|endif
block|{
name|MNG_UINT_sRGB
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_srgb
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_srgb
argument_list|)
block|,
operator|&
name|mng_chunk_descr_srgb
block|}
block|,
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tEXt
block|{
name|MNG_UINT_tEXt
block|,
name|mng_init_general
block|,
name|mng_free_text
block|,
name|mng_read_general
block|,
name|mng_write_text
block|,
name|mng_assign_text
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_text
argument_list|)
block|,
operator|&
name|mng_chunk_descr_text
block|}
block|,
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tIME
block|{
name|MNG_UINT_tIME
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_time
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_time
argument_list|)
block|,
operator|&
name|mng_chunk_descr_time
block|}
block|,
endif|#
directive|endif
block|{
name|MNG_UINT_tRNS
block|,
name|mng_init_general
block|,
name|mng_free_general
block|,
name|mng_read_general
block|,
name|mng_write_trns
block|,
name|mng_assign_general
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_trns
argument_list|)
block|,
operator|&
name|mng_chunk_descr_trns
block|}
block|,
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_zTXt
block|{
name|MNG_UINT_zTXt
block|,
name|mng_init_general
block|,
name|mng_free_ztxt
block|,
name|mng_read_general
block|,
name|mng_write_ztxt
block|,
name|mng_assign_ztxt
block|,
literal|0
block|,
literal|0
block|,
sizeof|sizeof
argument_list|(
name|mng_ztxt
argument_list|)
block|,
operator|&
name|mng_chunk_descr_ztxt
block|}
block|,
endif|#
directive|endif
block|}
decl_stmt|;
end_decl_stmt
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_function
DECL|function|mng_get_chunkheader
name|void
name|mng_get_chunkheader
parameter_list|(
name|mng_chunkid
name|iChunkname
parameter_list|,
name|mng_chunk_headerp
name|pResult
parameter_list|)
block|{
comment|/* binary search variables */
name|mng_int32
name|iTop
decl_stmt|,
name|iLower
decl_stmt|,
name|iUpper
decl_stmt|,
name|iMiddle
decl_stmt|;
name|mng_chunk_headerp
name|pEntry
decl_stmt|;
comment|/* pointer to found entry */
comment|/* determine max index of table */
name|iTop
operator|=
operator|(
sizeof|sizeof
argument_list|(
name|mng_chunk_table
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|mng_chunk_table
index|[
literal|0
index|]
argument_list|)
operator|)
operator|-
literal|1
expr_stmt|;
comment|/* binary search; with 54 chunks, worst-case is 7 comparisons */
name|iLower
operator|=
literal|0
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
name|iMiddle
operator|=
literal|11
expr_stmt|;
comment|/* start with the IDAT entry */
else|#
directive|else
name|iMiddle
operator|=
literal|8
expr_stmt|;
endif|#
directive|endif
name|iUpper
operator|=
name|iTop
expr_stmt|;
name|pEntry
operator|=
literal|0
expr_stmt|;
comment|/* no goods yet! */
do|do
comment|/* the binary search itself */
block|{
if|if
condition|(
name|mng_chunk_table
index|[
name|iMiddle
index|]
operator|.
name|iChunkname
operator|<
name|iChunkname
condition|)
name|iLower
operator|=
name|iMiddle
operator|+
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|mng_chunk_table
index|[
name|iMiddle
index|]
operator|.
name|iChunkname
operator|>
name|iChunkname
condition|)
name|iUpper
operator|=
name|iMiddle
operator|-
literal|1
expr_stmt|;
else|else
block|{
name|pEntry
operator|=
operator|&
name|mng_chunk_table
index|[
name|iMiddle
index|]
expr_stmt|;
break|break;
block|}
name|iMiddle
operator|=
operator|(
name|iLower
operator|+
name|iUpper
operator|)
operator|>>
literal|1
expr_stmt|;
block|}
do|while
condition|(
name|iLower
operator|<=
name|iUpper
condition|)
do|;
if|if
condition|(
operator|!
name|pEntry
condition|)
comment|/* unknown chunk ? */
name|pEntry
operator|=
operator|&
name|mng_chunk_unknown
expr_stmt|;
comment|/* make it so! */
name|MNG_COPY
argument_list|(
name|pResult
argument_list|,
name|pEntry
argument_list|,
sizeof|sizeof
argument_list|(
name|mng_chunk_header
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
end_function
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* PNG chunks */
end_comment
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_ihdr
argument_list|)
end_macro
begin_block
block|{
name|pData
operator|->
name|bHasIHDR
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate IHDR is present */
comment|/* and store interesting fields */
if|if
condition|(
operator|(
operator|!
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|iDeltatype
operator|==
name|MNG_DELTATYPE_NOCHANGE
operator|)
condition|)
block|{
name|pData
operator|->
name|iDatawidth
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iWidth
expr_stmt|;
name|pData
operator|->
name|iDataheight
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iHeight
expr_stmt|;
block|}
name|pData
operator|->
name|iBitdepth
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iBitdepth
expr_stmt|;
name|pData
operator|->
name|iColortype
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
expr_stmt|;
name|pData
operator|->
name|iCompression
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iCompression
expr_stmt|;
name|pData
operator|->
name|iFilter
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iFilter
expr_stmt|;
name|pData
operator|->
name|iInterlace
operator|=
operator|(
operator|(
name|mng_ihdrp
operator|)
name|pChunk
operator|)
operator|->
name|iInterlace
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_1_2_4BIT_SUPPORT
argument_list|)
operator|||
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
name|pData
operator|->
name|iPNGmult
operator|=
literal|1
expr_stmt|;
name|pData
operator|->
name|iPNGdepth
operator|=
name|pData
operator|->
name|iBitdepth
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_1_2_4BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|<
literal|8
condition|)
name|pData
operator|->
name|iBitdepth
operator|=
literal|8
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|>
literal|8
condition|)
block|{
name|pData
operator|->
name|iBitdepth
operator|=
literal|8
expr_stmt|;
name|pData
operator|->
name|iPNGmult
operator|=
literal|2
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|8
operator|)
comment|/* parameter validity checks */
ifndef|#
directive|ifndef
name|MNG_NO_1_2_4BIT_SUPPORT
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|1
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|2
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|4
operator|)
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|16
operator|)
endif|#
directive|endif
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAY
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGB
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_INDEXED
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAYA
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGBA
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOLORTYPE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_INDEXED
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|>
literal|8
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_RGB
operator|)
operator|||
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_GRAYA
operator|)
operator|||
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_RGBA
operator|)
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|<
literal|8
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|iCompression
operator|!=
name|MNG_COMPRESSION_DEFLATE
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOMPRESS
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|FILTER192
argument_list|)
operator|||
name|defined
argument_list|(
name|FILTER193
argument_list|)
if|if
condition|(
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_ADAPTIVE
operator|)
operator|&&
if|#
directive|if
name|defined
argument_list|(
name|FILTER192
argument_list|)
operator|&&
name|defined
argument_list|(
name|FILTER193
argument_list|)
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_DIFFERING
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_NOFILTER
operator|)
condition|)
else|#
directive|else
ifdef|#
directive|ifdef
name|FILTER192
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_DIFFERING
operator|)
block|)
end_block
begin_else
else|#
directive|else
end_else
begin_expr_stmt
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_NOFILTER
operator|)
end_expr_stmt
begin_endif
unit|)
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_expr_stmt
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_if
if|if
condition|(
name|pData
operator|->
name|iFilter
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|iInterlace
operator|!=
name|MNG_INTERLACE_NONE
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iInterlace
operator|!=
name|MNG_INTERLACE_ADAM7
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDINTERLACE
argument_list|)
expr_stmt|;
end_if
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_if
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* check the colortype for delta-images ! */
block|{
name|mng_imagedatap
name|pBuf
init|=
operator|(
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
operator|)
operator|->
name|pImgbuf
decl_stmt|;
if|if
condition|(
name|pData
operator|->
name|iColortype
operator|!=
name|pBuf
operator|->
name|iColortype
condition|)
block|{
if|if
condition|(
operator|(
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_INDEXED
operator|)
operator|||
operator|(
name|pBuf
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_GRAY
operator|)
operator|)
operator|&&
operator|(
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAY
operator|)
operator|||
operator|(
name|pBuf
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_INDEXED
operator|)
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOLORTYPE
argument_list|)
expr_stmt|;
block|}
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_if
if|if
condition|(
operator|!
name|pData
operator|->
name|bHasheader
condition|)
comment|/* first chunk ? */
block|{
name|pData
operator|->
name|bHasheader
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* we've got a header */
name|pData
operator|->
name|eImagetype
operator|=
name|mng_it_png
expr_stmt|;
comment|/* then this must be a PNG */
name|pData
operator|->
name|iWidth
operator|=
name|pData
operator|->
name|iDatawidth
expr_stmt|;
name|pData
operator|->
name|iHeight
operator|=
name|pData
operator|->
name|iDataheight
expr_stmt|;
comment|/* predict alpha-depth ! */
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_GRAYA
operator|)
operator|||
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_RGBA
operator|)
condition|)
name|pData
operator|->
name|iAlphadepth
operator|=
name|pData
operator|->
name|iBitdepth
expr_stmt|;
elseif|else
if|if
condition|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_INDEXED
condition|)
name|pData
operator|->
name|iAlphadepth
operator|=
literal|8
expr_stmt|;
comment|/* worst case scenario */
else|else
name|pData
operator|->
name|iAlphadepth
operator|=
literal|1
expr_stmt|;
comment|/* Possible tRNS cheap binary transparency */
comment|/* fits on maximum canvas ? */
if|if
condition|(
operator|(
name|pData
operator|->
name|iWidth
operator|>
name|pData
operator|->
name|iMaxwidth
operator|)
operator|||
operator|(
name|pData
operator|->
name|iHeight
operator|>
name|pData
operator|->
name|iMaxheight
operator|)
condition|)
name|MNG_WARNING
argument_list|(
name|pData
argument_list|,
name|MNG_IMAGETOOLARGE
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|MNG_INCLUDE_MPNG_PROPOSAL
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|MNG_SUPPORT_DISPLAY
argument_list|)
if|if
condition|(
name|pData
operator|->
name|fProcessheader
condition|)
comment|/* inform the app ? */
if|if
condition|(
operator|!
name|pData
operator|->
name|fProcessheader
argument_list|(
operator|(
operator|(
name|mng_handle
operator|)
name|pData
operator|)
argument_list|,
name|pData
operator|->
name|iWidth
argument_list|,
name|pData
operator|->
name|iHeight
argument_list|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_if
begin_if
if|if
condition|(
operator|!
name|pData
operator|->
name|bHasDHDR
condition|)
name|pData
operator|->
name|iImagelevel
operator|++
expr_stmt|;
end_if
begin_comment
comment|/* one level deeper */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_return
return|return
name|mng_process_display_ihdr
argument_list|(
name|pData
argument_list|)
return|;
end_return
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_debunk_plte
operator|)
block|{
name|mng_pltep
name|pPLTE
operator|=
operator|(
name|mng_pltep
operator|)
name|pChunk
block|;
name|mng_uint32
name|iRawlen
operator|=
operator|*
name|piRawlen
block|;
name|mng_uint8p
name|pRawdata
operator|=
operator|*
name|ppRawdata
block|;
comment|/* length must be multiple of 3 */
if|if
condition|(
operator|(
operator|(
name|iRawlen
operator|%
literal|3
operator|)
operator|!=
literal|0
operator|)
operator|||
operator|(
name|iRawlen
operator|>
literal|768
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
comment|/* this is the exact length */
name|pPLTE
operator|->
name|iEntrycount
operator|=
name|iRawlen
operator|/
literal|3
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|MNG_COPY
argument_list|(
name|pPLTE
operator|->
name|aEntries
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_plte
operator|)
block|{
comment|/* multiple PLTE only inside BASI */
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasPLTE
operator|)
operator|&&
operator|(
operator|!
name|pData
operator|->
name|bHasBASI
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_MULTIPLEERROR
argument_list|)
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
block|{
comment|/* only allowed for indexed-color or                                           rgb(a)-color! */
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGB
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_INDEXED
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGBA
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CHUNKNOTALLOWED
argument_list|)
expr_stmt|;
comment|/* empty only allowed if global present */
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
operator|)
operator|&&
operator|(
operator|!
name|pData
operator|->
name|bHasglobalPLTE
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CANNOTBEEMPTY
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
comment|/* cannot be empty as global! */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CANNOTBEEMPTY
argument_list|)
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
name|pData
operator|->
name|bHasPLTE
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* got it! */
else|else
name|pData
operator|->
name|bHasglobalPLTE
operator|=
name|MNG_TRUE
expr_stmt|;
end_if
begin_expr_stmt
name|pData
operator|->
name|iPLTEcount
operator|=
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|iEntrycount
expr_stmt|;
end_expr_stmt
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
block|{
name|mng_imagep
name|pImage
decl_stmt|;
name|mng_imagedatap
name|pBuf
decl_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* processing delta-image ? */
block|{
comment|/* store in object 0 !!! */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
name|pBuf
operator|->
name|bHasPLTE
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* it's definitely got a PLTE now */
name|pBuf
operator|->
name|iPLTEcount
operator|=
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|iEntrycount
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aPLTEentries
argument_list|,
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|aEntries
argument_list|,
sizeof|sizeof
argument_list|(
name|pBuf
operator|->
name|aPLTEentries
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
endif|#
directive|endif
block|{
comment|/* get the current object */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
expr_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
comment|/* address the object buffer */
name|pBuf
operator|->
name|bHasPLTE
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* and tell it it's got a PLTE now */
if|if
condition|(
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
comment|/* if empty, inherit from global */
block|{
name|pBuf
operator|->
name|iPLTEcount
operator|=
name|pData
operator|->
name|iGlobalPLTEcount
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aPLTEentries
argument_list|,
name|pData
operator|->
name|aGlobalPLTEentries
argument_list|,
sizeof|sizeof
argument_list|(
name|pBuf
operator|->
name|aPLTEentries
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|bHasglobalTRNS
condition|)
comment|/* also copy global tRNS ? */
block|{
name|mng_uint32
name|iRawlen2
init|=
name|pData
operator|->
name|iGlobalTRNSrawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata2
init|=
call|(
name|mng_uint8p
call|)
argument_list|(
name|pData
operator|->
name|aGlobalTRNSrawdata
argument_list|)
decl_stmt|;
comment|/* indicate tRNS available */
name|pBuf
operator|->
name|bHasTRNS
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* global length oke ? */
if|if
condition|(
operator|(
name|iRawlen2
operator|==
literal|0
operator|)
operator|||
operator|(
name|iRawlen2
operator|>
name|pBuf
operator|->
name|iPLTEcount
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_GLOBALLENGTHERR
argument_list|)
expr_stmt|;
comment|/* copy it */
name|pBuf
operator|->
name|iTRNScount
operator|=
name|iRawlen2
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aTRNSentries
argument_list|,
name|pRawdata2
argument_list|,
name|iRawlen2
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
comment|/* store fields for future reference */
name|pBuf
operator|->
name|iPLTEcount
operator|=
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|iEntrycount
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aPLTEentries
argument_list|,
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|aEntries
argument_list|,
sizeof|sizeof
argument_list|(
name|pBuf
operator|->
name|aPLTEentries
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
else|else
comment|/* store as global */
block|{
name|pData
operator|->
name|iGlobalPLTEcount
operator|=
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|iEntrycount
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pData
operator|->
name|aGlobalPLTEentries
argument_list|,
operator|(
operator|(
name|mng_pltep
operator|)
name|pChunk
operator|)
operator|->
name|aEntries
argument_list|,
sizeof|sizeof
argument_list|(
name|pData
operator|->
name|aGlobalPLTEentries
argument_list|)
argument_list|)
expr_stmt|;
comment|/* create an animation object */
return|return
name|mng_create_ani_plte
argument_list|(
name|pData
argument_list|)
return|;
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_idat
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphacompression
operator|!=
name|MNG_COMPRESSION_DEFLATE
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_SEQUENCEERROR
argument_list|)
expr_stmt|;
end_expr_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* not allowed for deltatype NO_CHANGE */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|&&
operator|(
operator|(
name|pData
operator|->
name|iDeltatype
operator|==
name|MNG_DELTATYPE_NOCHANGE
operator|)
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CHUNKNOTALLOWED
argument_list|)
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* can only be empty in BASI-block! */
end_comment
begin_if
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_idatp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
operator|)
operator|&&
operator|(
operator|!
name|pData
operator|->
name|bHasBASI
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
end_if
begin_comment
comment|/* indexed-color requires PLTE */
end_comment
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|==
literal|3
operator|)
operator|&&
operator|(
operator|!
name|pData
operator|->
name|bHasPLTE
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_PLTEMISSING
argument_list|)
expr_stmt|;
end_if
begin_expr_stmt
name|pData
operator|->
name|bHasIDAT
operator|=
name|MNG_TRUE
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* got some IDAT now, don't we */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_iend
operator|)
block|{
comment|/* IHDR-block requires IDAT */
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|&&
operator|(
operator|!
name|pData
operator|->
name|bHasIDAT
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_IDATMISSING
argument_list|)
expr_stmt|;
name|pData
operator|->
name|iImagelevel
operator|--
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* one level up */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_block
block|{
comment|/* create an animation object */
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_image
argument_list|(
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
comment|/* display processing */
name|iRetcode
operator|=
name|mng_process_display_iend
argument_list|(
name|pData
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_if
if|if
condition|(
operator|!
name|pData
operator|->
name|bTimerset
condition|)
comment|/* reset only if not broken !!! */
block|{
endif|#
directive|endif
comment|/* IEND signals the end for most ... */
name|pData
operator|->
name|bHasIHDR
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasBASI
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasDHDR
operator|=
name|MNG_FALSE
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
name|pData
operator|->
name|bHasJHDR
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasJSEP
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasJDAA
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasJDAT
operator|=
name|MNG_FALSE
expr_stmt|;
endif|#
directive|endif
name|pData
operator|->
name|bHasPLTE
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasTRNS
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasGAMA
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasCHRM
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasSRGB
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasICCP
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasBKGD
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bHasIDAT
operator|=
name|MNG_FALSE
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_debunk_trns
operator|)
block|{
name|mng_trnsp
name|pTRNS
operator|=
operator|(
name|mng_trnsp
operator|)
name|pChunk
block|;
name|mng_uint32
name|iRawlen
operator|=
operator|*
name|piRawlen
block|;
name|mng_uint8p
name|pRawdata
operator|=
operator|*
name|ppRawdata
block|;
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
block|{
comment|/* not global! */
name|pTRNS
operator|->
name|bGlobal
operator|=
name|MNG_FALSE
expr_stmt|;
name|pTRNS
operator|->
name|iType
operator|=
name|pData
operator|->
name|iColortype
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|!=
literal|0
condition|)
block|{
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
comment|/* store fields */
block|{
case|case
literal|0
case|:
block|{
comment|/* gray */
if|if
condition|(
name|iRawlen
operator|!=
literal|2
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pTRNS
operator|->
name|iGray
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
break|break;
block|}
end_expr_stmt
begin_case
case|case
literal|2
case|:
end_case
begin_block
block|{
comment|/* rgb */
if|if
condition|(
name|iRawlen
operator|!=
literal|6
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pTRNS
operator|->
name|iRed
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pTRNS
operator|->
name|iGreen
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|2
argument_list|)
expr_stmt|;
name|pTRNS
operator|->
name|iBlue
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|4
argument_list|)
expr_stmt|;
break|break;
block|}
end_block
begin_case
case|case
literal|3
case|:
end_case
begin_block
block|{
comment|/* indexed */
if|if
condition|(
name|iRawlen
operator|>
literal|256
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pTRNS
operator|->
name|iCount
operator|=
name|iRawlen
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pTRNS
operator|->
name|aEntries
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
break|break;
block|}
end_block
begin_comment
unit|}     }   }   else
comment|/* it's global! */
end_comment
begin_block
block|{
if|if
condition|(
name|iRawlen
operator|==
literal|0
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pTRNS
operator|->
name|bGlobal
operator|=
name|MNG_TRUE
expr_stmt|;
name|pTRNS
operator|->
name|iType
operator|=
literal|0
expr_stmt|;
name|pTRNS
operator|->
name|iRawlen
operator|=
name|iRawlen
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pTRNS
operator|->
name|aRawdata
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
name|pData
operator|->
name|iGlobalTRNSrawlen
operator|=
name|iRawlen
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pData
operator|->
name|aGlobalTRNSrawdata
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
block|}
end_block
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_trns
operator|)
block|{
comment|/* multiple tRNS only inside BASI */
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasTRNS
operator|)
operator|&&
operator|(
operator|!
name|pData
operator|->
name|bHasBASI
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_MULTIPLEERROR
argument_list|)
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
block|{
comment|/* not allowed with full alpha-channel */
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
literal|4
operator|)
operator|||
operator|(
name|pData
operator|->
name|iColortype
operator|==
literal|6
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CHUNKNOTALLOWED
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
comment|/* filled ? */
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
if|if
condition|(
name|pData
operator|->
name|iColortype
operator|==
literal|3
condition|)
block|{
name|mng_imagep
name|pImage
init|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
decl_stmt|;
name|mng_imagedatap
name|pBuf
decl_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then check obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
comment|/* address object buffer */
if|if
condition|(
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iCount
operator|>
name|pBuf
operator|->
name|iPLTEcount
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
block|}
else|else
comment|/* if empty there must be global stuff! */
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|bHasglobalTRNS
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CANNOTBEEMPTY
argument_list|)
expr_stmt|;
block|}
block|}
end_if
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
name|pData
operator|->
name|bHasTRNS
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate tRNS available */
else|else
name|pData
operator|->
name|bHasglobalTRNS
operator|=
name|MNG_TRUE
expr_stmt|;
end_if
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
block|{
name|mng_imagep
name|pImage
decl_stmt|;
name|mng_imagedatap
name|pBuf
decl_stmt|;
name|mng_uint8p
name|pRawdata2
decl_stmt|;
name|mng_uint32
name|iRawlen2
decl_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* processing delta-image ? */
block|{
comment|/* store in object 0 !!! */
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_1_2_4BIT_SUPPORT
argument_list|)
name|mng_uint8
name|multiplier
index|[]
init|=
block|{
literal|0
block|,
literal|255
block|,
literal|85
block|,
literal|0
block|,
literal|17
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|}
decl_stmt|;
endif|#
directive|endif
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
comment|/* address object buffer */
name|pBuf
operator|->
name|bHasTRNS
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* tell it it's got a tRNS now */
name|pBuf
operator|->
name|iTRNSgray
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNSred
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNScount
operator|=
literal|0
expr_stmt|;
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
comment|/* store fields for future reference */
block|{
case|case
literal|0
case|:
block|{
comment|/* gray */
name|pBuf
operator|->
name|iTRNSgray
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iGray
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_1_2_4BIT_SUPPORT
argument_list|)
name|pBuf
operator|->
name|iTRNSgray
operator|*=
name|multiplier
index|[
name|pData
operator|->
name|iPNGdepth
index|]
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
if|if
condition|(
name|pData
operator|->
name|iPNGmult
operator|==
literal|2
condition|)
name|pBuf
operator|->
name|iTRNSgray
operator|>>=
literal|8
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
case|case
literal|2
case|:
block|{
comment|/* rgb */
name|pBuf
operator|->
name|iTRNSred
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iRed
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iGreen
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iBlue
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
if|if
condition|(
name|pData
operator|->
name|iPNGmult
operator|==
literal|2
condition|)
block|{
name|pBuf
operator|->
name|iTRNSred
operator|>>=
literal|8
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|>>=
literal|8
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|>>=
literal|8
expr_stmt|;
block|}
endif|#
directive|endif
break|break;
block|}
case|case
literal|3
case|:
block|{
comment|/* indexed */
name|pBuf
operator|->
name|iTRNScount
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iCount
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aTRNSentries
argument_list|,
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|aEntries
argument_list|,
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iCount
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
block|}
else|else
endif|#
directive|endif
block|{
comment|/* address current object */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
expr_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
comment|/* address object buffer */
name|pBuf
operator|->
name|bHasTRNS
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* and tell it it's got a tRNS now */
name|pBuf
operator|->
name|iTRNSgray
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNSred
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|=
literal|0
expr_stmt|;
name|pBuf
operator|->
name|iTRNScount
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
comment|/* if empty, inherit from global */
block|{
name|iRawlen2
operator|=
name|pData
operator|->
name|iGlobalTRNSrawlen
expr_stmt|;
name|pRawdata2
operator|=
call|(
name|mng_ptr
call|)
argument_list|(
name|pData
operator|->
name|aGlobalTRNSrawdata
argument_list|)
expr_stmt|;
comment|/* global length oke ? */
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
literal|0
operator|)
operator|&&
operator|(
name|iRawlen2
operator|!=
literal|2
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_GLOBALLENGTHERR
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
literal|2
operator|)
operator|&&
operator|(
name|iRawlen2
operator|!=
literal|6
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_GLOBALLENGTHERR
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
literal|3
operator|)
operator|&&
operator|(
operator|(
name|iRawlen2
operator|==
literal|0
operator|)
operator|||
operator|(
name|iRawlen2
operator|>
name|pBuf
operator|->
name|iPLTEcount
operator|)
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_GLOBALLENGTHERR
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
comment|/* store fields for future reference */
block|{
case|case
literal|0
case|:
block|{
comment|/* gray */
name|pBuf
operator|->
name|iTRNSgray
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata2
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
if|if
condition|(
name|pData
operator|->
name|iPNGmult
operator|==
literal|2
condition|)
name|pBuf
operator|->
name|iTRNSgray
operator|>>=
literal|8
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
case|case
literal|2
case|:
block|{
comment|/* rgb */
name|pBuf
operator|->
name|iTRNSred
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata2
argument_list|)
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata2
operator|+
literal|2
argument_list|)
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata2
operator|+
literal|4
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
if|if
condition|(
name|pData
operator|->
name|iPNGmult
operator|==
literal|2
condition|)
block|{
name|pBuf
operator|->
name|iTRNSred
operator|>>=
literal|8
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|>>=
literal|8
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|>>=
literal|8
expr_stmt|;
block|}
endif|#
directive|endif
break|break;
block|}
case|case
literal|3
case|:
block|{
comment|/* indexed */
name|pBuf
operator|->
name|iTRNScount
operator|=
name|iRawlen2
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aTRNSentries
argument_list|,
name|pRawdata2
argument_list|,
name|iRawlen2
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
block|}
else|else
block|{
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
comment|/* store fields for future reference */
block|{
case|case
literal|0
case|:
block|{
comment|/* gray */
name|pBuf
operator|->
name|iTRNSgray
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iGray
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
if|if
condition|(
name|pData
operator|->
name|iPNGmult
operator|==
literal|2
condition|)
name|pBuf
operator|->
name|iTRNSgray
operator|>>=
literal|8
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
case|case
literal|2
case|:
block|{
comment|/* rgb */
name|pBuf
operator|->
name|iTRNSred
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iRed
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iGreen
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iBlue
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
if|if
condition|(
name|pData
operator|->
name|iPNGmult
operator|==
literal|2
condition|)
block|{
name|pBuf
operator|->
name|iTRNSred
operator|>>=
literal|8
expr_stmt|;
name|pBuf
operator|->
name|iTRNSgreen
operator|>>=
literal|8
expr_stmt|;
name|pBuf
operator|->
name|iTRNSblue
operator|>>=
literal|8
expr_stmt|;
block|}
endif|#
directive|endif
break|break;
block|}
case|case
literal|3
case|:
block|{
comment|/* indexed */
name|pBuf
operator|->
name|iTRNScount
operator|=
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iCount
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pBuf
operator|->
name|aTRNSentries
argument_list|,
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|aEntries
argument_list|,
operator|(
operator|(
name|mng_trnsp
operator|)
name|pChunk
operator|)
operator|->
name|iCount
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
block|}
block|}
block|}
else|else
block|{
comment|/* create an animation object */
return|return
name|mng_create_ani_trns
argument_list|(
name|pData
argument_list|)
return|;
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_gama
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
name|pData
operator|->
name|bHasGAMA
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we've got it */
else|else
name|pData
operator|->
name|bHasglobalGAMA
operator|=
operator|(
name|mng_bool
operator|)
operator|!
operator|(
operator|(
name|mng_gamap
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
expr_stmt|;
end_expr_stmt
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
block|{
name|mng_imagep
name|pImage
decl_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* update delta image ? */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
else|else
endif|#
directive|endif
block|{
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
expr_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
block|}
comment|/* store for color-processing routines */
name|pImage
operator|->
name|pImgbuf
operator|->
name|iGamma
operator|=
operator|(
operator|(
name|mng_gamap
operator|)
name|pChunk
operator|)
operator|->
name|iGamma
expr_stmt|;
name|pImage
operator|->
name|pImgbuf
operator|->
name|bHasGAMA
operator|=
name|MNG_TRUE
expr_stmt|;
block|}
else|else
block|{
comment|/* store as global */
if|if
condition|(
operator|!
operator|(
operator|(
name|mng_gamap
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
name|pData
operator|->
name|iGlobalGamma
operator|=
operator|(
operator|(
name|mng_gamap
operator|)
name|pChunk
operator|)
operator|->
name|iGamma
expr_stmt|;
comment|/* create an animation object */
return|return
name|mng_create_ani_gama
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_cHRM
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_chrm
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
name|pData
operator|->
name|bHasCHRM
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we've got it */
else|else
name|pData
operator|->
name|bHasglobalCHRM
operator|=
operator|(
name|mng_bool
operator|)
operator|!
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
block|{
name|mng_imagep
name|pImage
decl_stmt|;
name|mng_imagedatap
name|pBuf
decl_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* update delta image ? */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
else|else
endif|#
directive|endif
block|{
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
expr_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
block|}
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* address object buffer */
end_comment
begin_expr_stmt
name|pBuf
operator|->
name|bHasCHRM
operator|=
name|MNG_TRUE
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* and tell it it's got a CHRM now */
end_comment
begin_comment
comment|/* store for color-processing routines */
end_comment
begin_expr_stmt
name|pBuf
operator|->
name|iWhitepointx
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iWhitepointx
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iWhitepointy
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iWhitepointy
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iPrimaryredx
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iRedx
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iPrimaryredy
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iRedy
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iPrimarygreenx
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iGreenx
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iPrimarygreeny
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iGreeny
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iPrimarybluex
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iBluex
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pBuf
operator|->
name|iPrimarybluey
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iBluey
expr_stmt|;
end_expr_stmt
begin_block
unit|}     else
block|{
comment|/* store as global */
if|if
condition|(
operator|!
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
block|{
name|pData
operator|->
name|iGlobalWhitepointx
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iWhitepointx
expr_stmt|;
name|pData
operator|->
name|iGlobalWhitepointy
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iWhitepointy
expr_stmt|;
name|pData
operator|->
name|iGlobalPrimaryredx
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iRedx
expr_stmt|;
name|pData
operator|->
name|iGlobalPrimaryredy
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iRedy
expr_stmt|;
name|pData
operator|->
name|iGlobalPrimarygreenx
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iGreenx
expr_stmt|;
name|pData
operator|->
name|iGlobalPrimarygreeny
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iGreeny
expr_stmt|;
name|pData
operator|->
name|iGlobalPrimarybluex
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iBluex
expr_stmt|;
name|pData
operator|->
name|iGlobalPrimarybluey
operator|=
operator|(
operator|(
name|mng_chrmp
operator|)
name|pChunk
operator|)
operator|->
name|iBluey
expr_stmt|;
block|}
comment|/* create an animation object */
return|return
name|mng_create_ani_chrm
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
block|}
end_block
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_expr_stmt
unit|return
name|MNG_NOERROR
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_srgb
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
name|pData
operator|->
name|bHasSRGB
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we've got it */
else|else
name|pData
operator|->
name|bHasglobalSRGB
operator|=
operator|(
name|mng_bool
operator|)
operator|!
operator|(
operator|(
name|mng_srgbp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
expr_stmt|;
end_expr_stmt
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_if
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
block|{
name|mng_imagep
name|pImage
decl_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* update delta image ? */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
else|else
endif|#
directive|endif
block|{
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
expr_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
block|}
comment|/* store for color-processing routines */
name|pImage
operator|->
name|pImgbuf
operator|->
name|iRenderingintent
operator|=
operator|(
operator|(
name|mng_srgbp
operator|)
name|pChunk
operator|)
operator|->
name|iRenderingintent
expr_stmt|;
name|pImage
operator|->
name|pImgbuf
operator|->
name|bHasSRGB
operator|=
name|MNG_TRUE
expr_stmt|;
block|}
else|else
block|{
comment|/* store as global */
if|if
condition|(
operator|!
operator|(
operator|(
name|mng_srgbp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
name|pData
operator|->
name|iGlobalRendintent
operator|=
operator|(
operator|(
name|mng_srgbp
operator|)
name|pChunk
operator|)
operator|->
name|iRenderingintent
expr_stmt|;
comment|/* create an animation object */
return|return
name|mng_create_ani_srgb
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_comment
unit|}
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iCCP
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_iccp
operator|)
block|{
name|mng_retcode
name|iRetcode
block|;
name|mng_chunk_headerp
name|pDummy
block|;
ifdef|#
directive|ifdef
name|MNG_CHECK_BAD_ICCP
comment|/* Check for bad iCCP chunk */
if|if
condition|(
operator|!
name|strncmp
argument_list|(
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|zName
argument_list|,
literal|"Photoshop ICC profile"
argument_list|,
literal|21
argument_list|)
condition|)
block|{
if|if
condition|(
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
operator|==
literal|2615
condition|)
comment|/* is it the sRGB profile ? */
block|{
name|mng_chunk_header
name|chunk_srgb
decl_stmt|;
name|mng_get_chunkheader
argument_list|(
name|MNG_UINT_sRGB
argument_list|,
operator|&
name|chunk_srgb
argument_list|)
expr_stmt|;
comment|/* pretend it's an sRGB chunk then ! */
name|iRetcode
operator|=
name|mng_read_general
argument_list|(
name|pData
argument_list|,
operator|&
name|chunk_srgb
argument_list|,
literal|1
argument_list|,
operator|(
name|mng_ptr
operator|)
literal|"0"
argument_list|,
operator|&
name|pDummy
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
name|pDummy
operator|->
name|fCleanup
argument_list|(
name|pData
argument_list|,
name|pDummy
argument_list|)
expr_stmt|;
block|}
end_expr_stmt
begin_block
unit|}   else
block|{
endif|#
directive|endif
comment|/* MNG_CHECK_BAD_ICCP */
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
name|pData
operator|->
name|bHasICCP
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we've got it */
else|else
name|pData
operator|->
name|bHasglobalICCP
operator|=
operator|(
name|mng_bool
operator|)
operator|!
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
block|{
name|mng_imagep
name|pImage
decl_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
if|if
condition|(
name|pData
operator|->
name|bHasDHDR
condition|)
comment|/* update delta image ? */
block|{
comment|/* store in object 0 ! */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
if|if
condition|(
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
condition|)
comment|/* profile existed ? */
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
comment|/* allocate a buffer& copy it */
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
comment|/* store its length as well */
name|pImage
operator|->
name|pImgbuf
operator|->
name|iProfilesize
operator|=
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
expr_stmt|;
name|pImage
operator|->
name|pImgbuf
operator|->
name|bHasICCP
operator|=
name|MNG_TRUE
expr_stmt|;
block|}
else|else
endif|#
directive|endif
block|{
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
expr_stmt|;
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* no object then dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
if|if
condition|(
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
condition|)
comment|/* profile existed ? */
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
comment|/* allocate a buffer& copy it */
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pImage
operator|->
name|pImgbuf
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
comment|/* store its length as well */
name|pImage
operator|->
name|pImgbuf
operator|->
name|iProfilesize
operator|=
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
expr_stmt|;
name|pImage
operator|->
name|pImgbuf
operator|->
name|bHasICCP
operator|=
name|MNG_TRUE
expr_stmt|;
block|}
block|}
else|else
block|{
comment|/* store as global */
if|if
condition|(
name|pData
operator|->
name|pGlobalProfile
condition|)
comment|/* did we have a global profile ? */
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pData
operator|->
name|pGlobalProfile
argument_list|,
name|pData
operator|->
name|iGlobalProfilesize
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
comment|/* empty chunk ? */
block|{
name|pData
operator|->
name|iGlobalProfilesize
operator|=
literal|0
expr_stmt|;
comment|/* reset to null */
name|pData
operator|->
name|pGlobalProfile
operator|=
name|MNG_NULL
expr_stmt|;
block|}
else|else
block|{
comment|/* allocate a global buffer& copy it */
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pData
operator|->
name|pGlobalProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pData
operator|->
name|pGlobalProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|pProfile
argument_list|,
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
argument_list|)
expr_stmt|;
comment|/* store its length as well */
name|pData
operator|->
name|iGlobalProfilesize
operator|=
operator|(
operator|(
name|mng_iccpp
operator|)
name|pChunk
operator|)
operator|->
name|iProfilesize
expr_stmt|;
block|}
comment|/* create an animation object */
return|return
name|mng_create_ani_iccp
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
ifdef|#
directive|ifdef
name|MNG_CHECK_BAD_ICCP
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tEXt
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_text
operator|)
block|{
if|if
condition|(
name|pData
operator|->
name|fProcesstext
condition|)
comment|/* inform the application ? */
block|{
name|mng_bool
name|bOke
init|=
name|pData
operator|->
name|fProcesstext
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|,
name|MNG_TYPE_TEXT
argument_list|,
operator|(
operator|(
name|mng_textp
operator|)
name|pChunk
operator|)
operator|->
name|zKeyword
argument_list|,
operator|(
operator|(
name|mng_textp
operator|)
name|pChunk
operator|)
operator|->
name|zText
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
block|}
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_zTXt
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_ztxt
operator|)
block|{
if|if
condition|(
name|pData
operator|->
name|fProcesstext
condition|)
comment|/* inform the application ? */
block|{
name|mng_bool
name|bOke
init|=
name|pData
operator|->
name|fProcesstext
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|,
name|MNG_TYPE_ZTXT
argument_list|,
operator|(
operator|(
name|mng_ztxtp
operator|)
name|pChunk
operator|)
operator|->
name|zKeyword
argument_list|,
operator|(
operator|(
name|mng_ztxtp
operator|)
name|pChunk
operator|)
operator|->
name|zText
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
block|}
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iTXt
end_ifndef
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_deflate_itxt
operator|)
block|{
name|mng_itxtp
name|pITXT
operator|=
operator|(
name|mng_itxtp
operator|)
name|pChunk
block|;
name|mng_uint32
name|iBufsize
operator|=
literal|0
block|;
name|mng_uint8p
name|pBuf
operator|=
literal|0
block|;
name|mng_uint32
name|iTextlen
operator|=
literal|0
block|;
if|if
condition|(
name|pITXT
operator|->
name|iCompressionflag
condition|)
comment|/* decompress the text ? */
block|{
name|mng_retcode
name|iRetcode
init|=
name|mng_inflate_buffer
argument_list|(
name|pData
argument_list|,
operator|*
name|ppRawdata
argument_list|,
operator|*
name|piRawlen
argument_list|,
operator|&
name|pBuf
argument_list|,
operator|&
name|iBufsize
argument_list|,
operator|&
name|iTextlen
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
block|{
comment|/* don't forget to drop the temp buffer */
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
block|}
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pITXT
operator|->
name|zText
argument_list|,
name|iTextlen
operator|+
literal|1
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|MNG_COPY
argument_list|(
name|pITXT
operator|->
name|zText
argument_list|,
name|pBuf
argument_list|,
name|iTextlen
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pITXT
operator|->
name|iTextsize
operator|=
name|iTextlen
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
end_expr_stmt
begin_block
unit|} else
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pITXT
operator|->
name|zText
argument_list|,
operator|(
operator|*
name|piRawlen
operator|)
operator|+
literal|1
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pITXT
operator|->
name|zText
argument_list|,
operator|*
name|ppRawdata
argument_list|,
operator|*
name|piRawlen
argument_list|)
expr_stmt|;
name|pITXT
operator|->
name|iTextsize
operator|=
operator|*
name|piRawlen
expr_stmt|;
block|}
end_block
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_iTXt
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_itxt
operator|)
block|{
if|if
condition|(
name|pData
operator|->
name|fProcesstext
condition|)
comment|/* inform the application ? */
block|{
name|mng_bool
name|bOke
init|=
name|pData
operator|->
name|fProcesstext
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|,
name|MNG_TYPE_ITXT
argument_list|,
operator|(
operator|(
name|mng_itxtp
operator|)
name|pChunk
operator|)
operator|->
name|zKeyword
argument_list|,
operator|(
operator|(
name|mng_itxtp
operator|)
name|pChunk
operator|)
operator|->
name|zText
argument_list|,
operator|(
operator|(
name|mng_itxtp
operator|)
name|pChunk
operator|)
operator|->
name|zLanguage
argument_list|,
operator|(
operator|(
name|mng_itxtp
operator|)
name|pChunk
operator|)
operator|->
name|zTranslation
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
block|}
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_bKGD
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_bkgd
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
name|mng_imagep
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pCurrentobj
block|;
name|mng_imagedatap
name|pBuf
block|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasJHDR
operator|)
condition|)
else|#
directive|else
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
endif|#
directive|endif
name|pData
operator|->
name|bHasBKGD
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate bKGD available */
else|else
name|pData
operator|->
name|bHasglobalBKGD
operator|=
operator|(
name|mng_bool
operator|)
operator|!
operator|(
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
operator|)
expr_stmt|;
end_expr_stmt
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_if
if|if
condition|(
operator|!
name|pImage
condition|)
comment|/* if no object dump it in obj 0 */
name|pImage
operator|=
operator|(
name|mng_imagep
operator|)
name|pData
operator|->
name|pObjzero
expr_stmt|;
end_if
begin_expr_stmt
name|pBuf
operator|=
name|pImage
operator|->
name|pImgbuf
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* address object buffer */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_if
if|if
condition|(
name|pData
operator|->
name|bHasJHDR
condition|)
block|{
name|pBuf
operator|->
name|bHasBKGD
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* tell the object it's got bKGD now */
switch|switch
condition|(
name|pData
operator|->
name|iJHDRcolortype
condition|)
comment|/* store fields for future reference */
block|{
case|case
literal|8
case|:
empty_stmt|;
comment|/* gray */
case|case
literal|12
case|:
block|{
comment|/* graya */
name|pBuf
operator|->
name|iBKGDgray
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iGray
expr_stmt|;
break|break;
block|}
case|case
literal|10
case|:
empty_stmt|;
comment|/* rgb */
case|case
literal|14
case|:
block|{
comment|/* rgba */
name|pBuf
operator|->
name|iBKGDred
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iRed
expr_stmt|;
name|pBuf
operator|->
name|iBKGDgreen
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iGreen
expr_stmt|;
name|pBuf
operator|->
name|iBKGDblue
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iBlue
expr_stmt|;
break|break;
block|}
block|}
block|}
elseif|else
endif|#
directive|endif
comment|/* MNG_INCLUDE_JNG */
if|if
condition|(
operator|(
name|pData
operator|->
name|bHasIHDR
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasBASI
operator|)
operator|||
operator|(
name|pData
operator|->
name|bHasDHDR
operator|)
condition|)
block|{
name|pBuf
operator|->
name|bHasBKGD
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* tell the object it's got bKGD now */
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
comment|/* store fields for future reference */
block|{
case|case
literal|0
case|:
empty_stmt|;
comment|/* gray */
case|case
literal|4
case|:
block|{
comment|/* graya */
name|pBuf
operator|->
name|iBKGDgray
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iGray
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
empty_stmt|;
comment|/* rgb */
case|case
literal|6
case|:
block|{
comment|/* rgba */
name|pBuf
operator|->
name|iBKGDred
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iRed
expr_stmt|;
name|pBuf
operator|->
name|iBKGDgreen
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iGreen
expr_stmt|;
name|pBuf
operator|->
name|iBKGDblue
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iBlue
expr_stmt|;
break|break;
block|}
case|case
literal|3
case|:
block|{
comment|/* indexed */
name|pBuf
operator|->
name|iBKGDindex
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iIndex
expr_stmt|;
break|break;
block|}
block|}
block|}
else|else
comment|/* store as global */
block|{
if|if
condition|(
operator|!
operator|(
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
operator|)
condition|)
block|{
name|pData
operator|->
name|iGlobalBKGDred
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iRed
expr_stmt|;
name|pData
operator|->
name|iGlobalBKGDgreen
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iGreen
expr_stmt|;
name|pData
operator|->
name|iGlobalBKGDblue
operator|=
operator|(
operator|(
name|mng_bkgdp
operator|)
name|pChunk
operator|)
operator|->
name|iBlue
expr_stmt|;
block|}
comment|/* create an animation object */
return|return
name|mng_create_ani_bkgd
argument_list|(
name|pData
argument_list|)
return|;
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYs
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_phys
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_expr_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sBIT
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_sbit
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sPLT
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_splt_entries
argument_list|)
end_macro
begin_block
block|{
name|mng_spltp
name|pSPLT
init|=
operator|(
name|mng_spltp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
if|if
condition|(
operator|(
name|pSPLT
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_8
operator|)
operator|&&
operator|(
name|pSPLT
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_16
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVSAMPLEDEPTH
argument_list|)
expr_stmt|;
comment|/* check remaining length */
if|if
condition|(
operator|(
operator|(
name|pSPLT
operator|->
name|iSampledepth
operator|==
name|MNG_BITDEPTH_8
operator|)
operator|&&
operator|(
name|iRawlen
operator|%
literal|6
operator|!=
literal|0
operator|)
operator|)
operator|||
operator|(
operator|(
name|pSPLT
operator|->
name|iSampledepth
operator|==
name|MNG_BITDEPTH_16
operator|)
operator|&&
operator|(
name|iRawlen
operator|%
literal|10
operator|!=
literal|0
operator|)
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
if|if
condition|(
name|pSPLT
operator|->
name|iSampledepth
operator|==
name|MNG_BITDEPTH_8
condition|)
name|pSPLT
operator|->
name|iEntrycount
operator|=
name|iRawlen
operator|/
literal|6
expr_stmt|;
else|else
name|pSPLT
operator|->
name|iEntrycount
operator|=
name|iRawlen
operator|/
literal|10
expr_stmt|;
if|if
condition|(
name|iRawlen
condition|)
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pSPLT
operator|->
name|pEntries
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pSPLT
operator|->
name|pEntries
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_sPLT
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_splt
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_hIST
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_hist_entries
argument_list|)
end_macro
begin_block
block|{
name|mng_histp
name|pHIST
init|=
operator|(
name|mng_histp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
name|mng_uint32
name|iX
decl_stmt|;
if|if
condition|(
operator|(
operator|(
name|iRawlen
operator|&
literal|0x01
operator|)
operator|!=
literal|0
operator|)
operator|||
operator|(
operator|(
name|iRawlen
operator|>>
literal|1
operator|)
operator|!=
name|pData
operator|->
name|iPLTEcount
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pHIST
operator|->
name|iEntrycount
operator|=
name|iRawlen
operator|>>
literal|1
expr_stmt|;
for|for
control|(
name|iX
operator|=
literal|0
init|;
name|iX
operator|<
name|pHIST
operator|->
name|iEntrycount
condition|;
name|iX
operator|++
control|)
block|{
name|pHIST
operator|->
name|aEntries
index|[
name|iX
index|]
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|2
expr_stmt|;
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_hIST
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_hist
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_tIME
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_time
argument_list|)
end_macro
begin_block
block|{
comment|/*  if (pData->fProcesstime) */
comment|/* inform the application ? */
comment|/*  {      pData->fProcesstime ((mng_handle)pData, );   } */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* JNG chunks */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_jhdr
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|(
name|pData
operator|->
name|eSigtype
operator|==
name|mng_it_jng
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iChunkseq
operator|>
literal|1
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_SEQUENCEERROR
argument_list|)
expr_stmt|;
comment|/* inside a JHDR-IEND block now */
name|pData
operator|->
name|bHasJHDR
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* and store interesting fields */
name|pData
operator|->
name|iDatawidth
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iWidth
expr_stmt|;
name|pData
operator|->
name|iDataheight
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iHeight
expr_stmt|;
name|pData
operator|->
name|iJHDRcolortype
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
expr_stmt|;
name|pData
operator|->
name|iJHDRimgbitdepth
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iImagesampledepth
expr_stmt|;
name|pData
operator|->
name|iJHDRimgcompression
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iImagecompression
expr_stmt|;
name|pData
operator|->
name|iJHDRimginterlace
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iImageinterlace
expr_stmt|;
name|pData
operator|->
name|iJHDRalphabitdepth
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iAlphasampledepth
expr_stmt|;
name|pData
operator|->
name|iJHDRalphacompression
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iAlphacompression
expr_stmt|;
name|pData
operator|->
name|iJHDRalphafilter
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iAlphafilter
expr_stmt|;
name|pData
operator|->
name|iJHDRalphainterlace
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iAlphainterlace
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_1_2_4BIT_SUPPORT
argument_list|)
operator|||
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
name|pData
operator|->
name|iPNGmult
operator|=
literal|1
expr_stmt|;
name|pData
operator|->
name|iPNGdepth
operator|=
name|pData
operator|->
name|iJHDRalphabitdepth
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_1_2_4BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|<
literal|8
condition|)
name|pData
operator|->
name|iJHDRalphabitdepth
operator|=
literal|8
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|>
literal|8
condition|)
block|{
name|pData
operator|->
name|iPNGmult
operator|=
literal|2
expr_stmt|;
name|pData
operator|->
name|iJHDRalphabitdepth
operator|=
literal|8
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* parameter validity checks */
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|!=
name|MNG_COLORTYPE_JPEGGRAY
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|!=
name|MNG_COLORTYPE_JPEGCOLOR
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|!=
name|MNG_COLORTYPE_JPEGGRAYA
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|!=
name|MNG_COLORTYPE_JPEGCOLORA
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOLORTYPE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRimgbitdepth
operator|!=
name|MNG_BITDEPTH_JPEG8
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRimgbitdepth
operator|!=
name|MNG_BITDEPTH_JPEG12
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRimgbitdepth
operator|!=
name|MNG_BITDEPTH_JPEG8AND12
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|==
name|MNG_COLORTYPE_JPEGGRAYA
operator|)
operator|||
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|==
name|MNG_COLORTYPE_JPEGCOLORA
operator|)
condition|)
block|{
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|!=
name|MNG_BITDEPTH_8
operator|)
ifndef|#
directive|ifndef
name|MNG_NO_1_2_4BIT_SUPPORT
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|!=
name|MNG_BITDEPTH_1
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|!=
name|MNG_BITDEPTH_2
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|!=
name|MNG_BITDEPTH_4
operator|)
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|!=
name|MNG_BITDEPTH_16
operator|)
endif|#
directive|endif
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRalphacompression
operator|!=
name|MNG_COMPRESSION_DEFLATE
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphacompression
operator|!=
name|MNG_COMPRESSION_BASELINEJPEG
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOMPRESS
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRalphacompression
operator|==
name|MNG_COMPRESSION_BASELINEJPEG
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphabitdepth
operator|!=
name|MNG_BITDEPTH_8
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|FILTER192
argument_list|)
operator|||
name|defined
argument_list|(
name|FILTER193
argument_list|)
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRalphafilter
operator|!=
name|MNG_FILTER_ADAPTIVE
operator|)
operator|&&
if|#
directive|if
name|defined
argument_list|(
name|FILTER192
argument_list|)
operator|&&
name|defined
argument_list|(
name|FILTER193
argument_list|)
operator|(
name|pData
operator|->
name|iJHDRalphafilter
operator|!=
name|MNG_FILTER_DIFFERING
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iJHDRalphafilter
operator|!=
name|MNG_FILTER_NOFILTER
operator|)
condition|)
else|#
directive|else
ifdef|#
directive|ifdef
name|FILTER192
operator|(
name|pData
operator|->
name|iJHDRalphafilter
operator|!=
name|MNG_FILTER_DIFFERING
operator|)
block|)
else|#
directive|else
operator|(
name|pData
operator|->
name|iJHDRalphafilter
operator|!=
name|MNG_FILTER_NOFILTER
operator|)
block|)
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_expr_stmt
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_if
if|if
condition|(
name|pData
operator|->
name|iJHDRalphafilter
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_block
unit|}   else
block|{
if|if
condition|(
name|pData
operator|->
name|iJHDRalphabitdepth
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|iJHDRalphacompression
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOMPRESS
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|iJHDRalphafilter
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|iJHDRalphainterlace
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDINTERLACE
argument_list|)
expr_stmt|;
block|}
end_block
begin_if
if|if
condition|(
operator|!
name|pData
operator|->
name|bHasheader
condition|)
comment|/* first chunk ? */
block|{
name|pData
operator|->
name|bHasheader
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* we've got a header */
name|pData
operator|->
name|eImagetype
operator|=
name|mng_it_jng
expr_stmt|;
comment|/* then this must be a JNG */
name|pData
operator|->
name|iWidth
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iWidth
expr_stmt|;
name|pData
operator|->
name|iHeight
operator|=
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iHeight
expr_stmt|;
comment|/* predict alpha-depth ! */
if|if
condition|(
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|==
name|MNG_COLORTYPE_JPEGGRAYA
operator|)
operator|||
operator|(
name|pData
operator|->
name|iJHDRcolortype
operator|==
name|MNG_COLORTYPE_JPEGCOLORA
operator|)
condition|)
name|pData
operator|->
name|iAlphadepth
operator|=
name|pData
operator|->
name|iJHDRalphabitdepth
expr_stmt|;
else|else
name|pData
operator|->
name|iAlphadepth
operator|=
literal|0
expr_stmt|;
comment|/* fits on maximum canvas ? */
if|if
condition|(
operator|(
name|pData
operator|->
name|iWidth
operator|>
name|pData
operator|->
name|iMaxwidth
operator|)
operator|||
operator|(
name|pData
operator|->
name|iHeight
operator|>
name|pData
operator|->
name|iMaxheight
operator|)
condition|)
name|MNG_WARNING
argument_list|(
name|pData
argument_list|,
name|MNG_IMAGETOOLARGE
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|fProcessheader
condition|)
comment|/* inform the app ? */
if|if
condition|(
operator|!
name|pData
operator|->
name|fProcessheader
argument_list|(
operator|(
operator|(
name|mng_handle
operator|)
name|pData
operator|)
argument_list|,
name|pData
operator|->
name|iWidth
argument_list|,
name|pData
operator|->
name|iHeight
argument_list|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
block|}
end_if
begin_expr_stmt
name|pData
operator|->
name|iColortype
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* fake grayscale for other routines */
end_comment
begin_expr_stmt
name|pData
operator|->
name|iImagelevel
operator|++
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* one level deeper */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_block
block|{
name|mng_retcode
name|iRetcode
init|=
name|mng_process_display_jhdr
argument_list|(
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
end_ifdef
begin_if
if|if
condition|(
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iAlphasampledepth
operator|>
literal|8
condition|)
operator|(
operator|(
name|mng_jhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iAlphasampledepth
operator|=
literal|8
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_INCLUDE_JNG */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_jdaa
operator|)
block|{
if|if
condition|(
name|pData
operator|->
name|iJHDRalphacompression
operator|!=
name|MNG_COMPRESSION_BASELINEJPEG
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_SEQUENCEERROR
argument_list|)
expr_stmt|;
name|pData
operator|->
name|bHasJDAA
operator|=
name|MNG_TRUE
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* got some JDAA now, don't we */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_INCLUDE_JNG */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_jdat
operator|)
block|{
name|pData
operator|->
name|bHasJDAT
operator|=
name|MNG_TRUE
block|;
comment|/* got some JDAT now, don't we */
return|return
name|MNG_NOERROR
return|;
block|}
end_expr_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_INCLUDE_JNG */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_jsep
argument_list|)
end_macro
begin_block
block|{
name|pData
operator|->
name|bHasJSEP
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we've had the 8-/12-bit separator */
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_INCLUDE_JNG */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* MNG chunks */
end_comment
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_mhdr
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
name|pData
operator|->
name|bHasheader
condition|)
comment|/* can only be the first chunk! */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_SEQUENCEERROR
argument_list|)
expr_stmt|;
name|pData
operator|->
name|bHasMHDR
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* oh boy, a real MNG */
name|pData
operator|->
name|bHasheader
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* we've got a header */
name|pData
operator|->
name|eImagetype
operator|=
name|mng_it_mng
expr_stmt|;
comment|/* fill header fields */
name|pData
operator|->
name|iWidth
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iWidth
expr_stmt|;
name|pData
operator|->
name|iHeight
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iHeight
expr_stmt|;
name|pData
operator|->
name|iTicks
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iTicks
expr_stmt|;
name|pData
operator|->
name|iLayercount
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iLayercount
expr_stmt|;
name|pData
operator|->
name|iFramecount
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iFramecount
expr_stmt|;
name|pData
operator|->
name|iPlaytime
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iPlaytime
expr_stmt|;
name|pData
operator|->
name|iSimplicity
operator|=
operator|(
operator|(
name|mng_mhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iSimplicity
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_OLD_VERSIONS
name|pData
operator|->
name|bPreDraft48
operator|=
name|MNG_FALSE
expr_stmt|;
endif|#
directive|endif
comment|/* predict alpha-depth */
if|if
condition|(
operator|(
name|pData
operator|->
name|iSimplicity
operator|&
literal|0x00000001
operator|)
operator|==
literal|0
condition|)
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
name|pData
operator|->
name|iAlphadepth
operator|=
literal|16
expr_stmt|;
comment|/* no indicators = assume the worst */
else|#
directive|else
name|pData
operator|->
name|iAlphadepth
operator|=
literal|8
expr_stmt|;
comment|/* anything else = assume the worst */
endif|#
directive|endif
elseif|else
if|if
condition|(
operator|(
name|pData
operator|->
name|iSimplicity
operator|&
literal|0x00000008
operator|)
operator|==
literal|0
condition|)
name|pData
operator|->
name|iAlphadepth
operator|=
literal|0
expr_stmt|;
comment|/* no transparency at all */
elseif|else
if|if
condition|(
operator|(
name|pData
operator|->
name|iSimplicity
operator|&
literal|0x00000140
operator|)
operator|==
literal|0x00000040
condition|)
name|pData
operator|->
name|iAlphadepth
operator|=
literal|1
expr_stmt|;
comment|/* no semi-transparency guaranteed */
else|else
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
name|pData
operator|->
name|iAlphadepth
operator|=
literal|16
expr_stmt|;
comment|/* anything else = assume the worst */
else|#
directive|else
name|pData
operator|->
name|iAlphadepth
operator|=
literal|8
expr_stmt|;
comment|/* anything else = assume the worst */
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
comment|/* can we handle the complexity ? */
if|if
condition|(
name|pData
operator|->
name|iSimplicity
operator|&
literal|0x0000FC00
condition|)
else|#
directive|else
if|if
condition|(
name|pData
operator|->
name|iSimplicity
operator|&
literal|0x0000FC10
condition|)
endif|#
directive|endif
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_MNGTOOCOMPLEX
argument_list|)
expr_stmt|;
comment|/* fits on maximum canvas ? */
if|if
condition|(
operator|(
name|pData
operator|->
name|iWidth
operator|>
name|pData
operator|->
name|iMaxwidth
operator|)
operator|||
operator|(
name|pData
operator|->
name|iHeight
operator|>
name|pData
operator|->
name|iMaxheight
operator|)
condition|)
name|MNG_WARNING
argument_list|(
name|pData
argument_list|,
name|MNG_IMAGETOOLARGE
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|fProcessheader
condition|)
comment|/* inform the app ? */
if|if
condition|(
operator|!
name|pData
operator|->
name|fProcessheader
argument_list|(
operator|(
operator|(
name|mng_handle
operator|)
name|pData
operator|)
argument_list|,
name|pData
operator|->
name|iWidth
argument_list|,
name|pData
operator|->
name|iHeight
argument_list|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
name|pData
operator|->
name|iImagelevel
operator|++
expr_stmt|;
comment|/* one level deeper */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_mend
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* do something */
name|mng_retcode
name|iRetcode
init|=
name|mng_process_display_mend
argument_list|(
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
if|if
condition|(
operator|!
name|pData
operator|->
name|iTotalframes
condition|)
comment|/* save totals */
name|pData
operator|->
name|iTotalframes
operator|=
name|pData
operator|->
name|iFrameseq
expr_stmt|;
if|if
condition|(
operator|!
name|pData
operator|->
name|iTotallayers
condition|)
name|pData
operator|->
name|iTotallayers
operator|=
name|pData
operator|->
name|iLayerseq
expr_stmt|;
if|if
condition|(
operator|!
name|pData
operator|->
name|iTotalplaytime
condition|)
name|pData
operator|->
name|iTotalplaytime
operator|=
name|pData
operator|->
name|iFrametime
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
name|pData
operator|->
name|bHasMHDR
operator|=
name|MNG_FALSE
expr_stmt|;
comment|/* end of the line, bro! */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_debunk_loop
argument_list|)
end_macro
begin_block
block|{
name|mng_loopp
name|pLOOP
init|=
operator|(
name|mng_loopp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
if|if
condition|(
name|iRawlen
operator|>=
literal|5
condition|)
comment|/* length checks */
block|{
if|if
condition|(
name|iRawlen
operator|>=
literal|6
condition|)
block|{
if|if
condition|(
operator|(
name|iRawlen
operator|-
literal|6
operator|)
operator|%
literal|4
operator|!=
literal|0
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
block|}
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>=
literal|5
condition|)
comment|/* store the fields */
block|{
name|pLOOP
operator|->
name|iLevel
operator|=
operator|*
name|pRawdata
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_OLD_VERSIONS
if|if
condition|(
name|pData
operator|->
name|bPreDraft48
condition|)
block|{
name|pLOOP
operator|->
name|iTermination
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|1
operator|)
expr_stmt|;
name|pLOOP
operator|->
name|iRepeat
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
operator|+
literal|2
argument_list|)
expr_stmt|;
block|}
else|else
endif|#
directive|endif
block|{
name|pLOOP
operator|->
name|iRepeat
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|iRawlen
operator|>=
literal|6
condition|)
block|{
ifndef|#
directive|ifndef
name|MNG_NO_OLD_VERSIONS
if|if
condition|(
operator|!
name|pData
operator|->
name|bPreDraft48
condition|)
endif|#
directive|endif
name|pLOOP
operator|->
name|iTermination
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|5
operator|)
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>=
literal|10
condition|)
block|{
name|pLOOP
operator|->
name|iItermin
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
operator|+
literal|6
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_NO_LOOP_SIGNALS_SUPPORTED
if|if
condition|(
name|iRawlen
operator|>=
literal|14
condition|)
block|{
name|pLOOP
operator|->
name|iItermax
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
operator|+
literal|10
argument_list|)
expr_stmt|;
name|pLOOP
operator|->
name|iCount
operator|=
operator|(
name|iRawlen
operator|-
literal|14
operator|)
operator|/
literal|4
expr_stmt|;
if|if
condition|(
name|pLOOP
operator|->
name|iCount
condition|)
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pLOOP
operator|->
name|pSignals
argument_list|,
name|pLOOP
operator|->
name|iCount
operator|<<
literal|2
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_BIGENDIAN_SUPPORTED
block|{
name|mng_uint32
name|iX
decl_stmt|;
name|mng_uint8p
name|pIn
init|=
name|pRawdata
operator|+
literal|14
decl_stmt|;
name|mng_uint32p
name|pOut
init|=
operator|(
name|mng_uint32p
operator|)
name|pLOOP
operator|->
name|pSignals
decl_stmt|;
for|for
control|(
name|iX
operator|=
literal|0
init|;
name|iX
operator|<
name|pLOOP
operator|->
name|iCount
condition|;
name|iX
operator|++
control|)
block|{
operator|*
name|pOut
operator|++
operator|=
name|mng_get_uint32
argument_list|(
name|pIn
argument_list|)
expr_stmt|;
name|pIn
operator|+=
literal|4
expr_stmt|;
block|}
block|}
else|#
directive|else
name|MNG_COPY
argument_list|(
name|pLOOP
operator|->
name|pSignals
argument_list|,
name|pRawdata
operator|+
literal|14
argument_list|,
name|pLOOP
operator|->
name|iCount
operator|<<
literal|2
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* !MNG_BIGENDIAN_SUPPORTED */
block|}
block|}
endif|#
directive|endif
block|}
block|}
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_loop
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|bCacheplayback
condition|)
comment|/* must store playback info to work!! */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_LOOPWITHCACHEOFF
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
name|mng_retcode
name|iRetcode
decl_stmt|;
name|pData
operator|->
name|bHasLOOP
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we're inside a loop */
comment|/* create the LOOP ani-object */
name|iRetcode
operator|=
name|mng_create_ani_loop
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
comment|/* skip till matching ENDL if iteration=0 */
if|if
condition|(
operator|(
operator|!
name|pData
operator|->
name|bSkipping
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_loopp
operator|)
name|pChunk
operator|)
operator|->
name|iRepeat
operator|==
literal|0
operator|)
condition|)
name|pData
operator|->
name|bSkipping
operator|=
name|MNG_TRUE
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_LOOP
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_endl
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
if|if
condition|(
name|pData
operator|->
name|bHasLOOP
condition|)
comment|/* are we really processing a loop ? */
block|{
name|mng_uint8
name|iLevel
init|=
operator|(
operator|(
name|mng_endlp
operator|)
name|pChunk
operator|)
operator|->
name|iLevel
decl_stmt|;
comment|/* create an ENDL animation object */
return|return
name|mng_create_ani_endl
argument_list|(
name|pData
argument_list|,
name|iLevel
argument_list|)
return|;
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_NOMATCHINGLOOP
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DEFI
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_defi
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
name|mng_retcode
name|iRetcode
decl_stmt|;
name|pData
operator|->
name|iDEFIobjectid
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iObjectid
expr_stmt|;
name|pData
operator|->
name|bDEFIhasdonotshow
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|bHasdonotshow
expr_stmt|;
name|pData
operator|->
name|iDEFIdonotshow
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iDonotshow
expr_stmt|;
name|pData
operator|->
name|bDEFIhasconcrete
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|bHasconcrete
expr_stmt|;
name|pData
operator|->
name|iDEFIconcrete
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iConcrete
expr_stmt|;
name|pData
operator|->
name|bDEFIhasloca
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|bHasloca
expr_stmt|;
name|pData
operator|->
name|iDEFIlocax
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iXlocation
expr_stmt|;
name|pData
operator|->
name|iDEFIlocay
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iYlocation
expr_stmt|;
name|pData
operator|->
name|bDEFIhasclip
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|bHasclip
expr_stmt|;
name|pData
operator|->
name|iDEFIclipl
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iLeftcb
expr_stmt|;
name|pData
operator|->
name|iDEFIclipr
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iRightcb
expr_stmt|;
name|pData
operator|->
name|iDEFIclipt
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iTopcb
expr_stmt|;
name|pData
operator|->
name|iDEFIclipb
operator|=
operator|(
operator|(
name|mng_defip
operator|)
name|pChunk
operator|)
operator|->
name|iBottomcb
expr_stmt|;
comment|/* create an animation object */
name|iRetcode
operator|=
name|mng_create_ani_defi
argument_list|(
name|pData
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|iRetcode
condition|)
comment|/* do display processing */
name|iRetcode
operator|=
name|mng_process_display_defi
argument_list|(
name|pData
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
else|#
directive|else
return|return
name|MNG_NOERROR
return|;
comment|/* done */
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BASI
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_basi
argument_list|)
end_macro
begin_block
block|{
name|pData
operator|->
name|bHasBASI
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* inside a BASI-IEND block now */
comment|/* store interesting fields */
name|pData
operator|->
name|iDatawidth
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iWidth
expr_stmt|;
name|pData
operator|->
name|iDataheight
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iHeight
expr_stmt|;
name|pData
operator|->
name|iBitdepth
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iBitdepth
expr_stmt|;
name|pData
operator|->
name|iColortype
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
expr_stmt|;
name|pData
operator|->
name|iCompression
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iCompression
expr_stmt|;
name|pData
operator|->
name|iFilter
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iFilter
expr_stmt|;
name|pData
operator|->
name|iInterlace
operator|=
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iInterlace
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_NO_1_2_4BIT_SUPPORT
argument_list|)
operator|||
name|defined
argument_list|(
name|MNG_NO_16BIT_SUPPORT
argument_list|)
name|pData
operator|->
name|iPNGmult
operator|=
literal|1
expr_stmt|;
name|pData
operator|->
name|iPNGdepth
operator|=
name|pData
operator|->
name|iBitdepth
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_1_2_4BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|<
literal|8
condition|)
name|pData
operator|->
name|iBitdepth
operator|=
literal|8
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|>
literal|8
condition|)
block|{
name|pData
operator|->
name|iBitdepth
operator|=
literal|8
expr_stmt|;
name|pData
operator|->
name|iPNGmult
operator|=
literal|2
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|8
operator|)
comment|/* parameter validity checks */
ifndef|#
directive|ifndef
name|MNG_NO_1_2_4BIT_SUPPORT
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|1
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|2
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|4
operator|)
endif|#
directive|endif
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|!=
literal|16
operator|)
endif|#
directive|endif
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAY
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGB
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_INDEXED
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAYA
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGBA
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOLORTYPE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_INDEXED
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|>
literal|8
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_RGB
operator|)
operator|||
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_GRAYA
operator|)
operator|||
operator|(
name|pData
operator|->
name|iColortype
operator|==
name|MNG_COLORTYPE_RGBA
operator|)
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iBitdepth
operator|<
literal|8
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDBITDEPTH
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|FILTER192
argument_list|)
operator|||
name|defined
argument_list|(
name|FILTER193
argument_list|)
if|if
condition|(
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_ADAPTIVE
operator|)
operator|&&
if|#
directive|if
name|defined
argument_list|(
name|FILTER192
argument_list|)
operator|&&
name|defined
argument_list|(
name|FILTER193
argument_list|)
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_DIFFERING
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_NOFILTER
operator|)
condition|)
else|#
directive|else
ifdef|#
directive|ifdef
name|FILTER192
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_DIFFERING
operator|)
block|)
end_block
begin_else
else|#
directive|else
end_else
begin_expr_stmt
operator|(
name|pData
operator|->
name|iFilter
operator|!=
name|MNG_FILTER_NOFILTER
operator|)
end_expr_stmt
begin_endif
unit|)
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_expr_stmt
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_if
if|if
condition|(
name|pData
operator|->
name|iFilter
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDFILTER
argument_list|)
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_expr_stmt
name|pData
operator|->
name|iImagelevel
operator|++
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* one level deeper */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_block
block|{
comment|/* create an animation object */
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_basi
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
end_ifdef
begin_if
if|if
condition|(
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iBitdepth
operator|>
literal|8
condition|)
operator|(
operator|(
name|mng_basip
operator|)
name|pChunk
operator|)
operator|->
name|iBitdepth
operator|=
literal|8
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLON
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_clon
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_clon
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_PAST
end_ifndef
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_debunk_past
operator|)
block|{
name|mng_pastp
name|pPAST
operator|=
operator|(
name|mng_pastp
operator|)
name|pChunk
block|;
name|mng_uint32
name|iRawlen
operator|=
operator|*
name|piRawlen
block|;
name|mng_uint8p
name|pRawdata
operator|=
operator|*
name|ppRawdata
block|;
name|mng_uint32
name|iSize
block|;
name|mng_uint32
name|iX
block|;
name|mng_past_sourcep
name|pSource
block|;
comment|/* check the length */
if|if
condition|(
operator|(
name|iRawlen
operator|<
literal|41
operator|)
operator|||
operator|(
operator|(
operator|(
name|iRawlen
operator|-
literal|11
operator|)
operator|%
literal|30
operator|)
operator|!=
literal|0
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pPAST
operator|->
name|iDestid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pPAST
operator|->
name|iTargettype
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|2
operator|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pPAST
operator|->
name|iTargetx
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|3
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pPAST
operator|->
name|iTargety
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|7
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pPAST
operator|->
name|iCount
operator|=
operator|(
operator|(
name|iRawlen
operator|-
literal|11
operator|)
operator|/
literal|30
operator|)
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* how many entries again? */
end_comment
begin_expr_stmt
name|iSize
operator|=
name|pPAST
operator|->
name|iCount
operator|*
sizeof|sizeof
argument_list|(
name|mng_past_source
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pRawdata
operator|+=
literal|11
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* get a buffer for all the source blocks */
end_comment
begin_expr_stmt
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pPAST
operator|->
name|pSources
argument_list|,
name|iSize
argument_list|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pSource
operator|=
call|(
name|mng_past_sourcep
call|)
argument_list|(
name|pPAST
operator|->
name|pSources
argument_list|)
expr_stmt|;
end_expr_stmt
begin_for
for|for
control|(
name|iX
operator|=
name|pPAST
operator|->
name|iCount
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
block|{
comment|/* now copy the source blocks */
name|pSource
operator|->
name|iSourceid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pSource
operator|->
name|iComposition
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|2
operator|)
expr_stmt|;
name|pSource
operator|->
name|iOrientation
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|3
operator|)
expr_stmt|;
name|pSource
operator|->
name|iOffsettype
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|4
operator|)
expr_stmt|;
name|pSource
operator|->
name|iOffsetx
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|5
argument_list|)
expr_stmt|;
name|pSource
operator|->
name|iOffsety
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|9
argument_list|)
expr_stmt|;
name|pSource
operator|->
name|iBoundarytype
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|13
operator|)
expr_stmt|;
name|pSource
operator|->
name|iBoundaryl
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|14
argument_list|)
expr_stmt|;
name|pSource
operator|->
name|iBoundaryr
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|18
argument_list|)
expr_stmt|;
name|pSource
operator|->
name|iBoundaryt
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|22
argument_list|)
expr_stmt|;
name|pSource
operator|->
name|iBoundaryb
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|26
argument_list|)
expr_stmt|;
name|pSource
operator|++
expr_stmt|;
name|pRawdata
operator|+=
literal|30
expr_stmt|;
block|}
end_for
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_PAST
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_past
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_past
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DISC
end_ifndef
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_disc_entries
operator|)
block|{
name|mng_discp
name|pDISC
operator|=
operator|(
name|mng_discp
operator|)
name|pChunk
block|;
name|mng_uint32
name|iRawlen
operator|=
operator|*
name|piRawlen
block|;
name|mng_uint8p
name|pRawdata
operator|=
operator|*
name|ppRawdata
block|;
if|if
condition|(
operator|(
name|iRawlen
operator|%
literal|2
operator|)
operator|!=
literal|0
condition|)
comment|/* check the length */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pDISC
operator|->
name|iCount
operator|=
operator|(
name|iRawlen
operator|/
sizeof|sizeof
argument_list|(
name|mng_uint16
argument_list|)
operator|)
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
name|pDISC
operator|->
name|iCount
condition|)
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pDISC
operator|->
name|pObjectids
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_BIGENDIAN_SUPPORTED
block|{
name|mng_uint32
name|iX
decl_stmt|;
name|mng_uint8p
name|pIn
init|=
name|pRawdata
decl_stmt|;
name|mng_uint16p
name|pOut
init|=
name|pDISC
operator|->
name|pObjectids
decl_stmt|;
for|for
control|(
name|iX
operator|=
name|pDISC
operator|->
name|iCount
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
block|{
operator|*
name|pOut
operator|++
operator|=
name|mng_get_uint16
argument_list|(
name|pIn
argument_list|)
expr_stmt|;
name|pIn
operator|+=
literal|2
expr_stmt|;
block|}
block|}
else|#
directive|else
name|MNG_COPY
argument_list|(
name|pDISC
operator|->
name|pObjectids
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* !MNG_BIGENDIAN_SUPPORTED */
block|}
end_if
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DISC
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_disc
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_disc
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_BACK
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_back
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
comment|/* retrieve the fields */
name|pData
operator|->
name|bHasBACK
operator|=
name|MNG_TRUE
block|;
name|pData
operator|->
name|iBACKred
operator|=
operator|(
operator|(
name|mng_backp
operator|)
name|pChunk
operator|)
operator|->
name|iRed
block|;
name|pData
operator|->
name|iBACKgreen
operator|=
operator|(
operator|(
name|mng_backp
operator|)
name|pChunk
operator|)
operator|->
name|iGreen
block|;
name|pData
operator|->
name|iBACKblue
operator|=
operator|(
operator|(
name|mng_backp
operator|)
name|pChunk
operator|)
operator|->
name|iBlue
block|;
name|pData
operator|->
name|iBACKmandatory
operator|=
operator|(
operator|(
name|mng_backp
operator|)
name|pChunk
operator|)
operator|->
name|iMandatory
block|;
name|pData
operator|->
name|iBACKimageid
operator|=
operator|(
operator|(
name|mng_backp
operator|)
name|pChunk
operator|)
operator|->
name|iImageid
block|;
name|pData
operator|->
name|iBACKtile
operator|=
operator|(
operator|(
name|mng_backp
operator|)
name|pChunk
operator|)
operator|->
name|iTile
block|;
return|return
name|mng_create_ani_back
argument_list|(
name|pData
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_FRAM
end_ifndef
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_fram_remainder
operator|)
block|{
name|mng_framp
name|pFRAM
operator|=
operator|(
name|mng_framp
operator|)
name|pChunk
block|;
name|mng_uint32
name|iRawlen
operator|=
operator|*
name|piRawlen
block|;
name|mng_uint8p
name|pRawdata
operator|=
operator|*
name|ppRawdata
block|;
name|mng_uint32
name|iRequired
operator|=
literal|0
block|;
if|if
condition|(
name|iRawlen
operator|<
literal|4
condition|)
comment|/* must have at least 4 bytes */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|iRequired
operator|=
literal|4
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* calculate and check required remaining length */
end_comment
begin_expr_stmt
name|pFRAM
operator|->
name|iChangedelay
operator|=
operator|*
name|pRawdata
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pFRAM
operator|->
name|iChangetimeout
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|1
operator|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pFRAM
operator|->
name|iChangeclipping
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|2
operator|)
expr_stmt|;
end_expr_stmt
begin_expr_stmt
name|pFRAM
operator|->
name|iChangesyncid
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|3
operator|)
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangedelay
condition|)
block|{
name|iRequired
operator|+=
literal|4
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangetimeout
condition|)
block|{
name|iRequired
operator|+=
literal|4
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangeclipping
condition|)
block|{
name|iRequired
operator|+=
literal|17
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangesyncid
condition|)
block|{
if|if
condition|(
operator|(
name|iRawlen
operator|-
name|iRequired
operator|)
operator|%
literal|4
operator|!=
literal|0
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|iRawlen
operator|!=
name|iRequired
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
block|}
end_if
begin_expr_stmt
name|pRawdata
operator|+=
literal|4
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangedelay
condition|)
comment|/* delay changed ? */
block|{
name|pFRAM
operator|->
name|iDelay
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|4
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangetimeout
condition|)
comment|/* timeout changed ? */
block|{
name|pFRAM
operator|->
name|iTimeout
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|4
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangeclipping
condition|)
comment|/* clipping changed ? */
block|{
name|pFRAM
operator|->
name|iBoundarytype
operator|=
operator|*
name|pRawdata
expr_stmt|;
name|pFRAM
operator|->
name|iBoundaryl
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|1
argument_list|)
expr_stmt|;
name|pFRAM
operator|->
name|iBoundaryr
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|5
argument_list|)
expr_stmt|;
name|pFRAM
operator|->
name|iBoundaryt
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|9
argument_list|)
expr_stmt|;
name|pFRAM
operator|->
name|iBoundaryb
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|13
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|17
expr_stmt|;
block|}
end_if
begin_if
if|if
condition|(
name|pFRAM
operator|->
name|iChangesyncid
condition|)
block|{
name|pFRAM
operator|->
name|iCount
operator|=
operator|(
name|iRawlen
operator|-
name|iRequired
operator|)
operator|/
literal|4
expr_stmt|;
if|if
condition|(
name|pFRAM
operator|->
name|iCount
condition|)
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pFRAM
operator|->
name|pSyncids
argument_list|,
name|pFRAM
operator|->
name|iCount
operator|*
literal|4
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|MNG_BIGENDIAN_SUPPORTED
block|{
name|mng_uint32
name|iX
decl_stmt|;
name|mng_uint32p
name|pOut
init|=
name|pFRAM
operator|->
name|pSyncids
decl_stmt|;
for|for
control|(
name|iX
operator|=
name|pFRAM
operator|->
name|iCount
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
block|{
operator|*
name|pOut
operator|++
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|4
expr_stmt|;
block|}
block|}
else|#
directive|else
name|MNG_COPY
argument_list|(
name|pFRAM
operator|->
name|pSyncids
argument_list|,
name|pRawdata
argument_list|,
name|pFRAM
operator|->
name|iCount
operator|*
literal|4
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* !MNG_BIGENDIAN_SUPPORTED */
block|}
block|}
end_if
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_OLD_VERSIONS
end_ifndef
begin_if
if|if
condition|(
name|pData
operator|->
name|bPreDraft48
condition|)
comment|/* old style input-stream ? */
block|{
switch|switch
condition|(
name|pFRAM
operator|->
name|iMode
condition|)
comment|/* fix the framing mode then */
block|{
case|case
literal|0
case|:
block|{
break|break;
block|}
case|case
literal|1
case|:
block|{
name|pFRAM
operator|->
name|iMode
operator|=
literal|3
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
block|{
name|pFRAM
operator|->
name|iMode
operator|=
literal|4
expr_stmt|;
break|break;
block|}
case|case
literal|3
case|:
block|{
name|pFRAM
operator|->
name|iMode
operator|=
literal|1
expr_stmt|;
break|break;
block|}
case|case
literal|4
case|:
block|{
name|pFRAM
operator|->
name|iMode
operator|=
literal|1
expr_stmt|;
break|break;
block|}
case|case
literal|5
case|:
block|{
name|pFRAM
operator|->
name|iMode
operator|=
literal|2
expr_stmt|;
break|break;
block|}
default|default:
block|{
name|pFRAM
operator|->
name|iMode
operator|=
literal|1
expr_stmt|;
break|break;
block|}
block|}
block|}
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_FRAM
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_fram
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_fram
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MOVE
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_move
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_move
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_CLIP
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_clip
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_clip
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
end_expr_stmt
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SHOW
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_show
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
name|mng_retcode
name|iRetcode
block|;
if|if
condition|(
operator|!
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|bEmpty
condition|)
comment|/* any data ? */
block|{
if|if
condition|(
operator|!
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|bHaslastid
condition|)
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|iLastid
operator|=
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|iFirstid
expr_stmt|;
name|pData
operator|->
name|iSHOWfromid
operator|=
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|iFirstid
expr_stmt|;
name|pData
operator|->
name|iSHOWtoid
operator|=
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|iLastid
expr_stmt|;
name|pData
operator|->
name|iSHOWmode
operator|=
operator|(
operator|(
name|mng_showp
operator|)
name|pChunk
operator|)
operator|->
name|iMode
expr_stmt|;
block|}
end_expr_stmt
begin_else
else|else
comment|/* use defaults then */
block|{
name|pData
operator|->
name|iSHOWfromid
operator|=
literal|1
expr_stmt|;
name|pData
operator|->
name|iSHOWtoid
operator|=
literal|65535
expr_stmt|;
name|pData
operator|->
name|iSHOWmode
operator|=
literal|2
expr_stmt|;
block|}
end_else
begin_comment
comment|/* create a SHOW animation object */
end_comment
begin_expr_stmt
name|iRetcode
operator|=
name|mng_create_ani_show
argument_list|(
name|pData
argument_list|)
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
operator|!
name|iRetcode
condition|)
comment|/* go and do it! */
name|iRetcode
operator|=
name|mng_process_display_show
argument_list|(
name|pData
argument_list|)
expr_stmt|;
end_if
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|iRetcode
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_TERM
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_term
operator|)
block|{
comment|/* should be behind MHDR or SAVE !! */
if|if
condition|(
operator|(
operator|!
name|pData
operator|->
name|bHasSAVE
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iChunkseq
operator|>
literal|2
operator|)
condition|)
block|{
name|pData
operator|->
name|bMisplacedTERM
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* indicate we found a misplaced TERM */
comment|/* and send a warning signal!!! */
name|MNG_WARNING
argument_list|(
name|pData
argument_list|,
name|MNG_SEQUENCEERROR
argument_list|)
expr_stmt|;
block|}
name|pData
operator|->
name|bHasTERM
operator|=
name|MNG_TRUE
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
name|pData
operator|->
name|fProcessterm
condition|)
comment|/* inform the app ? */
if|if
condition|(
operator|!
name|pData
operator|->
name|fProcessterm
argument_list|(
operator|(
operator|(
name|mng_handle
operator|)
name|pData
operator|)
argument_list|,
operator|(
operator|(
name|mng_termp
operator|)
name|pChunk
operator|)
operator|->
name|iTermaction
argument_list|,
operator|(
operator|(
name|mng_termp
operator|)
name|pChunk
operator|)
operator|->
name|iIteraction
argument_list|,
operator|(
operator|(
name|mng_termp
operator|)
name|pChunk
operator|)
operator|->
name|iDelay
argument_list|,
operator|(
operator|(
name|mng_termp
operator|)
name|pChunk
operator|)
operator|->
name|iItermax
argument_list|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
end_if
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_block
block|{
comment|/* create the TERM ani-object */
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_term
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
comment|/* save for future reference */
name|pData
operator|->
name|pTermaniobj
operator|=
name|pData
operator|->
name|pLastaniobj
expr_stmt|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SAVE
end_ifndef
begin_expr_stmt
unit|MNG_F_SPECIALFUNC
DECL|function|MNG_F_SPECIALFUNC
operator|(
name|mng_save_entries
operator|)
block|{
name|mng_savep
name|pSAVE
operator|=
operator|(
name|mng_savep
operator|)
name|pChunk
block|;
name|mng_uint32
name|iRawlen
operator|=
operator|*
name|piRawlen
block|;
name|mng_uint8p
name|pRawdata
operator|=
operator|*
name|ppRawdata
block|;
name|mng_save_entryp
name|pEntry
operator|=
name|MNG_NULL
block|;
name|mng_uint32
name|iCount
operator|=
literal|0
block|;
name|mng_uint8
name|iOtype
operator|=
operator|*
name|pRawdata
block|;
name|mng_uint8
name|iEtype
block|;
name|mng_uint8p
name|pTemp
block|;
name|mng_uint8p
name|pNull
block|;
name|mng_uint32
name|iLen
block|;
name|mng_uint32
name|iOffset
index|[
literal|2
index|]
block|;
name|mng_uint32
name|iStarttime
index|[
literal|2
index|]
block|;
name|mng_uint32
name|iFramenr
block|;
name|mng_uint32
name|iLayernr
block|;
name|mng_uint32
name|iX
block|;
name|mng_uint32
name|iNamesize
block|;
if|if
condition|(
operator|(
name|iOtype
operator|!=
literal|4
operator|)
operator|&&
operator|(
name|iOtype
operator|!=
literal|8
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVOFFSETSIZE
argument_list|)
expr_stmt|;
name|pSAVE
operator|->
name|iOffsettype
operator|=
name|iOtype
expr_stmt|;
end_expr_stmt
begin_for
for|for
control|(
name|iX
operator|=
literal|0
init|;
name|iX
operator|<
literal|2
condition|;
name|iX
operator|++
control|)
comment|/* do this twice to get the count first ! */
block|{
name|pTemp
operator|=
name|pRawdata
operator|+
literal|1
expr_stmt|;
name|iLen
operator|=
name|iRawlen
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|iX
condition|)
comment|/* second run ? */
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pEntry
argument_list|,
operator|(
name|iCount
operator|*
sizeof|sizeof
argument_list|(
name|mng_save_entry
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|pSAVE
operator|->
name|iCount
operator|=
name|iCount
expr_stmt|;
name|pSAVE
operator|->
name|pEntries
operator|=
name|pEntry
expr_stmt|;
block|}
while|while
condition|(
name|iLen
condition|)
comment|/* anything left ? */
block|{
name|iEtype
operator|=
operator|*
name|pTemp
expr_stmt|;
comment|/* entrytype */
if|if
condition|(
operator|(
name|iEtype
operator|!=
literal|0
operator|)
operator|&&
operator|(
name|iEtype
operator|!=
literal|1
operator|)
operator|&&
operator|(
name|iEtype
operator|!=
literal|2
operator|)
operator|&&
operator|(
name|iEtype
operator|!=
literal|3
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVENTRYTYPE
argument_list|)
expr_stmt|;
name|pTemp
operator|++
expr_stmt|;
if|if
condition|(
name|iEtype
operator|>
literal|1
condition|)
block|{
name|iOffset
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|iOffset
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
name|iStarttime
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|iStarttime
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
name|iLayernr
operator|=
literal|0
expr_stmt|;
name|iFramenr
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|iOtype
operator|==
literal|4
condition|)
block|{
name|iOffset
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|iOffset
index|[
literal|1
index|]
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
argument_list|)
expr_stmt|;
name|pTemp
operator|+=
literal|4
expr_stmt|;
block|}
else|else
block|{
name|iOffset
index|[
literal|0
index|]
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
argument_list|)
expr_stmt|;
name|iOffset
index|[
literal|1
index|]
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|4
argument_list|)
expr_stmt|;
name|pTemp
operator|+=
literal|8
expr_stmt|;
block|}
if|if
condition|(
name|iEtype
operator|>
literal|0
condition|)
block|{
name|iStarttime
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|iStarttime
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
name|iLayernr
operator|=
literal|0
expr_stmt|;
name|iFramenr
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|iOtype
operator|==
literal|4
condition|)
block|{
name|iStarttime
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|iStarttime
index|[
literal|1
index|]
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|0
argument_list|)
expr_stmt|;
name|iLayernr
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|4
argument_list|)
expr_stmt|;
name|iFramenr
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|8
argument_list|)
expr_stmt|;
name|pTemp
operator|+=
literal|12
expr_stmt|;
block|}
else|else
block|{
name|iStarttime
index|[
literal|0
index|]
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|0
argument_list|)
expr_stmt|;
name|iStarttime
index|[
literal|1
index|]
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|4
argument_list|)
expr_stmt|;
name|iLayernr
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|8
argument_list|)
expr_stmt|;
name|iFramenr
operator|=
name|mng_get_uint32
argument_list|(
name|pTemp
operator|+
literal|12
argument_list|)
expr_stmt|;
name|pTemp
operator|+=
literal|16
expr_stmt|;
block|}
block|}
block|}
name|pNull
operator|=
name|pTemp
expr_stmt|;
comment|/* get the name length */
while|while
condition|(
operator|*
name|pNull
condition|)
name|pNull
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|pNull
operator|-
name|pRawdata
operator|)
operator|>
operator|(
name|mng_int32
operator|)
name|iRawlen
condition|)
block|{
name|iNamesize
operator|=
name|iLen
expr_stmt|;
comment|/* no null found; so end of SAVE */
name|iLen
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|iNamesize
operator|=
name|pNull
operator|-
name|pTemp
expr_stmt|;
comment|/* should be another entry */
name|iLen
operator|-=
name|iNamesize
expr_stmt|;
if|if
condition|(
operator|!
name|iLen
condition|)
comment|/* must not end with a null ! */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_ENDWITHNULL
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|pEntry
condition|)
block|{
name|iCount
operator|++
expr_stmt|;
block|}
else|else
block|{
name|pEntry
operator|->
name|iEntrytype
operator|=
name|iEtype
expr_stmt|;
name|pEntry
operator|->
name|iOffset
index|[
literal|0
index|]
operator|=
name|iOffset
index|[
literal|0
index|]
expr_stmt|;
name|pEntry
operator|->
name|iOffset
index|[
literal|1
index|]
operator|=
name|iOffset
index|[
literal|1
index|]
expr_stmt|;
name|pEntry
operator|->
name|iStarttime
index|[
literal|0
index|]
operator|=
name|iStarttime
index|[
literal|0
index|]
expr_stmt|;
name|pEntry
operator|->
name|iStarttime
index|[
literal|1
index|]
operator|=
name|iStarttime
index|[
literal|1
index|]
expr_stmt|;
name|pEntry
operator|->
name|iLayernr
operator|=
name|iLayernr
expr_stmt|;
name|pEntry
operator|->
name|iFramenr
operator|=
name|iFramenr
expr_stmt|;
name|pEntry
operator|->
name|iNamesize
operator|=
name|iNamesize
expr_stmt|;
if|if
condition|(
name|iNamesize
condition|)
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pEntry
operator|->
name|zName
argument_list|,
name|iNamesize
operator|+
literal|1
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pEntry
operator|->
name|zName
argument_list|,
name|pTemp
argument_list|,
name|iNamesize
argument_list|)
expr_stmt|;
block|}
name|pEntry
operator|++
expr_stmt|;
block|}
name|pTemp
operator|+=
name|iNamesize
expr_stmt|;
block|}
block|}
end_for
begin_expr_stmt
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
end_expr_stmt
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SAVE
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_save
operator|)
block|{
name|pData
operator|->
name|bHasSAVE
operator|=
name|MNG_TRUE
block|;
if|if
condition|(
name|pData
operator|->
name|fProcesssave
condition|)
comment|/* inform the application ? */
block|{
name|mng_bool
name|bOke
init|=
name|pData
operator|->
name|fProcesssave
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
name|mng_retcode
name|iRetcode
block|;
comment|/* TODO: something with the parameters */
comment|/* create a SAVE animation object */
name|iRetcode
operator|=
name|mng_create_ani_save
argument_list|(
name|pData
argument_list|)
block|;
if|if
condition|(
operator|!
name|iRetcode
condition|)
comment|/* process it */
name|iRetcode
operator|=
name|mng_process_display_save
argument_list|(
name|pData
argument_list|)
expr_stmt|;
end_expr_stmt
begin_if
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
end_if
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_expr_stmt
unit|return
name|MNG_NOERROR
expr_stmt|;
end_expr_stmt
begin_comment
comment|/* done */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_SEEK
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_seek
operator|)
block|{
name|mng_retcode
name|iRetcode
block|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
comment|/* create a SEEK animation object */
name|iRetcode
operator|=
name|mng_create_ani_seek
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
block|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
end_expr_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_if
if|if
condition|(
name|pData
operator|->
name|fProcessseek
condition|)
comment|/* inform the app ? */
if|if
condition|(
operator|!
name|pData
operator|->
name|fProcessseek
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|,
operator|(
operator|(
name|mng_seekp
operator|)
name|pChunk
operator|)
operator|->
name|zName
argument_list|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
end_if
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
end_ifdef
begin_return
return|return
name|mng_process_display_seek
argument_list|(
name|pData
argument_list|)
return|;
end_return
begin_else
else|#
directive|else
end_else
begin_return
return|return
name|MNG_NOERROR
return|;
end_return
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_SUPPORT_DISPLAY */
end_comment
begin_endif
unit|}
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_eXPI
end_ifndef
begin_expr_stmt
unit|MNG_C_SPECIALFUNC
DECL|function|MNG_C_SPECIALFUNC
operator|(
name|mng_special_expi
operator|)
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_expr_stmt
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_fPRI
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_fpri
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_nEED
end_ifndef
begin_function
DECL|function|CheckKeyword
name|MNG_LOCAL
name|mng_bool
name|CheckKeyword
parameter_list|(
name|mng_datap
name|pData
parameter_list|,
name|mng_uint8p
name|pKeyword
parameter_list|)
block|{
name|mng_chunkid
name|handled_chunks
index|[]
init|=
block|{
name|MNG_UINT_BACK
block|,
comment|/* keep it sorted !!!! */
name|MNG_UINT_BASI
block|,
name|MNG_UINT_CLIP
block|,
name|MNG_UINT_CLON
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
comment|/* TODO:    MNG_UINT_DBYK,  */
endif|#
directive|endif
name|MNG_UINT_DEFI
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
name|MNG_UINT_DHDR
block|,
endif|#
directive|endif
name|MNG_UINT_DISC
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
comment|/* TODO:    MNG_UINT_DROP,  */
endif|#
directive|endif
name|MNG_UINT_ENDL
block|,
name|MNG_UINT_FRAM
block|,
name|MNG_UINT_IDAT
block|,
name|MNG_UINT_IEND
block|,
name|MNG_UINT_IHDR
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
name|MNG_UINT_IJNG
block|,
endif|#
directive|endif
name|MNG_UINT_IPNG
block|,
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
name|MNG_UINT_JDAA
block|,
name|MNG_UINT_JDAT
block|,
name|MNG_UINT_JHDR
block|,
comment|/* TODO:    MNG_UINT_JSEP,  */
name|MNG_UINT_JdAA
block|,
endif|#
directive|endif
name|MNG_UINT_LOOP
block|,
name|MNG_UINT_MAGN
block|,
name|MNG_UINT_MEND
block|,
name|MNG_UINT_MHDR
block|,
name|MNG_UINT_MOVE
block|,
comment|/* TODO:    MNG_UINT_ORDR,  */
name|MNG_UINT_PAST
block|,
name|MNG_UINT_PLTE
block|,
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
name|MNG_UINT_PPLT
block|,
name|MNG_UINT_PROM
block|,
endif|#
directive|endif
name|MNG_UINT_SAVE
block|,
name|MNG_UINT_SEEK
block|,
name|MNG_UINT_SHOW
block|,
name|MNG_UINT_TERM
block|,
name|MNG_UINT_bKGD
block|,
name|MNG_UINT_cHRM
block|,
comment|/* TODO:    MNG_UINT_eXPI,  */
name|MNG_UINT_evNT
block|,
comment|/* TODO:    MNG_UINT_fPRI,  */
name|MNG_UINT_gAMA
block|,
comment|/* TODO:    MNG_UINT_hIST,  */
name|MNG_UINT_iCCP
block|,
name|MNG_UINT_iTXt
block|,
name|MNG_UINT_nEED
block|,
comment|/* TODO:    MNG_UINT_oFFs,  */
comment|/* TODO:    MNG_UINT_pCAL,  */
comment|/* TODO:    MNG_UINT_pHYg,  */
comment|/* TODO:    MNG_UINT_pHYs,  */
comment|/* TODO:    MNG_UINT_sBIT,  */
comment|/* TODO:    MNG_UINT_sCAL,  */
comment|/* TODO:    MNG_UINT_sPLT,  */
name|MNG_UINT_sRGB
block|,
name|MNG_UINT_tEXt
block|,
name|MNG_UINT_tIME
block|,
name|MNG_UINT_tRNS
block|,
name|MNG_UINT_zTXt
block|,   }
decl_stmt|;
name|mng_bool
name|bOke
init|=
name|MNG_FALSE
decl_stmt|;
if|if
condition|(
name|pData
operator|->
name|fProcessneed
condition|)
comment|/* does the app handle it ? */
name|bOke
operator|=
name|pData
operator|->
name|fProcessneed
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|,
operator|(
name|mng_pchar
operator|)
name|pKeyword
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
block|{
comment|/* find the keyword length */
name|mng_uint8p
name|pNull
init|=
name|pKeyword
decl_stmt|;
while|while
condition|(
operator|*
name|pNull
condition|)
name|pNull
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|pNull
operator|-
name|pKeyword
operator|)
operator|==
literal|4
condition|)
comment|/* test a chunk ? */
block|{
comment|/* get the chunk-id */
name|mng_chunkid
name|iChunkid
init|=
operator|(
operator|*
name|pKeyword
operator|<<
literal|24
operator|)
operator|+
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|1
operator|)
operator|<<
literal|16
operator|)
operator|+
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|2
operator|)
operator|<<
literal|8
operator|)
operator|+
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|3
operator|)
operator|)
decl_stmt|;
comment|/* binary search variables */
name|mng_int32
name|iTop
decl_stmt|,
name|iLower
decl_stmt|,
name|iUpper
decl_stmt|,
name|iMiddle
decl_stmt|;
comment|/* determine max index of table */
name|iTop
operator|=
operator|(
sizeof|sizeof
argument_list|(
name|handled_chunks
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|handled_chunks
index|[
literal|0
index|]
argument_list|)
operator|)
operator|-
literal|1
expr_stmt|;
comment|/* binary search; with 52 chunks, worst-case is 7 comparisons */
name|iLower
operator|=
literal|0
expr_stmt|;
name|iMiddle
operator|=
name|iTop
operator|>>
literal|1
expr_stmt|;
name|iUpper
operator|=
name|iTop
expr_stmt|;
do|do
comment|/* the binary search itself */
block|{
if|if
condition|(
name|handled_chunks
index|[
name|iMiddle
index|]
operator|<
name|iChunkid
condition|)
name|iLower
operator|=
name|iMiddle
operator|+
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|handled_chunks
index|[
name|iMiddle
index|]
operator|>
name|iChunkid
condition|)
name|iUpper
operator|=
name|iMiddle
operator|-
literal|1
expr_stmt|;
else|else
block|{
name|bOke
operator|=
name|MNG_TRUE
expr_stmt|;
break|break;
block|}
name|iMiddle
operator|=
operator|(
name|iLower
operator|+
name|iUpper
operator|)
operator|>>
literal|1
expr_stmt|;
block|}
do|while
condition|(
name|iLower
operator|<=
name|iUpper
condition|)
do|;
block|}
comment|/* test draft ? */
if|if
condition|(
operator|(
operator|!
name|bOke
operator|)
operator|&&
operator|(
operator|(
name|pNull
operator|-
name|pKeyword
operator|)
operator|==
literal|8
operator|)
operator|&&
operator|(
operator|*
name|pKeyword
operator|==
literal|'d'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|1
operator|)
operator|==
literal|'r'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|2
operator|)
operator|==
literal|'a'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|3
operator|)
operator|==
literal|'f'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|4
operator|)
operator|==
literal|'t'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|5
operator|)
operator|==
literal|' '
operator|)
condition|)
block|{
name|mng_uint32
name|iDraft
decl_stmt|;
name|iDraft
operator|=
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|6
operator|)
operator|-
literal|'0'
operator|)
operator|*
literal|10
operator|+
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|7
operator|)
operator|-
literal|'0'
operator|)
expr_stmt|;
name|bOke
operator|=
call|(
name|mng_bool
call|)
argument_list|(
name|iDraft
operator|<=
name|MNG_MNG_DRAFT
argument_list|)
expr_stmt|;
block|}
comment|/* test MNG 1.0/1.1 ? */
if|if
condition|(
operator|(
operator|!
name|bOke
operator|)
operator|&&
operator|(
operator|(
name|pNull
operator|-
name|pKeyword
operator|)
operator|==
literal|7
operator|)
operator|&&
operator|(
operator|*
name|pKeyword
operator|==
literal|'M'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|1
operator|)
operator|==
literal|'N'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|2
operator|)
operator|==
literal|'G'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|3
operator|)
operator|==
literal|'-'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|4
operator|)
operator|==
literal|'1'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|5
operator|)
operator|==
literal|'.'
operator|)
operator|&&
operator|(
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|6
operator|)
operator|==
literal|'0'
operator|)
operator|||
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|6
operator|)
operator|==
literal|'1'
operator|)
operator|)
condition|)
name|bOke
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* test CACHEOFF ? */
if|if
condition|(
operator|(
operator|!
name|bOke
operator|)
operator|&&
operator|(
operator|(
name|pNull
operator|-
name|pKeyword
operator|)
operator|==
literal|8
operator|)
operator|&&
operator|(
operator|*
name|pKeyword
operator|==
literal|'C'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|1
operator|)
operator|==
literal|'A'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|2
operator|)
operator|==
literal|'C'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|3
operator|)
operator|==
literal|'H'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|4
operator|)
operator|==
literal|'E'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|5
operator|)
operator|==
literal|'O'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|6
operator|)
operator|==
literal|'F'
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pKeyword
operator|+
literal|7
operator|)
operator|==
literal|'F'
operator|)
condition|)
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|pFirstaniobj
condition|)
comment|/* only if caching hasn't started yet ! */
block|{
name|bOke
operator|=
name|MNG_TRUE
expr_stmt|;
name|pData
operator|->
name|bCacheplayback
operator|=
name|MNG_FALSE
expr_stmt|;
name|pData
operator|->
name|bStorechunks
operator|=
name|MNG_FALSE
expr_stmt|;
block|}
block|}
block|}
return|return
name|bOke
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_nEED
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_need
argument_list|)
end_macro
begin_block
block|{
comment|/* let's check it */
name|mng_bool
name|bOke
init|=
name|MNG_TRUE
decl_stmt|;
name|mng_uint8p
name|pNull
decl_stmt|,
name|pTemp
decl_stmt|,
name|pMax
decl_stmt|;
name|pTemp
operator|=
call|(
name|mng_uint8p
call|)
argument_list|(
operator|(
name|mng_needp
operator|)
name|pChunk
argument_list|)
operator|->
name|zKeywords
expr_stmt|;
name|pMax
operator|=
call|(
name|mng_uint8p
call|)
argument_list|(
name|pTemp
operator|+
operator|(
operator|(
name|mng_needp
operator|)
name|pChunk
operator|)
operator|->
name|iKeywordssize
argument_list|)
expr_stmt|;
name|pNull
operator|=
name|pTemp
expr_stmt|;
while|while
condition|(
operator|*
name|pNull
condition|)
name|pNull
operator|++
expr_stmt|;
while|while
condition|(
operator|(
name|bOke
operator|)
operator|&&
operator|(
name|pNull
operator|<
name|pMax
operator|)
condition|)
block|{
name|bOke
operator|=
name|CheckKeyword
argument_list|(
name|pData
argument_list|,
name|pTemp
argument_list|)
expr_stmt|;
name|pTemp
operator|=
name|pNull
operator|+
literal|1
expr_stmt|;
name|pNull
operator|=
name|pTemp
expr_stmt|;
while|while
condition|(
operator|*
name|pNull
condition|)
name|pNull
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|bOke
condition|)
name|bOke
operator|=
name|CheckKeyword
argument_list|(
name|pData
argument_list|,
name|pTemp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_UNSUPPORTEDNEED
argument_list|)
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_pHYg
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_phyg
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_dhdr
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_dhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iDeltatype
operator|==
name|MNG_DELTATYPE_REPLACE
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_dhdrp
operator|)
name|pChunk
operator|)
operator|->
name|bHasblockloc
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_dhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iDeltatype
operator|==
name|MNG_DELTATYPE_NOCHANGE
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_dhdrp
operator|)
name|pChunk
operator|)
operator|->
name|bHasblocksize
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|pData
operator|->
name|bHasDHDR
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* inside a DHDR-IEND block now */
name|pData
operator|->
name|iDeltatype
operator|=
operator|(
operator|(
name|mng_dhdrp
operator|)
name|pChunk
operator|)
operator|->
name|iDeltatype
expr_stmt|;
name|pData
operator|->
name|iImagelevel
operator|++
expr_stmt|;
comment|/* one level deeper */
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_dhdr
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
else|#
directive|else
return|return
name|MNG_NOERROR
return|;
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_prom
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAY
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGB
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_INDEXED
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_GRAYA
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_RGBA
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOLORTYPE
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
if|if
condition|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|==
name|MNG_BITDEPTH_16
condition|)
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|=
name|MNG_BITDEPTH_8
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_1
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_2
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_4
operator|)
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_8
operator|)
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
operator|&&
operator|(
operator|(
operator|(
name|mng_promp
operator|)
name|pChunk
operator|)
operator|->
name|iSampledepth
operator|!=
name|MNG_BITDEPTH_16
operator|)
endif|#
directive|endif
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVSAMPLEDEPTH
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_prom
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_ipng
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_ipng
argument_list|(
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|iRetcode
condition|)
comment|/* process it */
name|iRetcode
operator|=
name|mng_process_display_ipng
argument_list|(
name|pData
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_pplt_entries
argument_list|)
end_macro
begin_block
block|{
name|mng_ppltp
name|pPPLT
init|=
operator|(
name|mng_ppltp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
name|mng_uint8
name|iDeltatype
init|=
name|pPPLT
operator|->
name|iDeltatype
decl_stmt|;
name|mng_uint32
name|iMax
init|=
literal|0
decl_stmt|;
name|mng_int32
name|iX
decl_stmt|,
name|iY
decl_stmt|,
name|iM
decl_stmt|;
name|mng_rgbpaltab
name|aIndexentries
decl_stmt|;
name|mng_uint8arr
name|aAlphaentries
decl_stmt|;
name|mng_uint8arr
name|aUsedentries
decl_stmt|;
comment|/* must be indexed color ! */
if|if
condition|(
name|pData
operator|->
name|iColortype
operator|!=
name|MNG_COLORTYPE_INDEXED
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDCOLORTYPE
argument_list|)
expr_stmt|;
for|for
control|(
name|iY
operator|=
literal|255
init|;
name|iY
operator|>=
literal|0
condition|;
name|iY
operator|--
control|)
comment|/* reset arrays */
block|{
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iRed
operator|=
literal|0
expr_stmt|;
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iGreen
operator|=
literal|0
expr_stmt|;
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iBlue
operator|=
literal|0
expr_stmt|;
name|aAlphaentries
index|[
name|iY
index|]
operator|=
literal|255
expr_stmt|;
name|aUsedentries
index|[
name|iY
index|]
operator|=
literal|0
expr_stmt|;
block|}
while|while
condition|(
name|iRawlen
condition|)
comment|/* as long as there are entries left ... */
block|{
name|mng_uint32
name|iDiff
decl_stmt|;
if|if
condition|(
name|iRawlen
operator|<
literal|2
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|iX
operator|=
call|(
name|mng_int32
call|)
argument_list|(
operator|*
name|pRawdata
argument_list|)
expr_stmt|;
comment|/* get start and end index */
name|iM
operator|=
call|(
name|mng_int32
call|)
argument_list|(
operator|*
operator|(
name|pRawdata
operator|+
literal|1
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|iM
operator|<
name|iX
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDINDEX
argument_list|)
expr_stmt|;
if|if
condition|(
name|iM
operator|>=
operator|(
name|mng_int32
operator|)
name|iMax
condition|)
comment|/* determine highest used index */
name|iMax
operator|=
name|iM
operator|+
literal|1
expr_stmt|;
name|pRawdata
operator|+=
literal|2
expr_stmt|;
name|iRawlen
operator|-=
literal|2
expr_stmt|;
name|iDiff
operator|=
operator|(
name|iM
operator|-
name|iX
operator|+
literal|1
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_REPLACERGB
operator|)
operator|||
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_DELTARGB
operator|)
condition|)
name|iDiff
operator|=
name|iDiff
operator|*
literal|3
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_REPLACERGBA
operator|)
operator|||
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_DELTARGBA
operator|)
condition|)
name|iDiff
operator|=
name|iDiff
operator|*
literal|4
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|<
name|iDiff
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_REPLACERGB
operator|)
operator|||
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_DELTARGB
operator|)
condition|)
block|{
for|for
control|(
name|iY
operator|=
name|iX
init|;
name|iY
operator|<=
name|iM
condition|;
name|iY
operator|++
control|)
block|{
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iRed
operator|=
operator|*
name|pRawdata
expr_stmt|;
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iGreen
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|1
operator|)
expr_stmt|;
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iBlue
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|2
operator|)
expr_stmt|;
name|aUsedentries
index|[
name|iY
index|]
operator|=
literal|1
expr_stmt|;
name|pRawdata
operator|+=
literal|3
expr_stmt|;
name|iRawlen
operator|-=
literal|3
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_REPLACEALPHA
operator|)
operator|||
operator|(
name|iDeltatype
operator|==
name|MNG_DELTATYPE_DELTAALPHA
operator|)
condition|)
block|{
for|for
control|(
name|iY
operator|=
name|iX
init|;
name|iY
operator|<=
name|iM
condition|;
name|iY
operator|++
control|)
block|{
name|aAlphaentries
index|[
name|iY
index|]
operator|=
operator|*
name|pRawdata
expr_stmt|;
name|aUsedentries
index|[
name|iY
index|]
operator|=
literal|1
expr_stmt|;
name|pRawdata
operator|++
expr_stmt|;
name|iRawlen
operator|--
expr_stmt|;
block|}
block|}
else|else
block|{
for|for
control|(
name|iY
operator|=
name|iX
init|;
name|iY
operator|<=
name|iM
condition|;
name|iY
operator|++
control|)
block|{
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iRed
operator|=
operator|*
name|pRawdata
expr_stmt|;
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iGreen
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|1
operator|)
expr_stmt|;
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iBlue
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|2
operator|)
expr_stmt|;
name|aAlphaentries
index|[
name|iY
index|]
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|3
operator|)
expr_stmt|;
name|aUsedentries
index|[
name|iY
index|]
operator|=
literal|1
expr_stmt|;
name|pRawdata
operator|+=
literal|4
expr_stmt|;
name|iRawlen
operator|-=
literal|4
expr_stmt|;
block|}
block|}
block|}
switch|switch
condition|(
name|pData
operator|->
name|iBitdepth
condition|)
comment|/* check maximum allowed entries for bitdepth */
block|{
case|case
name|MNG_BITDEPTH_1
case|:
block|{
if|if
condition|(
name|iMax
operator|>
literal|2
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDINDEX
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|MNG_BITDEPTH_2
case|:
block|{
if|if
condition|(
name|iMax
operator|>
literal|4
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDINDEX
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|MNG_BITDEPTH_4
case|:
block|{
if|if
condition|(
name|iMax
operator|>
literal|16
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDINDEX
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|pPPLT
operator|->
name|iCount
operator|=
name|iMax
expr_stmt|;
for|for
control|(
name|iY
operator|=
literal|255
init|;
name|iY
operator|>=
literal|0
condition|;
name|iY
operator|--
control|)
block|{
name|pPPLT
operator|->
name|aEntries
index|[
name|iY
index|]
operator|.
name|iRed
operator|=
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iRed
expr_stmt|;
name|pPPLT
operator|->
name|aEntries
index|[
name|iY
index|]
operator|.
name|iGreen
operator|=
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iGreen
expr_stmt|;
name|pPPLT
operator|->
name|aEntries
index|[
name|iY
index|]
operator|.
name|iBlue
operator|=
name|aIndexentries
index|[
name|iY
index|]
operator|.
name|iBlue
expr_stmt|;
name|pPPLT
operator|->
name|aEntries
index|[
name|iY
index|]
operator|.
name|iAlpha
operator|=
name|aAlphaentries
index|[
name|iY
index|]
expr_stmt|;
name|pPPLT
operator|->
name|aEntries
index|[
name|iY
index|]
operator|.
name|bUsed
operator|=
call|(
name|mng_bool
call|)
argument_list|(
name|aUsedentries
index|[
name|iY
index|]
argument_list|)
expr_stmt|;
block|}
block|{
comment|/* create animation object */
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_pplt
argument_list|(
name|pData
argument_list|,
name|iDeltatype
argument_list|,
name|iMax
argument_list|,
name|aIndexentries
argument_list|,
name|aAlphaentries
argument_list|,
name|aUsedentries
argument_list|)
decl_stmt|;
if|if
condition|(
name|iRetcode
condition|)
return|return
name|iRetcode
return|;
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_pplt
argument_list|)
end_macro
begin_block
block|{
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_JNG
end_ifdef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_ijng
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
name|mng_retcode
name|iRetcode
init|=
name|mng_create_ani_ijng
argument_list|(
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|iRetcode
condition|)
comment|/* process it */
name|iRetcode
operator|=
name|mng_process_display_ijng
argument_list|(
name|pData
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
else|#
directive|else
return|return
name|MNG_NOERROR
return|;
comment|/* done */
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_drop_entries
argument_list|)
end_macro
begin_block
block|{
name|mng_dropp
name|pDROP
init|=
operator|(
name|mng_dropp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
name|mng_uint32
name|iX
decl_stmt|;
name|mng_uint32p
name|pEntry
decl_stmt|;
comment|/* check length */
if|if
condition|(
operator|(
name|iRawlen
operator|<
literal|4
operator|)
operator|||
operator|(
operator|(
name|iRawlen
operator|%
literal|4
operator|)
operator|!=
literal|0
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pEntry
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
name|pDROP
operator|->
name|iCount
operator|=
name|iRawlen
operator|/
literal|4
expr_stmt|;
name|pDROP
operator|->
name|pChunknames
operator|=
operator|(
name|mng_ptr
operator|)
name|pEntry
expr_stmt|;
for|for
control|(
name|iX
operator|=
name|pDROP
operator|->
name|iCount
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
block|{
operator|*
name|pEntry
operator|++
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|4
expr_stmt|;
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_drop
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_DBYK
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_dbyk
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_ORDR
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_ordr_entries
argument_list|)
end_macro
begin_block
block|{
name|mng_ordrp
name|pORDR
init|=
operator|(
name|mng_ordrp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
name|mng_uint32
name|iX
decl_stmt|;
name|mng_ordr_entryp
name|pEntry
decl_stmt|;
comment|/* check length */
if|if
condition|(
operator|(
name|iRawlen
operator|<
literal|5
operator|)
operator|||
operator|(
operator|(
name|iRawlen
operator|%
literal|5
operator|)
operator|!=
literal|0
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pEntry
argument_list|,
name|iRawlen
argument_list|)
expr_stmt|;
name|pORDR
operator|->
name|iCount
operator|=
name|iRawlen
operator|/
literal|5
expr_stmt|;
name|pORDR
operator|->
name|pEntries
operator|=
operator|(
name|mng_ptr
operator|)
name|pEntry
expr_stmt|;
for|for
control|(
name|iX
operator|=
name|pORDR
operator|->
name|iCount
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
block|{
name|pEntry
operator|->
name|iChunkname
operator|=
name|mng_get_uint32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pEntry
operator|->
name|iOrdertype
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|4
operator|)
expr_stmt|;
name|pEntry
operator|++
expr_stmt|;
name|pRawdata
operator|+=
literal|5
expr_stmt|;
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_NO_DELTA_PNG
end_ifndef
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_ORDR
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_ordr
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
block|{
comment|/* TODO: something !!! */
block|}
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MAGN
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_debunk_magn
argument_list|)
end_macro
begin_block
block|{
name|mng_magnp
name|pMAGN
init|=
operator|(
name|mng_magnp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
name|mng_bool
name|bFaulty
decl_stmt|;
comment|/* check length */
if|if
condition|(
name|iRawlen
operator|>
literal|20
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
comment|/* following is an ugly hack to allow faulty layout caused by previous      versions of libmng and MNGeye, which wrote MAGN with a 16-bit      MethodX/MethodY (as opposed to the proper 8-bit as defined in the spec!) */
if|if
condition|(
operator|(
name|iRawlen
operator|==
literal|6
operator|)
operator|||
operator|(
name|iRawlen
operator|==
literal|8
operator|)
operator|||
operator|(
name|iRawlen
operator|==
literal|10
operator|)
operator|||
operator|(
name|iRawlen
operator|==
literal|12
operator|)
operator|||
operator|(
name|iRawlen
operator|==
literal|14
operator|)
operator|||
operator|(
name|iRawlen
operator|==
literal|16
operator|)
operator|||
operator|(
name|iRawlen
operator|==
literal|20
operator|)
condition|)
name|bFaulty
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* these lengths are all wrong */
elseif|else
comment|/* length 18 can be right or wrong !!! */
if|if
condition|(
operator|(
name|iRawlen
operator|==
literal|18
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|4
argument_list|)
operator|<=
literal|5
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|6
argument_list|)
operator|<
literal|256
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|8
argument_list|)
operator|<
literal|256
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|10
argument_list|)
operator|<
literal|256
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|12
argument_list|)
operator|<
literal|256
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|14
argument_list|)
operator|<
literal|256
operator|)
operator|&&
operator|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|16
argument_list|)
operator|<
literal|256
operator|)
condition|)
name|bFaulty
operator|=
name|MNG_TRUE
expr_stmt|;
comment|/* this is very likely the wrong layout */
else|else
name|bFaulty
operator|=
name|MNG_FALSE
expr_stmt|;
comment|/* all other cases are handled as right */
if|if
condition|(
name|bFaulty
condition|)
comment|/* wrong layout ? */
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|0
condition|)
comment|/* get the fields */
name|pMAGN
operator|->
name|iFirstid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iFirstid
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|2
condition|)
name|pMAGN
operator|->
name|iLastid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|2
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iLastid
operator|=
name|pMAGN
operator|->
name|iFirstid
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|4
condition|)
name|pMAGN
operator|->
name|iMethodX
operator|=
call|(
name|mng_uint8
call|)
argument_list|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|4
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMethodX
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|6
condition|)
name|pMAGN
operator|->
name|iMX
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|6
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMX
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|8
condition|)
name|pMAGN
operator|->
name|iMY
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|8
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMY
operator|=
name|pMAGN
operator|->
name|iMX
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|10
condition|)
name|pMAGN
operator|->
name|iML
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|10
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iML
operator|=
name|pMAGN
operator|->
name|iMX
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|12
condition|)
name|pMAGN
operator|->
name|iMR
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|12
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMR
operator|=
name|pMAGN
operator|->
name|iMX
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|14
condition|)
name|pMAGN
operator|->
name|iMT
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|14
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMT
operator|=
name|pMAGN
operator|->
name|iMY
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|16
condition|)
name|pMAGN
operator|->
name|iMB
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|16
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMB
operator|=
name|pMAGN
operator|->
name|iMY
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|18
condition|)
name|pMAGN
operator|->
name|iMethodY
operator|=
call|(
name|mng_uint8
call|)
argument_list|(
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|18
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMethodY
operator|=
name|pMAGN
operator|->
name|iMethodX
expr_stmt|;
block|}
else|else
comment|/* proper layout !!!! */
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|0
condition|)
comment|/* get the fields */
name|pMAGN
operator|->
name|iFirstid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iFirstid
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|2
condition|)
name|pMAGN
operator|->
name|iLastid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|2
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iLastid
operator|=
name|pMAGN
operator|->
name|iFirstid
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|4
condition|)
name|pMAGN
operator|->
name|iMethodX
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|4
operator|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMethodX
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|5
condition|)
name|pMAGN
operator|->
name|iMX
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|5
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMX
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|7
condition|)
name|pMAGN
operator|->
name|iMY
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|7
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMY
operator|=
name|pMAGN
operator|->
name|iMX
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|9
condition|)
name|pMAGN
operator|->
name|iML
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|9
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iML
operator|=
name|pMAGN
operator|->
name|iMX
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|11
condition|)
name|pMAGN
operator|->
name|iMR
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|11
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMR
operator|=
name|pMAGN
operator|->
name|iMX
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|13
condition|)
name|pMAGN
operator|->
name|iMT
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|13
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMT
operator|=
name|pMAGN
operator|->
name|iMY
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|15
condition|)
name|pMAGN
operator|->
name|iMB
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|15
argument_list|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMB
operator|=
name|pMAGN
operator|->
name|iMY
expr_stmt|;
if|if
condition|(
name|iRawlen
operator|>
literal|17
condition|)
name|pMAGN
operator|->
name|iMethodY
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|17
operator|)
expr_stmt|;
else|else
name|pMAGN
operator|->
name|iMethodY
operator|=
name|pMAGN
operator|->
name|iMethodX
expr_stmt|;
block|}
comment|/* check field validity */
if|if
condition|(
operator|(
name|pMAGN
operator|->
name|iMethodX
operator|>
literal|5
operator|)
operator|||
operator|(
name|pMAGN
operator|->
name|iMethodY
operator|>
literal|5
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDMETHOD
argument_list|)
expr_stmt|;
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_MAGN
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_magn
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ani_magn
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
else|#
directive|else
return|return
name|MNG_NOERROR
return|;
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_evNT
end_ifndef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_evnt_entries
argument_list|)
end_macro
begin_block
block|{
name|mng_evntp
name|pEVNT
init|=
operator|(
name|mng_evntp
operator|)
name|pChunk
decl_stmt|;
name|mng_uint32
name|iRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
decl_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MNG_SUPPORT_DISPLAY
argument_list|)
operator|&&
name|defined
argument_list|(
name|MNG_SUPPORT_DYNAMICMNG
argument_list|)
name|mng_retcode
name|iRetcode
decl_stmt|;
endif|#
directive|endif
name|mng_uint8p
name|pNull
decl_stmt|;
name|mng_uint8
name|iEventtype
decl_stmt|;
name|mng_uint8
name|iMasktype
decl_stmt|;
name|mng_int32
name|iLeft
decl_stmt|;
name|mng_int32
name|iRight
decl_stmt|;
name|mng_int32
name|iTop
decl_stmt|;
name|mng_int32
name|iBottom
decl_stmt|;
name|mng_uint16
name|iObjectid
decl_stmt|;
name|mng_uint8
name|iIndex
decl_stmt|;
name|mng_uint32
name|iNamesize
decl_stmt|;
name|mng_uint32
name|iCount
init|=
literal|0
decl_stmt|;
name|mng_evnt_entryp
name|pEntry
init|=
name|MNG_NULL
decl_stmt|;
name|mng_uint32
name|iX
decl_stmt|;
for|for
control|(
name|iX
operator|=
literal|0
init|;
name|iX
operator|<
literal|2
condition|;
name|iX
operator|++
control|)
block|{
name|iRawlen
operator|=
operator|*
name|piRawlen
expr_stmt|;
name|pRawdata
operator|=
operator|*
name|ppRawdata
expr_stmt|;
if|if
condition|(
name|iX
condition|)
comment|/* second run ? */
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pEntry
argument_list|,
operator|(
name|iCount
operator|*
sizeof|sizeof
argument_list|(
name|mng_evnt_entry
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|pEVNT
operator|->
name|iCount
operator|=
name|iCount
expr_stmt|;
name|pEVNT
operator|->
name|pEntries
operator|=
name|pEntry
expr_stmt|;
block|}
while|while
condition|(
name|iRawlen
condition|)
comment|/* anything left ? */
block|{
if|if
condition|(
name|iRawlen
operator|<
literal|2
condition|)
comment|/* must have at least 2 bytes ! */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
name|iEventtype
operator|=
operator|*
name|pRawdata
expr_stmt|;
comment|/* eventtype */
if|if
condition|(
name|iEventtype
operator|>
literal|5
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDEVENT
argument_list|)
expr_stmt|;
name|pRawdata
operator|++
expr_stmt|;
name|iMasktype
operator|=
operator|*
name|pRawdata
expr_stmt|;
comment|/* masktype */
if|if
condition|(
name|iMasktype
operator|>
literal|5
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDMASK
argument_list|)
expr_stmt|;
name|pRawdata
operator|++
expr_stmt|;
name|iRawlen
operator|-=
literal|2
expr_stmt|;
name|iLeft
operator|=
literal|0
expr_stmt|;
name|iRight
operator|=
literal|0
expr_stmt|;
name|iTop
operator|=
literal|0
expr_stmt|;
name|iBottom
operator|=
literal|0
expr_stmt|;
name|iObjectid
operator|=
literal|0
expr_stmt|;
name|iIndex
operator|=
literal|0
expr_stmt|;
switch|switch
condition|(
name|iMasktype
condition|)
block|{
case|case
literal|1
case|:
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|16
condition|)
block|{
name|iLeft
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|iRight
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|4
argument_list|)
expr_stmt|;
name|iTop
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|8
argument_list|)
expr_stmt|;
name|iBottom
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|12
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|16
expr_stmt|;
name|iRawlen
operator|-=
literal|16
expr_stmt|;
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|2
condition|)
block|{
name|iObjectid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|2
expr_stmt|;
name|iRawlen
operator|-=
literal|2
expr_stmt|;
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|3
case|:
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|3
condition|)
block|{
name|iObjectid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|iIndex
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|2
operator|)
expr_stmt|;
name|pRawdata
operator|+=
literal|3
expr_stmt|;
name|iRawlen
operator|-=
literal|3
expr_stmt|;
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|4
case|:
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|18
condition|)
block|{
name|iLeft
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|iRight
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|4
argument_list|)
expr_stmt|;
name|iTop
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|8
argument_list|)
expr_stmt|;
name|iBottom
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|12
argument_list|)
expr_stmt|;
name|iObjectid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|16
argument_list|)
expr_stmt|;
name|pRawdata
operator|+=
literal|18
expr_stmt|;
name|iRawlen
operator|-=
literal|18
expr_stmt|;
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|5
case|:
block|{
if|if
condition|(
name|iRawlen
operator|>
literal|19
condition|)
block|{
name|iLeft
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
argument_list|)
expr_stmt|;
name|iRight
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|4
argument_list|)
expr_stmt|;
name|iTop
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|8
argument_list|)
expr_stmt|;
name|iBottom
operator|=
name|mng_get_int32
argument_list|(
name|pRawdata
operator|+
literal|12
argument_list|)
expr_stmt|;
name|iObjectid
operator|=
name|mng_get_uint16
argument_list|(
name|pRawdata
operator|+
literal|16
argument_list|)
expr_stmt|;
name|iIndex
operator|=
operator|*
operator|(
name|pRawdata
operator|+
literal|18
operator|)
expr_stmt|;
name|pRawdata
operator|+=
literal|19
expr_stmt|;
name|iRawlen
operator|-=
literal|19
expr_stmt|;
block|}
else|else
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_INVALIDLENGTH
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|pNull
operator|=
name|pRawdata
expr_stmt|;
comment|/* get the name length */
while|while
condition|(
operator|*
name|pNull
condition|)
name|pNull
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|pNull
operator|-
name|pRawdata
operator|)
operator|>
operator|(
name|mng_int32
operator|)
name|iRawlen
condition|)
block|{
name|iNamesize
operator|=
name|iRawlen
expr_stmt|;
comment|/* no null found; so end of evNT */
name|iRawlen
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|iNamesize
operator|=
name|pNull
operator|-
name|pRawdata
expr_stmt|;
comment|/* should be another entry */
name|iRawlen
operator|=
name|iRawlen
operator|-
name|iNamesize
operator|-
literal|1
expr_stmt|;
if|if
condition|(
operator|!
name|iRawlen
condition|)
comment|/* must not end with a null ! */
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_ENDWITHNULL
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|iX
condition|)
block|{
name|iCount
operator|++
expr_stmt|;
block|}
else|else
block|{
name|pEntry
operator|->
name|iEventtype
operator|=
name|iEventtype
expr_stmt|;
name|pEntry
operator|->
name|iMasktype
operator|=
name|iMasktype
expr_stmt|;
name|pEntry
operator|->
name|iLeft
operator|=
name|iLeft
expr_stmt|;
name|pEntry
operator|->
name|iRight
operator|=
name|iRight
expr_stmt|;
name|pEntry
operator|->
name|iTop
operator|=
name|iTop
expr_stmt|;
name|pEntry
operator|->
name|iBottom
operator|=
name|iBottom
expr_stmt|;
name|pEntry
operator|->
name|iObjectid
operator|=
name|iObjectid
expr_stmt|;
name|pEntry
operator|->
name|iIndex
operator|=
name|iIndex
expr_stmt|;
name|pEntry
operator|->
name|iSegmentnamesize
operator|=
name|iNamesize
expr_stmt|;
if|if
condition|(
name|iNamesize
condition|)
block|{
name|MNG_ALLOC
argument_list|(
name|pData
argument_list|,
name|pEntry
operator|->
name|zSegmentname
argument_list|,
name|iNamesize
operator|+
literal|1
argument_list|)
expr_stmt|;
name|MNG_COPY
argument_list|(
name|pEntry
operator|->
name|zSegmentname
argument_list|,
name|pRawdata
argument_list|,
name|iNamesize
argument_list|)
expr_stmt|;
block|}
if|#
directive|if
name|defined
argument_list|(
name|MNG_SUPPORT_DISPLAY
argument_list|)
operator|&&
name|defined
argument_list|(
name|MNG_SUPPORT_DYNAMICMNG
argument_list|)
name|iRetcode
operator|=
name|mng_create_event
argument_list|(
name|pData
argument_list|,
operator|(
name|mng_ptr
operator|)
name|pEntry
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
return|return
name|iRetcode
return|;
endif|#
directive|endif
name|pEntry
operator|++
expr_stmt|;
block|}
name|pRawdata
operator|=
name|pRawdata
operator|+
name|iNamesize
operator|+
literal|1
expr_stmt|;
block|}
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifndef
ifndef|#
directive|ifndef
name|MNG_SKIPCHUNK_evNT
end_ifndef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_evnt
argument_list|)
end_macro
begin_block
block|{
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_MPNG_PROPOSAL
end_ifdef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_mpng
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|(
name|pData
operator|->
name|eImagetype
operator|!=
name|mng_it_png
operator|)
operator|&&
operator|(
name|pData
operator|->
name|eImagetype
operator|!=
name|mng_it_jng
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CHUNKNOTALLOWED
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_mpng_obj
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
else|#
directive|else
return|return
name|MNG_NOERROR
return|;
endif|#
directive|endif
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
end_ifdef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_ahdr
argument_list|)
end_macro
begin_block
block|{
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
return|return
name|mng_create_ang_obj
argument_list|(
name|pData
argument_list|,
name|pChunk
argument_list|)
return|;
else|#
directive|else
return|return
name|MNG_NOERROR
return|;
endif|#
directive|endif
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
end_ifdef
begin_macro
DECL|function|MNG_F_SPECIALFUNC
name|MNG_F_SPECIALFUNC
argument_list|(
argument|mng_adat_tiles
argument_list|)
end_macro
begin_block
block|{
if|if
condition|(
operator|(
name|pData
operator|->
name|eImagetype
operator|!=
name|mng_it_ang
operator|)
operator|||
operator|(
operator|!
name|pData
operator|->
name|pANG
operator|)
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_CHUNKNOTALLOWED
argument_list|)
expr_stmt|;
block|{
name|mng_adatp
name|pADAT
init|=
operator|(
name|mng_adatp
operator|)
name|pChunk
decl_stmt|;
name|mng_ang_objp
name|pANG
init|=
operator|(
name|mng_ang_objp
operator|)
name|pData
operator|->
name|pANG
decl_stmt|;
name|mng_uint32
name|iRawlen
init|=
operator|*
name|piRawlen
decl_stmt|;
name|mng_uint8p
name|pRawdata
init|=
operator|*
name|ppRawdata
decl_stmt|;
name|mng_retcode
name|iRetcode
decl_stmt|;
name|mng_uint8p
name|pBuf
decl_stmt|;
name|mng_uint32
name|iBufsize
decl_stmt|;
name|mng_uint32
name|iRealsize
decl_stmt|;
name|mng_uint8p
name|pTemp
decl_stmt|;
name|mng_uint8p
name|pTemp2
decl_stmt|;
name|mng_int32
name|iX
decl_stmt|;
name|mng_int32
name|iSize
decl_stmt|;
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
name|mng_imagep
name|pImage
decl_stmt|;
name|mng_int32
name|iTemplen
decl_stmt|;
name|mng_uint8p
name|pSwap
decl_stmt|;
name|mng_processobject
name|pProcess
decl_stmt|;
name|mng_uint32
name|iSavedatawidth
decl_stmt|;
name|mng_uint32
name|iSavedataheight
decl_stmt|;
name|mng_fptr
name|fSaveinitrowproc
decl_stmt|;
name|mng_fptr
name|fSavestorerow
decl_stmt|;
name|mng_fptr
name|fSaveprocessrow
decl_stmt|;
name|mng_fptr
name|fSavedifferrow
decl_stmt|;
name|mng_imagep
name|fSavestoreobj
decl_stmt|;
name|mng_imagedatap
name|fSavestorebuf
decl_stmt|;
ifdef|#
directive|ifdef
name|MNG_OPTIMIZE_FOOTPRINT_INIT
name|png_imgtype
name|eSavepngimgtype
decl_stmt|;
endif|#
directive|endif
name|mng_uint8
name|iSaveinterlace
decl_stmt|;
name|mng_int8
name|iSavepass
decl_stmt|;
name|mng_int32
name|iSaverow
decl_stmt|;
name|mng_int32
name|iSaverowinc
decl_stmt|;
name|mng_int32
name|iSavecol
decl_stmt|;
name|mng_int32
name|iSavecolinc
decl_stmt|;
name|mng_int32
name|iSaverowsamples
decl_stmt|;
name|mng_int32
name|iSavesamplemul
decl_stmt|;
name|mng_int32
name|iSavesampleofs
decl_stmt|;
name|mng_int32
name|iSavesamplediv
decl_stmt|;
name|mng_int32
name|iSaverowsize
decl_stmt|;
name|mng_int32
name|iSaverowmax
decl_stmt|;
name|mng_int32
name|iSavefilterofs
decl_stmt|;
name|mng_int32
name|iSavepixelofs
decl_stmt|;
name|mng_uint32
name|iSavelevel0
decl_stmt|;
name|mng_uint32
name|iSavelevel1
decl_stmt|;
name|mng_uint32
name|iSavelevel2
decl_stmt|;
name|mng_uint32
name|iSavelevel3
decl_stmt|;
name|mng_uint8p
name|pSaveworkrow
decl_stmt|;
name|mng_uint8p
name|pSaveprevrow
decl_stmt|;
name|mng_uint8p
name|pSaverGBArow
decl_stmt|;
name|mng_bool
name|bSaveisRGBA16
decl_stmt|;
name|mng_bool
name|bSaveisOpaque
decl_stmt|;
name|mng_int32
name|iSavefilterbpp
decl_stmt|;
name|mng_int32
name|iSavedestl
decl_stmt|;
name|mng_int32
name|iSavedestt
decl_stmt|;
name|mng_int32
name|iSavedestr
decl_stmt|;
name|mng_int32
name|iSavedestb
decl_stmt|;
name|mng_int32
name|iSavesourcel
decl_stmt|;
name|mng_int32
name|iSavesourcet
decl_stmt|;
name|mng_int32
name|iSavesourcer
decl_stmt|;
name|mng_int32
name|iSavesourceb
decl_stmt|;
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
name|iRetcode
operator|=
name|mng_inflate_buffer
argument_list|(
name|pData
argument_list|,
name|pRawdata
argument_list|,
name|iRawlen
argument_list|,
operator|&
name|pBuf
argument_list|,
operator|&
name|iBufsize
argument_list|,
operator|&
name|iRealsize
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
block|{
comment|/* don't forget to drop the temp buffer */
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
block|}
comment|/* get buffer for tile info in ADAT chunk */
name|pADAT
operator|->
name|iTilessize
operator|=
name|pANG
operator|->
name|iNumframes
operator|*
sizeof|sizeof
argument_list|(
name|mng_adat_tile
argument_list|)
expr_stmt|;
name|MNG_ALLOCX
argument_list|(
name|pData
argument_list|,
name|pADAT
operator|->
name|pTiles
argument_list|,
name|pADAT
operator|->
name|iTilessize
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|pADAT
operator|->
name|pTiles
condition|)
block|{
name|pADAT
operator|->
name|iTilessize
operator|=
literal|0
expr_stmt|;
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_OUTOFMEMORY
argument_list|)
expr_stmt|;
block|}
name|pTemp
operator|=
name|pBuf
expr_stmt|;
name|pTemp2
operator|=
operator|(
name|mng_uint8p
operator|)
name|pADAT
operator|->
name|pTiles
expr_stmt|;
if|if
condition|(
operator|!
name|pANG
operator|->
name|iStillused
condition|)
name|iSize
operator|=
literal|12
expr_stmt|;
else|else
name|iSize
operator|=
literal|13
expr_stmt|;
for|for
control|(
name|iX
operator|=
literal|0
init|;
name|iX
operator|<
name|pANG
operator|->
name|iNumframes
condition|;
name|iX
operator|++
control|)
block|{
name|MNG_COPY
argument_list|(
name|pTemp2
argument_list|,
name|pTemp
argument_list|,
name|iSize
argument_list|)
expr_stmt|;
name|pTemp
operator|+=
name|iSize
expr_stmt|;
name|pTemp2
operator|+=
sizeof|sizeof
argument_list|(
name|mng_adat_tile
argument_list|)
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|MNG_SUPPORT_DISPLAY
comment|/* get buffer for tile info in ANG object */
name|pANG
operator|->
name|iTilessize
operator|=
name|pADAT
operator|->
name|iTilessize
expr_stmt|;
name|MNG_ALLOCX
argument_list|(
name|pData
argument_list|,
name|pANG
operator|->
name|pTiles
argument_list|,
name|pANG
operator|->
name|iTilessize
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|pANG
operator|->
name|pTiles
condition|)
block|{
name|pANG
operator|->
name|iTilessize
operator|=
literal|0
expr_stmt|;
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_OUTOFMEMORY
argument_list|)
expr_stmt|;
block|}
comment|/* copy it from the ADAT object */
name|MNG_COPY
argument_list|(
name|pANG
operator|->
name|pTiles
argument_list|,
name|pADAT
operator|->
name|pTiles
argument_list|,
name|pANG
operator|->
name|iTilessize
argument_list|)
expr_stmt|;
comment|/* save IDAT work-parms */
name|fSaveinitrowproc
operator|=
name|pData
operator|->
name|fInitrowproc
expr_stmt|;
name|fSavestorerow
operator|=
name|pData
operator|->
name|fDisplayrow
expr_stmt|;
name|fSaveprocessrow
operator|=
name|pData
operator|->
name|fProcessrow
expr_stmt|;
name|fSavedifferrow
operator|=
name|pData
operator|->
name|fDifferrow
expr_stmt|;
name|fSavestoreobj
operator|=
name|pData
operator|->
name|pStoreobj
expr_stmt|;
name|fSavestorebuf
operator|=
name|pData
operator|->
name|pStorebuf
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_OPTIMIZE_FOOTPRINT_INIT
name|eSavepngimgtype
operator|=
name|pData
operator|->
name|ePng_imgtype
expr_stmt|;
endif|#
directive|endif
name|iSavedatawidth
operator|=
name|pData
operator|->
name|iDatawidth
expr_stmt|;
name|iSavedataheight
operator|=
name|pData
operator|->
name|iDataheight
expr_stmt|;
name|iSaveinterlace
operator|=
name|pData
operator|->
name|iInterlace
expr_stmt|;
name|iSavepass
operator|=
name|pData
operator|->
name|iPass
expr_stmt|;
name|iSaverow
operator|=
name|pData
operator|->
name|iRow
expr_stmt|;
name|iSaverowinc
operator|=
name|pData
operator|->
name|iRowinc
expr_stmt|;
name|iSavecol
operator|=
name|pData
operator|->
name|iCol
expr_stmt|;
name|iSavecolinc
operator|=
name|pData
operator|->
name|iColinc
expr_stmt|;
name|iSaverowsamples
operator|=
name|pData
operator|->
name|iRowsamples
expr_stmt|;
name|iSavesamplemul
operator|=
name|pData
operator|->
name|iSamplemul
expr_stmt|;
name|iSavesampleofs
operator|=
name|pData
operator|->
name|iSampleofs
expr_stmt|;
name|iSavesamplediv
operator|=
name|pData
operator|->
name|iSamplediv
expr_stmt|;
name|iSaverowsize
operator|=
name|pData
operator|->
name|iRowsize
expr_stmt|;
name|iSaverowmax
operator|=
name|pData
operator|->
name|iRowmax
expr_stmt|;
name|iSavefilterofs
operator|=
name|pData
operator|->
name|iFilterofs
expr_stmt|;
name|iSavepixelofs
operator|=
name|pData
operator|->
name|iPixelofs
expr_stmt|;
name|iSavelevel0
operator|=
name|pData
operator|->
name|iLevel0
expr_stmt|;
name|iSavelevel1
operator|=
name|pData
operator|->
name|iLevel1
expr_stmt|;
name|iSavelevel2
operator|=
name|pData
operator|->
name|iLevel2
expr_stmt|;
name|iSavelevel3
operator|=
name|pData
operator|->
name|iLevel3
expr_stmt|;
name|pSaveworkrow
operator|=
name|pData
operator|->
name|pWorkrow
expr_stmt|;
name|pSaveprevrow
operator|=
name|pData
operator|->
name|pPrevrow
expr_stmt|;
name|pSaverGBArow
operator|=
name|pData
operator|->
name|pRGBArow
expr_stmt|;
name|bSaveisRGBA16
operator|=
name|pData
operator|->
name|bIsRGBA16
expr_stmt|;
name|bSaveisOpaque
operator|=
name|pData
operator|->
name|bIsOpaque
expr_stmt|;
name|iSavefilterbpp
operator|=
name|pData
operator|->
name|iFilterbpp
expr_stmt|;
name|iSavedestl
operator|=
name|pData
operator|->
name|iDestl
expr_stmt|;
name|iSavedestt
operator|=
name|pData
operator|->
name|iDestt
expr_stmt|;
name|iSavedestr
operator|=
name|pData
operator|->
name|iDestr
expr_stmt|;
name|iSavedestb
operator|=
name|pData
operator|->
name|iDestb
expr_stmt|;
name|iSavesourcel
operator|=
name|pData
operator|->
name|iSourcel
expr_stmt|;
name|iSavesourcet
operator|=
name|pData
operator|->
name|iSourcet
expr_stmt|;
name|iSavesourcer
operator|=
name|pData
operator|->
name|iSourcer
expr_stmt|;
name|iSavesourceb
operator|=
name|pData
operator|->
name|iSourceb
expr_stmt|;
name|pData
operator|->
name|iDatawidth
operator|=
name|pANG
operator|->
name|iTilewidth
expr_stmt|;
name|pData
operator|->
name|iDataheight
operator|=
name|pANG
operator|->
name|iTileheight
expr_stmt|;
name|pData
operator|->
name|iDestl
operator|=
literal|0
expr_stmt|;
name|pData
operator|->
name|iDestt
operator|=
literal|0
expr_stmt|;
name|pData
operator|->
name|iDestr
operator|=
name|pANG
operator|->
name|iTilewidth
expr_stmt|;
name|pData
operator|->
name|iDestb
operator|=
name|pANG
operator|->
name|iTileheight
expr_stmt|;
name|pData
operator|->
name|iSourcel
operator|=
literal|0
expr_stmt|;
name|pData
operator|->
name|iSourcet
operator|=
literal|0
expr_stmt|;
name|pData
operator|->
name|iSourcer
operator|=
name|pANG
operator|->
name|iTilewidth
expr_stmt|;
name|pData
operator|->
name|iSourceb
operator|=
name|pANG
operator|->
name|iTileheight
expr_stmt|;
name|pData
operator|->
name|fInitrowproc
operator|=
name|MNG_NULL
expr_stmt|;
name|pData
operator|->
name|fStorerow
operator|=
name|MNG_NULL
expr_stmt|;
name|pData
operator|->
name|fProcessrow
operator|=
name|MNG_NULL
expr_stmt|;
name|pData
operator|->
name|fDifferrow
operator|=
name|MNG_NULL
expr_stmt|;
comment|/* clone image object to store the pixel-data from object 0 */
name|iRetcode
operator|=
name|mng_clone_imageobject
argument_list|(
name|pData
argument_list|,
literal|1
argument_list|,
name|MNG_FALSE
argument_list|,
name|MNG_FALSE
argument_list|,
name|MNG_FALSE
argument_list|,
name|MNG_FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|pData
operator|->
name|pObjzero
argument_list|,
operator|&
name|pImage
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error, drop temp buffer and bail */
block|{
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
block|}
comment|/* make sure we got the right dimensions and interlacing */
name|iRetcode
operator|=
name|mng_reset_object_details
argument_list|(
name|pData
argument_list|,
name|pImage
argument_list|,
name|pANG
operator|->
name|iTilewidth
argument_list|,
name|pANG
operator|->
name|iTileheight
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|iBitdepth
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|iColortype
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|iCompression
argument_list|,
name|pImage
operator|->
name|pImgbuf
operator|->
name|iFilter
argument_list|,
name|pANG
operator|->
name|iInterlace
argument_list|,
name|MNG_FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error, drop temp buffer and bail */
block|{
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
block|}
name|pData
operator|->
name|pStoreobj
operator|=
name|pImage
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_OPTIMIZE_FOOTPRINT_INIT
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rowproc
expr_stmt|;
name|pData
operator|->
name|ePng_imgtype
operator|=
name|mng_png_imgtype
argument_list|(
name|pData
operator|->
name|iColortype
argument_list|,
name|pData
operator|->
name|iBitdepth
argument_list|)
expr_stmt|;
else|#
directive|else
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
comment|/* determine row initialization routine */
block|{
case|case
literal|0
case|:
block|{
comment|/* gray */
switch|switch
condition|(
name|pData
operator|->
name|iBitdepth
condition|)
block|{
ifndef|#
directive|ifndef
name|MNG_NO_1_2_4BIT_SUPPORT
case|case
literal|1
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g1_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g1_i
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g2_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g2_i
expr_stmt|;
break|break;
block|}
case|case
literal|4
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g4_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g4_i
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
comment|/* MNG_NO_1_2_4BIT_SUPPORT */
case|case
literal|8
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g8_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g8_i
expr_stmt|;
break|break;
block|}
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
case|case
literal|16
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g16_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_g16_i
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
block|}
break|break;
block|}
case|case
literal|2
case|:
block|{
comment|/* rgb */
switch|switch
condition|(
name|pData
operator|->
name|iBitdepth
condition|)
block|{
case|case
literal|8
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgb8_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgb8_i
expr_stmt|;
break|break;
block|}
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
case|case
literal|16
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgb16_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgb16_i
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
block|}
break|break;
block|}
case|case
literal|3
case|:
block|{
comment|/* indexed */
switch|switch
condition|(
name|pData
operator|->
name|iBitdepth
condition|)
block|{
ifndef|#
directive|ifndef
name|MNG_NO_1_2_4BIT_SUPPORT
case|case
literal|1
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx1_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx1_i
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx2_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx2_i
expr_stmt|;
break|break;
block|}
case|case
literal|4
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx4_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx4_i
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
comment|/* MNG_NO_1_2_4BIT_SUPPORT */
case|case
literal|8
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx8_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_idx8_i
expr_stmt|;
break|break;
block|}
block|}
break|break;
block|}
case|case
literal|4
case|:
block|{
comment|/* gray+alpha */
switch|switch
condition|(
name|pData
operator|->
name|iBitdepth
condition|)
block|{
case|case
literal|8
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_ga8_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_ga8_i
expr_stmt|;
break|break;
block|}
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
case|case
literal|16
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_ga16_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_ga16_i
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
block|}
break|break;
block|}
case|case
literal|6
case|:
block|{
comment|/* rgb+alpha */
switch|switch
condition|(
name|pData
operator|->
name|iBitdepth
condition|)
block|{
case|case
literal|8
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgba8_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgba8_i
expr_stmt|;
break|break;
block|}
ifndef|#
directive|ifndef
name|MNG_NO_16BIT_SUPPORT
case|case
literal|16
case|:
block|{
if|if
condition|(
operator|!
name|pData
operator|->
name|iInterlace
condition|)
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgba16_ni
expr_stmt|;
else|else
name|pData
operator|->
name|fInitrowproc
operator|=
operator|(
name|mng_fptr
operator|)
name|mng_init_rgba16_i
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
block|}
break|break;
block|}
block|}
endif|#
directive|endif
comment|/* MNG_OPTIMIZE_FOOTPRINT_INIT */
name|pData
operator|->
name|iFilterofs
operator|=
literal|0
expr_stmt|;
comment|/* determine filter characteristics */
name|pData
operator|->
name|iLevel0
operator|=
literal|0
expr_stmt|;
comment|/* default levels */
name|pData
operator|->
name|iLevel1
operator|=
literal|0
expr_stmt|;
name|pData
operator|->
name|iLevel2
operator|=
literal|0
expr_stmt|;
name|pData
operator|->
name|iLevel3
operator|=
literal|0
expr_stmt|;
ifdef|#
directive|ifdef
name|FILTER192
comment|/* leveling& differing ? */
if|if
condition|(
name|pData
operator|->
name|iFilter
operator|==
name|MNG_FILTER_DIFFERING
condition|)
block|{
switch|switch
condition|(
name|pData
operator|->
name|iColortype
condition|)
block|{
case|case
literal|0
case|:
block|{
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|<=
literal|8
condition|)
name|pData
operator|->
name|iFilterofs
operator|=
literal|1
expr_stmt|;
else|else
name|pData
operator|->
name|iFilterofs
operator|=
literal|2
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
block|{
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|<=
literal|8
condition|)
name|pData
operator|->
name|iFilterofs
operator|=
literal|3
expr_stmt|;
else|else
name|pData
operator|->
name|iFilterofs
operator|=
literal|6
expr_stmt|;
break|break;
block|}
case|case
literal|3
case|:
block|{
name|pData
operator|->
name|iFilterofs
operator|=
literal|1
expr_stmt|;
break|break;
block|}
case|case
literal|4
case|:
block|{
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|<=
literal|8
condition|)
name|pData
operator|->
name|iFilterofs
operator|=
literal|2
expr_stmt|;
else|else
name|pData
operator|->
name|iFilterofs
operator|=
literal|4
expr_stmt|;
break|break;
block|}
case|case
literal|6
case|:
block|{
if|if
condition|(
name|pData
operator|->
name|iBitdepth
operator|<=
literal|8
condition|)
name|pData
operator|->
name|iFilterofs
operator|=
literal|4
expr_stmt|;
else|else
name|pData
operator|->
name|iFilterofs
operator|=
literal|8
expr_stmt|;
break|break;
block|}
block|}
block|}
endif|#
directive|endif
ifdef|#
directive|ifdef
name|FILTER193
comment|/* no adaptive filtering ? */
if|if
condition|(
name|pData
operator|->
name|iFilter
operator|==
name|MNG_FILTER_NOFILTER
condition|)
name|pData
operator|->
name|iPixelofs
operator|=
name|pData
operator|->
name|iFilterofs
expr_stmt|;
else|else
endif|#
directive|endif
name|pData
operator|->
name|iPixelofs
operator|=
name|pData
operator|->
name|iFilterofs
operator|+
literal|1
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|fInitrowproc
condition|)
comment|/* need to initialize row processing? */
block|{
name|iRetcode
operator|=
operator|(
operator|(
name|mng_initrowproc
operator|)
name|pData
operator|->
name|fInitrowproc
operator|)
operator|(
name|pData
operator|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
block|{
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
return|return
name|iRetcode
return|;
block|}
block|}
comment|/* calculate remainder of buffer */
name|pTemp
operator|=
name|pBuf
operator|+
call|(
name|mng_int32
call|)
argument_list|(
name|pANG
operator|->
name|iNumframes
operator|*
name|iSize
argument_list|)
expr_stmt|;
name|iTemplen
operator|=
name|iRealsize
operator|-
call|(
name|mng_int32
call|)
argument_list|(
name|pANG
operator|->
name|iNumframes
operator|*
name|iSize
argument_list|)
expr_stmt|;
do|do
block|{
if|if
condition|(
name|iTemplen
operator|>
name|pData
operator|->
name|iRowmax
condition|)
comment|/* get a pixel-row from the temp buffer */
block|{
name|MNG_COPY
argument_list|(
name|pData
operator|->
name|pWorkrow
argument_list|,
name|pTemp
argument_list|,
name|pData
operator|->
name|iRowmax
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|MNG_COPY
argument_list|(
name|pData
operator|->
name|pWorkrow
argument_list|,
name|pTemp
argument_list|,
name|iTemplen
argument_list|)
expr_stmt|;
block|}
block|{
comment|/* image not completed yet ? */
if|if
condition|(
name|pData
operator|->
name|iRow
operator|<
operator|(
name|mng_int32
operator|)
name|pData
operator|->
name|iDataheight
condition|)
block|{
ifdef|#
directive|ifdef
name|MNG_NO_1_2_4BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iPNGdepth
operator|==
literal|1
condition|)
block|{
comment|/* Inflate Workrow to 8-bit */
name|mng_int32
name|iX
decl_stmt|;
name|mng_uint8p
name|pSrc
init|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
decl_stmt|;
name|mng_uint8p
name|pDest
init|=
name|pSrc
operator|+
name|pData
operator|->
name|iRowsize
operator|-
operator|(
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
decl_stmt|;
for|for
control|(
name|iX
operator|=
operator|(
operator|(
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
operator|)
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
operator|*
name|pDest
operator|++
operator|=
operator|*
name|pSrc
operator|++
expr_stmt|;
name|pDest
operator|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
expr_stmt|;
name|pSrc
operator|=
name|pDest
operator|+
name|pData
operator|->
name|iRowsize
operator|-
operator|(
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
expr_stmt|;
for|for
control|(
name|iX
operator|=
name|pData
operator|->
name|iRowsize
init|;
condition|;
control|)
block|{
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|7
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|6
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|5
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|4
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|3
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|2
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|1
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
name|pSrc
operator|++
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|pData
operator|->
name|iPNGdepth
operator|==
literal|2
condition|)
block|{
comment|/* Inflate Workrow to 8-bit */
name|mng_int32
name|iX
decl_stmt|;
name|mng_uint8p
name|pSrc
init|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
decl_stmt|;
name|mng_uint8p
name|pDest
init|=
name|pSrc
operator|+
name|pData
operator|->
name|iRowsize
operator|-
operator|(
literal|2
operator|*
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
decl_stmt|;
for|for
control|(
name|iX
operator|=
operator|(
operator|(
literal|2
operator|*
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
operator|)
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
operator|*
name|pDest
operator|++
operator|=
operator|*
name|pSrc
operator|++
expr_stmt|;
name|pDest
operator|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
expr_stmt|;
name|pSrc
operator|=
name|pDest
operator|+
name|pData
operator|->
name|iRowsize
operator|-
operator|(
literal|2
operator|*
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
expr_stmt|;
for|for
control|(
name|iX
operator|=
name|pData
operator|->
name|iRowsize
init|;
condition|;
control|)
block|{
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|6
operator|)
operator|&
literal|3
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|4
operator|)
operator|&
literal|3
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|2
operator|)
operator|&
literal|3
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|)
operator|&
literal|3
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
name|pSrc
operator|++
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|pData
operator|->
name|iPNGdepth
operator|==
literal|4
condition|)
block|{
comment|/* Inflate Workrow to 8-bit */
name|mng_int32
name|iX
decl_stmt|;
name|mng_uint8p
name|pSrc
init|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
decl_stmt|;
name|mng_uint8p
name|pDest
init|=
name|pSrc
operator|+
name|pData
operator|->
name|iRowsize
operator|-
operator|(
literal|4
operator|*
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
decl_stmt|;
for|for
control|(
name|iX
operator|=
operator|(
operator|(
literal|4
operator|*
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
operator|)
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
operator|*
name|pDest
operator|++
operator|=
operator|*
name|pSrc
operator|++
expr_stmt|;
name|pDest
operator|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
expr_stmt|;
name|pSrc
operator|=
name|pDest
operator|+
name|pData
operator|->
name|iRowsize
operator|-
operator|(
literal|4
operator|*
name|pData
operator|->
name|iRowsize
operator|+
literal|7
operator|)
operator|/
literal|8
expr_stmt|;
for|for
control|(
name|iX
operator|=
name|pData
operator|->
name|iRowsize
init|;
condition|;
control|)
block|{
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|>>
literal|4
operator|)
operator|&
literal|0x0f
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
operator|*
name|pDest
operator|++
operator|=
operator|(
operator|(
operator|(
operator|*
name|pSrc
operator|)
operator|)
operator|&
literal|0x0f
operator|)
expr_stmt|;
if|if
condition|(
name|iX
operator|--
operator|<=
literal|0
condition|)
break|break;
name|pSrc
operator|++
expr_stmt|;
block|}
block|}
if|if
condition|(
name|pData
operator|->
name|iPNGdepth
operator|<
literal|8
operator|&&
name|pData
operator|->
name|iColortype
operator|==
literal|0
condition|)
block|{
comment|/* Expand samples to 8-bit by LBR */
name|mng_int32
name|iX
decl_stmt|;
name|mng_uint8p
name|pSrc
init|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
decl_stmt|;
name|mng_uint8
name|multiplier
index|[]
init|=
block|{
literal|0
block|,
literal|255
block|,
literal|85
block|,
literal|0
block|,
literal|17
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|}
decl_stmt|;
for|for
control|(
name|iX
operator|=
name|pData
operator|->
name|iRowsize
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
operator|*
name|pSrc
operator|++
operator|*=
name|multiplier
index|[
name|pData
operator|->
name|iPNGdepth
index|]
expr_stmt|;
block|}
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_NO_16BIT_SUPPORT
if|if
condition|(
name|pData
operator|->
name|iPNGdepth
operator|>
literal|8
condition|)
block|{
comment|/* Reduce Workrow to 8-bit */
name|mng_int32
name|iX
decl_stmt|;
name|mng_uint8p
name|pSrc
init|=
name|pData
operator|->
name|pWorkrow
operator|+
literal|1
decl_stmt|;
name|mng_uint8p
name|pDest
init|=
name|pSrc
decl_stmt|;
for|for
control|(
name|iX
operator|=
name|pData
operator|->
name|iRowsize
init|;
name|iX
operator|>
literal|0
condition|;
name|iX
operator|--
control|)
block|{
operator|*
name|pDest
operator|=
operator|*
name|pSrc
expr_stmt|;
name|pDest
operator|++
expr_stmt|;
name|pSrc
operator|+=
literal|2
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifdef|#
directive|ifdef
name|FILTER192
comment|/* has leveling info ? */
if|if
condition|(
name|pData
operator|->
name|iFilterofs
operator|==
name|MNG_FILTER_DIFFERING
condition|)
name|iRetcode
operator|=
name|init_rowdiffering
argument_list|(
name|pData
argument_list|)
expr_stmt|;
else|else
endif|#
directive|endif
name|iRetcode
operator|=
name|MNG_NOERROR
expr_stmt|;
comment|/* filter the row if necessary */
if|if
condition|(
operator|(
operator|!
name|iRetcode
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iFilterofs
operator|<
name|pData
operator|->
name|iPixelofs
operator|)
operator|&&
operator|(
operator|*
operator|(
name|pData
operator|->
name|pWorkrow
operator|+
name|pData
operator|->
name|iFilterofs
operator|)
operator|)
condition|)
name|iRetcode
operator|=
name|mng_filter_a_row
argument_list|(
name|pData
argument_list|)
expr_stmt|;
comment|/* additional leveling/differing ? */
if|if
condition|(
operator|(
operator|!
name|iRetcode
operator|)
operator|&&
operator|(
name|pData
operator|->
name|fDifferrow
operator|)
condition|)
block|{
name|iRetcode
operator|=
operator|(
operator|(
name|mng_differrow
operator|)
name|pData
operator|->
name|fDifferrow
operator|)
operator|(
name|pData
operator|)
expr_stmt|;
name|pSwap
operator|=
name|pData
operator|->
name|pWorkrow
expr_stmt|;
name|pData
operator|->
name|pWorkrow
operator|=
name|pData
operator|->
name|pPrevrow
expr_stmt|;
name|pData
operator|->
name|pPrevrow
operator|=
name|pSwap
expr_stmt|;
comment|/* make sure we're processing the right data */
block|}
if|if
condition|(
operator|!
name|iRetcode
condition|)
block|{
block|{
comment|/* process this row */
if|if
condition|(
operator|(
operator|!
name|iRetcode
operator|)
operator|&&
operator|(
name|pData
operator|->
name|fProcessrow
operator|)
condition|)
name|iRetcode
operator|=
operator|(
operator|(
name|mng_processrow
operator|)
name|pData
operator|->
name|fProcessrow
operator|)
operator|(
name|pData
operator|)
expr_stmt|;
comment|/* store in object ? */
if|if
condition|(
operator|(
operator|!
name|iRetcode
operator|)
operator|&&
operator|(
name|pData
operator|->
name|fStorerow
operator|)
condition|)
name|iRetcode
operator|=
operator|(
operator|(
name|mng_storerow
operator|)
name|pData
operator|->
name|fStorerow
operator|)
operator|(
name|pData
operator|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
block|{
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|iRetcode
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|pData
operator|->
name|fDifferrow
condition|)
comment|/* swap row-pointers */
block|{
name|pSwap
operator|=
name|pData
operator|->
name|pWorkrow
expr_stmt|;
name|pData
operator|->
name|pWorkrow
operator|=
name|pData
operator|->
name|pPrevrow
expr_stmt|;
name|pData
operator|->
name|pPrevrow
operator|=
name|pSwap
expr_stmt|;
comment|/* so prev points to the processed row! */
block|}
comment|/* adjust variables for next row */
name|iRetcode
operator|=
name|mng_next_row
argument_list|(
name|pData
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
comment|/* on error bail out */
block|{
name|MNG_FREEX
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|iRetcode
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|pTemp
operator|+=
name|pData
operator|->
name|iRowmax
expr_stmt|;
name|iTemplen
operator|-=
name|pData
operator|->
name|iRowmax
expr_stmt|;
block|}
comment|/* until some error or EOI                                           or all pixels received */
do|while
condition|(
operator|(
name|iTemplen
operator|>
literal|0
operator|)
operator|&&
operator|(
operator|(
name|pData
operator|->
name|iRow
operator|<
operator|(
name|mng_int32
operator|)
name|pData
operator|->
name|iDataheight
operator|)
operator|||
operator|(
operator|(
name|pData
operator|->
name|iPass
operator|>=
literal|0
operator|)
operator|&&
operator|(
name|pData
operator|->
name|iPass
operator|<
literal|7
operator|)
operator|)
operator|)
condition|)
do|;
name|mng_cleanup_rowproc
argument_list|(
name|pData
argument_list|)
expr_stmt|;
comment|/* cleanup row processing buffers !! */
comment|/* restore saved work-parms */
name|pData
operator|->
name|iDatawidth
operator|=
name|iSavedatawidth
expr_stmt|;
name|pData
operator|->
name|iDataheight
operator|=
name|iSavedataheight
expr_stmt|;
name|pData
operator|->
name|fInitrowproc
operator|=
name|fSaveinitrowproc
expr_stmt|;
name|pData
operator|->
name|fDisplayrow
operator|=
name|fSavestorerow
expr_stmt|;
name|pData
operator|->
name|fProcessrow
operator|=
name|fSaveprocessrow
expr_stmt|;
name|pData
operator|->
name|fDifferrow
operator|=
name|fSavedifferrow
expr_stmt|;
name|pData
operator|->
name|pStoreobj
operator|=
name|fSavestoreobj
expr_stmt|;
name|pData
operator|->
name|pStorebuf
operator|=
name|fSavestorebuf
expr_stmt|;
ifdef|#
directive|ifdef
name|MNG_OPTIMIZE_FOOTPRINT_INIT
name|pData
operator|->
name|ePng_imgtype
operator|=
name|eSavepngimgtype
expr_stmt|;
endif|#
directive|endif
name|pData
operator|->
name|iInterlace
operator|=
name|iSaveinterlace
expr_stmt|;
name|pData
operator|->
name|iPass
operator|=
name|iSavepass
expr_stmt|;
name|pData
operator|->
name|iRow
operator|=
name|iSaverow
expr_stmt|;
name|pData
operator|->
name|iRowinc
operator|=
name|iSaverowinc
expr_stmt|;
name|pData
operator|->
name|iCol
operator|=
name|iSavecol
expr_stmt|;
name|pData
operator|->
name|iColinc
operator|=
name|iSavecolinc
expr_stmt|;
name|pData
operator|->
name|iRowsamples
operator|=
name|iSaverowsamples
expr_stmt|;
name|pData
operator|->
name|iSamplemul
operator|=
name|iSavesamplemul
expr_stmt|;
name|pData
operator|->
name|iSampleofs
operator|=
name|iSavesampleofs
expr_stmt|;
name|pData
operator|->
name|iSamplediv
operator|=
name|iSavesamplediv
expr_stmt|;
name|pData
operator|->
name|iRowsize
operator|=
name|iSaverowsize
expr_stmt|;
name|pData
operator|->
name|iRowmax
operator|=
name|iSaverowmax
expr_stmt|;
name|pData
operator|->
name|iFilterofs
operator|=
name|iSavefilterofs
expr_stmt|;
name|pData
operator|->
name|iPixelofs
operator|=
name|iSavepixelofs
expr_stmt|;
name|pData
operator|->
name|iLevel0
operator|=
name|iSavelevel0
expr_stmt|;
name|pData
operator|->
name|iLevel1
operator|=
name|iSavelevel1
expr_stmt|;
name|pData
operator|->
name|iLevel2
operator|=
name|iSavelevel2
expr_stmt|;
name|pData
operator|->
name|iLevel3
operator|=
name|iSavelevel3
expr_stmt|;
name|pData
operator|->
name|pWorkrow
operator|=
name|pSaveworkrow
expr_stmt|;
name|pData
operator|->
name|pPrevrow
operator|=
name|pSaveprevrow
expr_stmt|;
name|pData
operator|->
name|pRGBArow
operator|=
name|pSaverGBArow
expr_stmt|;
name|pData
operator|->
name|bIsRGBA16
operator|=
name|bSaveisRGBA16
expr_stmt|;
name|pData
operator|->
name|bIsOpaque
operator|=
name|bSaveisOpaque
expr_stmt|;
name|pData
operator|->
name|iFilterbpp
operator|=
name|iSavefilterbpp
expr_stmt|;
name|pData
operator|->
name|iDestl
operator|=
name|iSavedestl
expr_stmt|;
name|pData
operator|->
name|iDestt
operator|=
name|iSavedestt
expr_stmt|;
name|pData
operator|->
name|iDestr
operator|=
name|iSavedestr
expr_stmt|;
name|pData
operator|->
name|iDestb
operator|=
name|iSavedestb
expr_stmt|;
name|pData
operator|->
name|iSourcel
operator|=
name|iSavesourcel
expr_stmt|;
name|pData
operator|->
name|iSourcet
operator|=
name|iSavesourcet
expr_stmt|;
name|pData
operator|->
name|iSourcer
operator|=
name|iSavesourcer
expr_stmt|;
name|pData
operator|->
name|iSourceb
operator|=
name|iSavesourceb
expr_stmt|;
comment|/* create the animation directives ! */
name|pProcess
operator|=
operator|(
name|mng_processobject
operator|)
name|pANG
operator|->
name|sHeader
operator|.
name|fProcess
expr_stmt|;
name|iRetcode
operator|=
name|pProcess
argument_list|(
name|pData
argument_list|,
operator|(
name|mng_objectp
operator|)
name|pData
operator|->
name|pANG
argument_list|)
expr_stmt|;
if|if
condition|(
name|iRetcode
condition|)
return|return
name|iRetcode
return|;
endif|#
directive|endif
comment|/* MNG_SUPPORT_DISPLAY */
name|MNG_FREE
argument_list|(
name|pData
argument_list|,
name|pBuf
argument_list|,
name|iBufsize
argument_list|)
expr_stmt|;
comment|/* always free the temp buffer ! */
block|}
operator|*
name|piRawlen
operator|=
literal|0
expr_stmt|;
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_ifdef
ifdef|#
directive|ifdef
name|MNG_INCLUDE_ANG_PROPOSAL
end_ifdef
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_adat
argument_list|)
end_macro
begin_block
block|{
return|return
name|MNG_NOERROR
return|;
block|}
end_block
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_macro
DECL|function|MNG_C_SPECIALFUNC
name|MNG_C_SPECIALFUNC
argument_list|(
argument|mng_special_unknown
argument_list|)
end_macro
begin_block
block|{
comment|/* critical chunk ? */
if|if
condition|(
operator|(
operator|(
operator|(
name|mng_uint32
operator|)
name|pData
operator|->
name|iChunkname
operator|&
literal|0x20000000
operator|)
operator|==
literal|0
operator|)
ifdef|#
directive|ifdef
name|MNG_SKIPCHUNK_SAVE
operator|&&
operator|(
name|pData
operator|->
name|iChunkname
operator|!=
name|MNG_UINT_SAVE
operator|)
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_SKIPCHUNK_SEEK
operator|&&
operator|(
name|pData
operator|->
name|iChunkname
operator|!=
name|MNG_UINT_SEEK
operator|)
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_SKIPCHUNK_DBYK
operator|&&
operator|(
name|pData
operator|->
name|iChunkname
operator|!=
name|MNG_UINT_DBYK
operator|)
endif|#
directive|endif
ifdef|#
directive|ifdef
name|MNG_SKIPCHUNK_ORDR
operator|&&
operator|(
name|pData
operator|->
name|iChunkname
operator|!=
name|MNG_UINT_ORDR
operator|)
endif|#
directive|endif
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_UNKNOWNCRITICAL
argument_list|)
expr_stmt|;
if|if
condition|(
name|pData
operator|->
name|fProcessunknown
condition|)
comment|/* let the app handle it ? */
block|{
name|mng_bool
name|bOke
init|=
name|pData
operator|->
name|fProcessunknown
argument_list|(
operator|(
name|mng_handle
operator|)
name|pData
argument_list|,
name|pData
operator|->
name|iChunkname
argument_list|,
operator|(
operator|(
name|mng_unknown_chunkp
operator|)
name|pChunk
operator|)
operator|->
name|iDatasize
argument_list|,
operator|(
operator|(
name|mng_unknown_chunkp
operator|)
name|pChunk
operator|)
operator|->
name|pData
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|bOke
condition|)
name|MNG_ERROR
argument_list|(
name|pData
argument_list|,
name|MNG_APPMISCERROR
argument_list|)
expr_stmt|;
block|}
return|return
name|MNG_NOERROR
return|;
comment|/* done */
block|}
end_block
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_INCLUDE_READ_PROCS || MNG_INCLUDE_WRITE_PROCS */
end_comment
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|/* MNG_OPTIMIZE_CHUNKREADER */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
begin_comment
comment|/* * end of file                                                            * */
end_comment
begin_comment
comment|/* ************************************************************************** */
end_comment
end_unit
