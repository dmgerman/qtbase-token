begin_unit
begin_comment
comment|/*  * Copyright (C) 2000  Red Hat, Inc.  *  * This is part of HarfBuzz, an OpenType Layout engine library.  *  * Permission is hereby granted, without written agreement and without  * license or royalty fees, to use, copy, modify, and distribute this  * software and its documentation for any purpose, provided that the  * above copyright notice and the following two paragraphs appear in  * all copies of this software.  *  * IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE TO ANY PARTY FOR  * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES  * ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN  * IF THE COPYRIGHT HOLDER HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH  * DAMAGE.  *  * THE COPYRIGHT HOLDER SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING,  * BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  * FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE PROVIDED HEREUNDER IS  * ON AN "AS IS" BASIS, AND THE COPYRIGHT HOLDER HAS NO OBLIGATION TO  * PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.  *  * Red Hat Author(s): Owen Taylor  */
end_comment
begin_include
include|#
directive|include
file|<stdio.h>
end_include
begin_include
include|#
directive|include
file|<stdlib.h>
end_include
begin_include
include|#
directive|include
file|"harfbuzz.h"
end_include
begin_include
include|#
directive|include
file|"harfbuzz-dump.h"
end_include
begin_define
DECL|macro|N_ELEMENTS
define|#
directive|define
name|N_ELEMENTS
parameter_list|(
name|arr
parameter_list|)
value|(sizeof(arr)/ sizeof((arr)[0]))
end_define
begin_function
specifier|static
name|int
DECL|function|croak
name|croak
parameter_list|(
specifier|const
name|char
modifier|*
name|situation
parameter_list|,
name|HB_Error
name|error
parameter_list|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Error %d\n"
argument_list|,
name|situation
argument_list|,
name|error
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
name|int
DECL|function|main
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
modifier|*
name|argv
parameter_list|)
block|{
name|HB_Error
name|error
decl_stmt|;
name|FT_Library
name|library
decl_stmt|;
name|HB_Font
name|font
decl_stmt|;
name|HB_GSUB
name|gsub
decl_stmt|;
name|HB_GPOS
name|gpos
decl_stmt|;
if|if
condition|(
name|argc
operator|!=
literal|2
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Usage: harfbuzz-dump MYFONT.TTF\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|error
operator|=
name|FT_Init_FreeType
argument_list|(
operator|&
name|library
argument_list|)
operator|)
condition|)
name|croak
argument_list|(
literal|"FT_Init_FreeType"
argument_list|,
name|error
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|FT_New_Face
argument_list|(
name|library
argument_list|,
name|argv
index|[
literal|1
index|]
argument_list|,
literal|0
argument_list|,
operator|&
name|font
argument_list|)
operator|)
condition|)
name|croak
argument_list|(
literal|"FT_New_Face"
argument_list|,
name|error
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"<?xml version=\"1.0\"?>\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"<OpenType>\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|error
operator|=
name|HB_Load_GSUB_Table
argument_list|(
name|font
argument_list|,
operator|&
name|gsub
argument_list|,
name|NULL
argument_list|)
operator|)
condition|)
block|{
name|HB_Dump_GSUB_Table
argument_list|(
name|gsub
argument_list|,
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|HB_Done_GSUB_Table
argument_list|(
name|gsub
argument_list|)
operator|)
condition|)
name|croak
argument_list|(
literal|"HB_Done_GSUB_Table"
argument_list|,
name|error
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|error
operator|!=
name|HB_Err_Not_Covered
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"HB_Load_GSUB_Table: error 0x%x\n"
argument_list|,
name|error
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|error
operator|=
name|HB_Load_GPOS_Table
argument_list|(
name|font
argument_list|,
operator|&
name|gpos
argument_list|,
name|NULL
argument_list|)
operator|)
condition|)
block|{
name|HB_Dump_GPOS_Table
argument_list|(
name|gpos
argument_list|,
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|HB_Done_GPOS_Table
argument_list|(
name|gpos
argument_list|)
operator|)
condition|)
name|croak
argument_list|(
literal|"HB_Done_GPOS_Table"
argument_list|,
name|error
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|error
operator|!=
name|HB_Err_Not_Covered
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"HB_Load_GPOS_Table: error 0x%x\n"
argument_list|,
name|error
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"</OpenType>\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|FT_Done_Face
argument_list|(
name|font
argument_list|)
operator|)
condition|)
name|croak
argument_list|(
literal|"FT_Done_Face"
argument_list|,
name|error
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|FT_Done_FreeType
argument_list|(
name|library
argument_list|)
operator|)
condition|)
name|croak
argument_list|(
literal|"FT_Done_FreeType"
argument_list|,
name|error
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function
end_unit
