begin_unit
begin_comment
comment|/* The Keccak sponge function, designed by Guido Bertoni, Joan Daemen, MichaÃ«l Peeters and Gilles Van Assche. For more information, feedback or questions, please refer to our website: http://keccak.noekeon.org/  Implementation by the designers, hereby denoted as "the implementer".  To the extent possible under law, the implementer has waived all copyright and related or neighboring rights to the source code in this file. http://creativecommons.org/publicdomain/zero/1.0/ */
end_comment
begin_include
include|#
directive|include
file|<string.h>
end_include
begin_include
include|#
directive|include
file|"brg_endian.h"
end_include
begin_include
include|#
directive|include
file|"KeccakF-1600-opt64-settings.h"
end_include
begin_include
include|#
directive|include
file|"KeccakF-1600-interface.h"
end_include
begin_typedef
DECL|typedef|UINT8
typedef|typedef
name|unsigned
name|char
name|UINT8
typedef|;
end_typedef
begin_typedef
DECL|typedef|UINT64
typedef|typedef
name|unsigned
name|long
name|long
name|int
name|UINT64
typedef|;
end_typedef
begin_if
if|#
directive|if
name|defined
argument_list|(
name|UseSSE
argument_list|)
operator|||
name|defined
argument_list|(
name|UseXOP
argument_list|)
end_if
begin_if
if|#
directive|if
name|defined
argument_list|(
name|__GNUC__
argument_list|)
end_if
begin_define
DECL|macro|ALIGN
define|#
directive|define
name|ALIGN
value|__attribute__ ((aligned(32)))
end_define
begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|_MSC_VER
argument_list|)
end_elif
begin_define
DECL|macro|ALIGN
define|#
directive|define
name|ALIGN
value|__declspec(align(32))
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_ifndef
ifndef|#
directive|ifndef
name|ALIGN
end_ifndef
begin_define
DECL|macro|ALIGN
define|#
directive|define
name|ALIGN
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_if
if|#
directive|if
name|defined
argument_list|(
name|UseSSE
argument_list|)
end_if
begin_include
include|#
directive|include
file|<x86intrin.h>
end_include
begin_typedef
DECL|typedef|V64
typedef|typedef
name|__m128i
name|V64
typedef|;
end_typedef
begin_typedef
DECL|typedef|V128
typedef|typedef
name|__m128i
name|V128
typedef|;
end_typedef
begin_typedef
typedef|typedef
union|union
block|{
DECL|member|v128
name|V128
name|v128
decl_stmt|;
DECL|member|v64
name|UINT64
name|v64
index|[
literal|2
index|]
decl_stmt|;
block|}
DECL|typedef|V6464
name|V6464
typedef|;
end_typedef
begin_define
DECL|macro|ANDnu64
define|#
directive|define
name|ANDnu64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_andnot_si128(a, b)
end_define
begin_define
DECL|macro|LOAD64
define|#
directive|define
name|LOAD64
parameter_list|(
name|a
parameter_list|)
value|_mm_loadl_epi64((const V64 *)&(a))
end_define
begin_define
DECL|macro|CONST64
define|#
directive|define
name|CONST64
parameter_list|(
name|a
parameter_list|)
value|_mm_loadl_epi64((const V64 *)&(a))
end_define
begin_define
DECL|macro|ROL64
define|#
directive|define
name|ROL64
parameter_list|(
name|a
parameter_list|,
name|o
parameter_list|)
value|_mm_or_si128(_mm_slli_epi64(a, o), _mm_srli_epi64(a, 64-(o)))
end_define
begin_define
DECL|macro|STORE64
define|#
directive|define
name|STORE64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_storel_epi64((V64 *)&(a), b)
end_define
begin_define
DECL|macro|XOR64
define|#
directive|define
name|XOR64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|XOReq64
define|#
directive|define
name|XOReq64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|a = _mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|SHUFFLEBYTES128
define|#
directive|define
name|SHUFFLEBYTES128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_shuffle_epi8(a, b)
end_define
begin_define
DECL|macro|ANDnu128
define|#
directive|define
name|ANDnu128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_andnot_si128(a, b)
end_define
begin_define
DECL|macro|LOAD6464
define|#
directive|define
name|LOAD6464
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_set_epi64((__m64)(a), (__m64)(b))
end_define
begin_define
DECL|macro|CONST128
define|#
directive|define
name|CONST128
parameter_list|(
name|a
parameter_list|)
value|_mm_load_si128((const V128 *)&(a))
end_define
begin_define
DECL|macro|LOAD128
define|#
directive|define
name|LOAD128
parameter_list|(
name|a
parameter_list|)
value|_mm_load_si128((const V128 *)&(a))
end_define
begin_define
DECL|macro|LOAD128u
define|#
directive|define
name|LOAD128u
parameter_list|(
name|a
parameter_list|)
value|_mm_loadu_si128((const V128 *)&(a))
end_define
begin_define
DECL|macro|ROL64in128
define|#
directive|define
name|ROL64in128
parameter_list|(
name|a
parameter_list|,
name|o
parameter_list|)
value|_mm_or_si128(_mm_slli_epi64(a, o), _mm_srli_epi64(a, 64-(o)))
end_define
begin_define
DECL|macro|STORE128
define|#
directive|define
name|STORE128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_store_si128((V128 *)&(a), b)
end_define
begin_define
DECL|macro|XOR128
define|#
directive|define
name|XOR128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|XOReq128
define|#
directive|define
name|XOReq128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|a = _mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|GET64LOLO
define|#
directive|define
name|GET64LOLO
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_unpacklo_epi64(a, b)
end_define
begin_define
DECL|macro|GET64HIHI
define|#
directive|define
name|GET64HIHI
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_unpackhi_epi64(a, b)
end_define
begin_define
DECL|macro|COPY64HI2LO
define|#
directive|define
name|COPY64HI2LO
parameter_list|(
name|a
parameter_list|)
value|_mm_shuffle_epi32(a, 0xEE)
end_define
begin_define
DECL|macro|COPY64LO2HI
define|#
directive|define
name|COPY64LO2HI
parameter_list|(
name|a
parameter_list|)
value|_mm_shuffle_epi32(a, 0x44)
end_define
begin_define
DECL|macro|ZERO128
define|#
directive|define
name|ZERO128
parameter_list|()
value|_mm_setzero_si128()
end_define
begin_ifdef
ifdef|#
directive|ifdef
name|UseOnlySIMD64
end_ifdef
begin_include
include|#
directive|include
file|"KeccakF-1600-simd64.macros"
end_include
begin_else
else|#
directive|else
end_else
begin_decl_stmt
DECL|variable|rho8_56
name|ALIGN
specifier|const
name|UINT64
name|rho8_56
index|[
literal|2
index|]
init|=
block|{
literal|0x0605040302010007
block|,
literal|0x080F0E0D0C0B0A09
block|}
decl_stmt|;
end_decl_stmt
begin_include
include|#
directive|include
file|"KeccakF-1600-simd128.macros"
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|UseBebigokimisa
end_ifdef
begin_error
error|#
directive|error
literal|"UseBebigokimisa cannot be used in combination with UseSSE"
end_error
begin_endif
endif|#
directive|endif
end_endif
begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|UseXOP
argument_list|)
end_elif
begin_include
include|#
directive|include
file|<x86intrin.h>
end_include
begin_typedef
DECL|typedef|V64
typedef|typedef
name|__m128i
name|V64
typedef|;
end_typedef
begin_typedef
DECL|typedef|V128
typedef|typedef
name|__m128i
name|V128
typedef|;
end_typedef
begin_define
DECL|macro|LOAD64
define|#
directive|define
name|LOAD64
parameter_list|(
name|a
parameter_list|)
value|_mm_loadl_epi64((const V64 *)&(a))
end_define
begin_define
DECL|macro|CONST64
define|#
directive|define
name|CONST64
parameter_list|(
name|a
parameter_list|)
value|_mm_loadl_epi64((const V64 *)&(a))
end_define
begin_define
DECL|macro|STORE64
define|#
directive|define
name|STORE64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_storel_epi64((V64 *)&(a), b)
end_define
begin_define
DECL|macro|XOR64
define|#
directive|define
name|XOR64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|XOReq64
define|#
directive|define
name|XOReq64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|a = _mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|ANDnu128
define|#
directive|define
name|ANDnu128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_andnot_si128(a, b)
end_define
begin_define
DECL|macro|LOAD6464
define|#
directive|define
name|LOAD6464
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_set_epi64((__m64)(a), (__m64)(b))
end_define
begin_define
DECL|macro|CONST128
define|#
directive|define
name|CONST128
parameter_list|(
name|a
parameter_list|)
value|_mm_load_si128((const V128 *)&(a))
end_define
begin_define
DECL|macro|LOAD128
define|#
directive|define
name|LOAD128
parameter_list|(
name|a
parameter_list|)
value|_mm_load_si128((const V128 *)&(a))
end_define
begin_define
DECL|macro|LOAD128u
define|#
directive|define
name|LOAD128u
parameter_list|(
name|a
parameter_list|)
value|_mm_loadu_si128((const V128 *)&(a))
end_define
begin_define
DECL|macro|STORE128
define|#
directive|define
name|STORE128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_store_si128((V128 *)&(a), b)
end_define
begin_define
DECL|macro|XOR128
define|#
directive|define
name|XOR128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|XOReq128
define|#
directive|define
name|XOReq128
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|a = _mm_xor_si128(a, b)
end_define
begin_define
DECL|macro|ZERO128
define|#
directive|define
name|ZERO128
parameter_list|()
value|_mm_setzero_si128()
end_define
begin_define
DECL|macro|SWAP64
define|#
directive|define
name|SWAP64
parameter_list|(
name|a
parameter_list|)
value|_mm_shuffle_epi32(a, 0x4E)
end_define
begin_define
DECL|macro|GET64LOLO
define|#
directive|define
name|GET64LOLO
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_unpacklo_epi64(a, b)
end_define
begin_define
DECL|macro|GET64HIHI
define|#
directive|define
name|GET64HIHI
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_unpackhi_epi64(a, b)
end_define
begin_define
DECL|macro|GET64LOHI
define|#
directive|define
name|GET64LOHI
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|((__m128i)_mm_blend_pd((__m128d)a, (__m128d)b, 2))
end_define
begin_define
DECL|macro|GET64HILO
define|#
directive|define
name|GET64HILO
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|SWAP64(GET64LOHI(b, a))
end_define
begin_define
DECL|macro|COPY64HI2LO
define|#
directive|define
name|COPY64HI2LO
parameter_list|(
name|a
parameter_list|)
value|_mm_shuffle_epi32(a, 0xEE)
end_define
begin_define
DECL|macro|COPY64LO2HI
define|#
directive|define
name|COPY64LO2HI
parameter_list|(
name|a
parameter_list|)
value|_mm_shuffle_epi32(a, 0x44)
end_define
begin_define
DECL|macro|ROL6464same
define|#
directive|define
name|ROL6464same
parameter_list|(
name|a
parameter_list|,
name|o
parameter_list|)
value|_mm_roti_epi64(a, o)
end_define
begin_define
DECL|macro|ROL6464
define|#
directive|define
name|ROL6464
parameter_list|(
name|a
parameter_list|,
name|r1
parameter_list|,
name|r2
parameter_list|)
value|_mm_rot_epi64(a, CONST128( rot_##r1##_##r2 ))
end_define
begin_decl_stmt
DECL|variable|rot_0_20
name|ALIGN
specifier|const
name|UINT64
name|rot_0_20
index|[
literal|2
index|]
init|=
block|{
literal|0
block|,
literal|20
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_44_3
name|ALIGN
specifier|const
name|UINT64
name|rot_44_3
index|[
literal|2
index|]
init|=
block|{
literal|44
block|,
literal|3
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_43_45
name|ALIGN
specifier|const
name|UINT64
name|rot_43_45
index|[
literal|2
index|]
init|=
block|{
literal|43
block|,
literal|45
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_21_61
name|ALIGN
specifier|const
name|UINT64
name|rot_21_61
index|[
literal|2
index|]
init|=
block|{
literal|21
block|,
literal|61
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_14_28
name|ALIGN
specifier|const
name|UINT64
name|rot_14_28
index|[
literal|2
index|]
init|=
block|{
literal|14
block|,
literal|28
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_1_36
name|ALIGN
specifier|const
name|UINT64
name|rot_1_36
index|[
literal|2
index|]
init|=
block|{
literal|1
block|,
literal|36
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_6_10
name|ALIGN
specifier|const
name|UINT64
name|rot_6_10
index|[
literal|2
index|]
init|=
block|{
literal|6
block|,
literal|10
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_25_15
name|ALIGN
specifier|const
name|UINT64
name|rot_25_15
index|[
literal|2
index|]
init|=
block|{
literal|25
block|,
literal|15
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_8_56
name|ALIGN
specifier|const
name|UINT64
name|rot_8_56
index|[
literal|2
index|]
init|=
block|{
literal|8
block|,
literal|56
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_18_27
name|ALIGN
specifier|const
name|UINT64
name|rot_18_27
index|[
literal|2
index|]
init|=
block|{
literal|18
block|,
literal|27
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_62_55
name|ALIGN
specifier|const
name|UINT64
name|rot_62_55
index|[
literal|2
index|]
init|=
block|{
literal|62
block|,
literal|55
block|}
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|rot_39_41
name|ALIGN
specifier|const
name|UINT64
name|rot_39_41
index|[
literal|2
index|]
init|=
block|{
literal|39
block|,
literal|41
block|}
decl_stmt|;
end_decl_stmt
begin_if
if|#
directive|if
name|defined
argument_list|(
name|UseSimulatedXOP
argument_list|)
end_if
begin_comment
comment|// For debugging purposes, when XOP is not available
end_comment
begin_undef
DECL|macro|ROL6464
undef|#
directive|undef
name|ROL6464
end_undef
begin_undef
DECL|macro|ROL6464same
undef|#
directive|undef
name|ROL6464same
end_undef
begin_define
DECL|macro|ROL6464same
define|#
directive|define
name|ROL6464same
parameter_list|(
name|a
parameter_list|,
name|o
parameter_list|)
value|_mm_or_si128(_mm_slli_epi64(a, o), _mm_srli_epi64(a, 64-(o)))
end_define
begin_function
DECL|function|ROL6464
name|V128
name|ROL6464
parameter_list|(
name|V128
name|a
parameter_list|,
name|int
name|r0
parameter_list|,
name|int
name|r1
parameter_list|)
block|{
name|V128
name|a0
init|=
name|ROL64
argument_list|(
name|a
argument_list|,
name|r0
argument_list|)
decl_stmt|;
name|V128
name|a1
init|=
name|COPY64HI2LO
argument_list|(
name|ROL64
argument_list|(
name|a
argument_list|,
name|r1
argument_list|)
argument_list|)
decl_stmt|;
return|return
name|GET64LOLO
argument_list|(
name|a0
argument_list|,
name|a1
argument_list|)
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"KeccakF-1600-xop.macros"
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|UseBebigokimisa
end_ifdef
begin_error
error|#
directive|error
literal|"UseBebigokimisa cannot be used in combination with UseXOP"
end_error
begin_endif
endif|#
directive|endif
end_endif
begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|UseMMX
argument_list|)
end_elif
begin_include
include|#
directive|include
file|<mmintrin.h>
end_include
begin_typedef
DECL|typedef|V64
typedef|typedef
name|__m64
name|V64
typedef|;
end_typedef
begin_define
DECL|macro|ANDnu64
define|#
directive|define
name|ANDnu64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_andnot_si64(a, b)
end_define
begin_if
if|#
directive|if
operator|(
name|defined
argument_list|(
name|_MSC_VER
argument_list|)
operator|||
name|defined
argument_list|(
name|__INTEL_COMPILER
argument_list|)
operator|)
end_if
begin_define
DECL|macro|LOAD64
define|#
directive|define
name|LOAD64
parameter_list|(
name|a
parameter_list|)
value|*(V64*)&(a)
end_define
begin_define
DECL|macro|CONST64
define|#
directive|define
name|CONST64
parameter_list|(
name|a
parameter_list|)
value|*(V64*)&(a)
end_define
begin_define
DECL|macro|STORE64
define|#
directive|define
name|STORE64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|*(V64*)&(a) = b
end_define
begin_else
else|#
directive|else
end_else
begin_define
DECL|macro|LOAD64
define|#
directive|define
name|LOAD64
parameter_list|(
name|a
parameter_list|)
value|(V64)a
end_define
begin_define
DECL|macro|CONST64
define|#
directive|define
name|CONST64
parameter_list|(
name|a
parameter_list|)
value|(V64)a
end_define
begin_define
DECL|macro|STORE64
define|#
directive|define
name|STORE64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|a = (UINT64)b
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_define
DECL|macro|ROL64
define|#
directive|define
name|ROL64
parameter_list|(
name|a
parameter_list|,
name|o
parameter_list|)
value|_mm_or_si64(_mm_slli_si64(a, o), _mm_srli_si64(a, 64-(o)))
end_define
begin_define
DECL|macro|XOR64
define|#
directive|define
name|XOR64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|_mm_xor_si64(a, b)
end_define
begin_define
DECL|macro|XOReq64
define|#
directive|define
name|XOReq64
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|a = _mm_xor_si64(a, b)
end_define
begin_include
include|#
directive|include
file|"KeccakF-1600-simd64.macros"
end_include
begin_ifdef
ifdef|#
directive|ifdef
name|UseBebigokimisa
end_ifdef
begin_error
error|#
directive|error
literal|"UseBebigokimisa cannot be used in combination with UseMMX"
end_error
begin_endif
endif|#
directive|endif
end_endif
begin_else
else|#
directive|else
end_else
begin_if
if|#
directive|if
name|defined
argument_list|(
name|_MSC_VER
argument_list|)
end_if
begin_define
DECL|macro|ROL64
define|#
directive|define
name|ROL64
parameter_list|(
name|a
parameter_list|,
name|offset
parameter_list|)
value|_rotl64(a, offset)
end_define
begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|UseSHLD
argument_list|)
end_elif
begin_define
DECL|macro|ROL64
define|#
directive|define
name|ROL64
parameter_list|(
name|x
parameter_list|,
name|N
parameter_list|)
value|({ \         register UINT64 __out; \         register UINT64 __in = x; \         __asm__ ("shld %2,%0,%0" : "=r"(__out) : "0"(__in), "i"(N)); \         __out; \       })
end_define
begin_else
else|#
directive|else
end_else
begin_define
DECL|macro|ROL64
define|#
directive|define
name|ROL64
parameter_list|(
name|a
parameter_list|,
name|offset
parameter_list|)
value|((((UINT64)a)<< offset) ^ (((UINT64)a)>> (64-offset)))
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"KeccakF-1600-64.macros"
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"KeccakF-1600-unrolling.macros"
end_include
begin_function
DECL|function|KeccakPermutationOnWords
specifier|static
name|void
name|KeccakPermutationOnWords
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|unsigned
name|int
name|j
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|laneCount
condition|;
name|j
operator|++
control|)
name|state
index|[
name|j
index|]
operator|^=
name|input
index|[
name|j
index|]
expr_stmt|;
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast576
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring576bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring576bits
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromStateAndXor576bits
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast832
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring832bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring832bits
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromStateAndXor832bits
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1024bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1024bits
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromStateAndXor1024bits
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1088
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1088bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1088bits
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromStateAndXor1088bits
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1152
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1152bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1152bits
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromStateAndXor1152bits
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1344
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1344bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1344bits
parameter_list|(
name|UINT64
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT64
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromStateAndXor1344bits
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
if|#
directive|if
name|defined
argument_list|(
name|UseMMX
argument_list|)
name|_mm_empty
parameter_list|()
function_decl|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakInitialize
specifier|static
name|void
name|KeccakInitialize
parameter_list|()
block|{ }
end_function
begin_function
DECL|function|KeccakInitializeState
specifier|static
name|void
name|KeccakInitializeState
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|)
block|{
name|memset
argument_list|(
name|state
argument_list|,
literal|0
argument_list|,
literal|200
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|UseBebigokimisa
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
literal|1
index|]
operator|=
operator|~
operator|(
name|UINT64
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
literal|2
index|]
operator|=
operator|~
operator|(
name|UINT64
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
literal|8
index|]
operator|=
operator|~
operator|(
name|UINT64
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
literal|12
index|]
operator|=
operator|~
operator|(
name|UINT64
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
literal|17
index|]
operator|=
operator|~
operator|(
name|UINT64
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
literal|20
index|]
operator|=
operator|~
operator|(
name|UINT64
operator|)
literal|0
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|KeccakPermutation
specifier|static
name|void
name|KeccakPermutation
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|)
block|{
comment|// We assume the state is always stored as words
name|KeccakPermutationOnWords
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|)
expr_stmt|;
block|}
end_function
begin_if
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_BIG_ENDIAN
operator|)
end_if
begin_function
DECL|function|fromBytesToWord
specifier|static
name|void
name|fromBytesToWord
parameter_list|(
name|UINT64
modifier|*
name|word
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|bytes
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|;
operator|*
name|word
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
operator|(
literal|64
operator|/
literal|8
operator|)
condition|;
name|i
operator|++
control|)
operator|*
name|word
operator||=
call|(
name|UINT64
call|)
argument_list|(
name|bytes
index|[
name|i
index|]
argument_list|)
operator|<<
operator|(
literal|8
operator|*
name|i
operator|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast576
end_ifdef
begin_function
DECL|function|KeccakAbsorb576bits
specifier|static
name|void
name|KeccakAbsorb576bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring576bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|9
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|9
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring576bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast832
end_ifdef
begin_function
DECL|function|KeccakAbsorb832bits
specifier|static
name|void
name|KeccakAbsorb832bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring832bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|13
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|13
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring832bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakAbsorb1024bits
specifier|static
name|void
name|KeccakAbsorb1024bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring1024bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|16
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring1024bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1088
end_ifdef
begin_function
DECL|function|KeccakAbsorb1088bits
specifier|static
name|void
name|KeccakAbsorb1088bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring1088bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|17
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|17
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring1088bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1152
end_ifdef
begin_function
DECL|function|KeccakAbsorb1152bits
specifier|static
name|void
name|KeccakAbsorb1152bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring1152bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|18
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|18
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring1152bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1344
end_ifdef
begin_function
DECL|function|KeccakAbsorb1344bits
specifier|static
name|void
name|KeccakAbsorb1344bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring1344bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|21
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|21
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring1344bits
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakAbsorb
specifier|static
name|void
name|KeccakAbsorb
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|KeccakPermutationOnWordsAfterXoring
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|data
argument_list|,
name|laneCount
argument_list|)
expr_stmt|;
else|#
directive|else
name|UINT64
name|dataAsWords
index|[
literal|25
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|laneCount
condition|;
name|i
operator|++
control|)
name|fromBytesToWord
argument_list|(
name|dataAsWords
operator|+
name|i
argument_list|,
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|KeccakPermutationOnWordsAfterXoring
argument_list|(
operator|(
name|UINT64
operator|*
operator|)
name|state
argument_list|,
name|dataAsWords
argument_list|,
name|laneCount
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_if
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_BIG_ENDIAN
operator|)
end_if
begin_function
DECL|function|fromWordToBytes
specifier|static
name|void
name|fromWordToBytes
parameter_list|(
name|UINT8
modifier|*
name|bytes
parameter_list|,
specifier|const
name|UINT64
name|word
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
operator|(
literal|64
operator|/
literal|8
operator|)
condition|;
name|i
operator|++
control|)
name|bytes
index|[
name|i
index|]
operator|=
operator|(
name|word
operator|>>
operator|(
literal|8
operator|*
name|i
operator|)
operator|)
operator|&
literal|0xFF
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakExtract1024bits
specifier|static
name|void
name|KeccakExtract1024bits
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|memcpy
argument_list|(
name|data
argument_list|,
name|state
argument_list|,
literal|128
argument_list|)
expr_stmt|;
else|#
directive|else
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
name|i
operator|++
control|)
name|fromWordToBytes
argument_list|(
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|,
operator|(
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
name|i
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|UseBebigokimisa
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|1
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|1
index|]
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|8
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|8
index|]
expr_stmt|;
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|12
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|12
index|]
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakExtract
specifier|static
name|void
name|KeccakExtract
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
name|unsigned
name|char
modifier|*
name|data
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
name|memcpy
argument_list|(
name|data
argument_list|,
name|state
argument_list|,
name|laneCount
operator|*
literal|8
argument_list|)
expr_stmt|;
else|#
directive|else
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|laneCount
condition|;
name|i
operator|++
control|)
name|fromWordToBytes
argument_list|(
name|data
operator|+
operator|(
name|i
operator|*
literal|8
operator|)
argument_list|,
operator|(
operator|(
specifier|const
name|UINT64
operator|*
operator|)
name|state
operator|)
index|[
name|i
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|UseBebigokimisa
if|if
condition|(
name|laneCount
operator|>
literal|1
condition|)
block|{
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|1
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|2
condition|)
block|{
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|8
condition|)
block|{
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|8
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|8
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|12
condition|)
block|{
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|12
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|12
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|17
condition|)
block|{
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|17
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|17
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|20
condition|)
block|{
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|20
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|data
operator|)
index|[
literal|20
index|]
expr_stmt|;
block|}
block|}
block|}
block|}
block|}
block|}
endif|#
directive|endif
block|}
end_function
end_unit
