begin_unit
begin_comment
comment|/* The Keccak sponge function, designed by Guido Bertoni, Joan Daemen, MichaÃ«l Peeters and Gilles Van Assche. For more information, feedback or questions, please refer to our website: http://keccak.noekeon.org/  Implementation by the designers, hereby denoted as "the implementer".  To the extent possible under law, the implementer has waived all copyright and related or neighboring rights to the source code in this file. http://creativecommons.org/publicdomain/zero/1.0/ */
end_comment
begin_include
include|#
directive|include
file|<string.h>
end_include
begin_include
include|#
directive|include
file|"brg_endian.h"
end_include
begin_include
include|#
directive|include
file|"KeccakF-1600-opt32-settings.h"
end_include
begin_include
include|#
directive|include
file|"KeccakF-1600-interface.h"
end_include
begin_typedef
DECL|typedef|UINT8
typedef|typedef
name|unsigned
name|char
name|UINT8
typedef|;
end_typedef
begin_typedef
DECL|typedef|UINT16
typedef|typedef
name|unsigned
name|short
name|UINT16
typedef|;
end_typedef
begin_typedef
DECL|typedef|UINT32
typedef|typedef
name|unsigned
name|int
name|UINT32
typedef|;
end_typedef
begin_typedef
DECL|typedef|UINT64
typedef|typedef
name|unsigned
name|long
name|long
name|int
name|UINT64
typedef|;
end_typedef
begin_ifdef
ifdef|#
directive|ifdef
name|UseInterleaveTables
end_ifdef
begin_decl_stmt
DECL|variable|interleaveTablesBuilt
name|int
name|interleaveTablesBuilt
init|=
literal|0
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|interleaveTable
name|UINT16
name|interleaveTable
index|[
literal|65536
index|]
decl_stmt|;
end_decl_stmt
begin_decl_stmt
DECL|variable|deinterleaveTable
name|UINT16
name|deinterleaveTable
index|[
literal|65536
index|]
decl_stmt|;
end_decl_stmt
begin_function
DECL|function|buildInterleaveTables
specifier|static
name|void
name|buildInterleaveTables
parameter_list|()
block|{
name|UINT32
name|i
decl_stmt|,
name|j
decl_stmt|;
name|UINT16
name|x
decl_stmt|;
if|if
condition|(
operator|!
name|interleaveTablesBuilt
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|65536
condition|;
name|i
operator|++
control|)
block|{
name|x
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|&
operator|(
literal|1
operator|<<
name|j
operator|)
condition|)
name|x
operator||=
operator|(
literal|1
operator|<<
operator|(
name|j
operator|/
literal|2
operator|+
literal|8
operator|*
operator|(
name|j
operator|%
literal|2
operator|)
operator|)
operator|)
expr_stmt|;
block|}
name|interleaveTable
index|[
name|i
index|]
operator|=
name|x
expr_stmt|;
name|deinterleaveTable
index|[
name|x
index|]
operator|=
operator|(
name|UINT16
operator|)
name|i
expr_stmt|;
block|}
name|interleaveTablesBuilt
operator|=
literal|1
expr_stmt|;
block|}
block|}
end_function
begin_if
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
end_if
begin_define
DECL|macro|xor2bytesIntoInterleavedWords
define|#
directive|define
name|xor2bytesIntoInterleavedWords
parameter_list|(
name|even
parameter_list|,
name|odd
parameter_list|,
name|source
parameter_list|,
name|j
parameter_list|)
define|\
value|i##j = interleaveTable[((const UINT16*)source)[j]]; \     ((UINT8*)even)[j] ^= i##j& 0xFF; \     ((UINT8*)odd)[j] ^= i##j>> 8;
end_define
begin_define
DECL|macro|setInterleavedWordsInto2bytes
define|#
directive|define
name|setInterleavedWordsInto2bytes
parameter_list|(
name|dest
parameter_list|,
name|even
parameter_list|,
name|odd
parameter_list|,
name|j
parameter_list|)
define|\
value|d##j = deinterleaveTable[((even>> (j*8))& 0xFF) ^ (((odd>> (j*8))& 0xFF)<< 8)]; \     ((UINT16*)dest)[j] = d##j;
end_define
begin_else
else|#
directive|else
end_else
begin_comment
comment|// (PLATFORM_BYTE_ORDER == IS_BIG_ENDIAN)
end_comment
begin_define
DECL|macro|xor2bytesIntoInterleavedWords
define|#
directive|define
name|xor2bytesIntoInterleavedWords
parameter_list|(
name|even
parameter_list|,
name|odd
parameter_list|,
name|source
parameter_list|,
name|j
parameter_list|)
define|\
value|i##j = interleaveTable[source[2*j] ^ ((UINT16)source[2*j+1]<< 8)]; \     *even ^= (i##j& 0xFF)<< (j*8); \     *odd ^= ((i##j>> 8)& 0xFF)<< (j*8);
end_define
begin_define
DECL|macro|setInterleavedWordsInto2bytes
define|#
directive|define
name|setInterleavedWordsInto2bytes
parameter_list|(
name|dest
parameter_list|,
name|even
parameter_list|,
name|odd
parameter_list|,
name|j
parameter_list|)
define|\
value|d##j = deinterleaveTable[((even>> (j*8))& 0xFF) ^ (((odd>> (j*8))& 0xFF)<< 8)]; \     dest[2*j] = d##j& 0xFF; \     dest[2*j+1] = d##j>> 8;
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// Endianness
end_comment
begin_function
DECL|function|xor8bytesIntoInterleavedWords
specifier|static
name|void
name|xor8bytesIntoInterleavedWords
parameter_list|(
name|UINT32
modifier|*
name|even
parameter_list|,
name|UINT32
modifier|*
name|odd
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|source
parameter_list|)
block|{
name|UINT16
name|i0
decl_stmt|,
name|i1
decl_stmt|,
name|i2
decl_stmt|,
name|i3
decl_stmt|;
name|xor2bytesIntoInterleavedWords
argument_list|(
argument|even
argument_list|,
argument|odd
argument_list|,
argument|source
argument_list|,
literal|0
argument_list|)
name|xor2bytesIntoInterleavedWords
argument_list|(
argument|even
argument_list|,
argument|odd
argument_list|,
argument|source
argument_list|,
literal|1
argument_list|)
name|xor2bytesIntoInterleavedWords
argument_list|(
argument|even
argument_list|,
argument|odd
argument_list|,
argument|source
argument_list|,
literal|2
argument_list|)
name|xor2bytesIntoInterleavedWords
argument_list|(
argument|even
argument_list|,
argument|odd
argument_list|,
argument|source
argument_list|,
literal|3
argument_list|)
block|}
end_function
begin_define
DECL|macro|xorLanesIntoState
define|#
directive|define
name|xorLanesIntoState
parameter_list|(
name|laneCount
parameter_list|,
name|state
parameter_list|,
name|input
parameter_list|)
define|\
value|{ \         int i; \         for(i=0; i<(laneCount); i++) \             xor8bytesIntoInterleavedWords(state+i*2, state+i*2+1, input+i*8); \     }
end_define
begin_function
DECL|function|setInterleavedWordsInto8bytes
specifier|static
name|void
name|setInterleavedWordsInto8bytes
parameter_list|(
name|UINT8
modifier|*
name|dest
parameter_list|,
name|UINT32
name|even
parameter_list|,
name|UINT32
name|odd
parameter_list|)
block|{
name|UINT16
name|d0
decl_stmt|,
name|d1
decl_stmt|,
name|d2
decl_stmt|,
name|d3
decl_stmt|;
name|setInterleavedWordsInto2bytes
argument_list|(
argument|dest
argument_list|,
argument|even
argument_list|,
argument|odd
argument_list|,
literal|0
argument_list|)
name|setInterleavedWordsInto2bytes
argument_list|(
argument|dest
argument_list|,
argument|even
argument_list|,
argument|odd
argument_list|,
literal|1
argument_list|)
name|setInterleavedWordsInto2bytes
argument_list|(
argument|dest
argument_list|,
argument|even
argument_list|,
argument|odd
argument_list|,
literal|2
argument_list|)
name|setInterleavedWordsInto2bytes
argument_list|(
argument|dest
argument_list|,
argument|even
argument_list|,
argument|odd
argument_list|,
literal|3
argument_list|)
block|}
end_function
begin_define
DECL|macro|extractLanes
define|#
directive|define
name|extractLanes
parameter_list|(
name|laneCount
parameter_list|,
name|state
parameter_list|,
name|data
parameter_list|)
define|\
value|{ \         int i; \         for(i=0; i<(laneCount); i++) \             setInterleavedWordsInto8bytes(data+i*8, ((UINT32*)state)[i*2], ((UINT32*)state)[i*2+1]); \     }
end_define
begin_else
else|#
directive|else
end_else
begin_comment
comment|// No interleaving tables
end_comment
begin_if
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
end_if
begin_comment
comment|// Credit: Henry S. Warren, Hacker's Delight, Addison-Wesley, 2002
end_comment
begin_define
DECL|macro|xorInterleavedLE
define|#
directive|define
name|xorInterleavedLE
parameter_list|(
name|rateInLanes
parameter_list|,
name|state
parameter_list|,
name|input
parameter_list|)
define|\
value|{ \ 		const UINT32 * pI = (const UINT32 *)input; \ 		UINT32 * pS = state; \ 		UINT32 t, x0, x1; \ 	    int i; \ 	    for (i = (rateInLanes)-1; i>= 0; --i) \ 		{ \ 			x0 = *(pI++); \ 			t = (x0 ^ (x0>>  1))& 0x22222222UL;  x0 = x0 ^ t ^ (t<<  1); \ 			t = (x0 ^ (x0>>  2))& 0x0C0C0C0CUL;  x0 = x0 ^ t ^ (t<<  2); \ 			t = (x0 ^ (x0>>  4))& 0x00F000F0UL;  x0 = x0 ^ t ^ (t<<  4); \ 			t = (x0 ^ (x0>>  8))& 0x0000FF00UL;  x0 = x0 ^ t ^ (t<<  8); \  			x1 = *(pI++); \ 			t = (x1 ^ (x1>>  1))& 0x22222222UL;  x1 = x1 ^ t ^ (t<<  1); \ 			t = (x1 ^ (x1>>  2))& 0x0C0C0C0CUL;  x1 = x1 ^ t ^ (t<<  2); \ 			t = (x1 ^ (x1>>  4))& 0x00F000F0UL;  x1 = x1 ^ t ^ (t<<  4); \ 			t = (x1 ^ (x1>>  8))& 0x0000FF00UL;  x1 = x1 ^ t ^ (t<<  8); \ 			*(pS++) ^= (UINT16)x0 | (x1<< 16); \ 			*(pS++) ^= (x0>> 16) | (x1& 0xFFFF0000); \ 		} \ 	}
end_define
begin_define
DECL|macro|xorLanesIntoState
define|#
directive|define
name|xorLanesIntoState
parameter_list|(
name|laneCount
parameter_list|,
name|state
parameter_list|,
name|input
parameter_list|)
define|\
value|xorInterleavedLE(laneCount, state, input)
end_define
begin_else
else|#
directive|else
end_else
begin_comment
comment|// (PLATFORM_BYTE_ORDER == IS_BIG_ENDIAN)
end_comment
begin_comment
comment|// Credit: Henry S. Warren, Hacker's Delight, Addison-Wesley, 2002
end_comment
begin_function
DECL|function|toInterleaving
specifier|static
name|UINT64
name|toInterleaving
parameter_list|(
name|UINT64
name|x
parameter_list|)
block|{
name|UINT64
name|t
decl_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|1
operator|)
operator|)
operator|&
literal|0x2222222222222222ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|1
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|2
operator|)
operator|)
operator|&
literal|0x0C0C0C0C0C0C0C0CULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|2
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|4
operator|)
operator|)
operator|&
literal|0x00F000F000F000F0ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|4
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|8
operator|)
operator|)
operator|&
literal|0x0000FF000000FF00ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|8
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|16
operator|)
operator|)
operator|&
literal|0x00000000FFFF0000ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|16
operator|)
expr_stmt|;
return|return
name|x
return|;
block|}
end_function
begin_function
DECL|function|xor8bytesIntoInterleavedWords
specifier|static
name|void
name|xor8bytesIntoInterleavedWords
parameter_list|(
name|UINT32
modifier|*
name|evenAndOdd
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|source
parameter_list|)
block|{
comment|// This can be optimized
name|UINT64
name|sourceWord
init|=
operator|(
name|UINT64
operator|)
name|source
index|[
literal|0
index|]
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|1
index|]
operator|)
operator|<<
literal|8
operator|)
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|2
index|]
operator|)
operator|<<
literal|16
operator|)
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|3
index|]
operator|)
operator|<<
literal|24
operator|)
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|4
index|]
operator|)
operator|<<
literal|32
operator|)
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|5
index|]
operator|)
operator|<<
literal|40
operator|)
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|6
index|]
operator|)
operator|<<
literal|48
operator|)
operator|^
operator|(
operator|(
operator|(
name|UINT64
operator|)
name|source
index|[
literal|7
index|]
operator|)
operator|<<
literal|56
operator|)
decl_stmt|;
name|UINT64
name|evenAndOddWord
init|=
name|toInterleaving
argument_list|(
name|sourceWord
argument_list|)
decl_stmt|;
name|evenAndOdd
index|[
literal|0
index|]
operator|^=
operator|(
name|UINT32
operator|)
name|evenAndOddWord
expr_stmt|;
name|evenAndOdd
index|[
literal|1
index|]
operator|^=
call|(
name|UINT32
call|)
argument_list|(
name|evenAndOddWord
operator|>>
literal|32
argument_list|)
expr_stmt|;
block|}
end_function
begin_define
DECL|macro|xorLanesIntoState
define|#
directive|define
name|xorLanesIntoState
parameter_list|(
name|laneCount
parameter_list|,
name|state
parameter_list|,
name|input
parameter_list|)
define|\
value|{ \         int i; \         for(i=0; i<(laneCount); i++) \             xor8bytesIntoInterleavedWords(state+i*2, input+i*8); \     }
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// Endianness
end_comment
begin_comment
comment|// Credit: Henry S. Warren, Hacker's Delight, Addison-Wesley, 2002
end_comment
begin_function
DECL|function|fromInterleaving
specifier|static
name|UINT64
name|fromInterleaving
parameter_list|(
name|UINT64
name|x
parameter_list|)
block|{
name|UINT64
name|t
decl_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|16
operator|)
operator|)
operator|&
literal|0x00000000FFFF0000ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|16
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|8
operator|)
operator|)
operator|&
literal|0x0000FF000000FF00ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|8
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|4
operator|)
operator|)
operator|&
literal|0x00F000F000F000F0ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|4
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|2
operator|)
operator|)
operator|&
literal|0x0C0C0C0C0C0C0C0CULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|2
operator|)
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|^
operator|(
name|x
operator|>>
literal|1
operator|)
operator|)
operator|&
literal|0x2222222222222222ULL
expr_stmt|;
name|x
operator|=
name|x
operator|^
name|t
operator|^
operator|(
name|t
operator|<<
literal|1
operator|)
expr_stmt|;
return|return
name|x
return|;
block|}
end_function
begin_function
DECL|function|setInterleavedWordsInto8bytes
specifier|static
name|void
name|setInterleavedWordsInto8bytes
parameter_list|(
name|UINT8
modifier|*
name|dest
parameter_list|,
name|UINT32
modifier|*
name|evenAndOdd
parameter_list|)
block|{
if|#
directive|if
operator|(
name|PLATFORM_BYTE_ORDER
operator|==
name|IS_LITTLE_ENDIAN
operator|)
operator|(
operator|(
name|UINT64
operator|*
operator|)
name|dest
operator|)
index|[
literal|0
index|]
operator|=
name|fromInterleaving
argument_list|(
operator|*
operator|(
name|UINT64
operator|*
operator|)
name|evenAndOdd
argument_list|)
expr_stmt|;
else|#
directive|else
comment|// (PLATFORM_BYTE_ORDER == IS_BIG_ENDIAN)
comment|// This can be optimized
name|UINT64
name|evenAndOddWord
init|=
operator|(
name|UINT64
operator|)
name|evenAndOdd
index|[
literal|0
index|]
operator|^
operator|(
operator|(
name|UINT64
operator|)
name|evenAndOdd
index|[
literal|1
index|]
operator|<<
literal|32
operator|)
decl_stmt|;
name|UINT64
name|destWord
init|=
name|fromInterleaving
argument_list|(
name|evenAndOddWord
argument_list|)
decl_stmt|;
name|dest
index|[
literal|0
index|]
operator|=
name|destWord
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|1
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|8
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|2
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|16
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|3
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|24
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|4
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|32
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|5
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|40
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|6
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|48
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|dest
index|[
literal|7
index|]
operator|=
operator|(
name|destWord
operator|>>
literal|56
operator|)
operator|&
literal|0xFF
expr_stmt|;
endif|#
directive|endif
comment|// Endianness
block|}
end_function
begin_define
DECL|macro|extractLanes
define|#
directive|define
name|extractLanes
parameter_list|(
name|laneCount
parameter_list|,
name|state
parameter_list|,
name|data
parameter_list|)
define|\
value|{ \         int i; \         for(i=0; i<(laneCount); i++) \             setInterleavedWordsInto8bytes(data+i*8, (UINT32*)state+i*2); \     }
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// With or without interleaving tables
end_comment
begin_if
if|#
directive|if
name|defined
argument_list|(
name|_MSC_VER
argument_list|)
end_if
begin_define
DECL|macro|ROL32
define|#
directive|define
name|ROL32
parameter_list|(
name|a
parameter_list|,
name|offset
parameter_list|)
value|_rotl(a, offset)
end_define
begin_elif
elif|#
directive|elif
operator|(
name|defined
argument_list|(
name|__arm__
argument_list|)
operator|&&
name|defined
argument_list|(
name|__ARMCC_VERSION
argument_list|)
operator|)
end_elif
begin_define
DECL|macro|ROL32
define|#
directive|define
name|ROL32
parameter_list|(
name|a
parameter_list|,
name|offset
parameter_list|)
value|__ror(a, 32-(offset))
end_define
begin_else
else|#
directive|else
end_else
begin_define
DECL|macro|ROL32
define|#
directive|define
name|ROL32
parameter_list|(
name|a
parameter_list|,
name|offset
parameter_list|)
value|((((UINT32)a)<< (offset)) ^ (((UINT32)a)>> (32-(offset))))
end_define
begin_endif
endif|#
directive|endif
end_endif
begin_include
include|#
directive|include
file|"KeccakF-1600-unrolling.macros"
end_include
begin_include
include|#
directive|include
file|"KeccakF-1600-32.macros"
end_include
begin_if
if|#
directive|if
operator|(
name|UseSchedule
operator|==
literal|3
operator|)
end_if
begin_ifdef
ifdef|#
directive|ifdef
name|UseBebigokimisa
end_ifdef
begin_error
error|#
directive|error
literal|"No lane complementing with schedule 3."
end_error
begin_endif
endif|#
directive|endif
end_endif
begin_if
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|2
operator|)
end_if
begin_error
error|#
directive|error
literal|"Only unrolling 2 is supported by schedule 3."
end_error
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakPermutationOnWords
specifier|static
name|void
name|KeccakPermutationOnWords
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|)
block|{
name|rounds
block|}
end_function
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
argument|laneCount
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast576
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring576bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring576bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
literal|9
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast832
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring832bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring832bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
literal|13
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1024bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1024bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
literal|16
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1088
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1088bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1088bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
literal|17
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1152
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1152bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1152bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
literal|18
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1344
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1344bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1344bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|xorLanesIntoState
argument_list|(
literal|21
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_else
else|#
directive|else
end_else
begin_comment
comment|// (Schedule != 3)
end_comment
begin_function
DECL|function|KeccakPermutationOnWords
specifier|static
name|void
name|KeccakPermutationOnWords
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|)
block|{
name|declareABCDE
if|#
directive|if
operator|(
name|Unrolling
operator|!=
literal|24
operator|)
name|unsigned
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
argument|laneCount
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast576
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring576bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring576bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
literal|9
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast832
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring832bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring832bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
literal|13
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1024bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1024bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
literal|16
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1088
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1088bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1088bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
literal|17
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1152
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1152bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1152bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
literal|18
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1344
end_ifdef
begin_function
DECL|function|KeccakPermutationOnWordsAfterXoring1344bits
specifier|static
name|void
name|KeccakPermutationOnWordsAfterXoring1344bits
parameter_list|(
name|UINT32
modifier|*
name|state
parameter_list|,
specifier|const
name|UINT8
modifier|*
name|input
parameter_list|)
block|{
name|declareABCDE
name|unsigned
name|int
name|i
decl_stmt|;
name|xorLanesIntoState
argument_list|(
literal|21
argument_list|,
argument|state
argument_list|,
argument|input
argument_list|)
name|copyFromState
argument_list|(
argument|A
argument_list|,
argument|state
argument_list|)
name|rounds
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakInitialize
specifier|static
name|void
name|KeccakInitialize
parameter_list|()
block|{
ifdef|#
directive|ifdef
name|UseInterleaveTables
name|buildInterleaveTables
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|KeccakInitializeState
specifier|static
name|void
name|KeccakInitializeState
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|)
block|{
name|memset
argument_list|(
name|state
argument_list|,
literal|0
argument_list|,
literal|200
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|UseBebigokimisa
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|2
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|3
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|4
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|5
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|16
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|17
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|24
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|25
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|34
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|35
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|40
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|state
operator|)
index|[
literal|41
index|]
operator|=
operator|~
operator|(
name|UINT32
operator|)
literal|0
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_function
DECL|function|KeccakPermutation
specifier|static
name|void
name|KeccakPermutation
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|)
block|{
comment|// We assume the state is always stored as interleaved 32-bit words
name|KeccakPermutationOnWords
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|)
expr_stmt|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast576
end_ifdef
begin_function
DECL|function|KeccakAbsorb576bits
specifier|static
name|void
name|KeccakAbsorb576bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring576bits
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast832
end_ifdef
begin_function
DECL|function|KeccakAbsorb832bits
specifier|static
name|void
name|KeccakAbsorb832bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring832bits
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakAbsorb1024bits
specifier|static
name|void
name|KeccakAbsorb1024bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring1024bits
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1088
end_ifdef
begin_function
DECL|function|KeccakAbsorb1088bits
specifier|static
name|void
name|KeccakAbsorb1088bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring1088bits
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1152
end_ifdef
begin_function
DECL|function|KeccakAbsorb1152bits
specifier|static
name|void
name|KeccakAbsorb1152bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring1152bits
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1344
end_ifdef
begin_function
DECL|function|KeccakAbsorb1344bits
specifier|static
name|void
name|KeccakAbsorb1344bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring1344bits
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakAbsorb
specifier|static
name|void
name|KeccakAbsorb
parameter_list|(
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|data
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
name|KeccakPermutationOnWordsAfterXoring
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|state
argument_list|,
name|data
argument_list|,
name|laneCount
argument_list|)
expr_stmt|;
block|}
end_function
begin_ifdef
ifdef|#
directive|ifdef
name|ProvideFast1024
end_ifdef
begin_function
DECL|function|KeccakExtract1024bits
specifier|static
name|void
name|KeccakExtract1024bits
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
name|unsigned
name|char
modifier|*
name|data
parameter_list|)
block|{
name|extractLanes
argument_list|(
literal|16
argument_list|,
name|state
argument_list|,
name|data
argument_list|)
ifdef|#
directive|ifdef
name|UseBebigokimisa
argument_list|(
operator|(
name|UINT32
operator|*
operator|)
name|data
argument_list|)
index|[
literal|2
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|3
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|3
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|4
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|4
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|5
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|5
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|16
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|16
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|17
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|17
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|24
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|24
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|25
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|25
index|]
expr_stmt|;
endif|#
directive|endif
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_function
DECL|function|KeccakExtract
specifier|static
name|void
name|KeccakExtract
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|state
parameter_list|,
name|unsigned
name|char
modifier|*
name|data
parameter_list|,
name|unsigned
name|int
name|laneCount
parameter_list|)
block|{
name|extractLanes
argument_list|(
argument|laneCount
argument_list|,
argument|state
argument_list|,
argument|data
argument_list|)
ifdef|#
directive|ifdef
name|UseBebigokimisa
if|if
condition|(
name|laneCount
operator|>
literal|1
condition|)
block|{
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|2
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|3
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|3
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|2
condition|)
block|{
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|4
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|4
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|5
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|5
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|8
condition|)
block|{
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|16
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|16
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|17
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|17
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|12
condition|)
block|{
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|24
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|24
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|25
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|25
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|17
condition|)
block|{
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|34
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|34
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|35
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|35
index|]
expr_stmt|;
if|if
condition|(
name|laneCount
operator|>
literal|20
condition|)
block|{
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|40
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|40
index|]
expr_stmt|;
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|41
index|]
operator|=
operator|~
operator|(
operator|(
name|UINT32
operator|*
operator|)
name|data
operator|)
index|[
literal|41
index|]
expr_stmt|;
block|}
block|}
block|}
block|}
block|}
block|}
endif|#
directive|endif
block|}
end_function
end_unit
