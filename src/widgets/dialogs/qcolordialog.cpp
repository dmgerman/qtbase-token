begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2015 The Qt Company Ltd. ** Contact: http://www.qt.io/licensing/ ** ** This file is part of the QtWidgets module of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL21$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and The Qt Company. For licensing terms ** and conditions see http://www.qt.io/terms-conditions. For further ** information use the contact form at http://www.qt.io/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 or version 3 as published by the Free ** Software Foundation and appearing in the file LICENSE.LGPLv21 and ** LICENSE.LGPLv3 included in the packaging of this file. Please review the ** following information to ensure the GNU Lesser General Public License ** requirements will be met: https://www.gnu.org/licenses/lgpl.html and ** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** As a special exception, The Qt Company gives you certain additional ** rights. These rights are described in The Qt Company LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|"qcolordialog.h"
end_include
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_COLORDIALOG
end_ifndef
begin_include
include|#
directive|include
file|"qapplication.h"
end_include
begin_include
include|#
directive|include
file|"qdesktopwidget.h"
end_include
begin_include
include|#
directive|include
file|"qdrawutil.h"
end_include
begin_include
include|#
directive|include
file|"qevent.h"
end_include
begin_include
include|#
directive|include
file|"qimage.h"
end_include
begin_include
include|#
directive|include
file|"qdrag.h"
end_include
begin_include
include|#
directive|include
file|"qlabel.h"
end_include
begin_include
include|#
directive|include
file|"qlayout.h"
end_include
begin_include
include|#
directive|include
file|"qlineedit.h"
end_include
begin_include
include|#
directive|include
file|"qmenu.h"
end_include
begin_include
include|#
directive|include
file|"qpainter.h"
end_include
begin_include
include|#
directive|include
file|"qpixmap.h"
end_include
begin_include
include|#
directive|include
file|"qpushbutton.h"
end_include
begin_include
include|#
directive|include
file|"qsettings.h"
end_include
begin_include
include|#
directive|include
file|"qsharedpointer.h"
end_include
begin_include
include|#
directive|include
file|"qstyle.h"
end_include
begin_include
include|#
directive|include
file|"qstyleoption.h"
end_include
begin_include
include|#
directive|include
file|"qvalidator.h"
end_include
begin_include
include|#
directive|include
file|"qmimedata.h"
end_include
begin_include
include|#
directive|include
file|"qspinbox.h"
end_include
begin_include
include|#
directive|include
file|"qdialogbuttonbox.h"
end_include
begin_include
include|#
directive|include
file|"qscreen.h"
end_include
begin_include
include|#
directive|include
file|"qcursor.h"
end_include
begin_include
include|#
directive|include
file|"qtimer.h"
end_include
begin_include
include|#
directive|include
file|"qwindow.h"
end_include
begin_include
include|#
directive|include
file|"private/qdialog_p.h"
end_include
begin_include
include|#
directive|include
file|<algorithm>
end_include
begin_macro
name|QT_BEGIN_NAMESPACE
end_macro
begin_namespace
namespace|namespace
block|{
class_decl|class
name|QColorLuminancePicker
class_decl|;
class_decl|class
name|QColorPicker
class_decl|;
class_decl|class
name|QColorShower
class_decl|;
class_decl|class
name|QWellArray
class_decl|;
class_decl|class
name|QColorPickingEventFilter
class_decl|;
block|}
end_namespace
begin_comment
comment|// unnamed namespace
end_comment
begin_class
DECL|class|QColorDialogPrivate
class|class
name|QColorDialogPrivate
super|:
specifier|public
name|QDialogPrivate
block|{
name|Q_DECLARE_PUBLIC
parameter_list|(
name|QColorDialog
parameter_list|)
specifier|public
private|:
DECL|enum|SetColorMode
enum|enum
name|SetColorMode
block|{
DECL|enumerator|ShowColor
name|ShowColor
init|=
literal|0x1
block|,
DECL|enumerator|SelectColor
name|SelectColor
init|=
literal|0x2
block|,
DECL|enumerator|SetColorAll
name|SetColorAll
init|=
name|ShowColor
operator||
name|SelectColor
block|}
enum|;
DECL|function|QColorDialogPrivate
name|QColorDialogPrivate
parameter_list|()
member_init_list|:
name|options
argument_list|(
operator|new
name|QColorDialogOptions
argument_list|)
ifdef|#
directive|ifdef
name|Q_OS_WIN32
member_init_list|,
name|updateTimer
argument_list|(
literal|0
argument_list|)
endif|#
directive|endif
block|{}
DECL|function|platformColorDialogHelper
name|QPlatformColorDialogHelper
modifier|*
name|platformColorDialogHelper
parameter_list|()
specifier|const
block|{
return|return
cast|static_cast
argument_list|<
name|QPlatformColorDialogHelper
operator|*
argument_list|>
argument_list|(
name|platformHelper
argument_list|()
argument_list|)
return|;
block|}
name|void
name|init
parameter_list|(
specifier|const
name|QColor
modifier|&
name|initial
parameter_list|)
function_decl|;
name|void
name|initWidgets
parameter_list|()
function_decl|;
name|QRgb
name|currentColor
parameter_list|()
specifier|const
function_decl|;
name|QColor
name|currentQColor
parameter_list|()
specifier|const
function_decl|;
name|void
name|setCurrentColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|,
name|SetColorMode
name|setColorMode
init|=
name|SetColorAll
parameter_list|)
function_decl|;
name|void
name|setCurrentRgbColor
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
function_decl|;
name|void
name|setCurrentQColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|)
function_decl|;
name|bool
name|selectColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|)
function_decl|;
name|QColor
name|grabScreenColor
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|p
parameter_list|)
function_decl|;
name|int
name|currentAlpha
parameter_list|()
specifier|const
function_decl|;
name|void
name|setCurrentAlpha
parameter_list|(
name|int
name|a
parameter_list|)
function_decl|;
name|void
name|showAlpha
parameter_list|(
name|bool
name|b
parameter_list|)
function_decl|;
name|bool
name|isAlphaVisible
parameter_list|()
specifier|const
function_decl|;
name|void
name|retranslateStrings
parameter_list|()
function_decl|;
name|void
name|_q_addCustom
parameter_list|()
function_decl|;
name|void
name|_q_newHsv
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
function_decl|;
name|void
name|_q_newColorTypedIn
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
function_decl|;
name|void
name|_q_nextCustom
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
name|void
name|_q_newCustom
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
name|void
name|_q_newStandard
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
name|void
name|_q_pickScreenColor
parameter_list|()
function_decl|;
name|void
name|_q_updateColorPicking
parameter_list|()
function_decl|;
name|void
name|updateColorLabelText
parameter_list|(
specifier|const
name|QPoint
modifier|&
parameter_list|)
function_decl|;
name|void
name|updateColorPicking
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pos
parameter_list|)
function_decl|;
name|void
name|releaseColorPicking
parameter_list|()
function_decl|;
name|bool
name|handleColorPickingMouseMove
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
function_decl|;
name|bool
name|handleColorPickingMouseButtonRelease
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
function_decl|;
name|bool
name|handleColorPickingKeyPress
parameter_list|(
name|QKeyEvent
modifier|*
name|e
parameter_list|)
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|bool
name|canBeNativeDialog
parameter_list|()
specifier|const
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|custom
name|QWellArray
modifier|*
name|custom
decl_stmt|;
DECL|member|standard
name|QWellArray
modifier|*
name|standard
decl_stmt|;
DECL|member|buttons
name|QDialogButtonBox
modifier|*
name|buttons
decl_stmt|;
DECL|member|leftLay
name|QVBoxLayout
modifier|*
name|leftLay
decl_stmt|;
DECL|member|cp
name|QColorPicker
modifier|*
name|cp
decl_stmt|;
DECL|member|lp
name|QColorLuminancePicker
modifier|*
name|lp
decl_stmt|;
DECL|member|cs
name|QColorShower
modifier|*
name|cs
decl_stmt|;
DECL|member|lblBasicColors
name|QLabel
modifier|*
name|lblBasicColors
decl_stmt|;
DECL|member|lblCustomColors
name|QLabel
modifier|*
name|lblCustomColors
decl_stmt|;
DECL|member|lblScreenColorInfo
name|QLabel
modifier|*
name|lblScreenColorInfo
decl_stmt|;
DECL|member|ok
name|QPushButton
modifier|*
name|ok
decl_stmt|;
DECL|member|cancel
name|QPushButton
modifier|*
name|cancel
decl_stmt|;
DECL|member|addCusBt
name|QPushButton
modifier|*
name|addCusBt
decl_stmt|;
DECL|member|screenColorPickerButton
name|QPushButton
modifier|*
name|screenColorPickerButton
decl_stmt|;
DECL|member|selectedQColor
name|QColor
name|selectedQColor
decl_stmt|;
DECL|member|nextCust
name|int
name|nextCust
decl_stmt|;
DECL|member|smallDisplay
name|bool
name|smallDisplay
decl_stmt|;
DECL|member|screenColorPicking
name|bool
name|screenColorPicking
decl_stmt|;
DECL|member|colorPickingEventFilter
name|QColorPickingEventFilter
modifier|*
name|colorPickingEventFilter
decl_stmt|;
DECL|member|beforeScreenColorPicking
name|QRgb
name|beforeScreenColorPicking
decl_stmt|;
DECL|member|options
name|QSharedPointer
argument_list|<
name|QColorDialogOptions
argument_list|>
name|options
decl_stmt|;
DECL|member|receiverToDisconnectOnClose
name|QPointer
argument_list|<
name|QObject
argument_list|>
name|receiverToDisconnectOnClose
decl_stmt|;
DECL|member|memberToDisconnectOnClose
name|QByteArray
name|memberToDisconnectOnClose
decl_stmt|;
ifdef|#
directive|ifdef
name|Q_OS_WIN32
DECL|member|updateTimer
name|QTimer
modifier|*
name|updateTimer
decl_stmt|;
DECL|member|dummyTransparentWindow
name|QWindow
name|dummyTransparentWindow
decl_stmt|;
endif|#
directive|endif
private|private:
DECL|member|Q_DECL_OVERRIDE
specifier|virtual
name|void
name|initHelper
parameter_list|(
name|QPlatformDialogHelper
modifier|*
name|h
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
specifier|virtual
name|void
name|helperPrepareShow
parameter_list|(
name|QPlatformDialogHelper
modifier|*
name|h
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
block|}
class|;
end_class
begin_comment
comment|//////////// QWellArray BEGIN
end_comment
begin_namespace
namespace|namespace
block|{
struct_decl|struct
name|QWellArrayData
struct_decl|;
DECL|class|QWellArray
class|class
name|QWellArray
super|:
specifier|public
name|QWidget
block|{
name|Q_OBJECT
name|Q_PROPERTY
argument_list|(
name|int
name|selectedColumn
name|READ
name|selectedColumn
argument_list|)
name|Q_PROPERTY
argument_list|(
name|int
name|selectedRow
name|READ
name|selectedRow
argument_list|)
decl|public
range|:
name|QWellArray
argument_list|(
argument|int rows
argument_list|,
argument|int cols
argument_list|,
argument|QWidget* parent=
literal|0
argument_list|)
decl_stmt|;
DECL|function|~QWellArray
name|~
name|QWellArray
parameter_list|()
block|{}
name|QString
name|cellContent
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
specifier|const
function_decl|;
DECL|function|selectedColumn
name|int
name|selectedColumn
parameter_list|()
specifier|const
block|{
return|return
name|selCol
return|;
block|}
DECL|function|selectedRow
name|int
name|selectedRow
parameter_list|()
specifier|const
block|{
return|return
name|selRow
return|;
block|}
specifier|virtual
name|void
name|setCurrent
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
function_decl|;
specifier|virtual
name|void
name|setSelected
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|QSize
name|sizeHint
parameter_list|()
specifier|const
name|Q_DECL_OVERRIDE
function_decl|;
specifier|virtual
name|void
name|setCellBrush
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QBrush
modifier|&
parameter_list|)
function_decl|;
name|QBrush
name|cellBrush
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
function_decl|;
DECL|function|cellWidth
specifier|inline
name|int
name|cellWidth
parameter_list|()
specifier|const
block|{
return|return
name|cellw
return|;
block|}
DECL|function|cellHeight
specifier|inline
name|int
name|cellHeight
parameter_list|()
specifier|const
block|{
return|return
name|cellh
return|;
block|}
DECL|function|rowAt
specifier|inline
name|int
name|rowAt
parameter_list|(
name|int
name|y
parameter_list|)
specifier|const
block|{
return|return
name|y
operator|/
name|cellh
return|;
block|}
DECL|function|columnAt
specifier|inline
name|int
name|columnAt
parameter_list|(
name|int
name|x
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|isRightToLeft
argument_list|()
condition|)
return|return
name|ncols
operator|-
operator|(
name|x
operator|/
name|cellw
operator|)
operator|-
literal|1
return|;
return|return
name|x
operator|/
name|cellw
return|;
block|}
DECL|function|rowY
specifier|inline
name|int
name|rowY
parameter_list|(
name|int
name|row
parameter_list|)
specifier|const
block|{
return|return
name|cellh
operator|*
name|row
return|;
block|}
DECL|function|columnX
specifier|inline
name|int
name|columnX
parameter_list|(
name|int
name|column
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|isRightToLeft
argument_list|()
condition|)
return|return
name|cellw
operator|*
operator|(
name|ncols
operator|-
name|column
operator|-
literal|1
operator|)
return|;
return|return
name|cellw
operator|*
name|column
return|;
block|}
DECL|function|numRows
specifier|inline
name|int
name|numRows
parameter_list|()
specifier|const
block|{
return|return
name|nrows
return|;
block|}
DECL|function|numCols
specifier|inline
name|int
name|numCols
parameter_list|()
specifier|const
block|{
return|return
name|ncols
return|;
block|}
DECL|function|cellRect
specifier|inline
name|QRect
name|cellRect
parameter_list|()
specifier|const
block|{
return|return
name|QRect
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|cellw
argument_list|,
name|cellh
argument_list|)
return|;
block|}
DECL|function|gridSize
specifier|inline
name|QSize
name|gridSize
parameter_list|()
specifier|const
block|{
return|return
name|QSize
argument_list|(
name|ncols
operator|*
name|cellw
argument_list|,
name|nrows
operator|*
name|cellh
argument_list|)
return|;
block|}
DECL|function|cellGeometry
name|QRect
name|cellGeometry
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|column
parameter_list|)
block|{
name|QRect
name|r
decl_stmt|;
if|if
condition|(
name|row
operator|>=
literal|0
operator|&&
name|row
operator|<
name|nrows
operator|&&
name|column
operator|>=
literal|0
operator|&&
name|column
operator|<
name|ncols
condition|)
name|r
operator|.
name|setRect
argument_list|(
name|columnX
argument_list|(
name|column
argument_list|)
argument_list|,
name|rowY
argument_list|(
name|row
argument_list|)
argument_list|,
name|cellw
argument_list|,
name|cellh
argument_list|)
expr_stmt|;
return|return
name|r
return|;
block|}
DECL|function|updateCell
specifier|inline
name|void
name|updateCell
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|column
parameter_list|)
block|{
name|update
argument_list|(
name|cellGeometry
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
argument_list|)
expr_stmt|;
block|}
signals|signals:
name|void
name|selected
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
function_decl|;
name|void
name|currentChanged
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
function_decl|;
protected|protected:
specifier|virtual
name|void
name|paintCell
parameter_list|(
name|QPainter
modifier|*
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QRect
modifier|&
parameter_list|)
function_decl|;
specifier|virtual
name|void
name|paintCellContents
parameter_list|(
name|QPainter
modifier|*
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QRect
modifier|&
parameter_list|)
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseReleaseEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|keyPressEvent
parameter_list|(
name|QKeyEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|focusInEvent
parameter_list|(
name|QFocusEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|focusOutEvent
parameter_list|(
name|QFocusEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
private|private:
name|Q_DISABLE_COPY
parameter_list|(
name|QWellArray
parameter_list|)
DECL|member|nrows
name|int
name|nrows
decl_stmt|;
DECL|member|ncols
name|int
name|ncols
decl_stmt|;
DECL|member|cellw
name|int
name|cellw
decl_stmt|;
DECL|member|cellh
name|int
name|cellh
decl_stmt|;
DECL|member|curRow
name|int
name|curRow
decl_stmt|;
DECL|member|curCol
name|int
name|curCol
decl_stmt|;
DECL|member|selRow
name|int
name|selRow
decl_stmt|;
DECL|member|selCol
name|int
name|selCol
decl_stmt|;
DECL|member|d
name|QWellArrayData
modifier|*
name|d
decl_stmt|;
block|}
class|;
DECL|function|paintEvent
name|void
name|QWellArray
operator|::
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
name|e
parameter_list|)
block|{
name|QRect
name|r
init|=
name|e
operator|->
name|rect
argument_list|()
decl_stmt|;
name|int
name|cx
init|=
name|r
operator|.
name|x
argument_list|()
decl_stmt|;
name|int
name|cy
init|=
name|r
operator|.
name|y
argument_list|()
decl_stmt|;
name|int
name|ch
init|=
name|r
operator|.
name|height
argument_list|()
decl_stmt|;
name|int
name|cw
init|=
name|r
operator|.
name|width
argument_list|()
decl_stmt|;
name|int
name|colfirst
init|=
name|columnAt
argument_list|(
name|cx
argument_list|)
decl_stmt|;
name|int
name|collast
init|=
name|columnAt
argument_list|(
name|cx
operator|+
name|cw
argument_list|)
decl_stmt|;
name|int
name|rowfirst
init|=
name|rowAt
argument_list|(
name|cy
argument_list|)
decl_stmt|;
name|int
name|rowlast
init|=
name|rowAt
argument_list|(
name|cy
operator|+
name|ch
argument_list|)
decl_stmt|;
if|if
condition|(
name|isRightToLeft
argument_list|()
condition|)
block|{
name|int
name|t
init|=
name|colfirst
decl_stmt|;
name|colfirst
operator|=
name|collast
expr_stmt|;
name|collast
operator|=
name|t
expr_stmt|;
block|}
name|QPainter
name|painter
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|QPainter
modifier|*
name|p
init|=
operator|&
name|painter
decl_stmt|;
name|QRect
name|rect
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|cellWidth
argument_list|()
argument_list|,
name|cellHeight
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|collast
operator|<
literal|0
operator|||
name|collast
operator|>=
name|ncols
condition|)
name|collast
operator|=
name|ncols
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|rowlast
operator|<
literal|0
operator|||
name|rowlast
operator|>=
name|nrows
condition|)
name|rowlast
operator|=
name|nrows
operator|-
literal|1
expr_stmt|;
comment|// Go through the rows
for|for
control|(
name|int
name|r
init|=
name|rowfirst
init|;
name|r
operator|<=
name|rowlast
condition|;
operator|++
name|r
control|)
block|{
comment|// get row position and height
name|int
name|rowp
init|=
name|rowY
argument_list|(
name|r
argument_list|)
decl_stmt|;
comment|// Go through the columns in the row r
comment|// if we know from where to where, go through [colfirst, collast],
comment|// else go through all of them
for|for
control|(
name|int
name|c
init|=
name|colfirst
init|;
name|c
operator|<=
name|collast
condition|;
operator|++
name|c
control|)
block|{
comment|// get position and width of column c
name|int
name|colp
init|=
name|columnX
argument_list|(
name|c
argument_list|)
decl_stmt|;
comment|// Translate painter and draw the cell
name|rect
operator|.
name|translate
argument_list|(
name|colp
argument_list|,
name|rowp
argument_list|)
expr_stmt|;
name|paintCell
argument_list|(
name|p
argument_list|,
name|r
argument_list|,
name|c
argument_list|,
name|rect
argument_list|)
expr_stmt|;
name|rect
operator|.
name|translate
argument_list|(
operator|-
name|colp
argument_list|,
operator|-
name|rowp
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|struct|QWellArrayData
struct|struct
name|QWellArrayData
block|{
DECL|member|brush
name|QBrush
modifier|*
name|brush
decl_stmt|;
block|}
struct|;
DECL|function|QWellArray
name|QWellArray
operator|::
name|QWellArray
parameter_list|(
name|int
name|rows
parameter_list|,
name|int
name|cols
parameter_list|,
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|nrows
argument_list|(
name|rows
argument_list|)
member_init_list|,
name|ncols
argument_list|(
name|cols
argument_list|)
block|{
name|d
operator|=
literal|0
expr_stmt|;
name|setFocusPolicy
argument_list|(
name|Qt
operator|::
name|StrongFocus
argument_list|)
expr_stmt|;
name|cellw
operator|=
literal|28
expr_stmt|;
name|cellh
operator|=
literal|24
expr_stmt|;
name|curCol
operator|=
literal|0
expr_stmt|;
name|curRow
operator|=
literal|0
expr_stmt|;
name|selCol
operator|=
operator|-
literal|1
expr_stmt|;
name|selRow
operator|=
operator|-
literal|1
expr_stmt|;
block|}
DECL|function|sizeHint
name|QSize
name|QWellArray
operator|::
name|sizeHint
parameter_list|()
specifier|const
block|{
name|ensurePolished
argument_list|()
expr_stmt|;
return|return
name|gridSize
argument_list|()
operator|.
name|boundedTo
argument_list|(
name|QSize
argument_list|(
literal|640
argument_list|,
literal|480
argument_list|)
argument_list|)
return|;
block|}
DECL|function|paintCell
name|void
name|QWellArray
operator|::
name|paintCell
parameter_list|(
name|QPainter
modifier|*
name|p
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QRect
modifier|&
name|rect
parameter_list|)
block|{
name|int
name|b
init|=
literal|3
decl_stmt|;
comment|//margin
specifier|const
name|QPalette
modifier|&
name|g
init|=
name|palette
argument_list|()
decl_stmt|;
name|QStyleOptionFrame
name|opt
decl_stmt|;
name|int
name|dfw
init|=
name|style
argument_list|()
operator|->
name|pixelMetric
argument_list|(
name|QStyle
operator|::
name|PM_DefaultFrameWidth
argument_list|)
decl_stmt|;
name|opt
operator|.
name|lineWidth
operator|=
name|dfw
expr_stmt|;
name|opt
operator|.
name|midLineWidth
operator|=
literal|1
expr_stmt|;
name|opt
operator|.
name|rect
operator|=
name|rect
operator|.
name|adjusted
argument_list|(
name|b
argument_list|,
name|b
argument_list|,
operator|-
name|b
argument_list|,
operator|-
name|b
argument_list|)
expr_stmt|;
name|opt
operator|.
name|palette
operator|=
name|g
expr_stmt|;
name|opt
operator|.
name|state
operator|=
name|QStyle
operator|::
name|State_Enabled
operator||
name|QStyle
operator|::
name|State_Sunken
expr_stmt|;
name|style
argument_list|()
operator|->
name|drawPrimitive
argument_list|(
name|QStyle
operator|::
name|PE_Frame
argument_list|,
operator|&
name|opt
argument_list|,
name|p
argument_list|,
name|this
argument_list|)
expr_stmt|;
name|b
operator|+=
name|dfw
expr_stmt|;
if|if
condition|(
operator|(
name|row
operator|==
name|curRow
operator|)
operator|&&
operator|(
name|col
operator|==
name|curCol
operator|)
condition|)
block|{
if|if
condition|(
name|hasFocus
argument_list|()
condition|)
block|{
name|QStyleOptionFocusRect
name|opt
decl_stmt|;
name|opt
operator|.
name|palette
operator|=
name|g
expr_stmt|;
name|opt
operator|.
name|rect
operator|=
name|rect
expr_stmt|;
name|opt
operator|.
name|state
operator|=
name|QStyle
operator|::
name|State_None
operator||
name|QStyle
operator|::
name|State_KeyboardFocusChange
expr_stmt|;
name|style
argument_list|()
operator|->
name|drawPrimitive
argument_list|(
name|QStyle
operator|::
name|PE_FrameFocusRect
argument_list|,
operator|&
name|opt
argument_list|,
name|p
argument_list|,
name|this
argument_list|)
expr_stmt|;
block|}
block|}
name|paintCellContents
argument_list|(
name|p
argument_list|,
name|row
argument_list|,
name|col
argument_list|,
name|opt
operator|.
name|rect
operator|.
name|adjusted
argument_list|(
name|dfw
argument_list|,
name|dfw
argument_list|,
operator|-
name|dfw
argument_list|,
operator|-
name|dfw
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/*!   Reimplement this function to change the contents of the well array.  */
DECL|function|paintCellContents
name|void
name|QWellArray
operator|::
name|paintCellContents
parameter_list|(
name|QPainter
modifier|*
name|p
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QRect
modifier|&
name|r
parameter_list|)
block|{
if|if
condition|(
name|d
condition|)
block|{
name|p
operator|->
name|fillRect
argument_list|(
name|r
argument_list|,
name|d
operator|->
name|brush
index|[
name|row
operator|*
name|numCols
argument_list|()
operator|+
name|col
index|]
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|p
operator|->
name|fillRect
argument_list|(
name|r
argument_list|,
name|Qt
operator|::
name|white
argument_list|)
expr_stmt|;
name|p
operator|->
name|setPen
argument_list|(
name|Qt
operator|::
name|black
argument_list|)
expr_stmt|;
name|p
operator|->
name|drawLine
argument_list|(
name|r
operator|.
name|topLeft
argument_list|()
argument_list|,
name|r
operator|.
name|bottomRight
argument_list|()
argument_list|)
expr_stmt|;
name|p
operator|->
name|drawLine
argument_list|(
name|r
operator|.
name|topRight
argument_list|()
argument_list|,
name|r
operator|.
name|bottomLeft
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|mousePressEvent
name|void
name|QWellArray
operator|::
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
comment|// The current cell marker is set to the cell the mouse is pressed in
name|QPoint
name|pos
init|=
name|e
operator|->
name|pos
argument_list|()
decl_stmt|;
name|setCurrent
argument_list|(
name|rowAt
argument_list|(
name|pos
operator|.
name|y
argument_list|()
argument_list|)
argument_list|,
name|columnAt
argument_list|(
name|pos
operator|.
name|x
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|mouseReleaseEvent
name|void
name|QWellArray
operator|::
name|mouseReleaseEvent
parameter_list|(
name|QMouseEvent
modifier|*
comment|/* event */
parameter_list|)
block|{
comment|// The current cell marker is set to the cell the mouse is clicked in
name|setSelected
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
block|}
comment|/*   Sets the cell currently having the focus. This is not necessarily   the same as the currently selected cell. */
DECL|function|setCurrent
name|void
name|QWellArray
operator|::
name|setCurrent
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
block|{
if|if
condition|(
operator|(
name|curRow
operator|==
name|row
operator|)
operator|&&
operator|(
name|curCol
operator|==
name|col
operator|)
condition|)
return|return;
if|if
condition|(
name|row
operator|<
literal|0
operator|||
name|col
operator|<
literal|0
condition|)
name|row
operator|=
name|col
operator|=
operator|-
literal|1
expr_stmt|;
name|int
name|oldRow
init|=
name|curRow
decl_stmt|;
name|int
name|oldCol
init|=
name|curCol
decl_stmt|;
name|curRow
operator|=
name|row
expr_stmt|;
name|curCol
operator|=
name|col
expr_stmt|;
name|updateCell
argument_list|(
name|oldRow
argument_list|,
name|oldCol
argument_list|)
expr_stmt|;
name|updateCell
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
emit|emit
name|currentChanged
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
emit|;
block|}
comment|/*   Sets the currently selected cell to \a row, \a column. If \a row or   \a column are less than zero, the current cell is unselected.    Does not set the position of the focus indicator. */
DECL|function|setSelected
name|void
name|QWellArray
operator|::
name|setSelected
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
block|{
name|int
name|oldRow
init|=
name|selRow
decl_stmt|;
name|int
name|oldCol
init|=
name|selCol
decl_stmt|;
if|if
condition|(
name|row
operator|<
literal|0
operator|||
name|col
operator|<
literal|0
condition|)
name|row
operator|=
name|col
operator|=
operator|-
literal|1
expr_stmt|;
name|selCol
operator|=
name|col
expr_stmt|;
name|selRow
operator|=
name|row
expr_stmt|;
name|updateCell
argument_list|(
name|oldRow
argument_list|,
name|oldCol
argument_list|)
expr_stmt|;
name|updateCell
argument_list|(
name|selRow
argument_list|,
name|selCol
argument_list|)
expr_stmt|;
if|if
condition|(
name|row
operator|>=
literal|0
condition|)
emit|emit
name|selected
argument_list|(
name|row
argument_list|,
name|col
argument_list|)
emit|;
ifndef|#
directive|ifndef
name|QT_NO_MENU
if|if
condition|(
name|isVisible
argument_list|()
operator|&&
name|qobject_cast
argument_list|<
name|QMenu
operator|*
argument_list|>
argument_list|(
name|parentWidget
argument_list|()
argument_list|)
condition|)
name|parentWidget
argument_list|()
operator|->
name|close
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
DECL|function|focusInEvent
name|void
name|QWellArray
operator|::
name|focusInEvent
parameter_list|(
name|QFocusEvent
modifier|*
parameter_list|)
block|{
name|updateCell
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
emit|emit
name|currentChanged
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
emit|;
block|}
DECL|function|setCellBrush
name|void
name|QWellArray
operator|::
name|setCellBrush
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QBrush
modifier|&
name|b
parameter_list|)
block|{
if|if
condition|(
operator|!
name|d
condition|)
block|{
name|d
operator|=
operator|new
name|QWellArrayData
expr_stmt|;
name|int
name|i
init|=
name|numRows
argument_list|()
operator|*
name|numCols
argument_list|()
decl_stmt|;
name|d
operator|->
name|brush
operator|=
operator|new
name|QBrush
index|[
name|i
index|]
expr_stmt|;
block|}
if|if
condition|(
name|row
operator|>=
literal|0
operator|&&
name|row
operator|<
name|numRows
argument_list|()
operator|&&
name|col
operator|>=
literal|0
operator|&&
name|col
operator|<
name|numCols
argument_list|()
condition|)
name|d
operator|->
name|brush
index|[
name|row
operator|*
name|numCols
argument_list|()
operator|+
name|col
index|]
operator|=
name|b
expr_stmt|;
block|}
comment|/*   Returns the brush set for the cell at \a row, \a column. If no brush is   set, Qt::NoBrush is returned. */
DECL|function|cellBrush
name|QBrush
name|QWellArray
operator|::
name|cellBrush
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|)
block|{
if|if
condition|(
name|d
operator|&&
name|row
operator|>=
literal|0
operator|&&
name|row
operator|<
name|numRows
argument_list|()
operator|&&
name|col
operator|>=
literal|0
operator|&&
name|col
operator|<
name|numCols
argument_list|()
condition|)
return|return
name|d
operator|->
name|brush
index|[
name|row
operator|*
name|numCols
argument_list|()
operator|+
name|col
index|]
return|;
return|return
name|Qt
operator|::
name|NoBrush
return|;
block|}
comment|/*!\reimp */
DECL|function|focusOutEvent
name|void
name|QWellArray
operator|::
name|focusOutEvent
parameter_list|(
name|QFocusEvent
modifier|*
parameter_list|)
block|{
name|updateCell
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
block|}
comment|/*\reimp */
DECL|function|keyPressEvent
name|void
name|QWellArray
operator|::
name|keyPressEvent
parameter_list|(
name|QKeyEvent
modifier|*
name|e
parameter_list|)
block|{
switch|switch
condition|(
name|e
operator|->
name|key
argument_list|()
condition|)
block|{
comment|// Look at the key code
case|case
name|Qt
operator|::
name|Key_Left
case|:
comment|// If 'left arrow'-key,
if|if
condition|(
name|curCol
operator|>
literal|0
condition|)
comment|// and cr't not in leftmost col
name|setCurrent
argument_list|(
name|curRow
argument_list|,
name|curCol
operator|-
literal|1
argument_list|)
expr_stmt|;
comment|// set cr't to next left column
break|break;
case|case
name|Qt
operator|::
name|Key_Right
case|:
comment|// Correspondingly...
if|if
condition|(
name|curCol
operator|<
name|numCols
argument_list|()
operator|-
literal|1
condition|)
name|setCurrent
argument_list|(
name|curRow
argument_list|,
name|curCol
operator|+
literal|1
argument_list|)
expr_stmt|;
break|break;
case|case
name|Qt
operator|::
name|Key_Up
case|:
if|if
condition|(
name|curRow
operator|>
literal|0
condition|)
name|setCurrent
argument_list|(
name|curRow
operator|-
literal|1
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
break|break;
case|case
name|Qt
operator|::
name|Key_Down
case|:
if|if
condition|(
name|curRow
operator|<
name|numRows
argument_list|()
operator|-
literal|1
condition|)
name|setCurrent
argument_list|(
name|curRow
operator|+
literal|1
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
break|break;
if|#
directive|if
literal|0
comment|// bad idea that shouldn't have been implemented; very counterintuitive
block|case Qt::Key_Return:     case Qt::Key_Enter:
comment|/*           ignore the key, so that the dialog get it, but still select           the current row/col         */
block|e->ignore();
comment|// fallthrough intended
endif|#
directive|endif
case|case
name|Qt
operator|::
name|Key_Space
case|:
name|setSelected
argument_list|(
name|curRow
argument_list|,
name|curCol
argument_list|)
expr_stmt|;
break|break;
default|default:
comment|// If not an interesting key,
name|e
operator|->
name|ignore
argument_list|()
expr_stmt|;
comment|// we don't accept the event
return|return;
block|}
block|}
comment|//////////// QWellArray END
comment|// Event filter to be installed on the dialog while in color-picking mode.
DECL|class|QColorPickingEventFilter
class|class
name|QColorPickingEventFilter
super|:
specifier|public
name|QObject
block|{
public|public:
DECL|function|QColorPickingEventFilter
specifier|explicit
name|QColorPickingEventFilter
parameter_list|(
name|QColorDialogPrivate
modifier|*
name|dp
parameter_list|,
name|QObject
modifier|*
name|parent
init|=
literal|0
parameter_list|)
member_init_list|:
name|QObject
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|m_dp
argument_list|(
name|dp
argument_list|)
block|{}
name|bool
name|eventFilter
parameter_list|(
name|QObject
modifier|*
parameter_list|,
name|QEvent
modifier|*
name|event
parameter_list|)
name|Q_DECL_OVERRIDE
block|{
switch|switch
condition|(
name|event
operator|->
name|type
argument_list|()
condition|)
block|{
case|case
name|QEvent
operator|::
name|MouseMove
case|:
return|return
name|m_dp
operator|->
name|handleColorPickingMouseMove
argument_list|(
cast|static_cast
argument_list|<
name|QMouseEvent
operator|*
argument_list|>
argument_list|(
name|event
argument_list|)
argument_list|)
return|;
case|case
name|QEvent
operator|::
name|MouseButtonRelease
case|:
return|return
name|m_dp
operator|->
name|handleColorPickingMouseButtonRelease
argument_list|(
cast|static_cast
argument_list|<
name|QMouseEvent
operator|*
argument_list|>
argument_list|(
name|event
argument_list|)
argument_list|)
return|;
case|case
name|QEvent
operator|::
name|KeyPress
case|:
return|return
name|m_dp
operator|->
name|handleColorPickingKeyPress
argument_list|(
cast|static_cast
argument_list|<
name|QKeyEvent
operator|*
argument_list|>
argument_list|(
name|event
argument_list|)
argument_list|)
return|;
default|default:
break|break;
block|}
return|return
literal|false
return|;
block|}
private|private:
DECL|member|m_dp
name|QColorDialogPrivate
modifier|*
name|m_dp
decl_stmt|;
block|}
class|;
block|}
end_namespace
begin_comment
comment|// unnamed namespace
end_comment
begin_comment
comment|/*!     Returns the number of custom colors supported by QColorDialog. All     color dialogs share the same custom colors. */
end_comment
begin_function
DECL|function|customCount
name|int
name|QColorDialog
operator|::
name|customCount
parameter_list|()
block|{
return|return
name|QColorDialogOptions
operator|::
name|customColorCount
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns the custom color at the given \a index as a QColor value. */
end_comment
begin_function
DECL|function|customColor
name|QColor
name|QColorDialog
operator|::
name|customColor
parameter_list|(
name|int
name|index
parameter_list|)
block|{
return|return
name|QColor
argument_list|(
name|QColorDialogOptions
operator|::
name|customColor
argument_list|(
name|index
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Sets the custom color at \a index to the QColor \a color value.      \note This function does not apply to the Native Color Dialog on the Mac     OS X platform. If you still require this function, use the     QColorDialog::DontUseNativeDialog option. */
end_comment
begin_function
DECL|function|setCustomColor
name|void
name|QColorDialog
operator|::
name|setCustomColor
parameter_list|(
name|int
name|index
parameter_list|,
name|QColor
name|color
parameter_list|)
block|{
name|QColorDialogOptions
operator|::
name|setCustomColor
argument_list|(
name|index
argument_list|,
name|color
operator|.
name|rgba
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_comment
comment|/*!     \since 5.0      Returns the standard color at the given \a index as a QColor value. */
end_comment
begin_function
DECL|function|standardColor
name|QColor
name|QColorDialog
operator|::
name|standardColor
parameter_list|(
name|int
name|index
parameter_list|)
block|{
return|return
name|QColor
argument_list|(
name|QColorDialogOptions
operator|::
name|standardColor
argument_list|(
name|index
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     Sets the standard color at \a index to the QColor \a color value.      \note This function does not apply to the Native Color Dialog on the Mac     OS X platform. If you still require this function, use the     QColorDialog::DontUseNativeDialog option. */
end_comment
begin_function
DECL|function|setStandardColor
name|void
name|QColorDialog
operator|::
name|setStandardColor
parameter_list|(
name|int
name|index
parameter_list|,
name|QColor
name|color
parameter_list|)
block|{
name|QColorDialogOptions
operator|::
name|setStandardColor
argument_list|(
name|index
argument_list|,
name|color
operator|.
name|rgba
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|rgb2hsv
specifier|static
specifier|inline
name|void
name|rgb2hsv
parameter_list|(
name|QRgb
name|rgb
parameter_list|,
name|int
modifier|&
name|h
parameter_list|,
name|int
modifier|&
name|s
parameter_list|,
name|int
modifier|&
name|v
parameter_list|)
block|{
name|QColor
name|c
decl_stmt|;
name|c
operator|.
name|setRgb
argument_list|(
name|rgb
argument_list|)
expr_stmt|;
name|c
operator|.
name|getHsv
argument_list|(
operator|&
name|h
argument_list|,
operator|&
name|s
argument_list|,
operator|&
name|v
argument_list|)
expr_stmt|;
block|}
end_function
begin_namespace
namespace|namespace
block|{
DECL|class|QColorWell
class|class
name|QColorWell
super|:
specifier|public
name|QWellArray
block|{
public|public:
DECL|function|QColorWell
name|QColorWell
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|,
name|int
name|r
parameter_list|,
name|int
name|c
parameter_list|,
name|QRgb
modifier|*
name|vals
parameter_list|)
member_init_list|:
name|QWellArray
argument_list|(
name|r
argument_list|,
name|c
argument_list|,
name|parent
argument_list|)
member_init_list|,
name|values
argument_list|(
name|vals
argument_list|)
member_init_list|,
name|mousePressed
argument_list|(
literal|false
argument_list|)
member_init_list|,
name|oldCurrent
argument_list|(
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
block|{
name|setSizePolicy
argument_list|(
name|QSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Minimum
argument_list|,
name|QSizePolicy
operator|::
name|Minimum
argument_list|)
argument_list|)
expr_stmt|;
block|}
protected|protected:
DECL|member|Q_DECL_OVERRIDE
name|void
name|paintCellContents
parameter_list|(
name|QPainter
modifier|*
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QRect
modifier|&
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseReleaseEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
ifndef|#
directive|ifndef
name|QT_NO_DRAGANDDROP
DECL|member|Q_DECL_OVERRIDE
name|void
name|dragEnterEvent
parameter_list|(
name|QDragEnterEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|dragLeaveEvent
parameter_list|(
name|QDragLeaveEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|dragMoveEvent
parameter_list|(
name|QDragMoveEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|dropEvent
parameter_list|(
name|QDropEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
endif|#
directive|endif
private|private:
DECL|member|values
name|QRgb
modifier|*
name|values
decl_stmt|;
DECL|member|mousePressed
name|bool
name|mousePressed
decl_stmt|;
DECL|member|pressPos
name|QPoint
name|pressPos
decl_stmt|;
DECL|member|oldCurrent
name|QPoint
name|oldCurrent
decl_stmt|;
block|}
class|;
DECL|function|paintCellContents
name|void
name|QColorWell
operator|::
name|paintCellContents
parameter_list|(
name|QPainter
modifier|*
name|p
parameter_list|,
name|int
name|row
parameter_list|,
name|int
name|col
parameter_list|,
specifier|const
name|QRect
modifier|&
name|r
parameter_list|)
block|{
name|int
name|i
init|=
name|row
operator|+
name|col
operator|*
name|numRows
argument_list|()
decl_stmt|;
name|p
operator|->
name|fillRect
argument_list|(
name|r
argument_list|,
name|QColor
argument_list|(
name|values
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|mousePressEvent
name|void
name|QColorWell
operator|::
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
name|oldCurrent
operator|=
name|QPoint
argument_list|(
name|selectedRow
argument_list|()
argument_list|,
name|selectedColumn
argument_list|()
argument_list|)
expr_stmt|;
name|QWellArray
operator|::
name|mousePressEvent
argument_list|(
name|e
argument_list|)
expr_stmt|;
name|mousePressed
operator|=
literal|true
expr_stmt|;
name|pressPos
operator|=
name|e
operator|->
name|pos
argument_list|()
expr_stmt|;
block|}
DECL|function|mouseMoveEvent
name|void
name|QColorWell
operator|::
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
name|QWellArray
operator|::
name|mouseMoveEvent
argument_list|(
name|e
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_DRAGANDDROP
if|if
condition|(
operator|!
name|mousePressed
condition|)
return|return;
if|if
condition|(
operator|(
name|pressPos
operator|-
name|e
operator|->
name|pos
argument_list|()
operator|)
operator|.
name|manhattanLength
argument_list|()
operator|>
name|QApplication
operator|::
name|startDragDistance
argument_list|()
condition|)
block|{
name|setCurrent
argument_list|(
name|oldCurrent
operator|.
name|x
argument_list|()
argument_list|,
name|oldCurrent
operator|.
name|y
argument_list|()
argument_list|)
expr_stmt|;
name|int
name|i
init|=
name|rowAt
argument_list|(
name|pressPos
operator|.
name|y
argument_list|()
argument_list|)
operator|+
name|columnAt
argument_list|(
name|pressPos
operator|.
name|x
argument_list|()
argument_list|)
operator|*
name|numRows
argument_list|()
decl_stmt|;
name|QColor
name|col
argument_list|(
name|values
index|[
name|i
index|]
argument_list|)
decl_stmt|;
name|QMimeData
modifier|*
name|mime
init|=
operator|new
name|QMimeData
decl_stmt|;
name|mime
operator|->
name|setColorData
argument_list|(
name|col
argument_list|)
expr_stmt|;
name|QPixmap
name|pix
argument_list|(
name|cellWidth
argument_list|()
argument_list|,
name|cellHeight
argument_list|()
argument_list|)
decl_stmt|;
name|pix
operator|.
name|fill
argument_list|(
name|col
argument_list|)
expr_stmt|;
name|QPainter
name|p
argument_list|(
operator|&
name|pix
argument_list|)
decl_stmt|;
name|p
operator|.
name|drawRect
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|pix
operator|.
name|width
argument_list|()
operator|-
literal|1
argument_list|,
name|pix
operator|.
name|height
argument_list|()
operator|-
literal|1
argument_list|)
expr_stmt|;
name|p
operator|.
name|end
argument_list|()
expr_stmt|;
name|QDrag
modifier|*
name|drg
init|=
operator|new
name|QDrag
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|drg
operator|->
name|setMimeData
argument_list|(
name|mime
argument_list|)
expr_stmt|;
name|drg
operator|->
name|setPixmap
argument_list|(
name|pix
argument_list|)
expr_stmt|;
name|mousePressed
operator|=
literal|false
expr_stmt|;
name|drg
operator|->
name|start
argument_list|()
expr_stmt|;
block|}
endif|#
directive|endif
block|}
ifndef|#
directive|ifndef
name|QT_NO_DRAGANDDROP
DECL|function|dragEnterEvent
name|void
name|QColorWell
operator|::
name|dragEnterEvent
parameter_list|(
name|QDragEnterEvent
modifier|*
name|e
parameter_list|)
block|{
if|if
condition|(
name|qvariant_cast
argument_list|<
name|QColor
argument_list|>
argument_list|(
name|e
operator|->
name|mimeData
argument_list|()
operator|->
name|colorData
argument_list|()
argument_list|)
operator|.
name|isValid
argument_list|()
condition|)
name|e
operator|->
name|accept
argument_list|()
expr_stmt|;
else|else
name|e
operator|->
name|ignore
argument_list|()
expr_stmt|;
block|}
DECL|function|dragLeaveEvent
name|void
name|QColorWell
operator|::
name|dragLeaveEvent
parameter_list|(
name|QDragLeaveEvent
modifier|*
parameter_list|)
block|{
if|if
condition|(
name|hasFocus
argument_list|()
condition|)
name|parentWidget
argument_list|()
operator|->
name|setFocus
argument_list|()
expr_stmt|;
block|}
DECL|function|dragMoveEvent
name|void
name|QColorWell
operator|::
name|dragMoveEvent
parameter_list|(
name|QDragMoveEvent
modifier|*
name|e
parameter_list|)
block|{
if|if
condition|(
name|qvariant_cast
argument_list|<
name|QColor
argument_list|>
argument_list|(
name|e
operator|->
name|mimeData
argument_list|()
operator|->
name|colorData
argument_list|()
argument_list|)
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|setCurrent
argument_list|(
name|rowAt
argument_list|(
name|e
operator|->
name|pos
argument_list|()
operator|.
name|y
argument_list|()
argument_list|)
argument_list|,
name|columnAt
argument_list|(
name|e
operator|->
name|pos
argument_list|()
operator|.
name|x
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|e
operator|->
name|accept
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|e
operator|->
name|ignore
argument_list|()
expr_stmt|;
block|}
block|}
DECL|function|dropEvent
name|void
name|QColorWell
operator|::
name|dropEvent
parameter_list|(
name|QDropEvent
modifier|*
name|e
parameter_list|)
block|{
name|QColor
name|col
init|=
name|qvariant_cast
argument_list|<
name|QColor
argument_list|>
argument_list|(
name|e
operator|->
name|mimeData
argument_list|()
operator|->
name|colorData
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|col
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|int
name|i
init|=
name|rowAt
argument_list|(
name|e
operator|->
name|pos
argument_list|()
operator|.
name|y
argument_list|()
argument_list|)
operator|+
name|columnAt
argument_list|(
name|e
operator|->
name|pos
argument_list|()
operator|.
name|x
argument_list|()
argument_list|)
operator|*
name|numRows
argument_list|()
decl_stmt|;
name|values
index|[
name|i
index|]
operator|=
name|col
operator|.
name|rgb
argument_list|()
expr_stmt|;
name|update
argument_list|()
expr_stmt|;
name|e
operator|->
name|accept
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|e
operator|->
name|ignore
argument_list|()
expr_stmt|;
block|}
block|}
endif|#
directive|endif
comment|// QT_NO_DRAGANDDROP
DECL|function|mouseReleaseEvent
name|void
name|QColorWell
operator|::
name|mouseReleaseEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
if|if
condition|(
operator|!
name|mousePressed
condition|)
return|return;
name|QWellArray
operator|::
name|mouseReleaseEvent
argument_list|(
name|e
argument_list|)
expr_stmt|;
name|mousePressed
operator|=
literal|false
expr_stmt|;
block|}
DECL|class|QColorPicker
class|class
name|QColorPicker
super|:
specifier|public
name|QFrame
block|{
name|Q_OBJECT
public|public:
name|QColorPicker
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
constructor_decl|;
name|~
name|QColorPicker
parameter_list|()
destructor_decl|;
name|void
name|setCrossVisible
parameter_list|(
name|bool
name|visible
parameter_list|)
function_decl|;
public|public
name|slots
public|:
name|void
name|setCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|)
function_decl|;
signals|signals:
name|void
name|newCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|)
function_decl|;
protected|protected:
DECL|member|Q_DECL_OVERRIDE
name|QSize
name|sizeHint
parameter_list|()
specifier|const
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|resizeEvent
parameter_list|(
name|QResizeEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
private|private:
DECL|member|hue
name|int
name|hue
decl_stmt|;
DECL|member|sat
name|int
name|sat
decl_stmt|;
name|QPoint
name|colPt
parameter_list|()
function_decl|;
name|int
name|huePt
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pt
parameter_list|)
function_decl|;
name|int
name|satPt
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pt
parameter_list|)
function_decl|;
name|void
name|setCol
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pt
parameter_list|)
function_decl|;
DECL|member|pix
name|QPixmap
name|pix
decl_stmt|;
DECL|member|crossVisible
name|bool
name|crossVisible
decl_stmt|;
block|}
class|;
DECL|member|pWidth
specifier|static
name|int
name|pWidth
init|=
literal|220
decl_stmt|;
DECL|member|pHeight
specifier|static
name|int
name|pHeight
init|=
literal|200
decl_stmt|;
DECL|class|QColorLuminancePicker
class|class
name|QColorLuminancePicker
super|:
specifier|public
name|QWidget
block|{
name|Q_OBJECT
public|public:
name|QColorLuminancePicker
parameter_list|(
name|QWidget
modifier|*
name|parent
init|=
literal|0
parameter_list|)
constructor_decl|;
name|~
name|QColorLuminancePicker
parameter_list|()
destructor_decl|;
public|public
name|slots
public|:
name|void
name|setCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
function_decl|;
name|void
name|setCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|)
function_decl|;
signals|signals:
name|void
name|newHsv
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
function_decl|;
protected|protected:
DECL|member|Q_DECL_OVERRIDE
name|void
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
private|private:
DECL|enumerator|foff
DECL|enumerator|coff
enum|enum
block|{
name|foff
init|=
literal|3
block|,
name|coff
init|=
literal|4
block|}
enum|;
comment|//frame and contents offset
DECL|member|val
name|int
name|val
decl_stmt|;
DECL|member|hue
name|int
name|hue
decl_stmt|;
DECL|member|sat
name|int
name|sat
decl_stmt|;
name|int
name|y2val
parameter_list|(
name|int
name|y
parameter_list|)
function_decl|;
name|int
name|val2y
parameter_list|(
name|int
name|val
parameter_list|)
function_decl|;
name|void
name|setVal
parameter_list|(
name|int
name|v
parameter_list|)
function_decl|;
DECL|member|pix
name|QPixmap
modifier|*
name|pix
decl_stmt|;
block|}
class|;
DECL|function|y2val
name|int
name|QColorLuminancePicker
operator|::
name|y2val
parameter_list|(
name|int
name|y
parameter_list|)
block|{
name|int
name|d
init|=
name|height
argument_list|()
operator|-
literal|2
operator|*
name|coff
operator|-
literal|1
decl_stmt|;
return|return
literal|255
operator|-
operator|(
name|y
operator|-
name|coff
operator|)
operator|*
literal|255
operator|/
name|d
return|;
block|}
DECL|function|val2y
name|int
name|QColorLuminancePicker
operator|::
name|val2y
parameter_list|(
name|int
name|v
parameter_list|)
block|{
name|int
name|d
init|=
name|height
argument_list|()
operator|-
literal|2
operator|*
name|coff
operator|-
literal|1
decl_stmt|;
return|return
name|coff
operator|+
operator|(
literal|255
operator|-
name|v
operator|)
operator|*
name|d
operator|/
literal|255
return|;
block|}
DECL|function|QColorLuminancePicker
name|QColorLuminancePicker
operator|::
name|QColorLuminancePicker
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
block|{
name|hue
operator|=
literal|100
expr_stmt|;
name|val
operator|=
literal|100
expr_stmt|;
name|sat
operator|=
literal|100
expr_stmt|;
name|pix
operator|=
literal|0
expr_stmt|;
comment|//    setAttribute(WA_NoErase, true);
block|}
DECL|function|~QColorLuminancePicker
name|QColorLuminancePicker
operator|::
name|~
name|QColorLuminancePicker
parameter_list|()
block|{
operator|delete
name|pix
expr_stmt|;
block|}
DECL|function|mouseMoveEvent
name|void
name|QColorLuminancePicker
operator|::
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|m
parameter_list|)
block|{
name|setVal
argument_list|(
name|y2val
argument_list|(
name|m
operator|->
name|y
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|mousePressEvent
name|void
name|QColorLuminancePicker
operator|::
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|m
parameter_list|)
block|{
name|setVal
argument_list|(
name|y2val
argument_list|(
name|m
operator|->
name|y
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|setVal
name|void
name|QColorLuminancePicker
operator|::
name|setVal
parameter_list|(
name|int
name|v
parameter_list|)
block|{
if|if
condition|(
name|val
operator|==
name|v
condition|)
return|return;
name|val
operator|=
name|qMax
argument_list|(
literal|0
argument_list|,
name|qMin
argument_list|(
name|v
argument_list|,
literal|255
argument_list|)
argument_list|)
expr_stmt|;
operator|delete
name|pix
expr_stmt|;
name|pix
operator|=
literal|0
expr_stmt|;
name|repaint
argument_list|()
expr_stmt|;
emit|emit
name|newHsv
argument_list|(
name|hue
argument_list|,
name|sat
argument_list|,
name|val
argument_list|)
emit|;
block|}
comment|//receives from a hue,sat chooser and relays.
DECL|function|setCol
name|void
name|QColorLuminancePicker
operator|::
name|setCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|)
block|{
name|setCol
argument_list|(
name|h
argument_list|,
name|s
argument_list|,
name|val
argument_list|)
expr_stmt|;
emit|emit
name|newHsv
argument_list|(
name|h
argument_list|,
name|s
argument_list|,
name|val
argument_list|)
emit|;
block|}
DECL|function|paintEvent
name|void
name|QColorLuminancePicker
operator|::
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
parameter_list|)
block|{
name|int
name|w
init|=
name|width
argument_list|()
operator|-
literal|5
decl_stmt|;
name|QRect
name|r
argument_list|(
literal|0
argument_list|,
name|foff
argument_list|,
name|w
argument_list|,
name|height
argument_list|()
operator|-
literal|2
operator|*
name|foff
argument_list|)
decl_stmt|;
name|int
name|wi
init|=
name|r
operator|.
name|width
argument_list|()
operator|-
literal|2
decl_stmt|;
name|int
name|hi
init|=
name|r
operator|.
name|height
argument_list|()
operator|-
literal|2
decl_stmt|;
if|if
condition|(
operator|!
name|pix
operator|||
name|pix
operator|->
name|height
argument_list|()
operator|!=
name|hi
operator|||
name|pix
operator|->
name|width
argument_list|()
operator|!=
name|wi
condition|)
block|{
operator|delete
name|pix
expr_stmt|;
name|QImage
name|img
argument_list|(
name|wi
argument_list|,
name|hi
argument_list|,
name|QImage
operator|::
name|Format_RGB32
argument_list|)
decl_stmt|;
name|int
name|y
decl_stmt|;
name|uint
modifier|*
name|pixel
init|=
operator|(
name|uint
operator|*
operator|)
name|img
operator|.
name|scanLine
argument_list|(
literal|0
argument_list|)
decl_stmt|;
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
name|hi
condition|;
name|y
operator|++
control|)
block|{
name|uint
modifier|*
name|end
init|=
name|pixel
operator|+
name|wi
decl_stmt|;
name|std
operator|::
name|fill
argument_list|(
name|pixel
argument_list|,
name|end
argument_list|,
name|QColor
operator|::
name|fromHsv
argument_list|(
name|hue
argument_list|,
name|sat
argument_list|,
name|y2val
argument_list|(
name|y
operator|+
name|coff
argument_list|)
argument_list|)
operator|.
name|rgb
argument_list|()
argument_list|)
expr_stmt|;
name|pixel
operator|=
name|end
expr_stmt|;
block|}
name|pix
operator|=
operator|new
name|QPixmap
argument_list|(
name|QPixmap
operator|::
name|fromImage
argument_list|(
name|img
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|QPainter
name|p
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|p
operator|.
name|drawPixmap
argument_list|(
literal|1
argument_list|,
name|coff
argument_list|,
operator|*
name|pix
argument_list|)
expr_stmt|;
specifier|const
name|QPalette
modifier|&
name|g
init|=
name|palette
argument_list|()
decl_stmt|;
name|qDrawShadePanel
argument_list|(
operator|&
name|p
argument_list|,
name|r
argument_list|,
name|g
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|p
operator|.
name|setPen
argument_list|(
name|g
operator|.
name|foreground
argument_list|()
operator|.
name|color
argument_list|()
argument_list|)
expr_stmt|;
name|p
operator|.
name|setBrush
argument_list|(
name|g
operator|.
name|foreground
argument_list|()
argument_list|)
expr_stmt|;
name|QPolygon
name|a
decl_stmt|;
name|int
name|y
init|=
name|val2y
argument_list|(
name|val
argument_list|)
decl_stmt|;
name|a
operator|.
name|setPoints
argument_list|(
literal|3
argument_list|,
name|w
argument_list|,
name|y
argument_list|,
name|w
operator|+
literal|5
argument_list|,
name|y
operator|+
literal|5
argument_list|,
name|w
operator|+
literal|5
argument_list|,
name|y
operator|-
literal|5
argument_list|)
expr_stmt|;
name|p
operator|.
name|eraseRect
argument_list|(
name|w
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|,
name|height
argument_list|()
argument_list|)
expr_stmt|;
name|p
operator|.
name|drawPolygon
argument_list|(
name|a
argument_list|)
expr_stmt|;
block|}
DECL|function|setCol
name|void
name|QColorLuminancePicker
operator|::
name|setCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
block|{
name|val
operator|=
name|v
expr_stmt|;
name|hue
operator|=
name|h
expr_stmt|;
name|sat
operator|=
name|s
expr_stmt|;
operator|delete
name|pix
expr_stmt|;
name|pix
operator|=
literal|0
expr_stmt|;
name|repaint
argument_list|()
expr_stmt|;
block|}
DECL|function|colPt
name|QPoint
name|QColorPicker
operator|::
name|colPt
parameter_list|()
block|{
name|QRect
name|r
init|=
name|contentsRect
argument_list|()
decl_stmt|;
return|return
name|QPoint
argument_list|(
operator|(
literal|360
operator|-
name|hue
operator|)
operator|*
operator|(
name|r
operator|.
name|width
argument_list|()
operator|-
literal|1
operator|)
operator|/
literal|360
argument_list|,
operator|(
literal|255
operator|-
name|sat
operator|)
operator|*
operator|(
name|r
operator|.
name|height
argument_list|()
operator|-
literal|1
operator|)
operator|/
literal|255
argument_list|)
return|;
block|}
DECL|function|huePt
name|int
name|QColorPicker
operator|::
name|huePt
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pt
parameter_list|)
block|{
name|QRect
name|r
init|=
name|contentsRect
argument_list|()
decl_stmt|;
return|return
literal|360
operator|-
name|pt
operator|.
name|x
argument_list|()
operator|*
literal|360
operator|/
operator|(
name|r
operator|.
name|width
argument_list|()
operator|-
literal|1
operator|)
return|;
block|}
DECL|function|satPt
name|int
name|QColorPicker
operator|::
name|satPt
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pt
parameter_list|)
block|{
name|QRect
name|r
init|=
name|contentsRect
argument_list|()
decl_stmt|;
return|return
literal|255
operator|-
name|pt
operator|.
name|y
argument_list|()
operator|*
literal|255
operator|/
operator|(
name|r
operator|.
name|height
argument_list|()
operator|-
literal|1
operator|)
return|;
block|}
DECL|function|setCol
name|void
name|QColorPicker
operator|::
name|setCol
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|pt
parameter_list|)
block|{
name|setCol
argument_list|(
name|huePt
argument_list|(
name|pt
argument_list|)
argument_list|,
name|satPt
argument_list|(
name|pt
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|QColorPicker
name|QColorPicker
operator|::
name|QColorPicker
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QFrame
argument_list|(
name|parent
argument_list|)
member_init_list|,
name|crossVisible
argument_list|(
literal|true
argument_list|)
block|{
name|hue
operator|=
literal|0
expr_stmt|;
name|sat
operator|=
literal|0
expr_stmt|;
name|setCol
argument_list|(
literal|150
argument_list|,
literal|255
argument_list|)
expr_stmt|;
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_NoSystemBackground
argument_list|)
expr_stmt|;
name|setSizePolicy
argument_list|(
name|QSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Fixed
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|function|~QColorPicker
name|QColorPicker
operator|::
name|~
name|QColorPicker
parameter_list|()
block|{ }
DECL|function|setCrossVisible
name|void
name|QColorPicker
operator|::
name|setCrossVisible
parameter_list|(
name|bool
name|visible
parameter_list|)
block|{
if|if
condition|(
name|crossVisible
operator|!=
name|visible
condition|)
block|{
name|crossVisible
operator|=
name|visible
expr_stmt|;
name|update
argument_list|()
expr_stmt|;
block|}
block|}
DECL|function|sizeHint
name|QSize
name|QColorPicker
operator|::
name|sizeHint
parameter_list|()
specifier|const
block|{
return|return
name|QSize
argument_list|(
name|pWidth
operator|+
literal|2
operator|*
name|frameWidth
argument_list|()
argument_list|,
name|pHeight
operator|+
literal|2
operator|*
name|frameWidth
argument_list|()
argument_list|)
return|;
block|}
DECL|function|setCol
name|void
name|QColorPicker
operator|::
name|setCol
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|)
block|{
name|int
name|nhue
init|=
name|qMin
argument_list|(
name|qMax
argument_list|(
literal|0
argument_list|,
name|h
argument_list|)
argument_list|,
literal|359
argument_list|)
decl_stmt|;
name|int
name|nsat
init|=
name|qMin
argument_list|(
name|qMax
argument_list|(
literal|0
argument_list|,
name|s
argument_list|)
argument_list|,
literal|255
argument_list|)
decl_stmt|;
if|if
condition|(
name|nhue
operator|==
name|hue
operator|&&
name|nsat
operator|==
name|sat
condition|)
return|return;
name|QRect
name|r
argument_list|(
name|colPt
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
decl_stmt|;
name|hue
operator|=
name|nhue
expr_stmt|;
name|sat
operator|=
name|nsat
expr_stmt|;
name|r
operator|=
name|r
operator|.
name|united
argument_list|(
name|QRect
argument_list|(
name|colPt
argument_list|()
argument_list|,
name|QSize
argument_list|(
literal|20
argument_list|,
literal|20
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|r
operator|.
name|translate
argument_list|(
name|contentsRect
argument_list|()
operator|.
name|x
argument_list|()
operator|-
literal|9
argument_list|,
name|contentsRect
argument_list|()
operator|.
name|y
argument_list|()
operator|-
literal|9
argument_list|)
expr_stmt|;
comment|//    update(r);
name|repaint
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
DECL|function|mouseMoveEvent
name|void
name|QColorPicker
operator|::
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|m
parameter_list|)
block|{
name|QPoint
name|p
init|=
name|m
operator|->
name|pos
argument_list|()
operator|-
name|contentsRect
argument_list|()
operator|.
name|topLeft
argument_list|()
decl_stmt|;
name|setCol
argument_list|(
name|p
argument_list|)
expr_stmt|;
emit|emit
name|newCol
argument_list|(
name|hue
argument_list|,
name|sat
argument_list|)
emit|;
block|}
DECL|function|mousePressEvent
name|void
name|QColorPicker
operator|::
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|m
parameter_list|)
block|{
name|QPoint
name|p
init|=
name|m
operator|->
name|pos
argument_list|()
operator|-
name|contentsRect
argument_list|()
operator|.
name|topLeft
argument_list|()
decl_stmt|;
name|setCol
argument_list|(
name|p
argument_list|)
expr_stmt|;
emit|emit
name|newCol
argument_list|(
name|hue
argument_list|,
name|sat
argument_list|)
emit|;
block|}
DECL|function|paintEvent
name|void
name|QColorPicker
operator|::
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
parameter_list|)
block|{
name|QPainter
name|p
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|drawFrame
argument_list|(
operator|&
name|p
argument_list|)
expr_stmt|;
name|QRect
name|r
init|=
name|contentsRect
argument_list|()
decl_stmt|;
name|p
operator|.
name|drawPixmap
argument_list|(
name|r
operator|.
name|topLeft
argument_list|()
argument_list|,
name|pix
argument_list|)
expr_stmt|;
if|if
condition|(
name|crossVisible
condition|)
block|{
name|QPoint
name|pt
init|=
name|colPt
argument_list|()
operator|+
name|r
operator|.
name|topLeft
argument_list|()
decl_stmt|;
name|p
operator|.
name|setPen
argument_list|(
name|Qt
operator|::
name|black
argument_list|)
expr_stmt|;
name|p
operator|.
name|fillRect
argument_list|(
name|pt
operator|.
name|x
argument_list|()
operator|-
literal|9
argument_list|,
name|pt
operator|.
name|y
argument_list|()
argument_list|,
literal|20
argument_list|,
literal|2
argument_list|,
name|Qt
operator|::
name|black
argument_list|)
expr_stmt|;
name|p
operator|.
name|fillRect
argument_list|(
name|pt
operator|.
name|x
argument_list|()
argument_list|,
name|pt
operator|.
name|y
argument_list|()
operator|-
literal|9
argument_list|,
literal|2
argument_list|,
literal|20
argument_list|,
name|Qt
operator|::
name|black
argument_list|)
expr_stmt|;
block|}
block|}
DECL|function|resizeEvent
name|void
name|QColorPicker
operator|::
name|resizeEvent
parameter_list|(
name|QResizeEvent
modifier|*
name|ev
parameter_list|)
block|{
name|QFrame
operator|::
name|resizeEvent
argument_list|(
name|ev
argument_list|)
expr_stmt|;
name|int
name|w
init|=
name|width
argument_list|()
operator|-
name|frameWidth
argument_list|()
operator|*
literal|2
decl_stmt|;
name|int
name|h
init|=
name|height
argument_list|()
operator|-
name|frameWidth
argument_list|()
operator|*
literal|2
decl_stmt|;
name|QImage
name|img
argument_list|(
name|w
argument_list|,
name|h
argument_list|,
name|QImage
operator|::
name|Format_RGB32
argument_list|)
decl_stmt|;
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
name|uint
modifier|*
name|pixel
init|=
operator|(
name|uint
operator|*
operator|)
name|img
operator|.
name|scanLine
argument_list|(
literal|0
argument_list|)
decl_stmt|;
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
name|h
condition|;
name|y
operator|++
control|)
block|{
specifier|const
name|uint
modifier|*
name|end
init|=
name|pixel
operator|+
name|w
decl_stmt|;
name|x
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|pixel
operator|<
name|end
condition|)
block|{
name|QPoint
name|p
argument_list|(
name|x
argument_list|,
name|y
argument_list|)
decl_stmt|;
name|QColor
name|c
decl_stmt|;
name|c
operator|.
name|setHsv
argument_list|(
name|huePt
argument_list|(
name|p
argument_list|)
argument_list|,
name|satPt
argument_list|(
name|p
argument_list|)
argument_list|,
literal|200
argument_list|)
expr_stmt|;
operator|*
name|pixel
operator|=
name|c
operator|.
name|rgb
argument_list|()
expr_stmt|;
operator|++
name|pixel
expr_stmt|;
operator|++
name|x
expr_stmt|;
block|}
block|}
name|pix
operator|=
name|QPixmap
operator|::
name|fromImage
argument_list|(
name|img
argument_list|)
expr_stmt|;
block|}
DECL|class|QColSpinBox
class|class
name|QColSpinBox
super|:
specifier|public
name|QSpinBox
block|{
public|public:
DECL|function|QColSpinBox
name|QColSpinBox
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QSpinBox
argument_list|(
name|parent
argument_list|)
block|{
name|setRange
argument_list|(
literal|0
argument_list|,
literal|255
argument_list|)
expr_stmt|;
block|}
DECL|function|setValue
name|void
name|setValue
parameter_list|(
name|int
name|i
parameter_list|)
block|{
specifier|const
name|QSignalBlocker
name|blocker
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|QSpinBox
operator|::
name|setValue
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
block|}
class|;
class_decl|class
name|QColorShowLabel
class_decl|;
DECL|class|QColorShower
class|class
name|QColorShower
super|:
specifier|public
name|QWidget
block|{
name|Q_OBJECT
public|public:
name|QColorShower
parameter_list|(
name|QColorDialog
modifier|*
name|parent
parameter_list|)
constructor_decl|;
comment|//things that don't emit signals
name|void
name|setHsv
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
function_decl|;
DECL|function|currentAlpha
name|int
name|currentAlpha
parameter_list|()
specifier|const
block|{
return|return
operator|(
name|colorDialog
operator|->
name|options
argument_list|()
operator|&
name|QColorDialog
operator|::
name|ShowAlphaChannel
operator|)
condition|?
name|alphaEd
operator|->
name|value
argument_list|()
else|:
literal|255
return|;
block|}
DECL|function|setCurrentAlpha
name|void
name|setCurrentAlpha
parameter_list|(
name|int
name|a
parameter_list|)
block|{
name|alphaEd
operator|->
name|setValue
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|rgbEd
argument_list|()
expr_stmt|;
block|}
name|void
name|showAlpha
parameter_list|(
name|bool
name|b
parameter_list|)
function_decl|;
name|bool
name|isAlphaVisible
parameter_list|()
specifier|const
function_decl|;
DECL|function|currentColor
name|QRgb
name|currentColor
parameter_list|()
specifier|const
block|{
return|return
name|curCol
return|;
block|}
DECL|function|currentQColor
name|QColor
name|currentQColor
parameter_list|()
specifier|const
block|{
return|return
name|curQColor
return|;
block|}
name|void
name|retranslateStrings
parameter_list|()
function_decl|;
name|void
name|updateQColor
parameter_list|()
function_decl|;
public|public
name|slots
public|:
name|void
name|setRgb
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
function_decl|;
signals|signals:
name|void
name|newCol
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
function_decl|;
name|void
name|currentColorChanged
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|)
function_decl|;
private|private
name|slots
private|:
name|void
name|rgbEd
parameter_list|()
function_decl|;
name|void
name|hsvEd
parameter_list|()
function_decl|;
name|void
name|htmlEd
parameter_list|()
function_decl|;
private|private:
name|void
name|showCurrentColor
parameter_list|()
function_decl|;
DECL|member|hue
DECL|member|sat
DECL|member|val
name|int
name|hue
decl_stmt|,
name|sat
decl_stmt|,
name|val
decl_stmt|;
DECL|member|curCol
name|QRgb
name|curCol
decl_stmt|;
DECL|member|curQColor
name|QColor
name|curQColor
decl_stmt|;
DECL|member|lblHue
name|QLabel
modifier|*
name|lblHue
decl_stmt|;
DECL|member|lblSat
name|QLabel
modifier|*
name|lblSat
decl_stmt|;
DECL|member|lblVal
name|QLabel
modifier|*
name|lblVal
decl_stmt|;
DECL|member|lblRed
name|QLabel
modifier|*
name|lblRed
decl_stmt|;
DECL|member|lblGreen
name|QLabel
modifier|*
name|lblGreen
decl_stmt|;
DECL|member|lblBlue
name|QLabel
modifier|*
name|lblBlue
decl_stmt|;
DECL|member|lblHtml
name|QLabel
modifier|*
name|lblHtml
decl_stmt|;
DECL|member|hEd
name|QColSpinBox
modifier|*
name|hEd
decl_stmt|;
DECL|member|sEd
name|QColSpinBox
modifier|*
name|sEd
decl_stmt|;
DECL|member|vEd
name|QColSpinBox
modifier|*
name|vEd
decl_stmt|;
DECL|member|rEd
name|QColSpinBox
modifier|*
name|rEd
decl_stmt|;
DECL|member|gEd
name|QColSpinBox
modifier|*
name|gEd
decl_stmt|;
DECL|member|bEd
name|QColSpinBox
modifier|*
name|bEd
decl_stmt|;
DECL|member|alphaEd
name|QColSpinBox
modifier|*
name|alphaEd
decl_stmt|;
DECL|member|alphaLab
name|QLabel
modifier|*
name|alphaLab
decl_stmt|;
DECL|member|htEd
name|QLineEdit
modifier|*
name|htEd
decl_stmt|;
DECL|member|lab
name|QColorShowLabel
modifier|*
name|lab
decl_stmt|;
DECL|member|rgbOriginal
name|bool
name|rgbOriginal
decl_stmt|;
DECL|member|colorDialog
name|QColorDialog
modifier|*
name|colorDialog
decl_stmt|;
DECL|member|gl
name|QGridLayout
modifier|*
name|gl
decl_stmt|;
friend|friend
name|class
name|QT_PREPEND_NAMESPACE
function_decl|(
name|QColorDialog
function_decl|);
friend|friend
name|class
name|QT_PREPEND_NAMESPACE
function_decl|(
name|QColorDialogPrivate
function_decl|);
block|}
class|;
DECL|class|QColorShowLabel
class|class
name|QColorShowLabel
super|:
specifier|public
name|QFrame
block|{
name|Q_OBJECT
public|public:
DECL|function|QColorShowLabel
name|QColorShowLabel
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QFrame
argument_list|(
name|parent
argument_list|)
block|{
name|setFrameStyle
argument_list|(
name|QFrame
operator|::
name|Panel
operator||
name|QFrame
operator|::
name|Sunken
argument_list|)
expr_stmt|;
name|setAcceptDrops
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|mousePressed
operator|=
literal|false
expr_stmt|;
block|}
DECL|function|setColor
name|void
name|setColor
parameter_list|(
name|QColor
name|c
parameter_list|)
block|{
name|col
operator|=
name|c
expr_stmt|;
block|}
signals|signals:
name|void
name|colorDropped
parameter_list|(
name|QRgb
parameter_list|)
function_decl|;
protected|protected:
DECL|member|Q_DECL_OVERRIDE
name|void
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|mouseReleaseEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
ifndef|#
directive|ifndef
name|QT_NO_DRAGANDDROP
DECL|member|Q_DECL_OVERRIDE
name|void
name|dragEnterEvent
parameter_list|(
name|QDragEnterEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|dragLeaveEvent
parameter_list|(
name|QDragLeaveEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
DECL|member|Q_DECL_OVERRIDE
name|void
name|dropEvent
parameter_list|(
name|QDropEvent
modifier|*
name|e
parameter_list|)
name|Q_DECL_OVERRIDE
function_decl|;
endif|#
directive|endif
private|private:
DECL|member|col
name|QColor
name|col
decl_stmt|;
DECL|member|mousePressed
name|bool
name|mousePressed
decl_stmt|;
DECL|member|pressPos
name|QPoint
name|pressPos
decl_stmt|;
block|}
class|;
DECL|function|paintEvent
name|void
name|QColorShowLabel
operator|::
name|paintEvent
parameter_list|(
name|QPaintEvent
modifier|*
name|e
parameter_list|)
block|{
name|QPainter
name|p
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|drawFrame
argument_list|(
operator|&
name|p
argument_list|)
expr_stmt|;
name|p
operator|.
name|fillRect
argument_list|(
name|contentsRect
argument_list|()
operator|&
name|e
operator|->
name|rect
argument_list|()
argument_list|,
name|col
argument_list|)
expr_stmt|;
block|}
DECL|function|showAlpha
name|void
name|QColorShower
operator|::
name|showAlpha
parameter_list|(
name|bool
name|b
parameter_list|)
block|{
name|alphaLab
operator|->
name|setVisible
argument_list|(
name|b
argument_list|)
expr_stmt|;
name|alphaEd
operator|->
name|setVisible
argument_list|(
name|b
argument_list|)
expr_stmt|;
block|}
DECL|function|isAlphaVisible
specifier|inline
name|bool
name|QColorShower
operator|::
name|isAlphaVisible
parameter_list|()
specifier|const
block|{
return|return
name|alphaLab
operator|->
name|isVisible
argument_list|()
return|;
block|}
DECL|function|mousePressEvent
name|void
name|QColorShowLabel
operator|::
name|mousePressEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
name|mousePressed
operator|=
literal|true
expr_stmt|;
name|pressPos
operator|=
name|e
operator|->
name|pos
argument_list|()
expr_stmt|;
block|}
DECL|function|mouseMoveEvent
name|void
name|QColorShowLabel
operator|::
name|mouseMoveEvent
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|QT_NO_DRAGANDDROP
name|Q_UNUSED
argument_list|(
name|e
argument_list|)
expr_stmt|;
else|#
directive|else
if|if
condition|(
operator|!
name|mousePressed
condition|)
return|return;
if|if
condition|(
operator|(
name|pressPos
operator|-
name|e
operator|->
name|pos
argument_list|()
operator|)
operator|.
name|manhattanLength
argument_list|()
operator|>
name|QApplication
operator|::
name|startDragDistance
argument_list|()
condition|)
block|{
name|QMimeData
modifier|*
name|mime
init|=
operator|new
name|QMimeData
decl_stmt|;
name|mime
operator|->
name|setColorData
argument_list|(
name|col
argument_list|)
expr_stmt|;
name|QPixmap
name|pix
argument_list|(
literal|30
argument_list|,
literal|20
argument_list|)
decl_stmt|;
name|pix
operator|.
name|fill
argument_list|(
name|col
argument_list|)
expr_stmt|;
name|QPainter
name|p
argument_list|(
operator|&
name|pix
argument_list|)
decl_stmt|;
name|p
operator|.
name|drawRect
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|pix
operator|.
name|width
argument_list|()
operator|-
literal|1
argument_list|,
name|pix
operator|.
name|height
argument_list|()
operator|-
literal|1
argument_list|)
expr_stmt|;
name|p
operator|.
name|end
argument_list|()
expr_stmt|;
name|QDrag
modifier|*
name|drg
init|=
operator|new
name|QDrag
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|drg
operator|->
name|setMimeData
argument_list|(
name|mime
argument_list|)
expr_stmt|;
name|drg
operator|->
name|setPixmap
argument_list|(
name|pix
argument_list|)
expr_stmt|;
name|mousePressed
operator|=
literal|false
expr_stmt|;
name|drg
operator|->
name|start
argument_list|()
expr_stmt|;
block|}
endif|#
directive|endif
block|}
ifndef|#
directive|ifndef
name|QT_NO_DRAGANDDROP
DECL|function|dragEnterEvent
name|void
name|QColorShowLabel
operator|::
name|dragEnterEvent
parameter_list|(
name|QDragEnterEvent
modifier|*
name|e
parameter_list|)
block|{
if|if
condition|(
name|qvariant_cast
argument_list|<
name|QColor
argument_list|>
argument_list|(
name|e
operator|->
name|mimeData
argument_list|()
operator|->
name|colorData
argument_list|()
argument_list|)
operator|.
name|isValid
argument_list|()
condition|)
name|e
operator|->
name|accept
argument_list|()
expr_stmt|;
else|else
name|e
operator|->
name|ignore
argument_list|()
expr_stmt|;
block|}
DECL|function|dragLeaveEvent
name|void
name|QColorShowLabel
operator|::
name|dragLeaveEvent
parameter_list|(
name|QDragLeaveEvent
modifier|*
parameter_list|)
block|{ }
DECL|function|dropEvent
name|void
name|QColorShowLabel
operator|::
name|dropEvent
parameter_list|(
name|QDropEvent
modifier|*
name|e
parameter_list|)
block|{
name|QColor
name|color
init|=
name|qvariant_cast
argument_list|<
name|QColor
argument_list|>
argument_list|(
name|e
operator|->
name|mimeData
argument_list|()
operator|->
name|colorData
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|color
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|col
operator|=
name|color
expr_stmt|;
name|repaint
argument_list|()
expr_stmt|;
emit|emit
name|colorDropped
argument_list|(
name|col
operator|.
name|rgb
argument_list|()
argument_list|)
emit|;
name|e
operator|->
name|accept
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|e
operator|->
name|ignore
argument_list|()
expr_stmt|;
block|}
block|}
endif|#
directive|endif
comment|// QT_NO_DRAGANDDROP
DECL|function|mouseReleaseEvent
name|void
name|QColorShowLabel
operator|::
name|mouseReleaseEvent
parameter_list|(
name|QMouseEvent
modifier|*
parameter_list|)
block|{
if|if
condition|(
operator|!
name|mousePressed
condition|)
return|return;
name|mousePressed
operator|=
literal|false
expr_stmt|;
block|}
DECL|function|QColorShower
name|QColorShower
operator|::
name|QColorShower
parameter_list|(
name|QColorDialog
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QWidget
argument_list|(
name|parent
argument_list|)
block|{
name|colorDialog
operator|=
name|parent
expr_stmt|;
name|curCol
operator|=
name|qRgb
argument_list|(
literal|255
argument_list|,
literal|255
argument_list|,
literal|255
argument_list|)
expr_stmt|;
name|curQColor
operator|=
name|Qt
operator|::
name|white
expr_stmt|;
name|gl
operator|=
operator|new
name|QGridLayout
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|gl
operator|->
name|setMargin
argument_list|(
name|gl
operator|->
name|spacing
argument_list|()
argument_list|)
expr_stmt|;
name|lab
operator|=
operator|new
name|QColorShowLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|Q_OS_WINCE
ifdef|#
directive|ifdef
name|QT_SMALL_COLORDIALOG
name|lab
operator|->
name|setMinimumHeight
argument_list|(
literal|60
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lab
operator|->
name|setMinimumWidth
argument_list|(
literal|60
argument_list|)
expr_stmt|;
else|#
directive|else
name|lab
operator|->
name|setMinimumWidth
argument_list|(
literal|20
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|// For QVGA screens only the comboboxes and color label are visible.
comment|// For nHD screens only color and luminence pickers and color label are visible.
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lab
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
operator|-
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lab
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|connect
argument_list|(
name|lab
argument_list|,
name|SIGNAL
argument_list|(
name|colorDropped
argument_list|(
name|QRgb
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SIGNAL
argument_list|(
name|newCol
argument_list|(
name|QRgb
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|lab
argument_list|,
name|SIGNAL
argument_list|(
name|colorDropped
argument_list|(
name|QRgb
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|setRgb
argument_list|(
name|QRgb
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|hEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|hEd
operator|->
name|setRange
argument_list|(
literal|0
argument_list|,
literal|359
argument_list|)
expr_stmt|;
name|lblHue
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblHue
operator|->
name|setBuddy
argument_list|(
name|hEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lblHue
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblHue
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|hEd
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblHue
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|hEd
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|sEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|lblSat
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblSat
operator|->
name|setBuddy
argument_list|(
name|sEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lblSat
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblSat
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|sEd
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblSat
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|sEd
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|vEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|lblVal
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblVal
operator|->
name|setBuddy
argument_list|(
name|vEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lblVal
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblVal
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|vEd
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblVal
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|vEd
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|rEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|lblRed
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblRed
operator|->
name|setBuddy
argument_list|(
name|rEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lblRed
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblRed
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|rEd
argument_list|,
literal|0
argument_list|,
literal|4
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblRed
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|rEd
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|gEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|lblGreen
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblGreen
operator|->
name|setBuddy
argument_list|(
name|gEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lblGreen
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblGreen
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|gEd
argument_list|,
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblGreen
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|gEd
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|bEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|lblBlue
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblBlue
operator|->
name|setBuddy
argument_list|(
name|bEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|lblBlue
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblBlue
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|bEd
argument_list|,
literal|2
argument_list|,
literal|4
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblBlue
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|bEd
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|alphaEd
operator|=
operator|new
name|QColSpinBox
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|alphaLab
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|alphaLab
operator|->
name|setBuddy
argument_list|(
name|alphaEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|alphaLab
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|alphaLab
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|alphaEd
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|alphaLab
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|alphaEd
argument_list|,
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|alphaEd
operator|->
name|hide
argument_list|()
expr_stmt|;
name|alphaLab
operator|->
name|hide
argument_list|()
expr_stmt|;
name|lblHtml
operator|=
operator|new
name|QLabel
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|htEd
operator|=
operator|new
name|QLineEdit
argument_list|(
name|this
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblHtml
operator|->
name|setBuddy
argument_list|(
name|htEd
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|QT_NO_REGULAREXPRESSION
argument_list|)
name|QRegularExpression
name|regExp
argument_list|(
name|QStringLiteral
argument_list|(
literal|"#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})"
argument_list|)
argument_list|)
decl_stmt|;
name|QRegularExpressionValidator
modifier|*
name|validator
init|=
operator|new
name|QRegularExpressionValidator
argument_list|(
name|regExp
argument_list|,
name|this
argument_list|)
decl_stmt|;
name|htEd
operator|->
name|setValidator
argument_list|(
name|validator
argument_list|)
expr_stmt|;
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|QT_NO_REGEXP
argument_list|)
name|QRegExp
name|regExp
argument_list|(
name|QStringLiteral
argument_list|(
literal|"#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})"
argument_list|)
argument_list|)
decl_stmt|;
name|QRegExpValidator
modifier|*
name|validator
init|=
operator|new
name|QRegExpValidator
argument_list|(
name|regExp
argument_list|,
name|this
argument_list|)
decl_stmt|;
name|htEd
operator|->
name|setValidator
argument_list|(
name|validator
argument_list|)
expr_stmt|;
else|#
directive|else
name|htEd
operator|->
name|setReadOnly
argument_list|(
literal|true
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|htEd
operator|->
name|setSizePolicy
argument_list|(
name|QSizePolicy
operator|::
name|Maximum
argument_list|,
name|QSizePolicy
operator|::
name|Fixed
argument_list|)
expr_stmt|;
name|lblHtml
operator|->
name|setAlignment
argument_list|(
name|Qt
operator|::
name|AlignRight
operator||
name|Qt
operator|::
name|AlignVCenter
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|gl
operator|->
name|addWidget
argument_list|(
name|lblHtml
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|htEd
argument_list|,
literal|5
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
comment|/*colspan=*/
literal|2
argument_list|)
expr_stmt|;
else|#
directive|else
name|gl
operator|->
name|addWidget
argument_list|(
name|lblHtml
argument_list|,
literal|5
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gl
operator|->
name|addWidget
argument_list|(
name|htEd
argument_list|,
literal|5
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
comment|/*colspan=*/
literal|3
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|connect
argument_list|(
name|hEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|hsvEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|sEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|hsvEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|vEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|hsvEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|rEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|rgbEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|gEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|rgbEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|bEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|rgbEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|alphaEd
argument_list|,
name|SIGNAL
argument_list|(
name|valueChanged
argument_list|(
name|int
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|rgbEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|htEd
argument_list|,
name|SIGNAL
argument_list|(
name|textEdited
argument_list|(
name|QString
argument_list|)
argument_list|)
argument_list|,
name|this
argument_list|,
name|SLOT
argument_list|(
name|htmlEd
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|retranslateStrings
argument_list|()
expr_stmt|;
block|}
block|}
end_namespace
begin_comment
comment|// unnamed namespace
end_comment
begin_function
DECL|function|currentColor
specifier|inline
name|QRgb
name|QColorDialogPrivate
operator|::
name|currentColor
parameter_list|()
specifier|const
block|{
return|return
name|cs
operator|->
name|currentColor
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|currentAlpha
specifier|inline
name|int
name|QColorDialogPrivate
operator|::
name|currentAlpha
parameter_list|()
specifier|const
block|{
return|return
name|cs
operator|->
name|currentAlpha
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|setCurrentAlpha
specifier|inline
name|void
name|QColorDialogPrivate
operator|::
name|setCurrentAlpha
parameter_list|(
name|int
name|a
parameter_list|)
block|{
name|cs
operator|->
name|setCurrentAlpha
argument_list|(
name|a
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|showAlpha
specifier|inline
name|void
name|QColorDialogPrivate
operator|::
name|showAlpha
parameter_list|(
name|bool
name|b
parameter_list|)
block|{
name|cs
operator|->
name|showAlpha
argument_list|(
name|b
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isAlphaVisible
specifier|inline
name|bool
name|QColorDialogPrivate
operator|::
name|isAlphaVisible
parameter_list|()
specifier|const
block|{
return|return
name|cs
operator|->
name|isAlphaVisible
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|currentQColor
name|QColor
name|QColorDialogPrivate
operator|::
name|currentQColor
parameter_list|()
specifier|const
block|{
if|if
condition|(
name|nativeDialogInUse
condition|)
return|return
name|platformColorDialogHelper
argument_list|()
operator|->
name|currentColor
argument_list|()
return|;
return|return
name|cs
operator|->
name|currentQColor
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|showCurrentColor
name|void
name|QColorShower
operator|::
name|showCurrentColor
parameter_list|()
block|{
name|lab
operator|->
name|setColor
argument_list|(
name|currentColor
argument_list|()
argument_list|)
expr_stmt|;
name|lab
operator|->
name|repaint
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|rgbEd
name|void
name|QColorShower
operator|::
name|rgbEd
parameter_list|()
block|{
name|rgbOriginal
operator|=
literal|true
expr_stmt|;
name|curCol
operator|=
name|qRgba
argument_list|(
name|rEd
operator|->
name|value
argument_list|()
argument_list|,
name|gEd
operator|->
name|value
argument_list|()
argument_list|,
name|bEd
operator|->
name|value
argument_list|()
argument_list|,
name|currentAlpha
argument_list|()
argument_list|)
expr_stmt|;
name|rgb2hsv
argument_list|(
name|currentColor
argument_list|()
argument_list|,
name|hue
argument_list|,
name|sat
argument_list|,
name|val
argument_list|)
expr_stmt|;
name|hEd
operator|->
name|setValue
argument_list|(
name|hue
argument_list|)
expr_stmt|;
name|sEd
operator|->
name|setValue
argument_list|(
name|sat
argument_list|)
expr_stmt|;
name|vEd
operator|->
name|setValue
argument_list|(
name|val
argument_list|)
expr_stmt|;
name|htEd
operator|->
name|setText
argument_list|(
name|QColor
argument_list|(
name|curCol
argument_list|)
operator|.
name|name
argument_list|()
argument_list|)
expr_stmt|;
name|showCurrentColor
argument_list|()
expr_stmt|;
emit|emit
name|newCol
argument_list|(
name|currentColor
argument_list|()
argument_list|)
emit|;
name|updateQColor
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|hsvEd
name|void
name|QColorShower
operator|::
name|hsvEd
parameter_list|()
block|{
name|rgbOriginal
operator|=
literal|false
expr_stmt|;
name|hue
operator|=
name|hEd
operator|->
name|value
argument_list|()
expr_stmt|;
name|sat
operator|=
name|sEd
operator|->
name|value
argument_list|()
expr_stmt|;
name|val
operator|=
name|vEd
operator|->
name|value
argument_list|()
expr_stmt|;
name|QColor
name|c
decl_stmt|;
name|c
operator|.
name|setHsv
argument_list|(
name|hue
argument_list|,
name|sat
argument_list|,
name|val
argument_list|)
expr_stmt|;
name|curCol
operator|=
name|c
operator|.
name|rgb
argument_list|()
expr_stmt|;
name|rEd
operator|->
name|setValue
argument_list|(
name|qRed
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|gEd
operator|->
name|setValue
argument_list|(
name|qGreen
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|bEd
operator|->
name|setValue
argument_list|(
name|qBlue
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|htEd
operator|->
name|setText
argument_list|(
name|c
operator|.
name|name
argument_list|()
argument_list|)
expr_stmt|;
name|showCurrentColor
argument_list|()
expr_stmt|;
emit|emit
name|newCol
argument_list|(
name|currentColor
argument_list|()
argument_list|)
emit|;
name|updateQColor
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|htmlEd
name|void
name|QColorShower
operator|::
name|htmlEd
parameter_list|()
block|{
name|QColor
name|c
decl_stmt|;
name|QString
name|t
init|=
name|htEd
operator|->
name|text
argument_list|()
decl_stmt|;
name|c
operator|.
name|setNamedColor
argument_list|(
name|t
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|c
operator|.
name|isValid
argument_list|()
condition|)
return|return;
name|curCol
operator|=
name|qRgba
argument_list|(
name|c
operator|.
name|red
argument_list|()
argument_list|,
name|c
operator|.
name|green
argument_list|()
argument_list|,
name|c
operator|.
name|blue
argument_list|()
argument_list|,
name|currentAlpha
argument_list|()
argument_list|)
expr_stmt|;
name|rgb2hsv
argument_list|(
name|curCol
argument_list|,
name|hue
argument_list|,
name|sat
argument_list|,
name|val
argument_list|)
expr_stmt|;
name|hEd
operator|->
name|setValue
argument_list|(
name|hue
argument_list|)
expr_stmt|;
name|sEd
operator|->
name|setValue
argument_list|(
name|sat
argument_list|)
expr_stmt|;
name|vEd
operator|->
name|setValue
argument_list|(
name|val
argument_list|)
expr_stmt|;
name|rEd
operator|->
name|setValue
argument_list|(
name|qRed
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|gEd
operator|->
name|setValue
argument_list|(
name|qGreen
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|bEd
operator|->
name|setValue
argument_list|(
name|qBlue
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|showCurrentColor
argument_list|()
expr_stmt|;
emit|emit
name|newCol
argument_list|(
name|currentColor
argument_list|()
argument_list|)
emit|;
name|updateQColor
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setRgb
name|void
name|QColorShower
operator|::
name|setRgb
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
block|{
name|rgbOriginal
operator|=
literal|true
expr_stmt|;
name|curCol
operator|=
name|rgb
expr_stmt|;
name|rgb2hsv
argument_list|(
name|currentColor
argument_list|()
argument_list|,
name|hue
argument_list|,
name|sat
argument_list|,
name|val
argument_list|)
expr_stmt|;
name|hEd
operator|->
name|setValue
argument_list|(
name|hue
argument_list|)
expr_stmt|;
name|sEd
operator|->
name|setValue
argument_list|(
name|sat
argument_list|)
expr_stmt|;
name|vEd
operator|->
name|setValue
argument_list|(
name|val
argument_list|)
expr_stmt|;
name|rEd
operator|->
name|setValue
argument_list|(
name|qRed
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|gEd
operator|->
name|setValue
argument_list|(
name|qGreen
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|bEd
operator|->
name|setValue
argument_list|(
name|qBlue
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|htEd
operator|->
name|setText
argument_list|(
name|QColor
argument_list|(
name|rgb
argument_list|)
operator|.
name|name
argument_list|()
argument_list|)
expr_stmt|;
name|showCurrentColor
argument_list|()
expr_stmt|;
name|updateQColor
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|setHsv
name|void
name|QColorShower
operator|::
name|setHsv
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
block|{
if|if
condition|(
name|h
argument_list|<
operator|-
literal|1
operator|||
operator|(
name|uint
operator|)
name|s
argument_list|>
literal|255
operator|||
operator|(
name|uint
operator|)
name|v
operator|>
literal|255
condition|)
return|return;
name|rgbOriginal
operator|=
literal|false
expr_stmt|;
name|hue
operator|=
name|h
expr_stmt|;
name|val
operator|=
name|v
expr_stmt|;
name|sat
operator|=
name|s
expr_stmt|;
name|QColor
name|c
decl_stmt|;
name|c
operator|.
name|setHsv
argument_list|(
name|hue
argument_list|,
name|sat
argument_list|,
name|val
argument_list|)
expr_stmt|;
name|curCol
operator|=
name|c
operator|.
name|rgb
argument_list|()
expr_stmt|;
name|hEd
operator|->
name|setValue
argument_list|(
name|hue
argument_list|)
expr_stmt|;
name|sEd
operator|->
name|setValue
argument_list|(
name|sat
argument_list|)
expr_stmt|;
name|vEd
operator|->
name|setValue
argument_list|(
name|val
argument_list|)
expr_stmt|;
name|rEd
operator|->
name|setValue
argument_list|(
name|qRed
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|gEd
operator|->
name|setValue
argument_list|(
name|qGreen
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|bEd
operator|->
name|setValue
argument_list|(
name|qBlue
argument_list|(
name|currentColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|htEd
operator|->
name|setText
argument_list|(
name|c
operator|.
name|name
argument_list|()
argument_list|)
expr_stmt|;
name|showCurrentColor
argument_list|()
expr_stmt|;
name|updateQColor
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|retranslateStrings
name|void
name|QColorShower
operator|::
name|retranslateStrings
parameter_list|()
block|{
name|lblHue
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"Hu&e:"
argument_list|)
argument_list|)
expr_stmt|;
name|lblSat
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Sat:"
argument_list|)
argument_list|)
expr_stmt|;
name|lblVal
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Val:"
argument_list|)
argument_list|)
expr_stmt|;
name|lblRed
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Red:"
argument_list|)
argument_list|)
expr_stmt|;
name|lblGreen
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Green:"
argument_list|)
argument_list|)
expr_stmt|;
name|lblBlue
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"Bl&ue:"
argument_list|)
argument_list|)
expr_stmt|;
name|alphaLab
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"A&lpha channel:"
argument_list|)
argument_list|)
expr_stmt|;
name|lblHtml
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&HTML:"
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|updateQColor
name|void
name|QColorShower
operator|::
name|updateQColor
parameter_list|()
block|{
name|QColor
name|oldQColor
argument_list|(
name|curQColor
argument_list|)
decl_stmt|;
name|curQColor
operator|.
name|setRgba
argument_list|(
name|qRgba
argument_list|(
name|qRed
argument_list|(
name|curCol
argument_list|)
argument_list|,
name|qGreen
argument_list|(
name|curCol
argument_list|)
argument_list|,
name|qBlue
argument_list|(
name|curCol
argument_list|)
argument_list|,
name|currentAlpha
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|curQColor
operator|!=
name|oldQColor
condition|)
emit|emit
name|currentColorChanged
argument_list|(
name|curQColor
argument_list|)
emit|;
block|}
end_function
begin_comment
comment|//sets all widgets to display h,s,v
end_comment
begin_function
DECL|function|_q_newHsv
name|void
name|QColorDialogPrivate
operator|::
name|_q_newHsv
parameter_list|(
name|int
name|h
parameter_list|,
name|int
name|s
parameter_list|,
name|int
name|v
parameter_list|)
block|{
if|if
condition|(
operator|!
name|nativeDialogInUse
condition|)
block|{
name|cs
operator|->
name|setHsv
argument_list|(
name|h
argument_list|,
name|s
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|cp
operator|->
name|setCol
argument_list|(
name|h
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|lp
operator|->
name|setCol
argument_list|(
name|h
argument_list|,
name|s
argument_list|,
name|v
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_comment
comment|//sets all widgets to display rgb
end_comment
begin_function
DECL|function|setCurrentRgbColor
name|void
name|QColorDialogPrivate
operator|::
name|setCurrentRgbColor
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
block|{
if|if
condition|(
operator|!
name|nativeDialogInUse
condition|)
block|{
name|cs
operator|->
name|setRgb
argument_list|(
name|rgb
argument_list|)
expr_stmt|;
name|_q_newColorTypedIn
argument_list|(
name|rgb
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_comment
comment|// hack; doesn't keep curCol in sync, so use with care
end_comment
begin_function
DECL|function|setCurrentQColor
name|void
name|QColorDialogPrivate
operator|::
name|setCurrentQColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|)
block|{
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
name|cs
operator|->
name|curQColor
operator|!=
name|color
condition|)
block|{
name|cs
operator|->
name|curQColor
operator|=
name|color
expr_stmt|;
emit|emit
name|q
operator|->
name|currentColorChanged
argument_list|(
name|color
argument_list|)
emit|;
block|}
block|}
end_function
begin_comment
comment|// size of standard and custom color selector
end_comment
begin_enum
enum|enum
block|{
DECL|enumerator|colorColumns
name|colorColumns
init|=
literal|8
block|,
DECL|enumerator|standardColorRows
name|standardColorRows
init|=
literal|6
block|,
DECL|enumerator|customColorRows
name|customColorRows
init|=
literal|2
block|}
enum|;
end_enum
begin_function
DECL|function|selectColor
name|bool
name|QColorDialogPrivate
operator|::
name|selectColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|col
parameter_list|)
block|{
name|QRgb
name|color
init|=
name|col
operator|.
name|rgb
argument_list|()
decl_stmt|;
comment|// Check standard colors
if|if
condition|(
name|standard
condition|)
block|{
specifier|const
name|QRgb
modifier|*
name|standardColors
init|=
name|QColorDialogOptions
operator|::
name|standardColors
argument_list|()
decl_stmt|;
specifier|const
name|QRgb
modifier|*
name|standardColorsEnd
init|=
name|standardColors
operator|+
name|standardColorRows
operator|*
name|colorColumns
decl_stmt|;
specifier|const
name|QRgb
modifier|*
name|match
init|=
name|std
operator|::
name|find
argument_list|(
name|standardColors
argument_list|,
name|standardColorsEnd
argument_list|,
name|color
argument_list|)
decl_stmt|;
if|if
condition|(
name|match
operator|!=
name|standardColorsEnd
condition|)
block|{
specifier|const
name|int
name|index
init|=
name|int
argument_list|(
name|match
operator|-
name|standardColors
argument_list|)
decl_stmt|;
specifier|const
name|int
name|column
init|=
name|index
operator|/
name|standardColorRows
decl_stmt|;
specifier|const
name|int
name|row
init|=
name|index
operator|%
name|standardColorRows
decl_stmt|;
name|_q_newStandard
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
expr_stmt|;
name|standard
operator|->
name|setCurrent
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
expr_stmt|;
name|standard
operator|->
name|setSelected
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
expr_stmt|;
name|standard
operator|->
name|setFocus
argument_list|()
expr_stmt|;
return|return
literal|true
return|;
block|}
block|}
comment|// Check custom colors
if|if
condition|(
name|custom
condition|)
block|{
specifier|const
name|QRgb
modifier|*
name|customColors
init|=
name|QColorDialogOptions
operator|::
name|customColors
argument_list|()
decl_stmt|;
specifier|const
name|QRgb
modifier|*
name|customColorsEnd
init|=
name|customColors
operator|+
name|customColorRows
operator|*
name|colorColumns
decl_stmt|;
specifier|const
name|QRgb
modifier|*
name|match
init|=
name|std
operator|::
name|find
argument_list|(
name|customColors
argument_list|,
name|customColorsEnd
argument_list|,
name|color
argument_list|)
decl_stmt|;
if|if
condition|(
name|match
operator|!=
name|customColorsEnd
condition|)
block|{
specifier|const
name|int
name|index
init|=
name|int
argument_list|(
name|match
operator|-
name|customColors
argument_list|)
decl_stmt|;
specifier|const
name|int
name|column
init|=
name|index
operator|/
name|customColorRows
decl_stmt|;
specifier|const
name|int
name|row
init|=
name|index
operator|%
name|customColorRows
decl_stmt|;
name|_q_newCustom
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
expr_stmt|;
name|custom
operator|->
name|setCurrent
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
expr_stmt|;
name|custom
operator|->
name|setSelected
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
expr_stmt|;
name|custom
operator|->
name|setFocus
argument_list|()
expr_stmt|;
return|return
literal|true
return|;
block|}
block|}
return|return
literal|false
return|;
block|}
end_function
begin_function
DECL|function|grabScreenColor
name|QColor
name|QColorDialogPrivate
operator|::
name|grabScreenColor
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|p
parameter_list|)
block|{
specifier|const
name|QDesktopWidget
modifier|*
name|desktop
init|=
name|QApplication
operator|::
name|desktop
argument_list|()
decl_stmt|;
specifier|const
name|QPixmap
name|pixmap
init|=
name|QGuiApplication
operator|::
name|screens
argument_list|()
operator|.
name|at
argument_list|(
name|desktop
operator|->
name|screenNumber
argument_list|()
argument_list|)
operator|->
name|grabWindow
argument_list|(
name|desktop
operator|->
name|winId
argument_list|()
argument_list|,
name|p
operator|.
name|x
argument_list|()
argument_list|,
name|p
operator|.
name|y
argument_list|()
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|QImage
name|i
init|=
name|pixmap
operator|.
name|toImage
argument_list|()
decl_stmt|;
return|return
name|i
operator|.
name|pixel
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
return|;
block|}
end_function
begin_comment
comment|//sets all widgets except cs to display rgb
end_comment
begin_function
DECL|function|_q_newColorTypedIn
name|void
name|QColorDialogPrivate
operator|::
name|_q_newColorTypedIn
parameter_list|(
name|QRgb
name|rgb
parameter_list|)
block|{
if|if
condition|(
operator|!
name|nativeDialogInUse
condition|)
block|{
name|int
name|h
decl_stmt|,
name|s
decl_stmt|,
name|v
decl_stmt|;
name|rgb2hsv
argument_list|(
name|rgb
argument_list|,
name|h
argument_list|,
name|s
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|cp
operator|->
name|setCol
argument_list|(
name|h
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|lp
operator|->
name|setCol
argument_list|(
name|h
argument_list|,
name|s
argument_list|,
name|v
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|_q_nextCustom
name|void
name|QColorDialogPrivate
operator|::
name|_q_nextCustom
parameter_list|(
name|int
name|r
parameter_list|,
name|int
name|c
parameter_list|)
block|{
name|nextCust
operator|=
name|r
operator|+
name|customColorRows
operator|*
name|c
expr_stmt|;
block|}
end_function
begin_function
DECL|function|_q_newCustom
name|void
name|QColorDialogPrivate
operator|::
name|_q_newCustom
parameter_list|(
name|int
name|r
parameter_list|,
name|int
name|c
parameter_list|)
block|{
specifier|const
name|int
name|i
init|=
name|r
operator|+
name|customColorRows
operator|*
name|c
decl_stmt|;
name|setCurrentRgbColor
argument_list|(
name|QColorDialogOptions
operator|::
name|customColor
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|standard
condition|)
name|standard
operator|->
name|setSelected
argument_list|(
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|_q_newStandard
name|void
name|QColorDialogPrivate
operator|::
name|_q_newStandard
parameter_list|(
name|int
name|r
parameter_list|,
name|int
name|c
parameter_list|)
block|{
name|setCurrentRgbColor
argument_list|(
name|QColorDialogOptions
operator|::
name|standardColor
argument_list|(
name|r
operator|+
name|c
operator|*
literal|6
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|custom
condition|)
name|custom
operator|->
name|setSelected
argument_list|(
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|_q_pickScreenColor
name|void
name|QColorDialogPrivate
operator|::
name|_q_pickScreenColor
parameter_list|()
block|{
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|colorPickingEventFilter
condition|)
name|colorPickingEventFilter
operator|=
operator|new
name|QColorPickingEventFilter
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|q
operator|->
name|installEventFilter
argument_list|(
name|colorPickingEventFilter
argument_list|)
expr_stmt|;
comment|// If user pushes Escape, the last color before picking will be restored.
name|beforeScreenColorPicking
operator|=
name|cs
operator|->
name|currentColor
argument_list|()
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_CURSOR
name|q
operator|->
name|grabMouse
argument_list|(
name|Qt
operator|::
name|CrossCursor
argument_list|)
expr_stmt|;
else|#
directive|else
name|q
operator|->
name|grabMouse
argument_list|()
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|Q_OS_WIN32
comment|// excludes WinCE and WinRT
comment|// On Windows mouse tracking doesn't work over other processes's windows
name|updateTimer
operator|->
name|start
argument_list|(
literal|30
argument_list|)
expr_stmt|;
comment|// HACK: Because mouse grabbing doesn't work across processes, we have to have a dummy,
comment|// invisible window to catch the mouse click, otherwise we will click whatever we clicked
comment|// and loose focus.
name|dummyTransparentWindow
operator|.
name|show
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|q
operator|->
name|grabKeyboard
argument_list|()
expr_stmt|;
comment|/* With setMouseTracking(true) the desired color can be more precisely picked up,      * and continuously pushing the mouse button is not necessary.      */
name|q
operator|->
name|setMouseTracking
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|addCusBt
operator|->
name|setDisabled
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|buttons
operator|->
name|setDisabled
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|screenColorPickerButton
operator|->
name|setDisabled
argument_list|(
literal|true
argument_list|)
expr_stmt|;
specifier|const
name|QPoint
name|globalPos
init|=
name|QCursor
operator|::
name|pos
argument_list|()
decl_stmt|;
name|q
operator|->
name|setCurrentColor
argument_list|(
name|grabScreenColor
argument_list|(
name|globalPos
argument_list|)
argument_list|)
expr_stmt|;
name|updateColorLabelText
argument_list|(
name|globalPos
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|updateColorLabelText
name|void
name|QColorDialogPrivate
operator|::
name|updateColorLabelText
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|globalPos
parameter_list|)
block|{
name|lblScreenColorInfo
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"Cursor at %1, %2\nPress ESC to cancel"
argument_list|)
operator|.
name|arg
argument_list|(
name|globalPos
operator|.
name|x
argument_list|()
argument_list|)
operator|.
name|arg
argument_list|(
name|globalPos
operator|.
name|y
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|releaseColorPicking
name|void
name|QColorDialogPrivate
operator|::
name|releaseColorPicking
parameter_list|()
block|{
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|cp
operator|->
name|setCrossVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|q
operator|->
name|removeEventFilter
argument_list|(
name|colorPickingEventFilter
argument_list|)
expr_stmt|;
name|q
operator|->
name|releaseMouse
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|Q_OS_WIN32
name|updateTimer
operator|->
name|stop
argument_list|()
expr_stmt|;
name|dummyTransparentWindow
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|q
operator|->
name|releaseKeyboard
argument_list|()
expr_stmt|;
name|q
operator|->
name|setMouseTracking
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|lblScreenColorInfo
operator|->
name|setText
argument_list|(
name|QLatin1String
argument_list|(
literal|"\n"
argument_list|)
argument_list|)
expr_stmt|;
name|addCusBt
operator|->
name|setDisabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|buttons
operator|->
name|setDisabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|screenColorPickerButton
operator|->
name|setDisabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|init
name|void
name|QColorDialogPrivate
operator|::
name|init
parameter_list|(
specifier|const
name|QColor
modifier|&
name|initial
parameter_list|)
block|{
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|q
operator|->
name|setSizeGripEnabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|q
operator|->
name|setWindowTitle
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"Select Color"
argument_list|)
argument_list|)
expr_stmt|;
comment|// default: use the native dialog if possible.  Can be overridden in setOptions()
name|nativeDialogInUse
operator|=
operator|(
name|platformColorDialogHelper
argument_list|()
operator|!=
literal|0
operator|)
expr_stmt|;
name|colorPickingEventFilter
operator|=
literal|0
expr_stmt|;
name|nextCust
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|nativeDialogInUse
condition|)
name|initWidgets
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|Q_OS_WIN32
name|dummyTransparentWindow
operator|.
name|resize
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dummyTransparentWindow
operator|.
name|setFlags
argument_list|(
name|Qt
operator|::
name|Tool
operator||
name|Qt
operator|::
name|FramelessWindowHint
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|q
operator|->
name|setCurrentColor
argument_list|(
name|initial
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|initWidgets
name|void
name|QColorDialogPrivate
operator|::
name|initWidgets
parameter_list|()
block|{
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|QVBoxLayout
modifier|*
name|mainLay
init|=
operator|new
name|QVBoxLayout
argument_list|(
name|q
argument_list|)
decl_stmt|;
comment|// there's nothing in this dialog that benefits from sizing up
name|mainLay
operator|->
name|setSizeConstraint
argument_list|(
name|QLayout
operator|::
name|SetFixedSize
argument_list|)
expr_stmt|;
name|QHBoxLayout
modifier|*
name|topLay
init|=
operator|new
name|QHBoxLayout
argument_list|()
decl_stmt|;
name|mainLay
operator|->
name|addLayout
argument_list|(
name|topLay
argument_list|)
expr_stmt|;
name|leftLay
operator|=
literal|0
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|Q_OS_WINCE
argument_list|)
operator|||
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|smallDisplay
operator|=
literal|true
expr_stmt|;
specifier|const
name|int
name|lumSpace
init|=
literal|20
decl_stmt|;
else|#
directive|else
comment|// small displays (e.g. PDAs) cannot fit the full color dialog,
comment|// so just use the color picker.
name|smallDisplay
operator|=
operator|(
name|QApplication
operator|::
name|desktop
argument_list|()
operator|->
name|width
argument_list|()
operator|<
literal|480
operator|||
name|QApplication
operator|::
name|desktop
argument_list|()
operator|->
name|height
argument_list|()
operator|<
literal|350
operator|)
expr_stmt|;
specifier|const
name|int
name|lumSpace
init|=
name|topLay
operator|->
name|spacing
argument_list|()
operator|/
literal|2
decl_stmt|;
endif|#
directive|endif
if|if
condition|(
operator|!
name|smallDisplay
condition|)
block|{
name|leftLay
operator|=
operator|new
name|QVBoxLayout
expr_stmt|;
name|topLay
operator|->
name|addLayout
argument_list|(
name|leftLay
argument_list|)
expr_stmt|;
name|standard
operator|=
operator|new
name|QColorWell
argument_list|(
name|q
argument_list|,
name|standardColorRows
argument_list|,
name|colorColumns
argument_list|,
name|QColorDialogOptions
operator|::
name|standardColors
argument_list|()
argument_list|)
expr_stmt|;
name|lblBasicColors
operator|=
operator|new
name|QLabel
argument_list|(
name|q
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblBasicColors
operator|->
name|setBuddy
argument_list|(
name|standard
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|q
operator|->
name|connect
argument_list|(
name|standard
argument_list|,
name|SIGNAL
argument_list|(
name|selected
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|_q_newStandard
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|leftLay
operator|->
name|addWidget
argument_list|(
name|lblBasicColors
argument_list|)
expr_stmt|;
name|leftLay
operator|->
name|addWidget
argument_list|(
name|standard
argument_list|)
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|Q_OS_WINCE
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
comment|// The screen color picker button
name|screenColorPickerButton
operator|=
operator|new
name|QPushButton
argument_list|()
expr_stmt|;
name|leftLay
operator|->
name|addWidget
argument_list|(
name|screenColorPickerButton
argument_list|)
expr_stmt|;
name|lblScreenColorInfo
operator|=
operator|new
name|QLabel
argument_list|(
name|QLatin1String
argument_list|(
literal|"\n"
argument_list|)
argument_list|)
expr_stmt|;
name|leftLay
operator|->
name|addWidget
argument_list|(
name|lblScreenColorInfo
argument_list|)
expr_stmt|;
name|q
operator|->
name|connect
argument_list|(
name|screenColorPickerButton
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|_q_pickScreenColor
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|Q_OS_WINCE
argument_list|)
name|leftLay
operator|->
name|addStretch
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|custom
operator|=
operator|new
name|QColorWell
argument_list|(
name|q
argument_list|,
name|customColorRows
argument_list|,
name|colorColumns
argument_list|,
name|QColorDialogOptions
operator|::
name|customColors
argument_list|()
argument_list|)
expr_stmt|;
name|custom
operator|->
name|setAcceptDrops
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|q
operator|->
name|connect
argument_list|(
name|custom
argument_list|,
name|SIGNAL
argument_list|(
name|selected
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|_q_newCustom
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|q
operator|->
name|connect
argument_list|(
name|custom
argument_list|,
name|SIGNAL
argument_list|(
name|currentChanged
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|,
name|SLOT
argument_list|(
name|_q_nextCustom
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|lblCustomColors
operator|=
operator|new
name|QLabel
argument_list|(
name|q
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_SHORTCUT
name|lblCustomColors
operator|->
name|setBuddy
argument_list|(
name|custom
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|leftLay
operator|->
name|addWidget
argument_list|(
name|lblCustomColors
argument_list|)
expr_stmt|;
name|leftLay
operator|->
name|addWidget
argument_list|(
name|custom
argument_list|)
expr_stmt|;
name|addCusBt
operator|=
operator|new
name|QPushButton
argument_list|(
name|q
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|addCusBt
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|q
argument_list|,
name|SLOT
argument_list|(
name|_q_addCustom
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|leftLay
operator|->
name|addWidget
argument_list|(
name|addCusBt
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// better color picker size for small displays
if|#
directive|if
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|QSize
name|screenSize
init|=
name|QApplication
operator|::
name|desktop
argument_list|()
operator|->
name|availableGeometry
argument_list|(
name|QCursor
operator|::
name|pos
argument_list|()
argument_list|)
operator|.
name|size
argument_list|()
decl_stmt|;
name|pWidth
operator|=
name|pHeight
operator|=
name|qMin
argument_list|(
name|screenSize
operator|.
name|width
argument_list|()
argument_list|,
name|screenSize
operator|.
name|height
argument_list|()
argument_list|)
expr_stmt|;
name|pHeight
operator|-=
literal|20
expr_stmt|;
if|if
condition|(
name|screenSize
operator|.
name|height
argument_list|()
operator|>
name|screenSize
operator|.
name|width
argument_list|()
condition|)
name|pWidth
operator|-=
literal|20
expr_stmt|;
else|#
directive|else
name|pWidth
operator|=
literal|150
expr_stmt|;
name|pHeight
operator|=
literal|100
expr_stmt|;
endif|#
directive|endif
name|custom
operator|=
literal|0
expr_stmt|;
name|standard
operator|=
literal|0
expr_stmt|;
block|}
name|QVBoxLayout
modifier|*
name|rightLay
init|=
operator|new
name|QVBoxLayout
decl_stmt|;
name|topLay
operator|->
name|addLayout
argument_list|(
name|rightLay
argument_list|)
expr_stmt|;
name|QHBoxLayout
modifier|*
name|pickLay
init|=
operator|new
name|QHBoxLayout
decl_stmt|;
name|rightLay
operator|->
name|addLayout
argument_list|(
name|pickLay
argument_list|)
expr_stmt|;
name|QVBoxLayout
modifier|*
name|cLay
init|=
operator|new
name|QVBoxLayout
decl_stmt|;
name|pickLay
operator|->
name|addLayout
argument_list|(
name|cLay
argument_list|)
expr_stmt|;
name|cp
operator|=
operator|new
name|QColorPicker
argument_list|(
name|q
argument_list|)
expr_stmt|;
name|cp
operator|->
name|setFrameStyle
argument_list|(
name|QFrame
operator|::
name|Panel
operator|+
name|QFrame
operator|::
name|Sunken
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|cp
operator|->
name|hide
argument_list|()
expr_stmt|;
else|#
directive|else
name|cLay
operator|->
name|addSpacing
argument_list|(
name|lumSpace
argument_list|)
expr_stmt|;
name|cLay
operator|->
name|addWidget
argument_list|(
name|cp
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|cLay
operator|->
name|addSpacing
argument_list|(
name|lumSpace
argument_list|)
expr_stmt|;
name|lp
operator|=
operator|new
name|QColorLuminancePicker
argument_list|(
name|q
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|lp
operator|->
name|hide
argument_list|()
expr_stmt|;
else|#
directive|else
name|lp
operator|->
name|setFixedWidth
argument_list|(
literal|20
argument_list|)
expr_stmt|;
name|pickLay
operator|->
name|addSpacing
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|pickLay
operator|->
name|addWidget
argument_list|(
name|lp
argument_list|)
expr_stmt|;
name|pickLay
operator|->
name|addStretch
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|QObject
operator|::
name|connect
argument_list|(
name|cp
argument_list|,
name|SIGNAL
argument_list|(
name|newCol
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|,
name|lp
argument_list|,
name|SLOT
argument_list|(
name|setCol
argument_list|(
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|lp
argument_list|,
name|SIGNAL
argument_list|(
name|newHsv
argument_list|(
name|int
argument_list|,
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|,
name|q
argument_list|,
name|SLOT
argument_list|(
name|_q_newHsv
argument_list|(
name|int
argument_list|,
name|int
argument_list|,
name|int
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|rightLay
operator|->
name|addStretch
argument_list|()
expr_stmt|;
name|cs
operator|=
operator|new
name|QColorShower
argument_list|(
name|q
argument_list|)
expr_stmt|;
name|pickLay
operator|->
name|setMargin
argument_list|(
name|cs
operator|->
name|gl
operator|->
name|margin
argument_list|()
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|cs
argument_list|,
name|SIGNAL
argument_list|(
name|newCol
argument_list|(
name|QRgb
argument_list|)
argument_list|)
argument_list|,
name|q
argument_list|,
name|SLOT
argument_list|(
name|_q_newColorTypedIn
argument_list|(
name|QRgb
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|cs
argument_list|,
name|SIGNAL
argument_list|(
name|currentColorChanged
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|,
name|q
argument_list|,
name|SIGNAL
argument_list|(
name|currentColorChanged
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|QT_SMALL_COLORDIALOG
argument_list|)
name|topLay
operator|->
name|addWidget
argument_list|(
name|cs
argument_list|)
expr_stmt|;
else|#
directive|else
name|rightLay
operator|->
name|addWidget
argument_list|(
name|cs
argument_list|)
expr_stmt|;
if|if
condition|(
name|leftLay
condition|)
name|leftLay
operator|->
name|addSpacing
argument_list|(
name|cs
operator|->
name|gl
operator|->
name|margin
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|buttons
operator|=
operator|new
name|QDialogButtonBox
argument_list|(
name|q
argument_list|)
expr_stmt|;
name|mainLay
operator|->
name|addWidget
argument_list|(
name|buttons
argument_list|)
expr_stmt|;
name|ok
operator|=
name|buttons
operator|->
name|addButton
argument_list|(
name|QDialogButtonBox
operator|::
name|Ok
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|ok
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|q
argument_list|,
name|SLOT
argument_list|(
name|accept
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|ok
operator|->
name|setDefault
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|cancel
operator|=
name|buttons
operator|->
name|addButton
argument_list|(
name|QDialogButtonBox
operator|::
name|Cancel
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|cancel
argument_list|,
name|SIGNAL
argument_list|(
name|clicked
argument_list|()
argument_list|)
argument_list|,
name|q
argument_list|,
name|SLOT
argument_list|(
name|reject
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|Q_OS_WIN32
name|updateTimer
operator|=
operator|new
name|QTimer
argument_list|(
name|q
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|updateTimer
argument_list|,
name|SIGNAL
argument_list|(
name|timeout
argument_list|()
argument_list|)
argument_list|,
name|q
argument_list|,
name|SLOT
argument_list|(
name|_q_updateColorPicking
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|retranslateStrings
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|initHelper
name|void
name|QColorDialogPrivate
operator|::
name|initHelper
parameter_list|(
name|QPlatformDialogHelper
modifier|*
name|h
parameter_list|)
block|{
name|QColorDialog
modifier|*
name|d
init|=
name|q_func
argument_list|()
decl_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|h
argument_list|,
name|SIGNAL
argument_list|(
name|currentColorChanged
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|,
name|d
argument_list|,
name|SIGNAL
argument_list|(
name|currentColorChanged
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|QObject
operator|::
name|connect
argument_list|(
name|h
argument_list|,
name|SIGNAL
argument_list|(
name|colorSelected
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|,
name|d
argument_list|,
name|SIGNAL
argument_list|(
name|colorSelected
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
cast|static_cast
argument_list|<
name|QPlatformColorDialogHelper
operator|*
argument_list|>
argument_list|(
name|h
argument_list|)
operator|->
name|setOptions
argument_list|(
name|options
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|helperPrepareShow
name|void
name|QColorDialogPrivate
operator|::
name|helperPrepareShow
parameter_list|(
name|QPlatformDialogHelper
modifier|*
parameter_list|)
block|{
name|options
operator|->
name|setWindowTitle
argument_list|(
name|q_func
argument_list|()
operator|->
name|windowTitle
argument_list|()
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|_q_addCustom
name|void
name|QColorDialogPrivate
operator|::
name|_q_addCustom
parameter_list|()
block|{
name|QColorDialogOptions
operator|::
name|setCustomColor
argument_list|(
name|nextCust
argument_list|,
name|cs
operator|->
name|currentColor
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|custom
condition|)
name|custom
operator|->
name|update
argument_list|()
expr_stmt|;
name|nextCust
operator|=
operator|(
name|nextCust
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
block|}
end_function
begin_function
DECL|function|retranslateStrings
name|void
name|QColorDialogPrivate
operator|::
name|retranslateStrings
parameter_list|()
block|{
if|if
condition|(
operator|!
name|smallDisplay
condition|)
block|{
name|lblBasicColors
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Basic colors"
argument_list|)
argument_list|)
expr_stmt|;
name|lblCustomColors
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Custom colors"
argument_list|)
argument_list|)
expr_stmt|;
name|addCusBt
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Add to Custom Colors"
argument_list|)
argument_list|)
expr_stmt|;
name|screenColorPickerButton
operator|->
name|setText
argument_list|(
name|QColorDialog
operator|::
name|tr
argument_list|(
literal|"&Pick Screen Color"
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|cs
operator|->
name|retranslateStrings
argument_list|()
expr_stmt|;
block|}
end_function
begin_function
DECL|function|canBeNativeDialog
name|bool
name|QColorDialogPrivate
operator|::
name|canBeNativeDialog
parameter_list|()
specifier|const
block|{
name|Q_Q
argument_list|(
specifier|const
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
name|nativeDialogInUse
condition|)
return|return
literal|true
return|;
if|if
condition|(
name|q
operator|->
name|testAttribute
argument_list|(
name|Qt
operator|::
name|WA_DontShowOnScreen
argument_list|)
condition|)
return|return
literal|false
return|;
if|if
condition|(
name|q
operator|->
name|options
argument_list|()
operator|&
name|QColorDialog
operator|::
name|DontUseNativeDialog
condition|)
return|return
literal|false
return|;
name|QLatin1String
name|staticName
argument_list|(
name|QColorDialog
operator|::
name|staticMetaObject
operator|.
name|className
argument_list|()
argument_list|)
decl_stmt|;
name|QLatin1String
name|dynamicName
argument_list|(
name|q
operator|->
name|metaObject
argument_list|()
operator|->
name|className
argument_list|()
argument_list|)
decl_stmt|;
return|return
operator|(
name|staticName
operator|==
name|dynamicName
operator|)
return|;
block|}
end_function
begin_decl_stmt
DECL|variable|DefaultWindowFlags
specifier|static
specifier|const
name|Qt
operator|::
name|WindowFlags
name|DefaultWindowFlags
init|=
name|Qt
operator|::
name|Dialog
operator||
name|Qt
operator|::
name|WindowTitleHint
operator||
name|Qt
operator|::
name|MSWindowsFixedSizeDialogHint
operator||
name|Qt
operator|::
name|WindowSystemMenuHint
operator||
name|Qt
operator|::
name|WindowCloseButtonHint
decl_stmt|;
end_decl_stmt
begin_comment
comment|/*!     \class QColorDialog     \brief The QColorDialog class provides a dialog widget for specifying colors.      \ingroup standard-dialogs     \inmodule QtWidgets      The color dialog's function is to allow users to choose colors.     For example, you might use this in a drawing program to allow the     user to set the brush color.      The static functions provide modal color dialogs.     \omit     If you require a modeless dialog, use the QColorDialog constructor.     \endomit      The static getColor() function shows the dialog, and allows the user to     specify a color. This function can also be used to let users choose a     color with a level of transparency: pass the ShowAlphaChannel option as     an additional argument.      The user can store customCount() different custom colors. The     custom colors are shared by all color dialogs, and remembered     during the execution of the program. Use setCustomColor() to set     the custom colors, and use customColor() to get them.      When pressing the "Pick Screen Color" button, the cursor changes to a haircross     and the colors on the screen are scanned. The user can pick up one by clicking     the mouse or the Enter button. Pressing Escape restores the last color selected     before entering this mode.      The \l{dialogs/standarddialogs}{Standard Dialogs} example shows     how to use QColorDialog as well as other built-in Qt dialogs.      \image fusion-colordialog.png A color dialog in the Fusion widget style.      \sa QColor, QFileDialog, QFontDialog, {Standard Dialogs Example} */
end_comment
begin_comment
comment|/*!     \since 4.5      Constructs a color dialog with the given \a parent. */
end_comment
begin_constructor
DECL|function|QColorDialog
name|QColorDialog
operator|::
name|QColorDialog
parameter_list|(
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QDialog
argument_list|(
operator|*
operator|new
name|QColorDialogPrivate
argument_list|,
name|parent
argument_list|,
name|DefaultWindowFlags
argument_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|d
operator|->
name|init
argument_list|(
name|Qt
operator|::
name|white
argument_list|)
expr_stmt|;
block|}
end_constructor
begin_comment
comment|/*!     \since 4.5      Constructs a color dialog with the given \a parent and specified     \a initial color. */
end_comment
begin_constructor
DECL|function|QColorDialog
name|QColorDialog
operator|::
name|QColorDialog
parameter_list|(
specifier|const
name|QColor
modifier|&
name|initial
parameter_list|,
name|QWidget
modifier|*
name|parent
parameter_list|)
member_init_list|:
name|QDialog
argument_list|(
operator|*
operator|new
name|QColorDialogPrivate
argument_list|,
name|parent
argument_list|,
name|DefaultWindowFlags
argument_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|d
operator|->
name|init
argument_list|(
name|initial
argument_list|)
expr_stmt|;
block|}
end_constructor
begin_function
DECL|function|setCurrentColor
name|void
name|QColorDialogPrivate
operator|::
name|setCurrentColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|,
name|SetColorMode
name|setColorMode
parameter_list|)
block|{
if|if
condition|(
name|nativeDialogInUse
condition|)
block|{
name|platformColorDialogHelper
argument_list|()
operator|->
name|setCurrentColor
argument_list|(
name|color
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|setColorMode
operator|&
name|ShowColor
condition|)
block|{
name|setCurrentRgbColor
argument_list|(
name|color
operator|.
name|rgb
argument_list|()
argument_list|)
expr_stmt|;
name|setCurrentAlpha
argument_list|(
name|color
operator|.
name|alpha
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|setColorMode
operator|&
name|SelectColor
condition|)
name|selectColor
argument_list|(
name|color
argument_list|)
expr_stmt|;
block|}
end_function
begin_comment
comment|/*!     \property QColorDialog::currentColor     \brief the currently selected color in the dialog */
end_comment
begin_function
DECL|function|setCurrentColor
name|void
name|QColorDialog
operator|::
name|setCurrentColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|color
parameter_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|d
operator|->
name|setCurrentColor
argument_list|(
name|color
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|currentColor
name|QColor
name|QColorDialog
operator|::
name|currentColor
parameter_list|()
specifier|const
block|{
name|Q_D
argument_list|(
specifier|const
name|QColorDialog
argument_list|)
expr_stmt|;
return|return
name|d
operator|->
name|currentQColor
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     Returns the color that the user selected by clicking the \uicontrol{OK}     or equivalent button.      \note This color is not always the same as the color held by the     \l currentColor property since the user can choose different colors     before finally selecting the one to use. */
end_comment
begin_function
DECL|function|selectedColor
name|QColor
name|QColorDialog
operator|::
name|selectedColor
parameter_list|()
specifier|const
block|{
name|Q_D
argument_list|(
specifier|const
name|QColorDialog
argument_list|)
expr_stmt|;
return|return
name|d
operator|->
name|selectedQColor
return|;
block|}
end_function
begin_comment
comment|/*!     Sets the given \a option to be enabled if \a on is true;     otherwise, clears the given \a option.      \sa options, testOption() */
end_comment
begin_function
DECL|function|setOption
name|void
name|QColorDialog
operator|::
name|setOption
parameter_list|(
name|ColorDialogOption
name|option
parameter_list|,
name|bool
name|on
parameter_list|)
block|{
specifier|const
name|QColorDialog
operator|::
name|ColorDialogOptions
name|previousOptions
init|=
name|options
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
operator|(
name|previousOptions
operator|&
name|option
operator|)
operator|!=
operator|!
name|on
condition|)
name|setOptions
argument_list|(
name|previousOptions
operator|^
name|option
argument_list|)
expr_stmt|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Returns \c true if the given \a option is enabled; otherwise, returns     false.      \sa options, setOption() */
end_comment
begin_function
DECL|function|testOption
name|bool
name|QColorDialog
operator|::
name|testOption
parameter_list|(
name|ColorDialogOption
name|option
parameter_list|)
specifier|const
block|{
name|Q_D
argument_list|(
specifier|const
name|QColorDialog
argument_list|)
expr_stmt|;
return|return
name|d
operator|->
name|options
operator|->
name|testOption
argument_list|(
cast|static_cast
argument_list|<
name|QColorDialogOptions
operator|::
name|ColorDialogOption
argument_list|>
argument_list|(
name|option
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \property QColorDialog::options     \brief the various options that affect the look and feel of the dialog      By default, all options are disabled.      Options should be set before showing the dialog. Setting them while the     dialog is visible is not guaranteed to have an immediate effect on the     dialog (depending on the option and on the platform).      \sa setOption(), testOption() */
end_comment
begin_function
DECL|function|setOptions
name|void
name|QColorDialog
operator|::
name|setOptions
parameter_list|(
name|ColorDialogOptions
name|options
parameter_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
name|QColorDialog
operator|::
name|options
argument_list|()
operator|==
name|options
condition|)
return|return;
name|d
operator|->
name|options
operator|->
name|setOptions
argument_list|(
name|QColorDialogOptions
operator|::
name|ColorDialogOptions
argument_list|(
name|int
argument_list|(
name|options
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|options
operator|&
name|DontUseNativeDialog
operator|)
operator|&&
name|d
operator|->
name|nativeDialogInUse
condition|)
block|{
name|d
operator|->
name|nativeDialogInUse
operator|=
literal|false
expr_stmt|;
name|d
operator|->
name|initWidgets
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|d
operator|->
name|nativeDialogInUse
condition|)
block|{
name|d
operator|->
name|buttons
operator|->
name|setVisible
argument_list|(
operator|!
operator|(
name|options
operator|&
name|NoButtons
operator|)
argument_list|)
expr_stmt|;
name|d
operator|->
name|showAlpha
argument_list|(
name|options
operator|&
name|ShowAlphaChannel
argument_list|)
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|options
name|QColorDialog
operator|::
name|ColorDialogOptions
name|QColorDialog
operator|::
name|options
parameter_list|()
specifier|const
block|{
name|Q_D
argument_list|(
specifier|const
name|QColorDialog
argument_list|)
expr_stmt|;
return|return
name|QColorDialog
operator|::
name|ColorDialogOptions
argument_list|(
name|int
argument_list|(
name|d
operator|->
name|options
operator|->
name|options
argument_list|()
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_comment
comment|/*!     \enum QColorDialog::ColorDialogOption      \since 4.5      This enum specifies various options that affect the look and feel     of a color dialog.      \value ShowAlphaChannel Allow the user to select the alpha component of a color.     \value NoButtons Don't display \uicontrol{OK} and \uicontrol{Cancel} buttons. (Useful for "live dialogs".)     \value DontUseNativeDialog  Use Qt's standard color dialog instead of the operating system                                 native color dialog.      \sa options, setOption(), testOption(), windowModality() */
end_comment
begin_comment
comment|/*!     \fn void QColorDialog::currentColorChanged(const QColor&color)      This signal is emitted whenever the current color changes in the dialog.     The current color is specified by \a color.      \sa color, colorSelected() */
end_comment
begin_comment
comment|/*!     \fn void QColorDialog::colorSelected(const QColor&color);      This signal is emitted just after the user has clicked \uicontrol{OK} to     select a color to use. The chosen color is specified by \a color.      \sa color, currentColorChanged() */
end_comment
begin_comment
comment|/*!     Changes the visibility of the dialog. If \a visible is true, the dialog     is shown; otherwise, it is hidden. */
end_comment
begin_function
DECL|function|setVisible
name|void
name|QColorDialog
operator|::
name|setVisible
parameter_list|(
name|bool
name|visible
parameter_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
name|visible
condition|)
block|{
if|if
condition|(
name|testAttribute
argument_list|(
name|Qt
operator|::
name|WA_WState_ExplicitShowHide
argument_list|)
operator|&&
operator|!
name|testAttribute
argument_list|(
name|Qt
operator|::
name|WA_WState_Hidden
argument_list|)
condition|)
return|return;
block|}
elseif|else
if|if
condition|(
name|testAttribute
argument_list|(
name|Qt
operator|::
name|WA_WState_ExplicitShowHide
argument_list|)
operator|&&
name|testAttribute
argument_list|(
name|Qt
operator|::
name|WA_WState_Hidden
argument_list|)
condition|)
return|return;
if|if
condition|(
name|visible
condition|)
name|d
operator|->
name|selectedQColor
operator|=
name|QColor
argument_list|()
expr_stmt|;
if|if
condition|(
name|d
operator|->
name|nativeDialogInUse
condition|)
block|{
name|d
operator|->
name|setNativeDialogVisible
argument_list|(
name|visible
argument_list|)
expr_stmt|;
comment|// Set WA_DontShowOnScreen so that QDialog::setVisible(visible) below
comment|// updates the state correctly, but skips showing the non-native version:
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_DontShowOnScreen
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|setAttribute
argument_list|(
name|Qt
operator|::
name|WA_DontShowOnScreen
argument_list|,
literal|false
argument_list|)
expr_stmt|;
block|}
name|QDialog
operator|::
name|setVisible
argument_list|(
name|visible
argument_list|)
expr_stmt|;
block|}
end_function
begin_comment
comment|/*!     \overload     \since 4.5      Opens the dialog and connects its colorSelected() signal to the slot specified     by \a receiver and \a member.      The signal will be disconnected from the slot when the dialog is closed. */
end_comment
begin_function
DECL|function|open
name|void
name|QColorDialog
operator|::
name|open
parameter_list|(
name|QObject
modifier|*
name|receiver
parameter_list|,
specifier|const
name|char
modifier|*
name|member
parameter_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
name|connect
argument_list|(
name|this
argument_list|,
name|SIGNAL
argument_list|(
name|colorSelected
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|,
name|receiver
argument_list|,
name|member
argument_list|)
expr_stmt|;
name|d
operator|->
name|receiverToDisconnectOnClose
operator|=
name|receiver
expr_stmt|;
name|d
operator|->
name|memberToDisconnectOnClose
operator|=
name|member
expr_stmt|;
name|QDialog
operator|::
name|open
argument_list|()
expr_stmt|;
block|}
end_function
begin_comment
comment|/*!     \since 4.5      Pops up a modal color dialog with the given window \a title (or "Select Color" if none is     specified), lets the user choose a color, and returns that color. The color is initially set     to \a initial. The dialog is a child of \a parent. It returns an invalid (see     QColor::isValid()) color if the user cancels the dialog.      The \a options argument allows you to customize the dialog. */
end_comment
begin_function
DECL|function|getColor
name|QColor
name|QColorDialog
operator|::
name|getColor
parameter_list|(
specifier|const
name|QColor
modifier|&
name|initial
parameter_list|,
name|QWidget
modifier|*
name|parent
parameter_list|,
specifier|const
name|QString
modifier|&
name|title
parameter_list|,
name|ColorDialogOptions
name|options
parameter_list|)
block|{
name|QColorDialog
name|dlg
argument_list|(
name|parent
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|title
operator|.
name|isEmpty
argument_list|()
condition|)
name|dlg
operator|.
name|setWindowTitle
argument_list|(
name|title
argument_list|)
expr_stmt|;
name|dlg
operator|.
name|setOptions
argument_list|(
name|options
argument_list|)
expr_stmt|;
name|dlg
operator|.
name|setCurrentColor
argument_list|(
name|initial
argument_list|)
expr_stmt|;
name|dlg
operator|.
name|exec
argument_list|()
expr_stmt|;
return|return
name|dlg
operator|.
name|selectedColor
argument_list|()
return|;
block|}
end_function
begin_comment
comment|/*!     \obsolete      Pops up a modal color dialog to allow the user to choose a color     and an alpha channel (transparency) value. The color+alpha is     initially set to \a initial. The dialog is a child of \a parent.      If \a ok is non-null, \e *\a ok is set to true if the user clicked     \uicontrol{OK}, and to false if the user clicked Cancel.      If the user clicks Cancel, the \a initial value is returned.      Use QColorDialog::getColor() instead, passing the     QColorDialog::ShowAlphaChannel option. */
end_comment
begin_function
DECL|function|getRgba
name|QRgb
name|QColorDialog
operator|::
name|getRgba
parameter_list|(
name|QRgb
name|initial
parameter_list|,
name|bool
modifier|*
name|ok
parameter_list|,
name|QWidget
modifier|*
name|parent
parameter_list|)
block|{
name|QColor
name|color
argument_list|(
name|getColor
argument_list|(
name|QColor
argument_list|(
name|initial
argument_list|)
argument_list|,
name|parent
argument_list|,
name|QString
argument_list|()
argument_list|,
name|ShowAlphaChannel
argument_list|)
argument_list|)
decl_stmt|;
name|QRgb
name|result
init|=
name|color
operator|.
name|isValid
argument_list|()
condition|?
name|color
operator|.
name|rgba
argument_list|()
else|:
name|initial
decl_stmt|;
if|if
condition|(
name|ok
condition|)
operator|*
name|ok
operator|=
name|color
operator|.
name|isValid
argument_list|()
expr_stmt|;
return|return
name|result
return|;
block|}
end_function
begin_comment
comment|/*!     Destroys the color dialog. */
end_comment
begin_destructor
DECL|function|~QColorDialog
name|QColorDialog
operator|::
name|~
name|QColorDialog
parameter_list|()
block|{  }
end_destructor
begin_comment
comment|/*!     \reimp */
end_comment
begin_function
DECL|function|changeEvent
name|void
name|QColorDialog
operator|::
name|changeEvent
parameter_list|(
name|QEvent
modifier|*
name|e
parameter_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
operator|->
name|type
argument_list|()
operator|==
name|QEvent
operator|::
name|LanguageChange
condition|)
name|d
operator|->
name|retranslateStrings
argument_list|()
expr_stmt|;
name|QDialog
operator|::
name|changeEvent
argument_list|(
name|e
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|_q_updateColorPicking
name|void
name|QColorDialogPrivate
operator|::
name|_q_updateColorPicking
parameter_list|()
block|{
ifndef|#
directive|ifndef
name|QT_NO_CURSOR
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
specifier|static
name|QPoint
name|lastGlobalPos
decl_stmt|;
name|QPoint
name|newGlobalPos
init|=
name|QCursor
operator|::
name|pos
argument_list|()
decl_stmt|;
if|if
condition|(
name|lastGlobalPos
operator|==
name|newGlobalPos
condition|)
return|return;
name|lastGlobalPos
operator|=
name|newGlobalPos
expr_stmt|;
if|if
condition|(
operator|!
name|q
operator|->
name|rect
argument_list|()
operator|.
name|contains
argument_list|(
name|q
operator|->
name|mapFromGlobal
argument_list|(
name|newGlobalPos
argument_list|)
argument_list|)
condition|)
block|{
comment|// Inside the dialog mouse tracking works, handleColorPickingMouseMove will be called
name|updateColorPicking
argument_list|(
name|newGlobalPos
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|Q_OS_WIN32
name|dummyTransparentWindow
operator|.
name|setPosition
argument_list|(
name|newGlobalPos
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
endif|#
directive|endif
comment|// ! QT_NO_CURSOR
block|}
end_function
begin_function
DECL|function|updateColorPicking
name|void
name|QColorDialogPrivate
operator|::
name|updateColorPicking
parameter_list|(
specifier|const
name|QPoint
modifier|&
name|globalPos
parameter_list|)
block|{
specifier|const
name|QColor
name|color
init|=
name|grabScreenColor
argument_list|(
name|globalPos
argument_list|)
decl_stmt|;
comment|// QTBUG-39792, do not change standard, custom color selectors while moving as
comment|// otherwise it is not possible to pre-select a custom cell for assignment.
name|setCurrentColor
argument_list|(
name|color
argument_list|,
name|ShowColor
argument_list|)
expr_stmt|;
name|updateColorLabelText
argument_list|(
name|globalPos
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|handleColorPickingMouseMove
name|bool
name|QColorDialogPrivate
operator|::
name|handleColorPickingMouseMove
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
comment|// If the cross is visible the grabbed color will be black most of the times
name|cp
operator|->
name|setCrossVisible
argument_list|(
operator|!
name|cp
operator|->
name|geometry
argument_list|()
operator|.
name|contains
argument_list|(
name|e
operator|->
name|pos
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|updateColorPicking
argument_list|(
name|e
operator|->
name|globalPos
argument_list|()
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|handleColorPickingMouseButtonRelease
name|bool
name|QColorDialogPrivate
operator|::
name|handleColorPickingMouseButtonRelease
parameter_list|(
name|QMouseEvent
modifier|*
name|e
parameter_list|)
block|{
name|setCurrentColor
argument_list|(
name|grabScreenColor
argument_list|(
name|e
operator|->
name|globalPos
argument_list|()
argument_list|)
argument_list|,
name|SetColorAll
argument_list|)
expr_stmt|;
name|releaseColorPicking
argument_list|()
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|handleColorPickingKeyPress
name|bool
name|QColorDialogPrivate
operator|::
name|handleColorPickingKeyPress
parameter_list|(
name|QKeyEvent
modifier|*
name|e
parameter_list|)
block|{
name|Q_Q
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|e
operator|->
name|key
argument_list|()
condition|)
block|{
case|case
name|Qt
operator|::
name|Key_Escape
case|:
name|releaseColorPicking
argument_list|()
expr_stmt|;
name|q
operator|->
name|setCurrentColor
argument_list|(
name|beforeScreenColorPicking
argument_list|)
expr_stmt|;
break|break;
case|case
name|Qt
operator|::
name|Key_Return
case|:
case|case
name|Qt
operator|::
name|Key_Enter
case|:
name|q
operator|->
name|setCurrentColor
argument_list|(
name|grabScreenColor
argument_list|(
name|QCursor
operator|::
name|pos
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|releaseColorPicking
argument_list|()
expr_stmt|;
break|break;
block|}
name|e
operator|->
name|accept
argument_list|()
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_comment
comment|/*!   Closes the dialog and sets its result code to \a result. If this dialog   is shown with exec(), done() causes the local event loop to finish,   and exec() to return \a result.    \sa QDialog::done() */
end_comment
begin_function
DECL|function|done
name|void
name|QColorDialog
operator|::
name|done
parameter_list|(
name|int
name|result
parameter_list|)
block|{
name|Q_D
argument_list|(
name|QColorDialog
argument_list|)
expr_stmt|;
if|if
condition|(
name|result
operator|==
name|Accepted
condition|)
block|{
name|d
operator|->
name|selectedQColor
operator|=
name|d
operator|->
name|currentQColor
argument_list|()
expr_stmt|;
emit|emit
name|colorSelected
argument_list|(
name|d
operator|->
name|selectedQColor
argument_list|)
emit|;
block|}
else|else
block|{
name|d
operator|->
name|selectedQColor
operator|=
name|QColor
argument_list|()
expr_stmt|;
block|}
name|QDialog
operator|::
name|done
argument_list|(
name|result
argument_list|)
expr_stmt|;
if|if
condition|(
name|d
operator|->
name|receiverToDisconnectOnClose
condition|)
block|{
name|disconnect
argument_list|(
name|this
argument_list|,
name|SIGNAL
argument_list|(
name|colorSelected
argument_list|(
name|QColor
argument_list|)
argument_list|)
argument_list|,
name|d
operator|->
name|receiverToDisconnectOnClose
argument_list|,
name|d
operator|->
name|memberToDisconnectOnClose
argument_list|)
expr_stmt|;
name|d
operator|->
name|receiverToDisconnectOnClose
operator|=
literal|0
expr_stmt|;
block|}
name|d
operator|->
name|memberToDisconnectOnClose
operator|.
name|clear
argument_list|()
expr_stmt|;
block|}
end_function
begin_macro
name|QT_END_NAMESPACE
end_macro
begin_include
include|#
directive|include
file|"qcolordialog.moc"
end_include
begin_include
include|#
directive|include
file|"moc_qcolordialog.cpp"
end_include
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// QT_NO_COLORDIALOG
end_comment
end_unit
