begin_unit
begin_comment
comment|/**************************************************************************** ** ** Copyright (C) 2013 Digia Plc and/or its subsidiary(-ies). ** Contact: http://www.qt-project.org/legal ** ** This file is part of the plugins of the Qt Toolkit. ** ** $QT_BEGIN_LICENSE:LGPL$ ** Commercial License Usage ** Licensees holding valid commercial Qt licenses may use this file in ** accordance with the commercial license agreement provided with the ** Software or, alternatively, in accordance with the terms contained in ** a written agreement between you and Digia.  For licensing terms and ** conditions see http://qt.digia.com/licensing.  For further information ** use the contact form at http://qt.digia.com/contact-us. ** ** GNU Lesser General Public License Usage ** Alternatively, this file may be used under the terms of the GNU Lesser ** General Public License version 2.1 as published by the Free Software ** Foundation and appearing in the file LICENSE.LGPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU Lesser General Public License version 2.1 requirements ** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html. ** ** In addition, as a special exception, Digia gives you certain additional ** rights.  These rights are described in the Digia Qt LGPL Exception ** version 1.1, included in the file LGPL_EXCEPTION.txt in this package. ** ** GNU General Public License Usage ** Alternatively, this file may be used under the terms of the GNU ** General Public License version 3.0 as published by the Free Software ** Foundation and appearing in the file LICENSE.GPL included in the ** packaging of this file.  Please review the following information to ** ensure the GNU General Public License version 3.0 requirements will be ** met: http://www.gnu.org/copyleft/gpl.html. ** ** ** $QT_END_LICENSE$ ** ****************************************************************************/
end_comment
begin_include
include|#
directive|include
file|"itemviews.h"
end_include
begin_include
include|#
directive|include
file|<qheaderview.h>
end_include
begin_include
include|#
directive|include
file|<qtableview.h>
end_include
begin_include
include|#
directive|include
file|<qlistview.h>
end_include
begin_include
include|#
directive|include
file|<qtreeview.h>
end_include
begin_include
include|#
directive|include
file|<private/qtreewidget_p.h>
end_include
begin_include
include|#
directive|include
file|<QtGui/private/qaccessible2_p.h>
end_include
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_ACCESSIBILITY
end_ifndef
begin_function_decl
name|QT_BEGIN_NAMESPACE
name|QString
name|Q_GUI_EXPORT
name|qt_accStripAmp
parameter_list|(
specifier|const
name|QString
modifier|&
name|text
parameter_list|)
function_decl|;
end_function_decl
begin_ifndef
ifndef|#
directive|ifndef
name|QT_NO_ITEMVIEWS
end_ifndef
begin_comment
comment|/* Implementation of the IAccessible2 table2 interface. Much simpler than the other table interfaces since there is only the main table and cells:  TABLE/LIST/TREE   |- HEADER CELL   |- CELL   |- CELL   ... */
end_comment
begin_function
DECL|function|view
name|QAbstractItemView
modifier|*
name|QAccessibleTable
operator|::
name|view
parameter_list|()
specifier|const
block|{
return|return
name|qobject_cast
argument_list|<
name|QAbstractItemView
operator|*
argument_list|>
argument_list|(
name|object
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|logicalIndex
name|int
name|QAccessibleTable
operator|::
name|logicalIndex
parameter_list|(
specifier|const
name|QModelIndex
modifier|&
name|index
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|||
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
return|return
operator|-
literal|1
return|;
name|int
name|vHeader
init|=
name|verticalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
name|int
name|hHeader
init|=
name|horizontalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
return|return
operator|(
name|index
operator|.
name|row
argument_list|()
operator|+
name|hHeader
operator|)
operator|*
operator|(
name|index
operator|.
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|+
name|vHeader
operator|)
operator|+
operator|(
name|index
operator|.
name|column
argument_list|()
operator|+
name|vHeader
operator|)
return|;
block|}
end_function
begin_constructor
DECL|function|QAccessibleTable
name|QAccessibleTable
operator|::
name|QAccessibleTable
parameter_list|(
name|QWidget
modifier|*
name|w
parameter_list|)
member_init_list|:
name|QAccessibleObject
argument_list|(
name|w
argument_list|)
block|{
name|Q_ASSERT
argument_list|(
name|view
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|qobject_cast
argument_list|<
specifier|const
name|QTableView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
condition|)
block|{
name|m_role
operator|=
name|QAccessible
operator|::
name|Table
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
condition|)
block|{
name|m_role
operator|=
name|QAccessible
operator|::
name|Tree
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|qobject_cast
argument_list|<
specifier|const
name|QListView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
condition|)
block|{
name|m_role
operator|=
name|QAccessible
operator|::
name|List
expr_stmt|;
block|}
else|else
block|{
comment|// is this our best guess?
name|m_role
operator|=
name|QAccessible
operator|::
name|Table
expr_stmt|;
block|}
block|}
end_constructor
begin_function
DECL|function|isValid
name|bool
name|QAccessibleTable
operator|::
name|isValid
parameter_list|()
specifier|const
block|{
return|return
operator|(
name|view
argument_list|()
operator|&&
operator|!
name|qobject_cast
argument_list|<
name|QWidget
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
operator|->
name|d_func
argument_list|()
operator|->
name|data
operator|.
name|in_destructor
operator|)
return|;
block|}
end_function
begin_destructor
DECL|function|~QAccessibleTable
name|QAccessibleTable
operator|::
name|~
name|QAccessibleTable
parameter_list|()
block|{
name|Q_FOREACH
argument_list|(
argument|QAccessible::Id id
argument_list|,
argument|childToId.values()
argument_list|)
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
end_destructor
begin_function
DECL|function|horizontalHeader
name|QHeaderView
modifier|*
name|QAccessibleTable
operator|::
name|horizontalHeader
parameter_list|()
specifier|const
block|{
name|QHeaderView
modifier|*
name|header
init|=
literal|0
decl_stmt|;
if|if
condition|(
literal|false
condition|)
block|{
ifndef|#
directive|ifndef
name|QT_NO_TABLEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTableView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTableView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|horizontalHeader
argument_list|()
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|QT_NO_TREEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTreeView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|header
argument_list|()
expr_stmt|;
if|if
condition|(
name|header
operator|&&
name|header
operator|->
name|isHidden
argument_list|()
condition|)
name|header
operator|=
literal|0
expr_stmt|;
endif|#
directive|endif
block|}
return|return
name|header
return|;
block|}
end_function
begin_function
DECL|function|verticalHeader
name|QHeaderView
modifier|*
name|QAccessibleTable
operator|::
name|verticalHeader
parameter_list|()
specifier|const
block|{
name|QHeaderView
modifier|*
name|header
init|=
literal|0
decl_stmt|;
if|if
condition|(
literal|false
condition|)
block|{
ifndef|#
directive|ifndef
name|QT_NO_TABLEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTableView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTableView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|verticalHeader
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
return|return
name|header
return|;
block|}
end_function
begin_function
DECL|function|cellAt
name|QAccessibleInterface
modifier|*
name|QAccessibleTable
operator|::
name|cellAt
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|column
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
name|Q_ASSERT
argument_list|(
name|role
argument_list|()
operator|!=
name|QAccessible
operator|::
name|Tree
argument_list|)
expr_stmt|;
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
name|row
argument_list|,
name|column
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|qWarning
argument_list|()
operator|<<
literal|"QAccessibleTable::cellAt: invalid index: "
operator|<<
name|index
operator|<<
literal|" for "
operator|<<
name|view
argument_list|()
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|child
argument_list|(
name|logicalIndex
argument_list|(
name|index
argument_list|)
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|caption
name|QAccessibleInterface
modifier|*
name|QAccessibleTable
operator|::
name|caption
parameter_list|()
specifier|const
block|{
return|return
literal|0
return|;
block|}
end_function
begin_function
DECL|function|columnDescription
name|QString
name|QAccessibleTable
operator|::
name|columnDescription
parameter_list|(
name|int
name|column
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
name|QString
argument_list|()
return|;
return|return
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|headerData
argument_list|(
name|column
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
operator|.
name|toString
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|columnCount
name|int
name|QAccessibleTable
operator|::
name|columnCount
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
return|return
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|rowCount
name|int
name|QAccessibleTable
operator|::
name|rowCount
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
return|return
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|rowCount
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|selectedCellCount
name|int
name|QAccessibleTable
operator|::
name|selectedCellCount
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|0
return|;
return|return
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|selectedIndexes
argument_list|()
operator|.
name|count
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|selectedColumnCount
name|int
name|QAccessibleTable
operator|::
name|selectedColumnCount
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|0
return|;
return|return
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|selectedColumns
argument_list|()
operator|.
name|count
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|selectedRowCount
name|int
name|QAccessibleTable
operator|::
name|selectedRowCount
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|0
return|;
return|return
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|selectedRows
argument_list|()
operator|.
name|count
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|rowDescription
name|QString
name|QAccessibleTable
operator|::
name|rowDescription
parameter_list|(
name|int
name|row
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
name|QString
argument_list|()
return|;
return|return
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|headerData
argument_list|(
name|row
argument_list|,
name|Qt
operator|::
name|Vertical
argument_list|)
operator|.
name|toString
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|selectedCells
name|QList
argument_list|<
name|QAccessibleInterface
modifier|*
argument_list|>
name|QAccessibleTable
operator|::
name|selectedCells
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|QAccessibleInterface
modifier|*
argument_list|>
name|cells
decl_stmt|;
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
name|cells
return|;
name|Q_FOREACH
argument_list|(
argument|const QModelIndex&index
argument_list|,
argument|view()->selectionModel()->selectedIndexes()
argument_list|)
name|cells
operator|.
name|append
argument_list|(
name|child
argument_list|(
name|logicalIndex
argument_list|(
name|index
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|cells
return|;
block|}
end_function
begin_function
DECL|function|selectedColumns
name|QList
argument_list|<
name|int
argument_list|>
name|QAccessibleTable
operator|::
name|selectedColumns
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
name|QList
argument_list|<
name|int
argument_list|>
argument_list|()
return|;
name|QList
argument_list|<
name|int
argument_list|>
name|columns
decl_stmt|;
name|Q_FOREACH
argument_list|(
argument|const QModelIndex&index
argument_list|,
argument|view()->selectionModel()->selectedColumns()
argument_list|)
block|{
name|columns
operator|.
name|append
argument_list|(
name|index
operator|.
name|column
argument_list|()
argument_list|)
expr_stmt|;
block|}
return|return
name|columns
return|;
block|}
end_function
begin_function
DECL|function|selectedRows
name|QList
argument_list|<
name|int
argument_list|>
name|QAccessibleTable
operator|::
name|selectedRows
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
name|QList
argument_list|<
name|int
argument_list|>
argument_list|()
return|;
name|QList
argument_list|<
name|int
argument_list|>
name|rows
decl_stmt|;
name|Q_FOREACH
argument_list|(
argument|const QModelIndex&index
argument_list|,
argument|view()->selectionModel()->selectedRows()
argument_list|)
block|{
name|rows
operator|.
name|append
argument_list|(
name|index
operator|.
name|row
argument_list|()
argument_list|)
expr_stmt|;
block|}
return|return
name|rows
return|;
block|}
end_function
begin_function
DECL|function|summary
name|QAccessibleInterface
modifier|*
name|QAccessibleTable
operator|::
name|summary
parameter_list|()
specifier|const
block|{
return|return
literal|0
return|;
block|}
end_function
begin_function
DECL|function|isColumnSelected
name|bool
name|QAccessibleTable
operator|::
name|isColumnSelected
parameter_list|(
name|int
name|column
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
return|return
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isColumnSelected
argument_list|(
name|column
argument_list|,
name|QModelIndex
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|isRowSelected
name|bool
name|QAccessibleTable
operator|::
name|isRowSelected
parameter_list|(
name|int
name|row
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
return|return
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
argument_list|,
name|QModelIndex
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|selectRow
name|bool
name|QAccessibleTable
operator|::
name|selectRow
parameter_list|(
name|int
name|row
parameter_list|)
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
name|row
argument_list|,
literal|0
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
operator|||
name|view
argument_list|()
operator|->
name|selectionBehavior
argument_list|()
operator|==
name|QAbstractItemView
operator|::
name|SelectColumns
condition|)
return|return
literal|false
return|;
switch|switch
condition|(
name|view
argument_list|()
operator|->
name|selectionMode
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|NoSelection
case|:
return|return
literal|false
return|;
case|case
name|QAbstractItemView
operator|::
name|SingleSelection
case|:
if|if
condition|(
name|view
argument_list|()
operator|->
name|selectionBehavior
argument_list|()
operator|!=
name|QAbstractItemView
operator|::
name|SelectRows
operator|&&
name|columnCount
argument_list|()
operator|>
literal|1
condition|)
return|return
literal|false
return|;
name|view
argument_list|()
operator|->
name|clearSelection
argument_list|()
expr_stmt|;
break|break;
case|case
name|QAbstractItemView
operator|::
name|ContiguousSelection
case|:
if|if
condition|(
operator|(
operator|!
name|row
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
operator|-
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
operator|)
operator|&&
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
operator|+
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
condition|)
name|view
argument_list|()
operator|->
name|clearSelection
argument_list|()
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|index
argument_list|,
name|QItemSelectionModel
operator|::
name|Select
operator||
name|QItemSelectionModel
operator|::
name|Rows
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|selectColumn
name|bool
name|QAccessibleTable
operator|::
name|selectColumn
parameter_list|(
name|int
name|column
parameter_list|)
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
literal|0
argument_list|,
name|column
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
operator|||
name|view
argument_list|()
operator|->
name|selectionBehavior
argument_list|()
operator|==
name|QAbstractItemView
operator|::
name|SelectRows
condition|)
return|return
literal|false
return|;
switch|switch
condition|(
name|view
argument_list|()
operator|->
name|selectionMode
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|NoSelection
case|:
return|return
literal|false
return|;
case|case
name|QAbstractItemView
operator|::
name|SingleSelection
case|:
if|if
condition|(
name|view
argument_list|()
operator|->
name|selectionBehavior
argument_list|()
operator|!=
name|QAbstractItemView
operator|::
name|SelectColumns
operator|&&
name|rowCount
argument_list|()
operator|>
literal|1
condition|)
return|return
literal|false
return|;
case|case
name|QAbstractItemView
operator|::
name|ContiguousSelection
case|:
if|if
condition|(
operator|(
operator|!
name|column
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isColumnSelected
argument_list|(
name|column
operator|-
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
operator|)
operator|&&
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isColumnSelected
argument_list|(
name|column
operator|+
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
condition|)
name|view
argument_list|()
operator|->
name|clearSelection
argument_list|()
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|index
argument_list|,
name|QItemSelectionModel
operator|::
name|Select
operator||
name|QItemSelectionModel
operator|::
name|Columns
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|unselectRow
name|bool
name|QAccessibleTable
operator|::
name|unselectRow
parameter_list|(
name|int
name|row
parameter_list|)
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
name|row
argument_list|,
literal|0
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
return|return
literal|false
return|;
name|QItemSelection
name|selection
argument_list|(
name|index
argument_list|,
name|index
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|view
argument_list|()
operator|->
name|selectionMode
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|SingleSelection
case|:
comment|//In SingleSelection and ContiguousSelection once an item
comment|//is selected, there's no way for the user to unselect all items
if|if
condition|(
name|selectedRowCount
argument_list|()
operator|==
literal|1
condition|)
return|return
literal|false
return|;
break|break;
case|case
name|QAbstractItemView
operator|::
name|ContiguousSelection
case|:
if|if
condition|(
name|selectedRowCount
argument_list|()
operator|==
literal|1
condition|)
return|return
literal|false
return|;
if|if
condition|(
operator|(
operator|!
name|row
operator|||
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
operator|-
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
operator|)
operator|&&
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
operator|+
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
condition|)
block|{
comment|//If there are rows selected both up the current row and down the current rown,
comment|//the ones which are down the current row will be deselected
name|selection
operator|=
name|QItemSelection
argument_list|(
name|index
argument_list|,
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
name|rowCount
argument_list|()
operator|-
literal|1
argument_list|,
literal|0
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
default|default:
break|break;
block|}
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|selection
argument_list|,
name|QItemSelectionModel
operator|::
name|Deselect
operator||
name|QItemSelectionModel
operator|::
name|Rows
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|unselectColumn
name|bool
name|QAccessibleTable
operator|::
name|unselectColumn
parameter_list|(
name|int
name|column
parameter_list|)
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
literal|0
argument_list|,
name|column
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
return|return
literal|false
return|;
name|QItemSelection
name|selection
argument_list|(
name|index
argument_list|,
name|index
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|view
argument_list|()
operator|->
name|selectionMode
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|SingleSelection
case|:
comment|//In SingleSelection and ContiguousSelection once an item
comment|//is selected, there's no way for the user to unselect all items
if|if
condition|(
name|selectedColumnCount
argument_list|()
operator|==
literal|1
condition|)
return|return
literal|false
return|;
break|break;
case|case
name|QAbstractItemView
operator|::
name|ContiguousSelection
case|:
if|if
condition|(
name|selectedColumnCount
argument_list|()
operator|==
literal|1
condition|)
return|return
literal|false
return|;
if|if
condition|(
operator|(
operator|!
name|column
operator|||
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isColumnSelected
argument_list|(
name|column
operator|-
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
operator|)
operator|&&
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isColumnSelected
argument_list|(
name|column
operator|+
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
condition|)
block|{
comment|//If there are columns selected both at the left of the current row and at the right
comment|//of the current rown, the ones which are at the right will be deselected
name|selection
operator|=
name|QItemSelection
argument_list|(
name|index
argument_list|,
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
literal|0
argument_list|,
name|columnCount
argument_list|()
operator|-
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
default|default:
break|break;
block|}
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|selection
argument_list|,
name|QItemSelectionModel
operator|::
name|Deselect
operator||
name|QItemSelectionModel
operator|::
name|Columns
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_function
DECL|function|role
name|QAccessible
operator|::
name|Role
name|QAccessibleTable
operator|::
name|role
parameter_list|()
specifier|const
block|{
return|return
name|m_role
return|;
block|}
end_function
begin_function
DECL|function|state
name|QAccessible
operator|::
name|State
name|QAccessibleTable
operator|::
name|state
parameter_list|()
specifier|const
block|{
return|return
name|QAccessible
operator|::
name|State
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|childAt
name|QAccessibleInterface
modifier|*
name|QAccessibleTable
operator|::
name|childAt
parameter_list|(
name|int
name|x
parameter_list|,
name|int
name|y
parameter_list|)
specifier|const
block|{
name|QPoint
name|viewportOffset
init|=
name|view
argument_list|()
operator|->
name|viewport
argument_list|()
operator|->
name|mapTo
argument_list|(
name|view
argument_list|()
argument_list|,
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|QPoint
name|indexPosition
init|=
name|view
argument_list|()
operator|->
name|mapFromGlobal
argument_list|(
name|QPoint
argument_list|(
name|x
argument_list|,
name|y
argument_list|)
operator|-
name|viewportOffset
argument_list|)
decl_stmt|;
comment|// FIXME: if indexPosition< 0 in one coordinate, return header
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|indexAt
argument_list|(
name|indexPosition
argument_list|)
decl_stmt|;
if|if
condition|(
name|index
operator|.
name|isValid
argument_list|()
condition|)
block|{
return|return
name|child
argument_list|(
name|logicalIndex
argument_list|(
name|index
argument_list|)
argument_list|)
return|;
block|}
return|return
literal|0
return|;
block|}
end_function
begin_function
DECL|function|childCount
name|int
name|QAccessibleTable
operator|::
name|childCount
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
name|int
name|vHeader
init|=
name|verticalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
name|int
name|hHeader
init|=
name|horizontalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
return|return
operator|(
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|rowCount
argument_list|()
operator|+
name|hHeader
operator|)
operator|*
operator|(
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|+
name|vHeader
operator|)
return|;
block|}
end_function
begin_function
DECL|function|indexOfChild
name|int
name|QAccessibleTable
operator|::
name|indexOfChild
parameter_list|(
specifier|const
name|QAccessibleInterface
modifier|*
name|iface
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
operator|-
literal|1
return|;
name|QAccessibleInterface
modifier|*
name|parent
init|=
name|iface
operator|->
name|parent
argument_list|()
decl_stmt|;
if|if
condition|(
name|parent
operator|->
name|object
argument_list|()
operator|!=
name|view
argument_list|()
condition|)
return|return
operator|-
literal|1
return|;
name|Q_ASSERT
argument_list|(
name|iface
operator|->
name|role
argument_list|()
operator|!=
name|QAccessible
operator|::
name|TreeItem
argument_list|)
expr_stmt|;
comment|// should be handled by tree class
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|Cell
operator|||
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ListItem
condition|)
block|{
specifier|const
name|QAccessibleTableCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
specifier|const
name|QAccessibleTableCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
return|return
name|logicalIndex
argument_list|(
name|cell
operator|->
name|m_index
argument_list|)
return|;
block|}
elseif|else
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ColumnHeader
condition|)
block|{
specifier|const
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
specifier|const
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
return|return
name|cell
operator|->
name|index
operator|+
operator|(
name|verticalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|RowHeader
condition|)
block|{
specifier|const
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
specifier|const
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
return|return
operator|(
name|cell
operator|->
name|index
operator|+
literal|1
operator|)
operator|*
operator|(
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|+
literal|1
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|Pane
condition|)
block|{
return|return
literal|0
return|;
comment|// corner button
block|}
else|else
block|{
name|qWarning
argument_list|()
operator|<<
literal|"WARNING QAccessibleTable::indexOfChild Fix my children..."
operator|<<
name|iface
operator|->
name|role
argument_list|()
operator|<<
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
expr_stmt|;
block|}
comment|// FIXME: we are in denial of our children. this should stop.
return|return
operator|-
literal|1
return|;
block|}
end_function
begin_function
DECL|function|text
name|QString
name|QAccessibleTable
operator|::
name|text
parameter_list|(
name|QAccessible
operator|::
name|Text
name|t
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|t
operator|==
name|QAccessible
operator|::
name|Description
condition|)
return|return
name|view
argument_list|()
operator|->
name|accessibleDescription
argument_list|()
return|;
return|return
name|view
argument_list|()
operator|->
name|accessibleName
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|rect
name|QRect
name|QAccessibleTable
operator|::
name|rect
parameter_list|()
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|isVisible
argument_list|()
condition|)
return|return
name|QRect
argument_list|()
return|;
name|QPoint
name|pos
init|=
name|view
argument_list|()
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
return|return
name|QRect
argument_list|(
name|pos
operator|.
name|x
argument_list|()
argument_list|,
name|pos
operator|.
name|y
argument_list|()
argument_list|,
name|view
argument_list|()
operator|->
name|width
argument_list|()
argument_list|,
name|view
argument_list|()
operator|->
name|height
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|parent
name|QAccessibleInterface
modifier|*
name|QAccessibleTable
operator|::
name|parent
parameter_list|()
specifier|const
block|{
if|if
condition|(
name|view
argument_list|()
operator|&&
name|view
argument_list|()
operator|->
name|parent
argument_list|()
condition|)
block|{
if|if
condition|(
name|qstrcmp
argument_list|(
literal|"QComboBoxPrivateContainer"
argument_list|,
name|view
argument_list|()
operator|->
name|parent
argument_list|()
operator|->
name|metaObject
argument_list|()
operator|->
name|className
argument_list|()
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|view
argument_list|()
operator|->
name|parent
argument_list|()
operator|->
name|parent
argument_list|()
argument_list|)
return|;
block|}
return|return
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|view
argument_list|()
operator|->
name|parent
argument_list|()
argument_list|)
return|;
block|}
return|return
literal|0
return|;
block|}
end_function
begin_function
DECL|function|child
name|QAccessibleInterface
modifier|*
name|QAccessibleTable
operator|::
name|child
parameter_list|(
name|int
name|logicalIndex
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|childToId
operator|.
name|contains
argument_list|(
name|logicalIndex
argument_list|)
condition|)
block|{
name|QAccessible
operator|::
name|Id
name|id
init|=
name|childToId
operator|.
name|value
argument_list|(
name|logicalIndex
argument_list|)
decl_stmt|;
return|return
name|QAccessible
operator|::
name|accessibleInterface
argument_list|(
name|id
argument_list|)
return|;
block|}
name|int
name|vHeader
init|=
name|verticalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
name|int
name|hHeader
init|=
name|horizontalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
name|int
name|columns
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|+
name|vHeader
decl_stmt|;
name|int
name|row
init|=
name|logicalIndex
operator|/
name|columns
decl_stmt|;
name|int
name|column
init|=
name|logicalIndex
operator|%
name|columns
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|vHeader
condition|)
block|{
if|if
condition|(
name|column
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|hHeader
operator|&&
name|row
operator|==
literal|0
condition|)
block|{
name|iface
operator|=
operator|new
name|QAccessibleTableCornerButton
argument_list|(
name|view
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|iface
operator|=
operator|new
name|QAccessibleTableHeaderCell
argument_list|(
name|view
argument_list|()
argument_list|,
name|row
operator|-
name|hHeader
argument_list|,
name|Qt
operator|::
name|Vertical
argument_list|)
expr_stmt|;
block|}
block|}
operator|--
name|column
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|iface
operator|&&
name|hHeader
condition|)
block|{
if|if
condition|(
name|row
operator|==
literal|0
condition|)
block|{
name|iface
operator|=
operator|new
name|QAccessibleTableHeaderCell
argument_list|(
name|view
argument_list|()
argument_list|,
name|column
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
block|}
operator|--
name|row
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|iface
condition|)
block|{
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
name|row
argument_list|,
name|column
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|qWarning
argument_list|()
operator|<<
literal|"QAccessibleTable::child: Invalid index at: "
operator|<<
name|row
operator|<<
name|column
expr_stmt|;
return|return
literal|0
return|;
block|}
name|iface
operator|=
operator|new
name|QAccessibleTableCell
argument_list|(
name|view
argument_list|()
argument_list|,
name|index
argument_list|,
name|cellRole
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QAccessible
operator|::
name|registerAccessibleInterface
argument_list|(
name|iface
argument_list|)
expr_stmt|;
name|childToId
operator|.
name|insert
argument_list|(
name|logicalIndex
argument_list|,
name|QAccessible
operator|::
name|uniqueId
argument_list|(
name|iface
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|iface
return|;
block|}
end_function
begin_function
DECL|function|interface_cast
name|void
modifier|*
name|QAccessibleTable
operator|::
name|interface_cast
parameter_list|(
name|QAccessible
operator|::
name|InterfaceType
name|t
parameter_list|)
block|{
if|if
condition|(
name|t
operator|==
name|QAccessible
operator|::
name|TableInterface
condition|)
return|return
cast|static_cast
argument_list|<
name|QAccessibleTableInterface
operator|*
argument_list|>
argument_list|(
name|this
argument_list|)
return|;
return|return
literal|0
return|;
block|}
end_function
begin_function
DECL|function|modelChange
name|void
name|QAccessibleTable
operator|::
name|modelChange
parameter_list|(
name|QAccessibleTableModelChangeEvent
modifier|*
name|event
parameter_list|)
block|{
comment|// if there is no cache yet, we don't update anything
if|if
condition|(
name|childToId
operator|.
name|isEmpty
argument_list|()
condition|)
return|return;
switch|switch
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
condition|)
block|{
case|case
name|QAccessibleTableModelChangeEvent
operator|::
name|ModelReset
case|:
name|Q_FOREACH
argument_list|(
argument|QAccessible::Id id
argument_list|,
argument|childToId.values()
argument_list|)
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
name|childToId
operator|.
name|clear
argument_list|()
expr_stmt|;
break|break;
comment|// rows are inserted: move every row after that
case|case
name|QAccessibleTableModelChangeEvent
operator|::
name|RowsInserted
case|:
case|case
name|QAccessibleTableModelChangeEvent
operator|::
name|ColumnsInserted
case|:
block|{
name|int
name|newRows
init|=
name|event
operator|->
name|lastRow
argument_list|()
operator|-
name|event
operator|->
name|firstRow
argument_list|()
operator|+
literal|1
decl_stmt|;
name|int
name|newColumns
init|=
name|event
operator|->
name|lastColumn
argument_list|()
operator|-
name|event
operator|->
name|firstColumn
argument_list|()
operator|+
literal|1
decl_stmt|;
name|ChildCache
name|newCache
decl_stmt|;
name|ChildCache
operator|::
name|ConstIterator
name|iter
init|=
name|childToId
operator|.
name|constBegin
argument_list|()
decl_stmt|;
while|while
condition|(
name|iter
operator|!=
name|childToId
operator|.
name|constEnd
argument_list|()
condition|)
block|{
name|QAccessible
operator|::
name|Id
name|id
init|=
name|iter
operator|.
name|value
argument_list|()
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|accessibleInterface
argument_list|(
name|id
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|iface
argument_list|)
expr_stmt|;
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|Cell
operator|||
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ListItem
condition|)
block|{
name|Q_ASSERT
argument_list|(
name|iface
operator|->
name|tableCellInterface
argument_list|()
argument_list|)
expr_stmt|;
name|QAccessibleTableCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
name|QAccessibleTableCell
operator|*
argument_list|>
argument_list|(
name|iface
operator|->
name|tableCellInterface
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|RowsInserted
operator|&&
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
operator|>=
name|event
operator|->
name|firstRow
argument_list|()
condition|)
block|{
name|int
name|newRow
init|=
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
operator|+
name|newRows
decl_stmt|;
name|cell
operator|->
name|m_index
operator|=
name|cell
operator|->
name|m_index
operator|.
name|sibling
argument_list|(
name|newRow
argument_list|,
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|ColumnsInserted
operator|&&
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
operator|>=
name|event
operator|->
name|firstColumn
argument_list|()
condition|)
block|{
name|int
name|newColumn
init|=
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
operator|+
name|newColumns
decl_stmt|;
name|cell
operator|->
name|m_index
operator|=
name|cell
operator|->
name|m_index
operator|.
name|sibling
argument_list|(
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
argument_list|,
name|newColumn
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|RowsInserted
operator|&&
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|RowHeader
condition|)
block|{
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
if|if
condition|(
name|cell
operator|->
name|index
operator|>=
name|event
operator|->
name|firstRow
argument_list|()
condition|)
block|{
name|cell
operator|->
name|index
operator|+=
name|newRows
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|ColumnsInserted
operator|&&
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ColumnHeader
condition|)
block|{
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
if|if
condition|(
name|cell
operator|->
name|index
operator|>=
name|event
operator|->
name|firstColumn
argument_list|()
condition|)
block|{
name|cell
operator|->
name|index
operator|+=
name|newColumns
expr_stmt|;
block|}
block|}
if|if
condition|(
name|indexOfChild
argument_list|(
name|iface
argument_list|)
operator|>=
literal|0
condition|)
block|{
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|iface
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// ### This should really not happen,
comment|// but it might if the view has a root index set.
comment|// This needs to be fixed.
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
operator|++
name|iter
expr_stmt|;
block|}
name|childToId
operator|=
name|newCache
expr_stmt|;
break|break;
block|}
case|case
name|QAccessibleTableModelChangeEvent
operator|::
name|ColumnsRemoved
case|:
case|case
name|QAccessibleTableModelChangeEvent
operator|::
name|RowsRemoved
case|:
block|{
name|int
name|deletedColumns
init|=
name|event
operator|->
name|lastColumn
argument_list|()
operator|-
name|event
operator|->
name|firstColumn
argument_list|()
operator|+
literal|1
decl_stmt|;
name|int
name|deletedRows
init|=
name|event
operator|->
name|lastRow
argument_list|()
operator|-
name|event
operator|->
name|firstRow
argument_list|()
operator|+
literal|1
decl_stmt|;
name|ChildCache
name|newCache
decl_stmt|;
name|ChildCache
operator|::
name|ConstIterator
name|iter
init|=
name|childToId
operator|.
name|constBegin
argument_list|()
decl_stmt|;
while|while
condition|(
name|iter
operator|!=
name|childToId
operator|.
name|constEnd
argument_list|()
condition|)
block|{
name|QAccessible
operator|::
name|Id
name|id
init|=
name|iter
operator|.
name|value
argument_list|()
decl_stmt|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
name|QAccessible
operator|::
name|accessibleInterface
argument_list|(
name|id
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|iface
argument_list|)
expr_stmt|;
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|Cell
operator|||
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ListItem
condition|)
block|{
name|Q_ASSERT
argument_list|(
name|iface
operator|->
name|tableCellInterface
argument_list|()
argument_list|)
expr_stmt|;
name|QAccessibleTableCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
name|QAccessibleTableCell
operator|*
argument_list|>
argument_list|(
name|iface
operator|->
name|tableCellInterface
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|RowsRemoved
condition|)
block|{
if|if
condition|(
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
operator|<
name|event
operator|->
name|firstRow
argument_list|()
condition|)
block|{
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
operator|>
name|event
operator|->
name|lastRow
argument_list|()
condition|)
block|{
name|int
name|newRow
init|=
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
operator|-
name|deletedRows
decl_stmt|;
name|cell
operator|->
name|m_index
operator|=
name|cell
operator|->
name|m_index
operator|.
name|sibling
argument_list|(
name|newRow
argument_list|,
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
argument_list|)
expr_stmt|;
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|ColumnsRemoved
condition|)
block|{
if|if
condition|(
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
operator|<
name|event
operator|->
name|firstColumn
argument_list|()
condition|)
block|{
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
operator|>
name|event
operator|->
name|lastColumn
argument_list|()
condition|)
block|{
name|int
name|newColumn
init|=
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
operator|-
name|deletedColumns
decl_stmt|;
name|cell
operator|->
name|m_index
operator|=
name|cell
operator|->
name|m_index
operator|.
name|sibling
argument_list|(
name|cell
operator|->
name|m_index
operator|.
name|row
argument_list|()
argument_list|,
name|newColumn
argument_list|)
expr_stmt|;
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
block|}
block|}
elseif|else
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|RowsRemoved
operator|&&
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|RowHeader
condition|)
block|{
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
if|if
condition|(
name|cell
operator|->
name|index
operator|<
name|event
operator|->
name|firstRow
argument_list|()
condition|)
block|{
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|cell
operator|->
name|index
operator|>
name|event
operator|->
name|lastRow
argument_list|()
condition|)
block|{
name|cell
operator|->
name|index
operator|-=
name|deletedRows
expr_stmt|;
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|event
operator|->
name|modelChangeType
argument_list|()
operator|==
name|QAccessibleTableModelChangeEvent
operator|::
name|ColumnsRemoved
operator|&&
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ColumnHeader
condition|)
block|{
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
if|if
condition|(
name|cell
operator|->
name|index
operator|<
name|event
operator|->
name|firstColumn
argument_list|()
condition|)
block|{
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|cell
operator|->
name|index
operator|>
name|event
operator|->
name|lastColumn
argument_list|()
condition|)
block|{
name|cell
operator|->
name|index
operator|-=
name|deletedColumns
expr_stmt|;
name|newCache
operator|.
name|insert
argument_list|(
name|indexOfChild
argument_list|(
name|cell
argument_list|)
argument_list|,
name|id
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|QAccessible
operator|::
name|deleteAccessibleInterface
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
block|}
operator|++
name|iter
expr_stmt|;
block|}
name|childToId
operator|=
name|newCache
expr_stmt|;
break|break;
block|}
case|case
name|QAccessibleTableModelChangeEvent
operator|::
name|DataChanged
case|:
comment|// nothing to do in this case
break|break;
block|}
block|}
end_function
begin_comment
comment|// TREE VIEW
end_comment
begin_function
DECL|function|indexFromLogical
name|QModelIndex
name|QAccessibleTree
operator|::
name|indexFromLogical
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|column
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|isValid
argument_list|()
operator|||
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
name|QModelIndex
argument_list|()
return|;
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|(
name|row
operator|<
literal|0
operator|)
operator|||
operator|(
name|column
operator|<
literal|0
operator|)
operator|||
operator|(
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewItems
operator|.
name|count
argument_list|()
operator|<=
name|row
operator|)
condition|)
block|{
name|qWarning
argument_list|()
operator|<<
literal|"QAccessibleTree::indexFromLogical: invalid index: "
operator|<<
name|row
operator|<<
name|column
operator|<<
literal|" for "
operator|<<
name|treeView
expr_stmt|;
return|return
name|QModelIndex
argument_list|()
return|;
block|}
name|QModelIndex
name|modelIndex
init|=
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewItems
operator|.
name|at
argument_list|(
name|row
argument_list|)
operator|.
name|index
decl_stmt|;
if|if
condition|(
name|modelIndex
operator|.
name|isValid
argument_list|()
operator|&&
name|column
operator|>
literal|0
condition|)
block|{
name|modelIndex
operator|=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|index
argument_list|(
name|modelIndex
operator|.
name|row
argument_list|()
argument_list|,
name|column
argument_list|,
name|modelIndex
operator|.
name|parent
argument_list|()
argument_list|)
expr_stmt|;
block|}
return|return
name|modelIndex
return|;
block|}
end_function
begin_function
DECL|function|childAt
name|QAccessibleInterface
modifier|*
name|QAccessibleTree
operator|::
name|childAt
parameter_list|(
name|int
name|x
parameter_list|,
name|int
name|y
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
name|QPoint
name|viewportOffset
init|=
name|view
argument_list|()
operator|->
name|viewport
argument_list|()
operator|->
name|mapTo
argument_list|(
name|view
argument_list|()
argument_list|,
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|QPoint
name|indexPosition
init|=
name|view
argument_list|()
operator|->
name|mapFromGlobal
argument_list|(
name|QPoint
argument_list|(
name|x
argument_list|,
name|y
argument_list|)
operator|-
name|viewportOffset
argument_list|)
decl_stmt|;
name|QModelIndex
name|index
init|=
name|view
argument_list|()
operator|->
name|indexAt
argument_list|(
name|indexPosition
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
return|return
literal|0
return|;
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
decl_stmt|;
name|int
name|row
init|=
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewIndex
argument_list|(
name|index
argument_list|)
operator|+
operator|(
name|horizontalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
operator|)
decl_stmt|;
name|int
name|column
init|=
name|index
operator|.
name|column
argument_list|()
decl_stmt|;
name|int
name|i
init|=
name|row
operator|*
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|+
name|column
decl_stmt|;
return|return
name|child
argument_list|(
name|i
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|childCount
name|int
name|QAccessibleTree
operator|::
name|childCount
parameter_list|()
specifier|const
block|{
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|treeView
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
literal|0
return|;
name|int
name|hHeader
init|=
name|horizontalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
decl_stmt|;
return|return
operator|(
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewItems
operator|.
name|count
argument_list|()
operator|+
name|hHeader
operator|)
operator|*
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|child
name|QAccessibleInterface
modifier|*
name|QAccessibleTree
operator|::
name|child
parameter_list|(
name|int
name|logicalIndex
parameter_list|)
specifier|const
block|{
if|if
condition|(
name|logicalIndex
operator|<
literal|0
operator|||
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|||
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
condition|)
return|return
literal|0
return|;
name|QAccessibleInterface
modifier|*
name|iface
init|=
literal|0
decl_stmt|;
name|int
name|index
init|=
name|logicalIndex
decl_stmt|;
if|if
condition|(
name|horizontalHeader
argument_list|()
condition|)
block|{
if|if
condition|(
name|index
operator|<
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
condition|)
block|{
name|iface
operator|=
operator|new
name|QAccessibleTableHeaderCell
argument_list|(
name|view
argument_list|()
argument_list|,
name|index
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|index
operator|-=
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|iface
condition|)
block|{
name|int
name|row
init|=
name|index
operator|/
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
decl_stmt|;
name|int
name|column
init|=
name|index
operator|%
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
decl_stmt|;
name|QModelIndex
name|modelIndex
init|=
name|indexFromLogical
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|modelIndex
operator|.
name|isValid
argument_list|()
condition|)
return|return
literal|0
return|;
name|iface
operator|=
operator|new
name|QAccessibleTableCell
argument_list|(
name|view
argument_list|()
argument_list|,
name|modelIndex
argument_list|,
name|cellRole
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|QAccessible
operator|::
name|registerAccessibleInterface
argument_list|(
name|iface
argument_list|)
expr_stmt|;
comment|// ### FIXME: get interfaces from the cache instead of re-creating them
return|return
name|iface
return|;
block|}
end_function
begin_function
DECL|function|rowCount
name|int
name|QAccessibleTree
operator|::
name|rowCount
parameter_list|()
specifier|const
block|{
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|treeView
argument_list|)
expr_stmt|;
return|return
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewItems
operator|.
name|count
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|indexOfChild
name|int
name|QAccessibleTree
operator|::
name|indexOfChild
parameter_list|(
specifier|const
name|QAccessibleInterface
modifier|*
name|iface
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|model
argument_list|()
condition|)
return|return
operator|-
literal|1
return|;
name|QAccessibleInterface
modifier|*
name|parent
init|=
name|iface
operator|->
name|parent
argument_list|()
decl_stmt|;
if|if
condition|(
name|parent
operator|->
name|object
argument_list|()
operator|!=
name|view
argument_list|()
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|TreeItem
condition|)
block|{
specifier|const
name|QAccessibleTableCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
specifier|const
name|QAccessibleTableCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|treeView
argument_list|)
expr_stmt|;
name|int
name|row
init|=
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewIndex
argument_list|(
name|cell
operator|->
name|m_index
argument_list|)
operator|+
operator|(
name|horizontalHeader
argument_list|()
condition|?
literal|1
else|:
literal|0
operator|)
decl_stmt|;
name|int
name|column
init|=
name|cell
operator|->
name|m_index
operator|.
name|column
argument_list|()
decl_stmt|;
name|int
name|index
init|=
name|row
operator|*
name|view
argument_list|()
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|+
name|column
decl_stmt|;
return|return
name|index
return|;
block|}
elseif|else
if|if
condition|(
name|iface
operator|->
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|ColumnHeader
condition|)
block|{
specifier|const
name|QAccessibleTableHeaderCell
modifier|*
name|cell
init|=
cast|static_cast
argument_list|<
specifier|const
name|QAccessibleTableHeaderCell
operator|*
argument_list|>
argument_list|(
name|iface
argument_list|)
decl_stmt|;
return|return
name|cell
operator|->
name|index
return|;
block|}
else|else
block|{
name|qWarning
argument_list|()
operator|<<
literal|"WARNING QAccessibleTable::indexOfChild invalid child"
operator|<<
name|iface
operator|->
name|role
argument_list|()
operator|<<
name|iface
operator|->
name|text
argument_list|(
name|QAccessible
operator|::
name|Name
argument_list|)
expr_stmt|;
block|}
comment|// FIXME: add scrollbars and don't just ignore them
return|return
operator|-
literal|1
return|;
block|}
end_function
begin_function
DECL|function|cellAt
name|QAccessibleInterface
modifier|*
name|QAccessibleTree
operator|::
name|cellAt
parameter_list|(
name|int
name|row
parameter_list|,
name|int
name|column
parameter_list|)
specifier|const
block|{
name|QModelIndex
name|index
init|=
name|indexFromLogical
argument_list|(
name|row
argument_list|,
name|column
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
condition|)
block|{
name|qWarning
argument_list|()
operator|<<
literal|"Requested invalid tree cell: "
operator|<<
name|row
operator|<<
name|column
expr_stmt|;
return|return
literal|0
return|;
block|}
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|()
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|treeView
argument_list|)
expr_stmt|;
name|int
name|logicalIndex
init|=
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|accessibleTable2Index
argument_list|(
name|index
argument_list|)
decl_stmt|;
return|return
name|child
argument_list|(
name|logicalIndex
argument_list|)
return|;
comment|// FIXME ### new QAccessibleTableCell(view(), index, cellRole());
block|}
end_function
begin_function
DECL|function|rowDescription
name|QString
name|QAccessibleTree
operator|::
name|rowDescription
parameter_list|(
name|int
parameter_list|)
specifier|const
block|{
return|return
name|QString
argument_list|()
return|;
comment|// no headers for rows in trees
block|}
end_function
begin_function
DECL|function|isRowSelected
name|bool
name|QAccessibleTree
operator|::
name|isRowSelected
parameter_list|(
name|int
name|row
parameter_list|)
specifier|const
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
name|QModelIndex
name|index
init|=
name|indexFromLogical
argument_list|(
name|row
argument_list|)
decl_stmt|;
return|return
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|index
operator|.
name|row
argument_list|()
argument_list|,
name|index
operator|.
name|parent
argument_list|()
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|selectRow
name|bool
name|QAccessibleTree
operator|::
name|selectRow
parameter_list|(
name|int
name|row
parameter_list|)
block|{
if|if
condition|(
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
condition|)
return|return
literal|false
return|;
name|QModelIndex
name|index
init|=
name|indexFromLogical
argument_list|(
name|row
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|index
operator|.
name|isValid
argument_list|()
operator|||
name|view
argument_list|()
operator|->
name|selectionBehavior
argument_list|()
operator|==
name|QAbstractItemView
operator|::
name|SelectColumns
condition|)
return|return
literal|false
return|;
switch|switch
condition|(
name|view
argument_list|()
operator|->
name|selectionMode
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|NoSelection
case|:
return|return
literal|false
return|;
case|case
name|QAbstractItemView
operator|::
name|SingleSelection
case|:
if|if
condition|(
operator|(
name|view
argument_list|()
operator|->
name|selectionBehavior
argument_list|()
operator|!=
name|QAbstractItemView
operator|::
name|SelectRows
operator|)
operator|&&
operator|(
name|columnCount
argument_list|()
operator|>
literal|1
operator|)
condition|)
return|return
literal|false
return|;
name|view
argument_list|()
operator|->
name|clearSelection
argument_list|()
expr_stmt|;
break|break;
case|case
name|QAbstractItemView
operator|::
name|ContiguousSelection
case|:
if|if
condition|(
operator|(
operator|!
name|row
operator|||
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
operator|-
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
operator|)
operator|&&
operator|!
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|isRowSelected
argument_list|(
name|row
operator|+
literal|1
argument_list|,
name|view
argument_list|()
operator|->
name|rootIndex
argument_list|()
argument_list|)
condition|)
name|view
argument_list|()
operator|->
name|clearSelection
argument_list|()
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|view
argument_list|()
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|index
argument_list|,
name|QItemSelectionModel
operator|::
name|Select
operator||
name|QItemSelectionModel
operator|::
name|Rows
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
end_function
begin_comment
comment|// TABLE CELL
end_comment
begin_constructor
DECL|function|QAccessibleTableCell
name|QAccessibleTableCell
operator|::
name|QAccessibleTableCell
parameter_list|(
name|QAbstractItemView
modifier|*
name|view_
parameter_list|,
specifier|const
name|QModelIndex
modifier|&
name|index_
parameter_list|,
name|QAccessible
operator|::
name|Role
name|role_
parameter_list|)
member_init_list|:
comment|/* QAccessibleSimpleEditableTextInterface(this), */
name|view
argument_list|(
name|view_
argument_list|)
member_init_list|,
name|m_index
argument_list|(
name|index_
argument_list|)
member_init_list|,
name|m_role
argument_list|(
name|role_
argument_list|)
block|{
if|if
condition|(
operator|!
name|index_
operator|.
name|isValid
argument_list|()
condition|)
name|qWarning
argument_list|()
operator|<<
literal|"QAccessibleTableCell::QAccessibleTableCell with invalid index: "
operator|<<
name|index_
expr_stmt|;
block|}
end_constructor
begin_function
DECL|function|interface_cast
name|void
modifier|*
name|QAccessibleTableCell
operator|::
name|interface_cast
parameter_list|(
name|QAccessible
operator|::
name|InterfaceType
name|t
parameter_list|)
block|{
if|if
condition|(
name|t
operator|==
name|QAccessible
operator|::
name|TableCellInterface
condition|)
return|return
cast|static_cast
argument_list|<
name|QAccessibleTableCellInterface
operator|*
argument_list|>
argument_list|(
name|this
argument_list|)
return|;
if|if
condition|(
name|t
operator|==
name|QAccessible
operator|::
name|ActionInterface
condition|)
return|return
cast|static_cast
argument_list|<
name|QAccessibleActionInterface
operator|*
argument_list|>
argument_list|(
name|this
argument_list|)
return|;
return|return
literal|0
return|;
block|}
end_function
begin_function
DECL|function|columnExtent
name|int
name|QAccessibleTableCell
operator|::
name|columnExtent
parameter_list|()
specifier|const
block|{
return|return
literal|1
return|;
block|}
end_function
begin_function
DECL|function|rowExtent
name|int
name|QAccessibleTableCell
operator|::
name|rowExtent
parameter_list|()
specifier|const
block|{
return|return
literal|1
return|;
block|}
end_function
begin_function
DECL|function|rowHeaderCells
name|QList
argument_list|<
name|QAccessibleInterface
modifier|*
argument_list|>
name|QAccessibleTableCell
operator|::
name|rowHeaderCells
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|QAccessibleInterface
modifier|*
argument_list|>
name|headerCell
decl_stmt|;
if|if
condition|(
name|verticalHeader
argument_list|()
condition|)
block|{
comment|// FIXME
name|headerCell
operator|.
name|append
argument_list|(
operator|new
name|QAccessibleTableHeaderCell
argument_list|(
name|view
argument_list|,
name|m_index
operator|.
name|row
argument_list|()
argument_list|,
name|Qt
operator|::
name|Vertical
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|headerCell
return|;
block|}
end_function
begin_function
DECL|function|columnHeaderCells
name|QList
argument_list|<
name|QAccessibleInterface
modifier|*
argument_list|>
name|QAccessibleTableCell
operator|::
name|columnHeaderCells
parameter_list|()
specifier|const
block|{
name|QList
argument_list|<
name|QAccessibleInterface
modifier|*
argument_list|>
name|headerCell
decl_stmt|;
if|if
condition|(
name|horizontalHeader
argument_list|()
condition|)
block|{
comment|// FIXME
name|headerCell
operator|.
name|append
argument_list|(
operator|new
name|QAccessibleTableHeaderCell
argument_list|(
name|view
argument_list|,
name|m_index
operator|.
name|column
argument_list|()
argument_list|,
name|Qt
operator|::
name|Horizontal
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|headerCell
return|;
block|}
end_function
begin_function
DECL|function|horizontalHeader
name|QHeaderView
modifier|*
name|QAccessibleTableCell
operator|::
name|horizontalHeader
parameter_list|()
specifier|const
block|{
name|QHeaderView
modifier|*
name|header
init|=
literal|0
decl_stmt|;
if|if
condition|(
literal|false
condition|)
block|{
ifndef|#
directive|ifndef
name|QT_NO_TABLEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTableView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTableView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|horizontalHeader
argument_list|()
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|QT_NO_TREEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTreeView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|header
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
return|return
name|header
return|;
block|}
end_function
begin_function
DECL|function|verticalHeader
name|QHeaderView
modifier|*
name|QAccessibleTableCell
operator|::
name|verticalHeader
parameter_list|()
specifier|const
block|{
name|QHeaderView
modifier|*
name|header
init|=
literal|0
decl_stmt|;
ifndef|#
directive|ifndef
name|QT_NO_TABLEVIEW
if|if
condition|(
specifier|const
name|QTableView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTableView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
condition|)
name|header
operator|=
name|tv
operator|->
name|verticalHeader
argument_list|()
expr_stmt|;
endif|#
directive|endif
return|return
name|header
return|;
block|}
end_function
begin_function
DECL|function|columnIndex
name|int
name|QAccessibleTableCell
operator|::
name|columnIndex
parameter_list|()
specifier|const
block|{
return|return
name|m_index
operator|.
name|column
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|rowIndex
name|int
name|QAccessibleTableCell
operator|::
name|rowIndex
parameter_list|()
specifier|const
block|{
if|if
condition|(
name|role
argument_list|()
operator|==
name|QAccessible
operator|::
name|TreeItem
condition|)
block|{
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
decl_stmt|;
name|Q_ASSERT
argument_list|(
name|treeView
argument_list|)
expr_stmt|;
name|int
name|row
init|=
name|treeView
operator|->
name|d_func
argument_list|()
operator|->
name|viewIndex
argument_list|(
name|m_index
argument_list|)
decl_stmt|;
return|return
name|row
return|;
block|}
return|return
name|m_index
operator|.
name|row
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|isSelected
name|bool
name|QAccessibleTableCell
operator|::
name|isSelected
parameter_list|()
specifier|const
block|{
return|return
name|view
operator|->
name|selectionModel
argument_list|()
operator|->
name|isSelected
argument_list|(
name|m_index
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|actionNames
name|QStringList
name|QAccessibleTableCell
operator|::
name|actionNames
parameter_list|()
specifier|const
block|{
name|QStringList
name|names
decl_stmt|;
name|names
operator|<<
name|toggleAction
argument_list|()
expr_stmt|;
return|return
name|names
return|;
block|}
end_function
begin_function
DECL|function|doAction
name|void
name|QAccessibleTableCell
operator|::
name|doAction
parameter_list|(
specifier|const
name|QString
modifier|&
name|actionName
parameter_list|)
block|{
if|if
condition|(
name|actionName
operator|==
name|toggleAction
argument_list|()
condition|)
block|{
if|if
condition|(
name|isSelected
argument_list|()
condition|)
name|unselectCell
argument_list|()
expr_stmt|;
else|else
name|selectCell
argument_list|()
expr_stmt|;
block|}
block|}
end_function
begin_function
DECL|function|keyBindingsForAction
name|QStringList
name|QAccessibleTableCell
operator|::
name|keyBindingsForAction
parameter_list|(
specifier|const
name|QString
modifier|&
parameter_list|)
specifier|const
block|{
return|return
name|QStringList
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|selectCell
name|void
name|QAccessibleTableCell
operator|::
name|selectCell
parameter_list|()
block|{
name|QAbstractItemView
operator|::
name|SelectionMode
name|selectionMode
init|=
name|view
operator|->
name|selectionMode
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|m_index
operator|.
name|isValid
argument_list|()
operator|||
operator|(
name|selectionMode
operator|==
name|QAbstractItemView
operator|::
name|NoSelection
operator|)
condition|)
return|return;
name|Q_ASSERT
argument_list|(
name|table
argument_list|()
argument_list|)
expr_stmt|;
name|QAccessibleTableInterface
modifier|*
name|cellTable
init|=
name|table
argument_list|()
operator|->
name|tableInterface
argument_list|()
decl_stmt|;
switch|switch
condition|(
name|view
operator|->
name|selectionBehavior
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|SelectItems
case|:
break|break;
case|case
name|QAbstractItemView
operator|::
name|SelectColumns
case|:
if|if
condition|(
name|cellTable
condition|)
name|cellTable
operator|->
name|selectColumn
argument_list|(
name|m_index
operator|.
name|column
argument_list|()
argument_list|)
expr_stmt|;
return|return;
case|case
name|QAbstractItemView
operator|::
name|SelectRows
case|:
if|if
condition|(
name|cellTable
condition|)
name|cellTable
operator|->
name|selectRow
argument_list|(
name|m_index
operator|.
name|row
argument_list|()
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|selectionMode
operator|==
name|QAbstractItemView
operator|::
name|SingleSelection
condition|)
block|{
name|view
operator|->
name|clearSelection
argument_list|()
expr_stmt|;
block|}
name|view
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|m_index
argument_list|,
name|QItemSelectionModel
operator|::
name|Select
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|unselectCell
name|void
name|QAccessibleTableCell
operator|::
name|unselectCell
parameter_list|()
block|{
name|QAbstractItemView
operator|::
name|SelectionMode
name|selectionMode
init|=
name|view
operator|->
name|selectionMode
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|m_index
operator|.
name|isValid
argument_list|()
operator|||
operator|(
name|selectionMode
operator|&
name|QAbstractItemView
operator|::
name|NoSelection
operator|)
condition|)
return|return;
name|QAccessibleTableInterface
modifier|*
name|cellTable
init|=
name|table
argument_list|()
operator|->
name|tableInterface
argument_list|()
decl_stmt|;
switch|switch
condition|(
name|view
operator|->
name|selectionBehavior
argument_list|()
condition|)
block|{
case|case
name|QAbstractItemView
operator|::
name|SelectItems
case|:
break|break;
case|case
name|QAbstractItemView
operator|::
name|SelectColumns
case|:
if|if
condition|(
name|cellTable
condition|)
name|cellTable
operator|->
name|unselectColumn
argument_list|(
name|m_index
operator|.
name|column
argument_list|()
argument_list|)
expr_stmt|;
return|return;
case|case
name|QAbstractItemView
operator|::
name|SelectRows
case|:
if|if
condition|(
name|cellTable
condition|)
name|cellTable
operator|->
name|unselectRow
argument_list|(
name|m_index
operator|.
name|row
argument_list|()
argument_list|)
expr_stmt|;
return|return;
block|}
comment|//If the mode is not MultiSelection or ExtendedSelection and only
comment|//one cell is selected it cannot be unselected by the user
if|if
condition|(
operator|(
name|selectionMode
operator|!=
name|QAbstractItemView
operator|::
name|MultiSelection
operator|)
operator|&&
operator|(
name|selectionMode
operator|!=
name|QAbstractItemView
operator|::
name|ExtendedSelection
operator|)
operator|&&
operator|(
name|view
operator|->
name|selectionModel
argument_list|()
operator|->
name|selectedIndexes
argument_list|()
operator|.
name|count
argument_list|()
operator|<=
literal|1
operator|)
condition|)
return|return;
name|view
operator|->
name|selectionModel
argument_list|()
operator|->
name|select
argument_list|(
name|m_index
argument_list|,
name|QItemSelectionModel
operator|::
name|Deselect
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|table
name|QAccessibleInterface
modifier|*
name|QAccessibleTableCell
operator|::
name|table
parameter_list|()
specifier|const
block|{
return|return
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|view
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|role
name|QAccessible
operator|::
name|Role
name|QAccessibleTableCell
operator|::
name|role
parameter_list|()
specifier|const
block|{
return|return
name|m_role
return|;
block|}
end_function
begin_function
DECL|function|state
name|QAccessible
operator|::
name|State
name|QAccessibleTableCell
operator|::
name|state
parameter_list|()
specifier|const
block|{
name|QAccessible
operator|::
name|State
name|st
decl_stmt|;
name|QRect
name|globalRect
init|=
name|view
operator|->
name|rect
argument_list|()
decl_stmt|;
name|globalRect
operator|.
name|translate
argument_list|(
name|view
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|globalRect
operator|.
name|intersects
argument_list|(
name|rect
argument_list|()
argument_list|)
condition|)
name|st
operator|.
name|invisible
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|view
operator|->
name|selectionModel
argument_list|()
operator|->
name|isSelected
argument_list|(
name|m_index
argument_list|)
condition|)
name|st
operator|.
name|selected
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|view
operator|->
name|selectionModel
argument_list|()
operator|->
name|currentIndex
argument_list|()
operator|==
name|m_index
condition|)
name|st
operator|.
name|focused
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|m_index
operator|.
name|model
argument_list|()
operator|->
name|data
argument_list|(
name|m_index
argument_list|,
name|Qt
operator|::
name|CheckStateRole
argument_list|)
operator|.
name|toInt
argument_list|()
operator|==
name|Qt
operator|::
name|Checked
condition|)
name|st
operator|.
name|checked
operator|=
literal|true
expr_stmt|;
name|Qt
operator|::
name|ItemFlags
name|flags
init|=
name|m_index
operator|.
name|flags
argument_list|()
decl_stmt|;
if|if
condition|(
name|flags
operator|&
name|Qt
operator|::
name|ItemIsSelectable
condition|)
block|{
name|st
operator|.
name|selectable
operator|=
literal|true
expr_stmt|;
name|st
operator|.
name|focusable
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|view
operator|->
name|selectionMode
argument_list|()
operator|==
name|QAbstractItemView
operator|::
name|MultiSelection
condition|)
name|st
operator|.
name|multiSelectable
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|view
operator|->
name|selectionMode
argument_list|()
operator|==
name|QAbstractItemView
operator|::
name|ExtendedSelection
condition|)
name|st
operator|.
name|extSelectable
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|m_role
operator|==
name|QAccessible
operator|::
name|TreeItem
condition|)
block|{
specifier|const
name|QTreeView
modifier|*
name|treeView
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
decl_stmt|;
if|if
condition|(
name|treeView
operator|->
name|model
argument_list|()
operator|->
name|hasChildren
argument_list|(
name|m_index
argument_list|)
condition|)
name|st
operator|.
name|expandable
operator|=
literal|true
expr_stmt|;
if|if
condition|(
name|treeView
operator|->
name|isExpanded
argument_list|(
name|m_index
argument_list|)
condition|)
name|st
operator|.
name|expanded
operator|=
literal|true
expr_stmt|;
block|}
return|return
name|st
return|;
block|}
end_function
begin_function
DECL|function|rect
name|QRect
name|QAccessibleTableCell
operator|::
name|rect
parameter_list|()
specifier|const
block|{
name|QRect
name|r
decl_stmt|;
name|r
operator|=
name|view
operator|->
name|visualRect
argument_list|(
name|m_index
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
operator|.
name|isNull
argument_list|()
condition|)
name|r
operator|.
name|translate
argument_list|(
name|view
operator|->
name|viewport
argument_list|()
operator|->
name|mapTo
argument_list|(
name|view
argument_list|,
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|r
operator|.
name|translate
argument_list|(
name|view
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|r
return|;
block|}
end_function
begin_function
DECL|function|text
name|QString
name|QAccessibleTableCell
operator|::
name|text
parameter_list|(
name|QAccessible
operator|::
name|Text
name|t
parameter_list|)
specifier|const
block|{
name|QAbstractItemModel
modifier|*
name|model
init|=
name|view
operator|->
name|model
argument_list|()
decl_stmt|;
name|QString
name|value
decl_stmt|;
switch|switch
condition|(
name|t
condition|)
block|{
case|case
name|QAccessible
operator|::
name|Value
case|:
case|case
name|QAccessible
operator|::
name|Name
case|:
name|value
operator|=
name|model
operator|->
name|data
argument_list|(
name|m_index
argument_list|,
name|Qt
operator|::
name|AccessibleTextRole
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|value
operator|.
name|isEmpty
argument_list|()
condition|)
name|value
operator|=
name|model
operator|->
name|data
argument_list|(
name|m_index
argument_list|,
name|Qt
operator|::
name|DisplayRole
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
break|break;
case|case
name|QAccessible
operator|::
name|Description
case|:
name|value
operator|=
name|model
operator|->
name|data
argument_list|(
name|m_index
argument_list|,
name|Qt
operator|::
name|AccessibleDescriptionRole
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
break|break;
default|default:
break|break;
block|}
return|return
name|value
return|;
block|}
end_function
begin_function
DECL|function|setText
name|void
name|QAccessibleTableCell
operator|::
name|setText
parameter_list|(
name|QAccessible
operator|::
name|Text
comment|/*t*/
parameter_list|,
specifier|const
name|QString
modifier|&
name|text
parameter_list|)
block|{
if|if
condition|(
operator|!
operator|(
name|m_index
operator|.
name|flags
argument_list|()
operator|&
name|Qt
operator|::
name|ItemIsEditable
operator|)
condition|)
return|return;
name|view
operator|->
name|model
argument_list|()
operator|->
name|setData
argument_list|(
name|m_index
argument_list|,
name|text
argument_list|)
expr_stmt|;
block|}
end_function
begin_function
DECL|function|isValid
name|bool
name|QAccessibleTableCell
operator|::
name|isValid
parameter_list|()
specifier|const
block|{
return|return
name|view
operator|&&
name|view
operator|->
name|model
argument_list|()
operator|&&
name|m_index
operator|.
name|isValid
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|parent
name|QAccessibleInterface
modifier|*
name|QAccessibleTableCell
operator|::
name|parent
parameter_list|()
specifier|const
block|{
return|return
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|view
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|child
name|QAccessibleInterface
modifier|*
name|QAccessibleTableCell
operator|::
name|child
parameter_list|(
name|int
parameter_list|)
specifier|const
block|{
return|return
literal|0
return|;
block|}
end_function
begin_constructor
DECL|function|QAccessibleTableHeaderCell
name|QAccessibleTableHeaderCell
operator|::
name|QAccessibleTableHeaderCell
parameter_list|(
name|QAbstractItemView
modifier|*
name|view_
parameter_list|,
name|int
name|index_
parameter_list|,
name|Qt
operator|::
name|Orientation
name|orientation_
parameter_list|)
member_init_list|:
name|view
argument_list|(
name|view_
argument_list|)
member_init_list|,
name|index
argument_list|(
name|index_
argument_list|)
member_init_list|,
name|orientation
argument_list|(
name|orientation_
argument_list|)
block|{
name|Q_ASSERT
argument_list|(
name|index_
operator|>=
literal|0
argument_list|)
expr_stmt|;
block|}
end_constructor
begin_function
DECL|function|role
name|QAccessible
operator|::
name|Role
name|QAccessibleTableHeaderCell
operator|::
name|role
parameter_list|()
specifier|const
block|{
if|if
condition|(
name|orientation
operator|==
name|Qt
operator|::
name|Horizontal
condition|)
return|return
name|QAccessible
operator|::
name|ColumnHeader
return|;
return|return
name|QAccessible
operator|::
name|RowHeader
return|;
block|}
end_function
begin_function
DECL|function|state
name|QAccessible
operator|::
name|State
name|QAccessibleTableHeaderCell
operator|::
name|state
parameter_list|()
specifier|const
block|{
return|return
name|QAccessible
operator|::
name|State
argument_list|()
return|;
block|}
end_function
begin_function
DECL|function|rect
name|QRect
name|QAccessibleTableHeaderCell
operator|::
name|rect
parameter_list|()
specifier|const
block|{
name|QHeaderView
modifier|*
name|header
init|=
literal|0
decl_stmt|;
if|if
condition|(
literal|false
condition|)
block|{
ifndef|#
directive|ifndef
name|QT_NO_TABLEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTableView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTableView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
condition|)
block|{
if|if
condition|(
name|orientation
operator|==
name|Qt
operator|::
name|Horizontal
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|horizontalHeader
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|header
operator|=
name|tv
operator|->
name|verticalHeader
argument_list|()
expr_stmt|;
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|QT_NO_TREEVIEW
block|}
elseif|else
if|if
condition|(
specifier|const
name|QTreeView
modifier|*
name|tv
init|=
name|qobject_cast
argument_list|<
specifier|const
name|QTreeView
operator|*
argument_list|>
argument_list|(
name|view
argument_list|)
condition|)
block|{
name|header
operator|=
name|tv
operator|->
name|header
argument_list|()
expr_stmt|;
endif|#
directive|endif
block|}
if|if
condition|(
operator|!
name|header
condition|)
return|return
name|QRect
argument_list|()
return|;
name|QPoint
name|zero
init|=
name|header
operator|->
name|mapToGlobal
argument_list|(
name|QPoint
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
decl_stmt|;
name|int
name|sectionSize
init|=
name|header
operator|->
name|sectionSize
argument_list|(
name|index
argument_list|)
decl_stmt|;
name|int
name|sectionPos
init|=
name|header
operator|->
name|sectionPosition
argument_list|(
name|index
argument_list|)
decl_stmt|;
return|return
name|orientation
operator|==
name|Qt
operator|::
name|Horizontal
condition|?
name|QRect
argument_list|(
name|zero
operator|.
name|x
argument_list|()
operator|+
name|sectionPos
argument_list|,
name|zero
operator|.
name|y
argument_list|()
argument_list|,
name|sectionSize
argument_list|,
name|header
operator|->
name|height
argument_list|()
argument_list|)
else|:
name|QRect
argument_list|(
name|zero
operator|.
name|x
argument_list|()
argument_list|,
name|zero
operator|.
name|y
argument_list|()
operator|+
name|sectionPos
argument_list|,
name|header
operator|->
name|width
argument_list|()
argument_list|,
name|sectionSize
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|text
name|QString
name|QAccessibleTableHeaderCell
operator|::
name|text
parameter_list|(
name|QAccessible
operator|::
name|Text
name|t
parameter_list|)
specifier|const
block|{
name|QAbstractItemModel
modifier|*
name|model
init|=
name|view
operator|->
name|model
argument_list|()
decl_stmt|;
name|QString
name|value
decl_stmt|;
switch|switch
condition|(
name|t
condition|)
block|{
case|case
name|QAccessible
operator|::
name|Value
case|:
case|case
name|QAccessible
operator|::
name|Name
case|:
name|value
operator|=
name|model
operator|->
name|headerData
argument_list|(
name|index
argument_list|,
name|orientation
argument_list|,
name|Qt
operator|::
name|AccessibleTextRole
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|value
operator|.
name|isEmpty
argument_list|()
condition|)
name|value
operator|=
name|model
operator|->
name|headerData
argument_list|(
name|index
argument_list|,
name|orientation
argument_list|,
name|Qt
operator|::
name|DisplayRole
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
break|break;
case|case
name|QAccessible
operator|::
name|Description
case|:
name|value
operator|=
name|model
operator|->
name|headerData
argument_list|(
name|index
argument_list|,
name|orientation
argument_list|,
name|Qt
operator|::
name|AccessibleDescriptionRole
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
break|break;
default|default:
break|break;
block|}
return|return
name|value
return|;
block|}
end_function
begin_function
DECL|function|setText
name|void
name|QAccessibleTableHeaderCell
operator|::
name|setText
parameter_list|(
name|QAccessible
operator|::
name|Text
parameter_list|,
specifier|const
name|QString
modifier|&
parameter_list|)
block|{
return|return;
block|}
end_function
begin_function
DECL|function|isValid
name|bool
name|QAccessibleTableHeaderCell
operator|::
name|isValid
parameter_list|()
specifier|const
block|{
return|return
name|view
operator|&&
name|view
operator|->
name|model
argument_list|()
operator|&&
operator|(
name|index
operator|>=
literal|0
operator|)
operator|&&
operator|(
operator|(
name|orientation
operator|==
name|Qt
operator|::
name|Horizontal
operator|)
condition|?
operator|(
name|index
operator|<
name|view
operator|->
name|model
argument_list|()
operator|->
name|columnCount
argument_list|()
operator|)
else|:
operator|(
name|index
operator|<
name|view
operator|->
name|model
argument_list|()
operator|->
name|rowCount
argument_list|()
operator|)
operator|)
return|;
block|}
end_function
begin_function
DECL|function|parent
name|QAccessibleInterface
modifier|*
name|QAccessibleTableHeaderCell
operator|::
name|parent
parameter_list|()
specifier|const
block|{
return|return
name|QAccessible
operator|::
name|queryAccessibleInterface
argument_list|(
name|view
argument_list|)
return|;
block|}
end_function
begin_function
DECL|function|child
name|QAccessibleInterface
modifier|*
name|QAccessibleTableHeaderCell
operator|::
name|child
parameter_list|(
name|int
parameter_list|)
specifier|const
block|{
return|return
literal|0
return|;
block|}
end_function
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// QT_NO_ITEMVIEWS
end_comment
begin_macro
name|QT_END_NAMESPACE
end_macro
begin_endif
endif|#
directive|endif
end_endif
begin_comment
comment|// QT_NO_ACCESSIBILITY
end_comment
end_unit
